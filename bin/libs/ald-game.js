!function(){function I(){return new Promise(function(a,b){"1044"==k.scene?wx.getShareInfo({shareTicket:k.shareTicket,success:function(b){a(b)},fail:function(){a("")}}):a("")})}function h(a){function b(a){return Object.prototype.toString.call(a)}var c={};return"Boolean Number String Function Array Date RegExp Object Error Symbol".split(" ").forEach(function(a,b){c["[object "+a+"]"]=a.toLowerCase()}),null==a?a:"object"==typeof a||"function"==typeof a?c[b.call(a)]||"object":typeof a}function J(){function a(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return a()+a()+a()+a()+a()+a()+a()+a()}function K(){this.concurrency=4;this.queue=[];this.tasks=[];this.activeCount=0;var a=this;this.push=function(b){this.tasks.push(new Promise(function(c,d){var e=function(){a.activeCount++;b().then(function(a){c(a)}).then(function(){a.next()})};a.activeCount<a.concurrency?e():a.queue.push(e)}))};this.all=function(){return Promise.all(this.tasks)};this.next=function(){a.activeCount--;0<a.queue.length&&a.queue.shift()()}}function g(a,b){x++;a.as=L;a.at=y;a.rq_c=x;a.ifo=q;a.ak=p.app_key;a.uu=l;a.v=z;a.st=Date.now();a.ev=b;a.wsr=k;""!==M(a.ufo)&&(a.ufo=a.ufo);a.ec=A;wx.Queue.push(function(){return new Promise(function(b,d){wx.request({url:"https://"+B+".aldwx.com/d.html",data:a,header:{se:C||"",op:D||"",img:u||""},method:"GET",fail:function(){b("")},success:function(a){b(200==a.statusCode?"":"status error")}})})})}function M(a){if(void 0===a||""===a)return"";var b={},c;for(c in a)"rawData"!=c&&"errMsg"!=c&&(b[c]=a[c]);return b}function m(a){var b={},c;for(c in a)b[c]=a[c];return b}function E(a){for(var b="",c=0;c<a.length;c++)a[c].length>b.length&&(b=a[c]);return b}var z="2.0.0",B="glog",p=require("./ald-game-conf");""===p.app_key&&console.error("\u8bf7\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u586b\u5199\u60a8\u7684app_key");p.app_key=p.app_key.replace(/\s/g,"");(function(){wx.request({url:"https://"+B+".aldwx.com/config/app.json",method:"GET",success:function(a){200===a.statusCode&&(a.data.version!=z&&console.warn("\u60a8\u7684SDK\u4e0d\u662f\u6700\u65b0\u7248\u672c\uff0c\u8bf7\u5c3d\u5feb\u5347\u7ea7\uff01"),a.data.warn&&console.warn(a.data.warn),a.data.error&&console.error(a.data.error))}})})();var q="",l=function(){var a="";try{a=wx.getStorageSync("aldstat_uuid"),wx.setStorageSync("ald_ifo",!0)}catch(b){a="uuid_getstoragesync"}if(a)q=!1;else{a=J();q=!0;try{wx.setStorageSync("aldstat_uuid",a)}catch(b){wx.setStorageSync("aldstat_uuid","uuid_getstoragesync")}}return a}(),d={},C="",D="",A=0,x="",k=wx.getLaunchOptionsSync(),N=Date.now(),y=""+Date.now()+Math.floor(1E7*Math.random()),L=""+Date.now()+Math.floor(1E7*Math.random()),v=0,n="",u="",F=!0,r=!1,w="aldSendEvent aldOnShareAppMessage aldShareAppMessage aldSendSession aldSendOpenid aldLevelEvent".split(" "),G="payStart paySuccess payFail die revive tools award".split(" "),H=["complete","fail"];void 0===wx.Queue&&(wx.Queue=new K,wx.Queue.all());Promise.all([function(){return new Promise(function(a,b){wx.getSetting({success:function(b){b.authSetting["scope.userInfo"]?wx.getUserInfo({success:function(b){u=E(b.userInfo.avatarUrl.split("/"));a(b)},fail:function(){a("")}}):a("")},fail:function(){a("")}})})}(),function(){return new Promise(function(a,b){wx.getNetworkType({success:function(b){a(b)},fail:function(){a("")}})})}(),function(){return new Promise(function(a,b){p.getLocation?wx.getLocation({success:function(b){a(b)},fail:function(){a("")}}):wx.getSetting({success:function(b){b.authSetting["scope.userLocation"]?(wx.getLocation({success:function(b){a(b)},fail:function(){a("")}}),a("")):a("")},fail:function(){a("")}})})}()]).then(function(a){""!==a[2]?(d.lat=a[2].latitude||"",d.lng=a[2].longitude||"",d.spd=a[2].speed||""):(d.lat="",d.lng="",d.spd="");""!==a[1]?d.nt=a[1].networkType||"":d.nt="";var b=m(d);""!==a[0]&&(b.ufo=a[0],n=a[0]);g(b,"init")});wx.onShow(function(a){if(k=a,v=Date.now(),!F&&!r){y=""+Date.now()+Math.floor(1E7*Math.random());q=!1;try{wx.setStorageSync("ald_ifo",!1)}catch(P){}}r=F=!1;var b=m(d),c=m(d);b.sm=v-N;a.query.ald_share_src&&a.shareTicket&&"1044"===a.scene?(c.tp="ald_share_click",I().then(function(a){c.ct=a;g(c,"event")})):a.query.ald_share_src&&(c.tp="ald_share_click",c.ct="1",g(c,"event"));g(b,"show")});wx.onHide(function(){var a=m(d);a.dr=Date.now()-v;""===n?wx.getSetting({success:function(b){b.authSetting["scope.userInfo"]?wx.getUserInfo({success:function(b){n=a.ufo=b;u=E(b.userInfo.avatarUrl.split("/"));g(a,"hide")}}):g(a,"hide")}}):g(a,"hide")});wx.onError(function(a){var b=m(d);b.tp="ald_error_message";b.ct=a;A++;g(b,"event")});var O={aldSendEvent:function(a,b){var c=m(d);""!==a&&"string"==typeof a&&255>=a.length?(c.tp=a,"string"==typeof b&&255>=b.length?(c.ct=String(b),g(c,"event")):"object"==typeof b?(255<=JSON.stringify(b).length&&console.error("\u81ea\u5b9a\u4e49\u4e8b\u4ef6\u53c2\u6570\u4e0d\u80fd\u8d85\u8fc7255\u4e2a\u5b57\u7b26"),c.ct=JSON.stringify(b),g(c,"event")):void 0===b||""===b?g(c,"event"):console.error("\u4e8b\u4ef6\u53c2\u6570\u5fc5\u987b\u4e3aString,Object\u7c7b\u578b,\u4e14\u53c2\u6570\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc7255\u4e2a\u5b57\u7b26")):console.error("\u4e8b\u4ef6\u540d\u79f0\u5fc5\u987b\u4e3aString\u7c7b\u578b\u4e14\u4e0d\u80fd\u8d85\u8fc7255\u4e2a\u5b57\u7b26")},aldOnShareAppMessage:function(a){wx.onShareAppMessage(function(){r=!0;var b=a(),c;c=void 0!==k.query.ald_share_src?void 0!==b.query?(k.query.ald_share_src.indexOf(l),b.query+"\x26ald_share_src\x3d"+k.query.ald_share_src+","+l):(k.query.ald_share_src.indexOf(l),"ald_share_src\x3d"+k.query.ald_share_src+","+l):void 0!==b.query?b.query+"\x26ald_share_src\x3d"+l:"ald_share_src\x3d"+l;"undefined"!=h(b.ald_desc)&&(c+="\x26ald_desc\x3d"+b.ald_desc);b.query=c;c=m(d);return c.ct=b,c.ct.sho=1,c.tp="ald_share_chain",g(c,"event"),b})},aldShareAppMessage:function(a){r=!0;var b;b=void 0!==k.query.ald_share_src?void 0!==a.query?(k.query.ald_share_src.indexOf(l),a.query+"\x26ald_share_src\x3d"+k.query.ald_share_src+","+l):(k.query.ald_share_src.indexOf(l),"ald_share_src\x3d"+k.query.ald_share_src+","+l):void 0!==a.query?a.query+"\x26ald_share_src\x3d"+l:"ald_share_src\x3d"+l;var c=m(d);"undefined"!=h(a.ald_desc)&&(b+="\x26ald_desc\x3d"+a.ald_desc);a.query=b;c.ct=a;c.tp="ald_share_chain";g(c,"event");wx.shareAppMessage(a)},aldSendSession:function(a){if(""===a||!a)return void console.error("\u8bf7\u4f20\u5165\u4ece\u540e\u53f0\u83b7\u53d6\u7684session_key");var b=m(d);b.tp="session";b.ct="session";C=a;""===n?wx.getSetting({success:function(a){a.authSetting["scope.userInfo"]?wx.getUserInfo({success:function(a){b.ufo=a;g(b,"event")}}):g(b,"event")}}):(b.ufo=n,""!==n&&(b.gid=""),g(b,"event"))},aldSendOpenid:function(a){if(""===a||!a)return void console.error("openID\u4e0d\u80fd\u4e3a\u7a7a");D=a;a=m(d);a.tp="openid";a.ct="openid";g(a,"event")}};wx.aldStage=new function(){function a(a){return!/^\d+(.\d+)*$/.test(a.stageId)||32<a.stageId.length?(console.warn("\u5173\u5361stageId\u5fc5\u987b\u7b26\u5408\u4f20\u53c2\u89c4\u5219,\u8bf7\u53c2\u8003\u6587\u6863\u3002"),!1):!("string"!==h(a.stageName)||32<a.stageName.length)||(console.warn("\u5173\u5361\u540d\u79f0\u4e3a\u5fc5\u4f20\u5b57\u6bb5,\u4e14\u957f\u5ea6\u5c0f\u4e8e32\u4e2a\u5b57\u7b26,\u8bf7\u53c2\u8003\u6587\u6863"),!1)}var b="",c="",f=0;this.onStart=function(e){if(a(e)){var d={};f=Date.now();d.sid=e.stageId;d.snm=e.stageName;d.state="start";c=""+Date.now()+Math.floor(1E7*Math.random());b=d;32>("string"===h(e.userId)&&e.userId)&&(this.uid=e.uid);this.request()}};this.onRunning=function(e){if(a(e)){var c={params:{}};if(32>("string"===h(e.userId)&&e.userId)&&(this.uid=e.uid),!h(e.event)&&-1!=G.join(",").indexOf(e.event+","))return void G.join(",");if(c.event=e.event,"object"===h(e.params)){if("string"!==h(e.params.itemName)||32<e.params.itemName.length)return void console.warn("\u9053\u5177/\u5546\u54c1\u540d\u79f0\u4e3a\u5fc5\u4f20\u5b57\u6bb5\uff0c\u4e14\u957f\u5ea6\u5c0f\u4e8e32\u4e2a\u5b57\u7b26\uff0c\u8be6\u60c5\u8bf7\u53c2\u8003\u6587\u6863");c.params.itnm=e.params.itemName;"string"===h(e.params.itemId)&&32>e.params.itemId.length&&(c.params.itid=e.params.itemId);"number"===h(e.params.itemCount)&&32>e.params.itemCount.length?c.params.itco=e.params.itemCount:c.params.itco=1;-1!==e.event.indexOf("pay")&&("number"===h(e.params.itemMoney)&&32>e.params.itemMoney.length?c.params.money=e.params.itemMoney:c.params.money=0);"string"===h(e.params.desc)&&64>e.params.desc.length&&(c.params.desc=e.params.desc);c.state="running";c.sid=e.stageId;c.snm=e.stageName;b=c;this.request()}}};this.onEnd=function(c){if(a(c)){var d={};if(d.state="end",32>("string"===h(c.userId)&&c.userId)&&(this.uid=c.uid),!h(c.event)&&-1!==H.join(",").indexOf(c.event+","))return void H.join(",");d.sid=c.stageId;d.snm=c.stageName;d.event=c.event;d.sdr=0!==f?Date.now()-f:"";d.params={};"object"===h(c.params)&&"string"===h(c.params.desc)&&64>c.params.desc.length&&(d.params.desc=c.params.desc);b=d;this.request()}};this.request=function(){var a=m(d);b.ss=c;a.ct=b;g(a,"screen")}};for(var t=0;t<w.length;t++)Object.defineProperty(wx,w[t],{value:O[w[t]],writable:!1,enumerable:!0,configurable:!0}),!0;try{var f=wx.getSystemInfoSync();d.br=f.brand||"";d.md=f.model;d.pr=f.pixelRatio;d.sw=f.screenWidth;d.sh=f.screenHeight;d.ww=f.windowWidth;d.wh=f.windowHeight;d.lang=f.language;d.wv=f.version;d.sv=f.system;d.wvv=f.platform;d.fs=f.fontSizeSetting;d.wsdk=f.SDKVersion;d.bh=f.benchmarkLevel||"";d.bt=f.battery||"";d.wf=f.wifiSignal||"";d.lng="";d.lat="";d.nt="";d.spd="";d.ufo=""}catch(a){}}();