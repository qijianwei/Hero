(function(Y,Z,F){var R=F["static"],A=F["class"],D=F.getset,aa=F.__newvec,ka=laya.maths.Bezier,ba=laya.utils.Browser,N=laya.utils.Byte;Y=laya.events.EventDispatcher;Z=laya.display.Graphics;var P=laya.utils.Handler,J=laya.net.Loader,la=laya.maths.MathUtil,y=laya.maths.Matrix,ma=laya.maths.Rectangle,na=laya.resource.Resource,S=laya.media.SoundManager,O=laya.display.Sprite,U=laya.utils.Stat,ca=laya.resource.Texture,da=laya.utils.Utils,oa=function(){function b(){this.name=null;this.displayArr=[]}A(b,"laya.ani.bone.SlotData");b.prototype.getDisplayByName=function(b){for(var a,c=0,g=this.displayArr.length;c<g;c++)if(a=this.displayArr[c],a.attachmentName==b)return c;return-1};return b}(),pa=function(){function b(){this.uvTransform=this.texture=null;this.useUvTransform=!1;this.canvasPadding=1;this.uvs=new Float32Array([0,0,1,0,1,1,0,1]);this.vertices=new Float32Array([0,0,100,0,100,100,0,100]);this.indexes=new Uint16Array([0,1,3,3,1,2])}A(b,"laya.ani.bone.canvasmesh.MeshData");b.prototype.getBounds=function(){return ma._getWrapRec(this.vertices)};return b}(),ea=function(){function b(){this.name=null;this.parentIndex=0;this.parent=null;this.lerpType=this.keyframeWidth=0;this.keyFrame=this.childs=this.interpolationMethod=null;this.playTime=NaN;this.extenData=null;this.dataOffset=0}A(b,"laya.ani.AnimationNodeContent");return b}(),fa=function(){function b(){this.duration=this.startTime=NaN;this.nextData=this.dData=this.data=this.interpolationData=null}A(b,"laya.ani.KeyFramesContent");return b}(),qa=function(){function b(b,a){this.target=this._bones=this._data=null;this.shearMix=this.scaleMix=this.translateMix=this.rotateMix=NaN;this._temp=aa(2,0);this._data=b;null==this._bones&&(this._bones=[]);this.target=a[b.targetIndex];var c,g;c=0;for(g=b.boneIndexs.length;c<g;c++)this._bones.push(a[b.boneIndexs[c]]);this.rotateMix=b.rotateMix;this.translateMix=b.translateMix;this.scaleMix=b.scaleMix;this.shearMix=b.shearMix}A(b,"laya.ani.bone.TfConstraint");b.prototype.apply=function(){for(var b,a=this.target.resultMatrix.a,c=this.target.resultMatrix.b,g=this.target.resultMatrix.c,e=this.target.resultMatrix.d,d=0,k=this._bones.length;d<k;d++){b=this._bones[d];if(0<this.rotateMix){var f=b.resultMatrix.a,l=b.resultMatrix.b,p=b.resultMatrix.c,n=b.resultMatrix.d,m=Math.atan2(g,a)-Math.atan2(p,f)+this._data.offsetRotation*Math.PI/180;m>Math.PI?m-=2*Math.PI:m<-Math.PI&&(m+=2*Math.PI);var m=m*this.rotateMix,r=Math.cos(m),m=Math.sin(m);b.resultMatrix.a=r*f-m*p;b.resultMatrix.b=r*l-m*n;b.resultMatrix.c=m*f+r*p;b.resultMatrix.d=m*l+r*n}this.translateMix&&(this._temp[0]=this._data.offsetX,this._temp[1]=this._data.offsetY,this.target.localToWorld(this._temp),b.resultMatrix.tx+=(this._temp[0]-b.resultMatrix.tx)*this.translateMix,b.resultMatrix.ty+=(this._temp[1]-b.resultMatrix.ty)*this.translateMix,b.updateChild());0<this.scaleMix&&(l=Math.sqrt(b.resultMatrix.a*b.resultMatrix.a+b.resultMatrix.c*b.resultMatrix.c),n=Math.sqrt(a*a+g*g),l=1E-5<l?(l+(n-l+this._data.offsetScaleX)*this.scaleMix)/l:0,b.resultMatrix.a*=l,b.resultMatrix.c*=l,l=Math.sqrt(b.resultMatrix.b*b.resultMatrix.b+b.resultMatrix.d*b.resultMatrix.d),n=Math.sqrt(c*c+e*e),l=1E-5<l?(l+(n-l+this._data.offsetScaleY)*this.scaleMix)/l:0,b.resultMatrix.b*=l,b.resultMatrix.d*=l);0<this.shearMix&&(l=b.resultMatrix.b,n=b.resultMatrix.d,f=Math.atan2(n,l),m=Math.atan2(e,c)-Math.atan2(g,a)-(f-Math.atan2(b.resultMatrix.c,b.resultMatrix.a)),m>Math.PI?m-=2*Math.PI:m<-Math.PI&&(m+=2*Math.PI),m=f+(m+this._data.offsetShearY*Math.PI/180)*this.shearMix,l=Math.sqrt(l*l+n*n),b.resultMatrix.b=Math.cos(m)*l,b.resultMatrix.d=Math.sin(m)*l)}};return b}(),ra=function(){function b(){this.rotateMode=this.spacingMode=this.positionMode=this.target=this.name=null;this.translateMix=this.rotateMix=this.spacing=this.position=this.offsetRotation=NaN;this.bones=[]}A(b,"laya.ani.bone.PathConstraintData");return b}(),T=function(){function b(){}A(b,"laya.ani.bone.UVTools");b.getRelativeUV=function(b,a,c){var g=b[0],e=b[2]-b[0],d=b[1],k=b[5]-b[1];c||(c=[]);c.length=a.length;b=c.length;for(var e=1/e,f=1/k,k=0;k<b;k+=2)c[k]=(a[k]-g)*e,c[k+1]=(a[k+1]-d)*f;return c};b.getAbsoluteUV=function(b,a,c){if(0==b[0]&&0==b[1]&&1==b[4]&&1==b[5])return c?(da.copyArray(c,a),c):a;var g=b[0],e=b[2]-b[0],d=b[1];b=b[5]-b[1];c||(c=[]);c.length=a.length;var k,f;f=c.length;for(k=0;k<f;k+=2)c[k]=a[k]*e+g,c[k+1]=a[k+1]*b+d;return c};return b}(),sa=function(){function b(){this.deformSlotDisplayList=[]}A(b,"laya.ani.bone.DeformSlotData");return b}(),ta=function(){function b(){}A(b,"laya.ani.AnimationParser02");b.READ_DATA=function(){b._DATA.offset=b._reader.getUint32();b._DATA.size=b._reader.getUint32()};b.READ_BLOCK=function(){for(var h=b._BLOCK.count=b._reader.getUint16(),a=b._BLOCK.blockStarts=[],c=b._BLOCK.blockLengths=[],g=0;g<h;g++)a.push(b._reader.getUint32()),c.push(b._reader.getUint32())};b.READ_STRINGS=function(){var h=b._reader.getUint32(),a=b._reader.getUint16(),c=b._reader.pos;b._reader.pos=h+b._DATA.offset;for(h=0;h<a;h++)b._strings[h]=b._reader.readUTFString();b._reader.pos=c};b.parse=function(h,a){b._templet=h;b._reader=a;a.__getBuffer();b.READ_DATA();b.READ_BLOCK();b.READ_STRINGS();for(var c=0,g=b._BLOCK.count;c<g;c++){var e=a.getUint16(),d=b._strings[e],k=b["READ_"+d];if(null==k)throw Error("model file err,no this function:"+e+" "+d);k.call(null)}};b.READ_ANIMATIONS=function(){var h=b._reader,a=h.__getBuffer(),c,g,e,d,k=h.getUint16(),f=[];f.length=k;for(c=0;c<k;c++)f[c]=V.interpolation[h.getByte()];var l=h.getUint8();b._templet._anis.length=l;for(c=0;c<l;c++){var p=b._templet._anis[c]=new ga;p.nodes=[];g=p.name=b._strings[h.getUint16()];b._templet._aniMap[g]=c;p.bone3DMap={};p.playTime=h.getFloat32();var n=p.nodes.length=h.getInt16();for(g=p.totalKeyframeDatasLength=0;g<n;g++){var m=p.nodes[g]=new ea;m.keyframeWidth=k;m.childs=[];e=h.getUint16();0<=e&&(m.name=b._strings[e],p.bone3DMap[m.name]=g);m.keyFrame=[];m.parentIndex=h.getInt16();-1==m.parentIndex?m.parent=null:m.parent=p.nodes[m.parentIndex];p.totalKeyframeDatasLength+=k;m.interpolationMethod=f;null!=m.parent&&m.parent.childs.push(m);var r=h.getUint16();m.keyFrame.length=r;var t=null,u=null;e=0;for(d=r;e<d;e++){t=m.keyFrame[e]=new fa;t.startTime=h.getFloat32();u&&(u.duration=t.startTime-u.startTime);t.dData=new Float32Array(k);t.nextData=new Float32Array(k);var u=b._DATA.offset,q=h.getUint32(),u=a.slice(u+q,u+q+4*k);t.data=new Float32Array(u);u=t}t.duration=0;m.playTime=p.playTime;b._templet._calculateKeyFrame(m,r,k)}}};b._templet=null;b._reader=null;b._strings=[];R(b,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]);return b}(),ha=function(){function b(){}A(b,"laya.ani.AnimationParser01");b.parse=function(b,a){var c=a.__getBuffer(),g,e,d,k,f,l,p=a.readUTFString();b._aniClassName=p;var p=a.readUTFString().split("\n"),h=a.getUint8(),m=a.getUint32();g=a.getUint32();var r;0<m&&(r=c.slice(m,g));r=new N(r);0<g&&(b._publicExtData=c.slice(g,c.byteLength));b._useParent=!!a.getUint8();b._anis.length=h;for(g=0;g<h;g++){m=b._anis[g]=new ga;m.nodes=[];e=m.name=p[a.getUint16()];b._aniMap[e]=g;m.bone3DMap={};m.playTime=a.getFloat32();var t=m.nodes.length=a.getUint8();for(e=m.totalKeyframeDatasLength=0;e<t;e++){var u=m.nodes[e]=new ea;u.childs=[];var q=a.getInt16();0<=q&&(u.name=p[q],m.bone3DMap[u.name]=e);u.keyFrame=[];u.parentIndex=a.getInt16();-1==u.parentIndex?u.parent=null:u.parent=m.nodes[u.parentIndex];u.lerpType=a.getUint8();q=a.getUint32();r.pos=q;q=u.keyframeWidth=r.getUint16();m.totalKeyframeDatasLength+=q;if(0===u.lerpType||1===u.lerpType)for(u.interpolationMethod=[],u.interpolationMethod.length=q,d=0;d<q;d++)u.interpolationMethod[d]=V.interpolation[r.getUint8()];null!=u.parent&&u.parent.childs.push(u);d=a.getUint16();0<d&&(u.extenData=c.slice(a.pos,a.pos+d),a.pos+=d);var v=a.getUint16();u.keyFrame.length=v;var w=0,x;d=0;for(k=v;d<k;d++){x=u.keyFrame[d]=new fa;x.duration=a.getFloat32();x.startTime=w;if(2===u.lerpType)switch(x.interpolationData=[],f=a.getUint8(),l=a.getFloat32(),l){case 254:x.interpolationData.length=q;for(f=0;f<q;f++)x.interpolationData[f]=0;break;case 255:x.interpolationData.length=q;for(f=0;f<q;f++)x.interpolationData[f]=5;break;default:for(x.interpolationData.push(l),l=1;l<f;l++)x.interpolationData.push(a.getFloat32())}x.data=new Float32Array(q);x.dData=new Float32Array(q);x.nextData=new Float32Array(q);for(f=0;f<q;f++)x.data[f]=a.getFloat32(),-1E-8<x.data[f]&&1E-8>x.data[f]&&(x.data[f]=0);w+=x.duration}x.startTime=m.playTime;u.playTime=m.playTime;b._calculateKeyFrame(u,v,q)}}};return b}(),ua=function(){function b(){this.name=null;this.slotArr=[]}A(b,"laya.ani.bone.SkinData");return b}(),va=function(){function b(a,c){this.name=this._data=this._bones=this._targetBone=null;this.bendDirection=this.mix=NaN;this.isSpine=!0;this._sp=null;this.isDebug=!1;this._data=a;this._targetBone=c[a.targetBoneIndex];this.isSpine=a.isSpine;null==this._bones&&(this._bones=[]);for(var g=this._bones.length=0,e=a.boneIndexs.length;g<e;g++)this._bones.push(c[a.boneIndexs[g]]);this.name=a.name;this.mix=a.mix;this.bendDirection=a.bendDirection}A(b,"laya.ani.bone.IkConstraint");var h=b.prototype;h.apply=function(){switch(this._bones.length){case 1:this._applyIk1(this._bones[0],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.mix);break;case 2:this.isSpine?this._applyIk2(this._bones[0],this._bones[1],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.bendDirection,this.mix):this._applyIk3(this._bones[0],this._bones[1],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.bendDirection,this.mix)}};h._applyIk1=function(a,c,g,e){var d=a.parentBone,k=1/(d.resultMatrix.a*d.resultMatrix.d-d.resultMatrix.b*d.resultMatrix.c);c-=d.resultMatrix.tx;g-=d.resultMatrix.ty;d=Math.atan2((g*d.resultMatrix.a-c*d.resultMatrix.b)*k-a.transform.y,(c*d.resultMatrix.d-g*d.resultMatrix.c)*k-a.transform.x)*b.radDeg-0-a.transform.skX;0>a.transform.scX&&(d+=180);180<d?d-=360:-180>d&&(d+=360);a.transform.skX=a.transform.skY=a.transform.skX+d*e;a.update()};h.updatePos=function(a,c){this._sp&&this._sp.pos(a,c)};h._applyIk2=function(a,c,g,e,d,k){if(0!=k){var f=a.resultTransform.x,l=a.resultTransform.y,p=a.transform.scX,h=a.transform.scY,m=c.transform.scX,r,t,u;0>p?(p=-p,r=180,u=-1):(r=0,u=1);0>h&&(h=-h,u=-u);0>m?(m=-m,t=180):t=0;var q=c.resultTransform.x,v,w,x,z=a.resultMatrix.a,H=a.resultMatrix.c,A=a.resultMatrix.b,y=a.resultMatrix.d,D=1E-4>=Math.abs(p-h);D?(v=c.resultTransform.y,w=z*q+H*v+a.resultMatrix.tx,x=A*q+y*v+a.resultMatrix.ty):(v=0,w=z*q+a.resultMatrix.tx,x=A*q+a.resultMatrix.ty);this.isDebug&&(this._sp||(this._sp=new O,F.stage.addChild(this._sp)),this._sp.graphics.clear(),this._sp.graphics.drawCircle(g,e,15,"#ffff00"),this._sp.graphics.drawCircle(w,x,15,"#ff00ff"));a.setRotation(Math.atan2(x-a.resultMatrix.ty,w-a.resultMatrix.tx));var G=a.parentBone,z=G.resultMatrix.a,H=G.resultMatrix.c,A=G.resultMatrix.b,y=G.resultMatrix.d,I=1/(z*y-H*A),B=g-G.resultMatrix.tx,C=e-G.resultMatrix.ty;e=(B*y-C*H)*I-f;g=(C*z-B*A)*I-l;B=w-G.resultMatrix.tx;C=x-G.resultMatrix.ty;H=(B*y-C*H)*I-f;z=(C*z-B*A)*I-l;C=Math.sqrt(H*H+z*z);H=c.length*m;if(D)H*=p,z=(e*e+g*g-C*C-H*H)/(2*C*H),-1>z?z=-1:1<z&&(z=1),d*=Math.acos(z),z=C+H*z,H*=Math.sin(d),z=Math.atan2(g*z-e*H,e*z+g*H);else{z=p*H;H*=h;D=Math.atan2(g,e);p=0;m=Number.MAX_VALUE;G=x=w=h=I=A=0;B=C+z;y=B*B;y>w&&(h=0,w=y,x=B);B=C-z;y=B*B;y<m&&(p=Math.PI,m=y,A=B);var E=Math.acos(-z*C/(z*z-H*H)),B=z*Math.cos(E)+C,C=H*Math.sin(E),y=B*B+C*C;y<m&&(p=E,m=y,A=B,I=C);y>w&&(h=E,w=y,x=B,G=C);e*e+g*g<=(m+w)/2?(z=D-Math.atan2(I*d,A),d*=p):(z=D-Math.atan2(G*d,x),d*=h)}e=Math.atan2(v,q)*u;g=a.resultTransform.skX;z=(z-e)*b.radDeg+r-g;180<z?z-=360:-180>z&&(z+=360);a.resultTransform.x=f;a.resultTransform.y=l;a.resultTransform.skX=a.resultTransform.skY=g+z*k;g=c.resultTransform.skX;d=((d+e)*b.radDeg-0)*u+t-g%360;180<d?d-=360:-180>d&&(d+=360);c.resultTransform.x=q;c.resultTransform.y=v;c.resultTransform.skX=c.resultTransform.skY+=d*k;a.update()}};h._applyIk3=function(a,c,g,e,d,k){if(0!=k){var f;k=c.resultMatrix.a*c.length;var l=c.resultMatrix.b*c.length,p=k*k+l*l,h=Math.sqrt(p);k=a.resultMatrix.tx;l=a.resultMatrix.ty;f=c.resultMatrix.tx;var m=c.resultMatrix.ty;f-=k;var m=m-l,r=f*f+m*m,t=Math.sqrt(r);f=g-a.resultMatrix.tx;var m=e-a.resultMatrix.ty,u=f*f+m*m,q=Math.sqrt(u);h+t<=q||q+h<=t||q+t<=h?(d=h+t<=q?1:-1,f=k+d*(g-k)*t/q,m=l+d*(e-l)*t/q):(p=(r-p+u)/(2*u),h=Math.sqrt(r-p*p*u)/q,q=k+f*p,p=l+m*p,m=-m*h,h*=f,0<d?(f=q-m,m=p-h):(f=q+m,m=p+h));d=f;f=m;this.isDebug&&(this._sp||(this._sp=new O,F.stage.addChild(this._sp)),this._sp.graphics.clear(),this._sp.graphics.drawCircle(k,l,15,"#ff00ff"),this._sp.graphics.drawCircle(g,e,15,"#ffff00"),this._sp.graphics.drawCircle(d,f,15,"#ff00ff"));l=Math.atan2(f-a.resultMatrix.ty,d-a.resultMatrix.tx);a.setRotation(l);k=b._tempMatrix;k.identity();k.rotate(l);k.scale(a.resultMatrix.getScaleX(),a.resultMatrix.getScaleY());k.translate(a.resultMatrix.tx,a.resultMatrix.ty);k.copyTo(a.resultMatrix);a.updateChild();a=Math.atan2(e-f,g-d);c.setRotation(a);g=b._tempMatrix;g.identity();g.rotate(a);g.scale(c.resultMatrix.getScaleX(),c.resultMatrix.getScaleY());g.translate(d,f);k.copyTo(c.resultMatrix);c.updateChild()}};R(b,["radDeg",function(){return this.radDeg=180/Math.PI},"degRad",function(){return this.degRad=Math.PI/180},"_tempMatrix",function(){return this._tempMatrix=new y}]);return b}(),wa=function(){function b(){this.name=null;this.targetIndex=0;this.offsetShearY=this.offsetScaleY=this.offsetScaleX=this.offsetY=this.offsetX=this.offsetRotation=this.shearMix=this.scaleMix=this.translateMix=this.rotateMix=NaN;this.boneIndexs=[]}A(b,"laya.ani.bone.TfConstraintData");return b}(),ga=function(){function b(){this.name=this.nodes=null;this.playTime=NaN;this.bone3DMap=null;this.totalKeyframeDatasLength=0}A(b,"laya.ani.AnimationContent");return b}();(function(){function b(){}A(b,"laya.ani.AnimationState");b.stopped=0;b.paused=1;b.playing=2;return b})();var xa=function(){function b(){this.skinName=null;this.deformSlotDataList=[]}A(b,"laya.ani.bone.DeformAniData");return b}(),ya=function(){function b(){this.attachmentName=this.name=null;this.type=0;this.transform=null;this.height=this.width=NaN;this.lengths=this.vertices=this.triangles=this.weights=this.uvs=this.bones=this.texture=null;this.verLen=0}A(b,"laya.ani.bone.SkinSlotDisplayData");var h=b.prototype;h.createTexture=function(a){if(this.texture)return this.texture;this.texture=new ca(a.bitmap,this.uvs);this.uvs[0]>this.uvs[4]&&this.uvs[1]>this.uvs[5]?(this.texture.width=a.height,this.texture.height=a.width,this.texture.offsetX=-a.offsetX,this.texture.offsetY=-a.offsetY,this.texture.sourceWidth=a.sourceHeight,this.texture.sourceHeight=a.sourceWidth):(this.texture.width=a.width,this.texture.height=a.height,this.texture.offsetX=-a.offsetX,this.texture.offsetY=-a.offsetY,this.texture.sourceWidth=a.sourceWidth,this.texture.sourceHeight=a.sourceHeight);return this.texture};h.destory=function(){this.texture&&this.texture.destroy()};return b}(),za=function(){function b(){this.boneSlot=null;this.slotIndex=-1;this.deformData=this.attachment=null;this.frameIndex=0;this.timeList=[];this.vectices=[];this.tweenKeyList=[]}A(b,"laya.ani.bone.DeformSlotDisplayData");var h=b.prototype;h.binarySearch1=function(a,c){var g=0,e=a.length-2;if(0==e)return 1;for(var d=e>>>1;;){a[Math.floor(d+1)]<=c?g=d+1:e=d;if(g==e)return g+1;d=g+e>>>1}};h.apply=function(a,c,g){void 0===g&&(g=1);a+=.05;if(!(0>=this.timeList.length||a<this.timeList[0])){c=this.vectices[0].length;var e=[],d=this.binarySearch1(this.timeList,a);this.frameIndex=d;if(a>=this.timeList[this.timeList.length-1]){var b=this.vectices[this.vectices.length-1];if(1>g)for(a=0;a<c;a++)e[a]+=(b[a]-e[a])*g;else for(a=0;a<c;a++)e[a]=b[a]}else{var b=this.vectices[this.frameIndex-1],f=this.vectices[this.frameIndex];g=this.timeList[this.frameIndex-1];var l=this.timeList[this.frameIndex];g=this.tweenKeyList[d-1]?(a-g)/(l-g):0;for(a=0;a<c;a++)d=b[a],e[a]=d+(f[a]-d)*g}this.deformData=e}};return b}(),Ba=function(){function b(){this.attachmentName=this.parent=this.name=null;this.srcDisplayIndex=-1;this.type="src";this.currDisplayData=this.currTexture=this.currSlotData=this.templet=null;this.originalIndex=this.displayIndex=-1;this._resultMatrix=this._parentMatrix=this._diyTexture=null;this._replaceDic={};this._preGraphicMatrix=this._preGraphicVerticle=this._mVerticleArr=this.deformData=this._skinSprite=this._curDiyVS=this._curDiyUV=null}A(b,"laya.ani.bone.BoneSlot");var h=b.prototype;h.showSlotData=function(a,c){void 0===c&&(c=!0);this.currSlotData=a;c&&(this.displayIndex=this.srcDisplayIndex);this.currTexture=this.currDisplayData=null};h.showDisplayByName=function(a){this.currSlotData&&this.showDisplayByIndex(this.currSlotData.getDisplayByName(a))};h.replaceDisplayByName=function(a,c){if(this.currSlotData){var g;g=this.currSlotData.getDisplayByName(a);var e;e=this.currSlotData.getDisplayByName(c);this.replaceDisplayByIndex(g,e)}};h.replaceDisplayByIndex=function(a,c){this.currSlotData&&(this._replaceDic[a]=c,this.originalIndex==a&&this.showDisplayByIndex(a))};h.showDisplayByIndex=function(a){this.originalIndex=a;null!=this._replaceDic[a]&&(a=this._replaceDic[a]);this.currSlotData&&-1<a&&a<this.currSlotData.displayArr.length?(this.displayIndex=a,(this.currDisplayData=this.currSlotData.displayArr[a])&&(this.currTexture=this.templet.getTexture(this.currDisplayData.name))&&0==this.currDisplayData.type&&this.currDisplayData.uvs&&(this.currTexture=this.currDisplayData.createTexture(this.currTexture))):(this.displayIndex=-1,this.currTexture=this.currDisplayData=null)};h.replaceSkin=function(a){this._diyTexture=a;this._curDiyUV&&(this._curDiyUV.length=0);this.currDisplayData&&this._diyTexture==this.currDisplayData.texture&&(this._diyTexture=null)};h.setParentMatrix=function(a){this._parentMatrix=a};h.getSaveVerticle=function(a){b.useSameMatrixAndVerticle&&this._preGraphicVerticle&&b.isSameArr(a,this._preGraphicVerticle)?a=this._preGraphicVerticle:this._preGraphicVerticle=a=da.copyArray([],a);return a};h.getSaveMatrix=function(a){b.useSameMatrixAndVerticle&&this._preGraphicMatrix&&b.isSameMatrix(a,this._preGraphicMatrix)?a=this._preGraphicMatrix:this._preGraphicMatrix=a=a.clone();return a};h.draw=function(a,c,g,e){void 0===g&&(g=!1);void 0===e&&(e=1);if(null==this._diyTexture&&null==this.currTexture||null==this.currDisplayData)if(!this.currDisplayData||3!=this.currDisplayData.type)return;var d=this.currTexture;this._diyTexture&&(d=this._diyTexture);var k;switch(this.currDisplayData.type){case 0:if(a&&(c=this.getDisplayMatrix(),this._parentMatrix&&(k=!1,c))){y.mul(c,this._parentMatrix,y.TEMP);g?(null==this._resultMatrix&&(this._resultMatrix=new y),c=this._resultMatrix):c=b._tempResultMatrix;if(this._diyTexture&&this.currDisplayData.uvs){var f=b._tempMatrix;f.identity();this.currDisplayData.uvs[1]>this.currDisplayData.uvs[5]&&(f.d=-1);this.currDisplayData.uvs[0]>this.currDisplayData.uvs[4]&&this.currDisplayData.uvs[1]>this.currDisplayData.uvs[5]&&(k=!0,f.rotate(-Math.PI/2));y.mul(f,y.TEMP,c)}else y.TEMP.copyTo(c);g||(c=this.getSaveMatrix(c));c._checkTransform();k?a.drawTexture(d,-this.currDisplayData.height/2,-this.currDisplayData.width/2,this.currDisplayData.height,this.currDisplayData.width,c,e):a.drawTexture(d,-this.currDisplayData.width/2,-this.currDisplayData.height/2,this.currDisplayData.width,this.currDisplayData.height,c,e)}break;case 1:g?(null==this._skinSprite&&(this._skinSprite=b.createSkinMesh()),k=this._skinSprite):k=b.createSkinMesh();if(null==k)break;null==this.currDisplayData.bones?(f=this.currDisplayData.weights,this.deformData&&(f=this.deformData),this._diyTexture?(this._curDiyUV||(this._curDiyUV=[]),0==this._curDiyUV.length&&(this._curDiyUV=T.getRelativeUV(this.currTexture.uv,this.currDisplayData.uvs,this._curDiyUV),this._curDiyUV=T.getAbsoluteUV(this._diyTexture.uv,this._curDiyUV,this._curDiyUV)),c=this._curDiyUV):c=this.currDisplayData.uvs,this._mVerticleArr=f,f=this.currDisplayData.triangles,this.deformData&&!g&&(this._mVerticleArr=this.getSaveVerticle(this._mVerticleArr)),k.init2(d,f,this._mVerticleArr,c),d=this.getDisplayMatrix(),this._parentMatrix&&d&&(y.mul(d,this._parentMatrix,y.TEMP),g?(null==this._resultMatrix&&(this._resultMatrix=new y),d=this._resultMatrix):d=b._tempResultMatrix,y.TEMP.copyTo(d),g||(d=this.getSaveMatrix(d)),k.transform=d)):this.skinMesh(c,k);a.drawSkin(k,e);break;case 2:g?(null==this._skinSprite&&(this._skinSprite=b.createSkinMesh()),k=this._skinSprite):k=b.createSkinMesh(),null!=k&&(this.skinMesh(c,k),a.drawSkin(k,e))}};h.skinMesh=function(a,c){var g=this.currTexture,e=this.currDisplayData.bones,d;this._diyTexture?(g=this._diyTexture,this._curDiyUV||(this._curDiyUV=[]),0==this._curDiyUV.length&&(this._curDiyUV=T.getRelativeUV(this.currTexture.uv,this.currDisplayData.uvs,this._curDiyUV),this._curDiyUV=T.getAbsoluteUV(this._diyTexture.uv,this._curDiyUV,this._curDiyUV)),d=this._curDiyUV):d=this.currDisplayData.uvs;var k=this.currDisplayData.weights,f=this.currDisplayData.triangles,l,h,n,m,r,t,u=0,q,v,w,x;b._tempVerticleArr.length=0;v=b._tempVerticleArr;if(this.deformData&&0<this.deformData.length){var z=0;w=0;for(x=e.length;w<x;){n=e[w++]+w;for(h=l=0;w<n;w++)m=a[e[w]],r=k[u]+this.deformData[z++],t=k[u+1]+this.deformData[z++],q=k[u+2],l+=(r*m.a+t*m.c+m.tx)*q,h+=(r*m.b+t*m.d+m.ty)*q,u+=3;v.push(l,h)}}else for(w=0,x=e.length;w<x;){n=e[w++]+w;for(h=l=0;w<n;w++)m=a[e[w]],r=k[u],t=k[u+1],q=k[u+2],l+=(r*m.a+t*m.c+m.tx)*q,h+=(r*m.b+t*m.d+m.ty)*q,u+=3;v.push(l,h)}this._mVerticleArr=v;this._mVerticleArr=this.getSaveVerticle(this._mVerticleArr);c.init2(g,f,this._mVerticleArr,d)};h.drawBonePoint=function(a){a&&this._parentMatrix&&a.drawCircle(this._parentMatrix.tx,this._parentMatrix.ty,5,"#ff0000")};h.getDisplayMatrix=function(){return this.currDisplayData?this.currDisplayData.transform.getMatrix():null};h.getMatrix=function(){return this._resultMatrix};h.copy=function(){var a=new b;a.type="copy";a.name=this.name;a.attachmentName=this.attachmentName;a.srcDisplayIndex=this.srcDisplayIndex;a.parent=this.parent;a.displayIndex=this.displayIndex;a.templet=this.templet;a.currSlotData=this.currSlotData;a.currTexture=this.currTexture;a.currDisplayData=this.currDisplayData;return a};b.createSkinMesh=function(){return new Aa};b.isSameArr=function(a,c){if(a.length!=c.length)return!1;var g,e;e=a.length;for(g=0;g<e;g++)if(a[g]!=c[g])return!1;return!0};b.isSameMatrix=function(a,c){return a.a==c.a&&a.b==c.b&&a.c==c.c&&a.d==c.d&&1E-5>Math.abs(a.tx-c.tx)&&1E-5>Math.abs(a.ty-c.ty)};b.useSameMatrixAndVerticle=!0;b._tempVerticleArr=[];R(b,["_tempMatrix",function(){return this._tempMatrix=new y},"_tempResultMatrix",function(){return this._tempResultMatrix=new y}]);return b}(),ia=function(){function b(a,c){this.bones=this.data=this.target=null;this.translateMix=this.rotateMix=this.spacing=this.position=NaN;this._debugKey=!1;this._spaces=null;this._segments=[];this._curves=[];this.data=a;this.position=a.position;this.spacing=a.spacing;this.rotateMix=a.rotateMix;this.translateMix=a.translateMix;this.bones=[];for(var g=this.data.bones,e=0,d=g.length;e<d;e++)this.bones.push(c[g[e]])}A(b,"laya.ani.bone.PathConstraint");var h=b.prototype;h.apply=function(a,c){if(this.target){var g=this.translateMix,e=this.translateMix,d=0<e,b=this.data.spacingMode,f="length"==b,l=this.data.rotateMode,h="tangent"==l,n="chainScale"==l,m=[],r=this.bones.length,t=h?r:r+1,u=[];this._spaces=u;u[0]=this.position;var q=this.spacing;if(n||f)for(var v=0,w=t-1;v<w;){var x=this.bones[v],z=x.length,y=z*x.resultMatrix.a,A=z*x.resultMatrix.b,z=Math.sqrt(y*y+A*A);n&&(m[v]=z);u[++v]=f?Math.max(0,z+q):q}else for(v=1;v<t;v++)u[v]=q;b=this.computeWorldPositions(this.target,a,c,t,h,"percent"==this.data.positionMode,"percent"==b);if(this._debugKey){for(v=0;v<b.length;v++)c.drawCircle(b[v++],b[v++],5,"#00ff00");x=[];for(v=0;v<b.length;v++)x.push(b[v++],b[v++]);c.drawLines(0,0,x,"#ff0000")}t=b[0];q=b[1];f=this.data.offsetRotation;l="chain"==l&&0==f;v=0;for(w=3;v<r;v++,w+=3){x=this.bones[v];x.resultMatrix.tx+=(t-x.resultMatrix.tx)*g;x.resultMatrix.ty+=(q-x.resultMatrix.ty)*g;var y=b[w],A=b[w+1],D=y-t,F=A-q;n&&(z=m[v],0!=z&&(z=(Math.sqrt(D*D+F*F)/z-1)*e+1,x.resultMatrix.a*=z,x.resultMatrix.c*=z));t=y;q=A;if(d){var y=x.resultMatrix.a,A=x.resultMatrix.c,G=x.resultMatrix.b,I=x.resultMatrix.d,B,C,E;B=h?b[w-1]:0==u[v+1]?b[w+2]:Math.atan2(F,D);B-=Math.atan2(G,y)-f/180*Math.PI;l&&(C=Math.cos(B),E=Math.sin(B),z=x.length,t+=(z*(C*y-E*G)-D)*e,q+=(z*(E*y+C*G)-F)*e);B>Math.PI?B-=2*Math.PI:B<-Math.PI&&(B+=2*Math.PI);B*=e;C=Math.cos(B);E=Math.sin(B);x.resultMatrix.a=C*y-E*G;x.resultMatrix.c=C*A-E*I;x.resultMatrix.b=E*y+C*G;x.resultMatrix.d=E*A+C*I}}}};h.computeWorldVertices2=function(a,c,g,e,d,k){var f=a.currDisplayData.bones,l=a.currDisplayData.weights,h=a.currDisplayData.triangles,n,m=0,r=0,t,u;if(null==f){h||(h=l);a.deformData&&(h=a.deformData);f=a.parent;if(c)for(m=c.length,a=0;a<m;a++)if(c[a].name==f){u=c[a];break}u&&(n=u.resultMatrix);n||(n=b._tempMt);c=n.tx;f=n.ty;l=n.a;a=n.b;r=n.c;n=n.d;u&&(n*=u.d);m=g;for(g=k;g<e;m+=2,g+=2)k=h[m],u=h[m+1],d[g]=k*l+u*a+c,d[g+1]=-(k*r+u*n+f)}else{for(a=0;a<g;a+=2)h=f[m],m+=h+1,r+=h;g=k;for(a=3*r;g<e;g+=2){t=r=0;h=f[m++];for(h+=m;m<h;m++,a+=3){n=c[f[m]].resultMatrix;k=l[a];u=l[a+1];var q=l[a+2],r=r+(k*n.a+u*n.c+n.tx)*q;t+=(k*n.b+u*n.d+n.ty)*q}d[g]=r;d[g+1]=t}}};h.computeWorldPositions=function(a,c,g,e,d,b,f){var k=[],h=a.currDisplayData.verLen,n=this.position,m=this._spaces,r=[],t=h/6,u=-1,q,v,w;t--;h-=4;this.computeWorldVertices2(a,c,2,h,k,0);if(this._debugKey)for(a=0;a<k.length;)g.drawCircle(k[a++],k[a++],10,"#ff0000");this._curves.length=t;c=this._curves;g=0;var x=k[0],z=k[1],y=0,A=0,D=0,F=0,G=0,I=0,B,C,E,L;a=0;for(q=2;a<t;a++,q+=6)y=k[q],A=k[q+1],D=k[q+2],F=k[q+3],G=k[q+4],I=k[q+5],B=.1875*(x-2*y+D),C=.1875*(z-2*A+F),v=.09375*(3*(y-D)-x+G),w=.09375*(3*(A-F)-z+I),E=2*B+v,L=2*C+w,B=.75*(y-x)+B+.16666667*v,C=.75*(A-z)+C+.16666667*w,g+=Math.sqrt(B*B+C*C),B+=E,C+=L,E+=v,L+=w,g+=Math.sqrt(B*B+C*C),B+=E,C+=L,g+=Math.sqrt(B*B+C*C),B+=E+v,C+=L+w,g+=Math.sqrt(B*B+C*C),c[a]=g,x=G,z=I;b&&(n*=g);if(f)for(a=0;a<e;a++)m[a]*=g;var J=this._segments,M=0;for(E=f=b=a=0;a<e;a++,b+=3)if(q=m[a],t=n+=q,0>t)this.addBeforePosition(t,k,0,r,b);else if(t>g)this.addAfterPosition(t-g,k,h-4,r,b);else{for(;;f++)if(w=c[f],!(t>w)){0==f?t/=w:(v=c[f-1],t=(t-v)/(w-v));break}if(f!=u){var u=f,K=6*f,x=k[K],z=k[K+1],y=k[K+2],A=k[K+3],D=k[K+4],F=k[K+5],G=k[K+6],I=k[K+7];B=.03*(x-2*y+D);C=.03*(z-2*A+F);v=.006*(3*(y-D)-x+G);w=.006*(3*(A-F)-z+I);E=2*B+v;L=2*C+w;B=.3*(y-x)+B+.16666667*v;C=.3*(A-z)+C+.16666667*w;M=Math.sqrt(B*B+C*C);J[0]=M;for(K=1;8>K;K++)B+=E,C+=L,E+=v,L+=w,M+=Math.sqrt(B*B+C*C),J[K]=M;B+=E;C+=L;M+=Math.sqrt(B*B+C*C);J[8]=M;B+=E+v;C+=L+w;M+=Math.sqrt(B*B+C*C);J[9]=M;E=0}for(t*=M;;E++)if(w=J[E],!(t>w)){0==E?t/=w:(v=J[E-1],t=E+(t-v)/(w-v));break}this.addCurvePosition(.1*t,x,z,y,A,D,F,G,I,r,b,d||0<a&&0==q)}return r};h.addBeforePosition=function(a,c,g,e,d){var b=c[g],f=c[g+1];c=Math.atan2(c[g+3]-f,c[g+2]-b);e[d]=b+a*Math.cos(c);e[d+1]=f+a*Math.sin(c);e[d+2]=c};h.addAfterPosition=function(a,c,g,e,d){var b=c[g+2],f=c[g+3];c=Math.atan2(f-c[g+1],b-c[g]);e[d]=b+a*Math.cos(c);e[d+1]=f+a*Math.sin(c);e[d+2]=c};h.addCurvePosition=function(a,c,g,e,d,b,f,l,h,n,m,r){0==a&&(a=1E-4);var k=a*a,p=k*a,q=1-a,v=q*q,w=v*q,x=q*a,y=3*x,q=q*y;a*=y;l=c*w+e*q+b*a+l*p;h=g*w+d*q+f*a+h*p;n[m]=l;n[m+1]=h;n[m+2]=r?Math.atan2(h-(g*v+d*x*2+f*k),l-(c*v+e*x*2+b*k)):0};b.NONE=-1;b.BEFORE=-2;b.AFTER=-3;R(b,["_tempMt",function(){return this._tempMt=new y}]);return b}(),W=function(){function b(){this.skY=this.skX=0;this.scY=this.scX=1;this.skewY=this.skewX=this.y=this.x=0;this.mMatrix=null}A(b,"laya.ani.bone.Transform");var h=b.prototype;h.initData=function(a){void 0!=a.x&&(this.x=a.x);void 0!=a.y&&(this.y=a.y);void 0!=a.skX&&(this.skX=a.skX);void 0!=a.skY&&(this.skY=a.skY);void 0!=a.scX&&(this.scX=a.scX);void 0!=a.scY&&(this.scY=a.scY)};h.getMatrix=function(){var a;a=this.mMatrix?this.mMatrix:this.mMatrix=new y;a.identity();a.scale(this.scX,this.scY);(this.skewX||this.skewY)&&this.skew(a,this.skewX*Math.PI/180,this.skewY*Math.PI/180);a.rotate(this.skX*Math.PI/180);a.translate(this.x,this.y);return a};h.skew=function(a,c,g){var e=Math.sin(g);g=Math.cos(g);var d=Math.sin(c);c=Math.cos(c);a.setTo(a.a*c-a.b*e,a.a*d+a.b*g,a.c*c-a.d*e,a.c*d+a.d*g,a.tx*c-a.ty*e,a.tx*d+a.ty*g);return a};return b}(),Ca=function(){function b(){this.time=NaN;this.drawOrder=[]}A(b,"laya.ani.bone.DrawOrderData");return b}(),ja=function(){function b(){}A(b,"laya.ani.math.BezierLerp");b.getBezierRate=function(h,a,c,g,e){var d=b._getBezierParamKey(a,c,g,e),k=100*d+h;if(b._bezierResultCache[k])return b._bezierResultCache[k];a=b._getBezierPoints(a,c,g,e,d);g=a.length;for(c=0;c<g;c+=2)if(h<=a[c])return b._bezierResultCache[k]=a[c+1],a[c+1];return b._bezierResultCache[k]=1};b._getBezierParamKey=function(b,a,c,g){return 100*(100*(100*(100*b+a)+c)+g)};b._getBezierPoints=function(h,a,c,g,e){if(b._bezierPointsCache[e])return b._bezierPointsCache[e];h=[0,0,h,a,c,g,1,1];h=(new ka).getBezierPoints(h,100,3);return b._bezierPointsCache[e]=h};b._bezierResultCache={};b._bezierPointsCache={};return b}(),Da=function(){function b(){this.parentBone=this.root=this.name=null;this.length=10;this.transform=null;this.inheritRotation=this.inheritScale=!0;this.resultRotation=this.rotation=NaN;this.d=-1;this._sprite=this._tempMatrix=null;this.resultTransform=new W;this.resultMatrix=new y;this._children=[]}A(b,"laya.ani.bone.Bone");var h=b.prototype;h.setTempMatrix=function(a){this._tempMatrix=a;var c,g;a=0;for(c=this._children.length;a<c;a++)g=this._children[a],g.setTempMatrix(this._tempMatrix)};h.update=function(a){this.rotation=this.transform.skX;var c;if(a)c=this.resultTransform.getMatrix(),y.mul(c,a,this.resultMatrix),this.resultRotation=this.rotation;else if(this.resultRotation=this.rotation+this.parentBone.resultRotation,this.parentBone)if(this.inheritRotation&&this.inheritScale)c=this.resultTransform.getMatrix(),y.mul(c,this.parentBone.resultMatrix,this.resultMatrix);else{var g=this.parentBone,e=this.parentBone.resultMatrix;c=this.resultTransform.getMatrix();a=e.a*c.tx+e.c*c.ty+e.tx;var e=e.b*c.tx+e.d*c.ty+e.ty,d=new y;this.inheritRotation?(g=Math.atan2(g.resultMatrix.b,g.resultMatrix.a),c=Math.cos(g),g=Math.sin(g),d.setTo(c,g,-g,c,0,0),y.mul(this._tempMatrix,d,y.TEMP),y.TEMP.copyTo(d),c=this.resultTransform.getMatrix(),y.mul(c,d,this.resultMatrix),0>this.resultTransform.scX*this.resultTransform.scY&&this.resultMatrix.rotate(.5*Math.PI)):(c=this.resultTransform.getMatrix(),y.TEMP.identity(),y.TEMP.d=this.d,y.mul(c,y.TEMP,this.resultMatrix));this.resultMatrix.tx=a;this.resultMatrix.ty=e}else c=this.resultTransform.getMatrix(),c.copyTo(this.resultMatrix);a=0;for(e=this._children.length;a<e;a++)d=this._children[a],d.update()};h.updateChild=function(){var a,c,g;a=0;for(c=this._children.length;a<c;a++)g=this._children[a],g.update()};h.setRotation=function(a){this._sprite&&(this._sprite.rotation=180*a/Math.PI)};h.updateDraw=function(a,c){if(!b.ShowBones||b.ShowBones[this.name])this._sprite||(this._sprite=new O,this._sprite.graphics.drawCircle(0,0,5,"#ff0000"),this._sprite.graphics.drawLine(0,0,this.length,0,"#00ff00"),this._sprite.graphics.fillText(this.name,0,0,"20px Arial","#00ff00","center"),F.stage.addChild(this._sprite)),this._sprite.x=a+this.resultMatrix.tx,this._sprite.y=c+this.resultMatrix.ty;var g,e,d;g=0;for(e=this._children.length;g<e;g++)d=this._children[g],d.updateDraw(a,c)};h.addChild=function(a){this._children.push(a);a.parentBone=this};h.findBone=function(a){if(this.name==a)return this;var c,g,e;c=0;for(g=this._children.length;c<g;c++)if(e=this._children[c],e=e.findBone(a))return e;return null};h.localToWorld=function(a){var c=a[0],g=a[1];a[0]=c*this.resultMatrix.a+g*this.resultMatrix.c+this.resultMatrix.tx;a[1]=c*this.resultMatrix.b+g*this.resultMatrix.d+this.resultMatrix.ty};b.ShowBones={};return b}(),Ea=function(){function b(){this.name=null;this.intValue=0;this.floatValue=NaN;this.audioValue=this.stringValue=null;this.time=NaN}A(b,"laya.ani.bone.EventData");return b}(),Fa=function(){function b(){this.targetBoneName=this.name=null;this.mix=this.bendDirection=1;this.isSpine=!0;this.targetBoneIndex=-1;this.boneNames=[];this.boneIndexs=[]}A(b,"laya.ani.bone.IkConstraintData");return b}(),Ga=function(b){function h(){this._destroyed=!1;this._templet=null;this._overallDuration=this._playDuration=this._playEnd=this._playStart=this._currentFrameTime=this._currentTime=NaN;this._stopWhenCircleFinish=!1;this._startUpdateLoopCount=this._elapsedPlaybackTime=NaN;this._currentKeyframeIndex=this._currentAnimationClipIndex=0;this._paused=!1;this._cacheFrameRate=0;this._cachePlayRate=this._cacheFrameRateInterval=NaN;this.isCache=!0;this.playbackRate=1;this.returnToZeroStopped=!1;h.__super.call(this);this._destroyed=!1;this._currentKeyframeIndex=this._currentAnimationClipIndex=-1;this._currentTime=0;this._overallDuration=Number.MAX_VALUE;this._stopWhenCircleFinish=!1;this._elapsedPlaybackTime=0;this._startUpdateLoopCount=-1;this._cachePlayRate=1;this.cacheFrameRate=60;this.returnToZeroStopped=!1}A(h,"laya.ani.AnimationPlayer",b);b=h.prototype;F.imps(b,{"laya.resource.IDestroy":!0});b._onTempletLoadedComputeFullKeyframeIndices=function(a,c,g){this._templet===g&&this._cachePlayRate===a&&this._cacheFrameRate===c&&this._computeFullKeyframeIndices()};b._computeFullKeyframeIndices=function(){};b._onAnimationTempletLoaded=function(){this.destroyed||this._calculatePlayDuration()};b._calculatePlayDuration=function(){if(0!==this.state){var a=this._templet.getAniDuration(this._currentAnimationClipIndex);0===this._playEnd&&(this._playEnd=a);this._playEnd>a&&(this._playEnd=a);this._playDuration=this._playEnd-this._playStart}};b._setPlayParams=function(a,c){this._currentTime=a;this._currentKeyframeIndex=Math.floor(this.currentPlayTime/c+.01);this._currentFrameTime=this._currentKeyframeIndex*c};b._setPlayParamsWhenStop=function(a,c){this._currentTime=a;this._currentKeyframeIndex=Math.floor(a/c+.01);this._currentFrameTime=this._currentKeyframeIndex*c;this._currentAnimationClipIndex=-1};b._update=function(a){if(-1!==this._currentAnimationClipIndex&&!this._paused&&this._templet){var c=this._cacheFrameRateInterval*this._cachePlayRate,g=0;this._startUpdateLoopCount!==U.loopCount&&(g=a*this.playbackRate,this._elapsedPlaybackTime+=g);a=this.playDuration;0!==this._overallDuration&&this._elapsedPlaybackTime>=this._overallDuration||0===this._overallDuration&&this._elapsedPlaybackTime>=a?(this._setPlayParamsWhenStop(a,c),this.event("stopped")):(g+=this._currentTime,0<a?g>=a?this._stopWhenCircleFinish?(this._setPlayParamsWhenStop(a,c),this._stopWhenCircleFinish=!1,this.event("stopped")):(this._setPlayParams(g%a,c),this.event("complete")):this._setPlayParams(g,c):this._stopWhenCircleFinish?(this._setPlayParamsWhenStop(a,c),this._stopWhenCircleFinish=!1,this.event("stopped")):(this._currentTime=this._currentFrameTime=this._currentKeyframeIndex=0,this.event("complete")))}};b._destroy=function(){this.offAll();this._templet=null;this._destroyed=!0};b.play=function(a,c,g,e,d){void 0===a&&(a=0);void 0===c&&(c=1);void 0===g&&(g=2147483647);void 0===e&&(e=0);void 0===d&&(d=0);if(!this._templet)throw Error("AnimationPlayer:templet must not be null,maybe you need to set url.");if(0>g||0>e||0>d)throw Error("AnimationPlayer:overallDuration,playStart and playEnd must large than zero.");if(0!==d&&e>d)throw Error("AnimationPlayer:start must less than end.");this._elapsedPlaybackTime=this._currentFrameTime=this._currentTime=0;this.playbackRate=c;this._overallDuration=g;this._playStart=e;this._playEnd=d;this._paused=!1;this._currentAnimationClipIndex=a;this._currentKeyframeIndex=0;this._startUpdateLoopCount=U.loopCount;this.event("played");this._calculatePlayDuration();this._update(0)};b.playByFrame=function(a,c,g,e,d,b){void 0===a&&(a=0);void 0===c&&(c=1);void 0===g&&(g=2147483647);void 0===e&&(e=0);void 0===d&&(d=0);void 0===b&&(b=30);b=1E3/b;this.play(a,c,g,e*b,d*b)};b.stop=function(a){void 0===a&&(a=!0);a?(this._currentTime=this._currentFrameTime=this._currentKeyframeIndex=0,this._currentAnimationClipIndex=-1,this.event("stopped")):this._stopWhenCircleFinish=!0};b.destroy=function(){};D(0,b,"playEnd",function(){return this._playEnd});D(0,b,"templet",function(){return this._templet},function(a){0!==this.state&&this.stop(!0);this._templet!==a&&(this._templet=a,this._computeFullKeyframeIndices())});D(0,b,"playStart",function(){return this._playStart});D(0,b,"playDuration",function(){return this._playDuration});D(0,b,"state",function(){return-1===this._currentAnimationClipIndex?0:this._paused?1:2});D(0,b,"currentKeyframeIndex",function(){return this._currentKeyframeIndex});D(0,b,"overallDuration",function(){return this._overallDuration});D(0,b,"currentFrameTime",function(){return this._currentFrameTime});D(0,b,"currentAnimationClipIndex",function(){return this._currentAnimationClipIndex});D(0,b,"currentPlayTime",function(){return this._currentTime+this._playStart});D(0,b,"cachePlayRate",function(){return this._cachePlayRate},function(a){this._cachePlayRate!==a&&(this._cachePlayRate=a,this._templet&&this._computeFullKeyframeIndices())});D(0,b,"cacheFrameRate",function(){return this._cacheFrameRate},function(a){this._cacheFrameRate!==a&&(this._cacheFrameRate=a,this._cacheFrameRateInterval=1E3/this._cacheFrameRate,this._templet&&this._computeFullKeyframeIndices())});D(0,b,"currentTime",null,function(a){if(-1!==this._currentAnimationClipIndex&&this._templet){if(a<this._playStart||a>this._playEnd)throw Error("AnimationPlayer:value must large than playStartTime,small than playEndTime.");this._startUpdateLoopCount=U.loopCount;var c=this._cacheFrameRateInterval*this._cachePlayRate;this._currentTime=a;this._currentKeyframeIndex=Math.floor(this.currentPlayTime/c);this._currentFrameTime=this._currentKeyframeIndex*c}});D(0,b,"paused",function(){return this._paused},function(a){(this._paused=a)&&this.event("paused")});D(0,b,"cacheFrameRateInterval",function(){return this._cacheFrameRateInterval});D(0,b,"destroyed",function(){return this._destroyed});return h}(Y),X=function(b){function h(){h.__super.call(this)}A(h,"laya.ani.GraphicsAni",b);h.prototype.drawSkin=function(a,c){this.drawTriangles(a.texture,0,0,a.vertices,a.uvs,a.indexes,a.transform||y.EMPTY,c)};h.create=function(){return h._caches.pop()||new h};h.recycle=function(a){a.clear();h._caches.push(a)};h._caches=[];return h}(Z),Aa=function(b){function h(){this.transform=null;h.__super.call(this)}A(h,"laya.ani.bone.canvasmesh.SkinMeshForGraphic",b);h.prototype.init2=function(a,c,g,e){this.transform&&(this.transform=null);c=c||[0,1,3,3,1,2];this.texture=a;this.indexes=new Uint16Array(c);this.vertices=new Float32Array(g);this.uvs=new Float32Array(e)};return h}(pa),V=function(b){function h(){this._aniMap={};this.unfixedLastAniIndex=-1;this._fullFrames=null;this._boneCurKeyFrm=[];h.__super.call(this);this._anis=[]}A(h,"laya.ani.AnimationTemplet",b);b=h.prototype;b.parse=function(a){a=new N(a);this._aniVersion=a.readUTFString();ha.parse(this,a)};b._calculateKeyFrame=function(a,c,g){a=a.keyFrame;a[c]=a[0];for(var e=0;e<c;e++)for(var b=a[e],k=0;k<g;k++)b.dData[k]=0===b.duration?0:(a[e+1].data[k]-b.data[k])/b.duration,b.nextData[k]=a[e+1].data[k];a.length--};b._onAsynLoaded=function(a,c){var g=new N(a);this._aniVersion=g.readUTFString();switch(this._aniVersion){case "LAYAANIMATION:02":ta.parse(this,g);break;default:ha.parse(this,g)}};b.getAnimationCount=function(){return this._anis.length};b.getAnimation=function(a){return this._anis[a]};b.getAniDuration=function(a){return this._anis[a].playTime};b.getNodes=function(a){return this._anis[a].nodes};b.getNodeIndexWithName=function(a,c){return this._anis[a].bone3DMap[c]};b.getNodeCount=function(a){return this._anis[a].nodes.length};b.getTotalkeyframesLength=function(a){return this._anis[a].totalKeyframeDatasLength};b.getPublicExtData=function(){return this._publicExtData};b.getAnimationDataWithCache=function(a,c,g,e){return(c=c[g])?(a=c[a])?a[e]:null:null};b.setAnimationDataWithCache=function(a,c,g,e,b){c=c[g]||(c[g]={});(c[a]||(c[a]=[]))[e]=b};b.getNodeKeyFrame=function(a,c,g){var e=this._boneCurKeyFrm[c],b=a.length;if(void 0==e||e>=b)e=this._boneCurKeyFrm[c]=0;var k=a[e],f=g-k.startTime;if(0==f||0<f&&k.duration>f)return e;if(0<f){g+=.01;for(f=e+1;f<b;f++)if(k=a[f],k.startTime<=g&&k.startTime+k.duration>g)return this._boneCurKeyFrm[c]=f;return b-1}for(f=0;f<e;f++)if(k=a[f],k.startTime<=g&&k.startTime+k.duration>g)return this._boneCurKeyFrm[c]=f;return e};b.getOriginalData=function(a,c,g,e,b){a=this._anis[a].nodes;g=this._boneCurKeyFrm;g.length<a.length&&(g.length=a.length);var d;g=0;e=a.length;for(var f=0;g<e;g++){var l=a[g],p;p=l.keyFrame;p=p[this.getNodeKeyFrame(p,g,b)];l.dataOffset=f;var n=b-p.startTime;if(d=l.lerpType)switch(d){case 0:case 1:for(d=0;d<l.keyframeWidth;)d+=l.interpolationMethod[d](l,d,c,f+d,p.data,n,p.dData,p.duration,p.nextData);break;case 2:var m=p.interpolationData,r=m.length,t=0;for(d=0;d<r;){var u=m[d];switch(u){case 6:d+=h.interpolation[u](l,t,c,f+t,p.data,n,p.dData,p.duration,p.nextData,m,d+1);break;case 7:d+=h.interpolation[u](l,t,c,f+t,p.data,n,p.dData,p.duration,p.nextData,m,d+1);break;default:d+=h.interpolation[u](l,t,c,f+t,p.data,n,p.dData,p.duration,p.nextData)}t++}}else for(d=0;d<l.keyframeWidth;)d+=l.interpolationMethod[d](l,d,c,f+d,p.data,n,p.dData,p.duration,p.nextData);f+=l.keyframeWidth}};b.getNodesCurrentFrameIndex=function(a,c){var g=this._anis[a].nodes;a!==this.unfixedLastAniIndex&&(this.unfixedCurrentFrameIndexes=new Uint32Array(g.length),this.unfixedCurrentTimes=new Float32Array(g.length),this.unfixedLastAniIndex=a);for(var e=0,b=g.length;e<b;e++){var k=g[e];c<this.unfixedCurrentTimes[e]&&(this.unfixedCurrentFrameIndexes[e]=0);for(this.unfixedCurrentTimes[e]=c;this.unfixedCurrentFrameIndexes[e]<k.keyFrame.length&&!(k.keyFrame[this.unfixedCurrentFrameIndexes[e]].startTime>this.unfixedCurrentTimes[e]);)this.unfixedCurrentFrameIndexes[e]++;this.unfixedCurrentFrameIndexes[e]--}return this.unfixedCurrentFrameIndexes};b.getOriginalDataUnfixedRate=function(a,c,g){var e=this._anis[a].nodes;a!==this.unfixedLastAniIndex&&(this.unfixedCurrentFrameIndexes=new Uint32Array(e.length),this.unfixedCurrentTimes=new Float32Array(e.length),this.unfixedKeyframes=aa(e.length),this.unfixedLastAniIndex=a);for(var b=0,k=e.length,f=0;b<k;b++){var l=e[b];g<this.unfixedCurrentTimes[b]&&(this.unfixedCurrentFrameIndexes[b]=0);for(this.unfixedCurrentTimes[b]=g;this.unfixedCurrentFrameIndexes[b]<l.keyFrame.length&&!(l.keyFrame[this.unfixedCurrentFrameIndexes[b]].startTime>this.unfixedCurrentTimes[b]);)this.unfixedKeyframes[b]=l.keyFrame[this.unfixedCurrentFrameIndexes[b]],this.unfixedCurrentFrameIndexes[b]++;var p=this.unfixedKeyframes[b];l.dataOffset=f;var n=g-p.startTime;if(l.lerpType)switch(l.lerpType){case 0:case 1:for(a=0;a<l.keyframeWidth;)a+=l.interpolationMethod[a](l,a,c,f+a,p.data,n,p.dData,p.duration,p.nextData);break;case 2:var m=p.interpolationData,r=m.length,t=0;for(a=0;a<r;){var u=m[a];switch(u){case 6:a+=h.interpolation[u](l,t,c,f+t,p.data,n,p.dData,p.duration,p.nextData,m,a+1);break;case 7:a+=h.interpolation[u](l,t,c,f+t,p.data,n,p.dData,p.duration,p.nextData,m,a+1);break;default:a+=h.interpolation[u](l,t,c,f+t,p.data,n,p.dData,p.duration,p.nextData)}t++}}else for(a=0;a<l.keyframeWidth;)a+=l.interpolationMethod[a](l,a,c,f+a,p.data,n,p.dData,p.duration,p.nextData);f+=l.keyframeWidth}};h._LinearInterpolation_0=function(a,c,g,e,b,k,f,l,h,n){g[e]=b[c]+k*f[c];return 1};h._QuaternionInterpolation_1=function(a,c,g,e,b,k,f,l,h,n){la.slerpQuaternionArray(b,c,h,c,0===l?0:k/l,g,e);return 4};h._AngleInterpolation_2=function(a,c,g,e,b,k,f,l,h,n){return 0};h._RadiansInterpolation_3=function(a,c,g,e,b,k,f,l,h,n){return 0};h._Matrix4x4Interpolation_4=function(a,c,g,e,b,k,f,l,h,n){for(a=0;16>a;a++,c++)g[e+a]=b[c]+k*f[c];return 16};h._NoInterpolation_5=function(a,c,g,e,b,k,f,l,h,n){g[e]=b[c];return 1};h._BezierInterpolation_6=function(a,c,g,e,b,k,f,l,h,n,m){void 0===m&&(m=0);g[e]=b[c]+(h[c]-b[c])*ja.getBezierRate(k/l,n[m],n[m+1],n[m+2],n[m+3]);return 5};h._BezierInterpolation_7=function(a,c,g,b,d,k,f,l,h,n,m){void 0===m&&(m=0);g[b]=n[m+4]+n[m+5]*ja.getBezierRate((.001*k+n[m+6])/n[m+7],n[m],n[m+1],n[m+2],n[m+3]);return 9};h.interpolation=[h._LinearInterpolation_0,h._QuaternionInterpolation_1,h._AngleInterpolation_2,h._RadiansInterpolation_3,h._Matrix4x4Interpolation_4,h._NoInterpolation_5,h._BezierInterpolation_6,h._BezierInterpolation_7];return h}(na);(function(b){function h(c){this._Pos=this._start=0;this._data=null;this._playIndex=this._preIndex=this._curIndex=0;this._playing=!1;this._ended=!0;this._count=0;this._ids=null;this._loadedImage={};this._url=this._atlasPath=this.basePath=this._labels=this._movieClipList=this._parentMovieClip=this._idOfSprite=null;this._isRoot=!1;this._completeHandler=null;this._endFrame=-1;this.interval=30;this.loop=!1;h.__super.call(this);this._ids={};this._idOfSprite=[];this._reset();this._playing=!1;(this._parentMovieClip=c)?(this._isRoot=!1,this._movieClipList=c._movieClipList,this._movieClipList.push(this)):(this._movieClipList=[this],this._isRoot=!0,this._setBitUp(16))}A(h,"laya.ani.swf.MovieClip",b);var a=h.prototype;a.destroy=function(c){void 0===c&&(c=!0);this._clear();b.prototype.destroy.call(this,c)};a._setDisplay=function(c){b.prototype._setDisplay.call(this,c);this._isRoot&&this._$3__onDisplay(c)};a._$3__onDisplay=function(c){c?this.timer.loop(this.interval,this,this.updates,null,!0):this.timer.clear(this,this.updates)};a.updates=function(){if(!this._parentMovieClip){var c,a;a=this._movieClipList.length;for(c=0;c<a;c++)this._movieClipList[c]&&this._movieClipList[c]._update()}};a.addLabel=function(c,a){this._labels||(this._labels={});this._labels[a]=c};a.removeLabel=function(c){if(!c)this._labels=null;else if(!this._labels)for(var a in this._labels)if(this._labels[a]===c){delete this._labels[a];break}};a._update=function(){if(this._data&&this._playing){this._playIndex++;if(this._playIndex>=this._count){if(!this.loop){this._playIndex--;this.stop();return}this._playIndex=0}this._parseFrame(this._playIndex);this._labels&&this._labels[this._playIndex]&&this.event("label",this._labels[this._playIndex]);if(-1!=this._endFrame&&this._endFrame==this._playIndex){this._endFrame=-1;if(null!=this._completeHandler){var c=this._completeHandler;this._completeHandler=null;c.run()}this.stop()}}};a.stop=function(){this._playing=!1};a.gotoAndStop=function(c){this.index=c;this.stop()};a._clear=function(){this.stop();this._idOfSprite.length=0;if(!this._parentMovieClip){this.timer.clear(this,this.updates);var c,a;a=this._movieClipList.length;for(c=0;c<a;c++)this._movieClipList[c]!=this&&this._movieClipList[c]._clear();this._movieClipList.length=0}this._atlasPath&&J.clearRes(this._atlasPath);for(var b in this._loadedImage)this._loadedImage[b]&&(J.clearRes(b),this._loadedImage[b]=!1);this.removeChildren();this._parentMovieClip=this.graphics=null};a.play=function(c,a){void 0===c&&(c=0);void 0===a&&(a=!0);this.loop=a;this._playing=!0;this._data&&this._displayFrame(c)};a._displayFrame=function(c){void 0===c&&(c=-1);-1!=c&&(this._curIndex>c&&this._reset(),this._parseFrame(c))};a._reset=function(c){void 0===c&&(c=!0);c&&1!=this._curIndex&&this.removeChildren();this._preIndex=this._curIndex=-1;this._Pos=this._start};a._parseFrame=function(c){var a,b,d,k=!1,f=this._idOfSprite,l=this._data;this._ended&&this._reset();l.pos=this._Pos;this._ended=!1;this._playIndex=c;this._curIndex>c&&c<this._preIndex&&(this._reset(!0),l.pos=this._Pos);for(;this._curIndex<=c&&!this._ended;)switch(b=l.getUint16(),b){case 12:d=l.getUint16();b=this._ids[l.getUint16()];this._Pos=l.pos;l.pos=b;0==(a=l.getUint8())?(a=l.getUint16(),b=f[d],b||(b=f[d]=new O,d=new O,d.loadImage(this.basePath+a+".png"),this._loadedImage[this.basePath+a+".png"]=!0,b.addChild(d),d.size(l.getFloat32(),l.getFloat32()),a=l._getMatrix(),d.transform=a),b.alpha=1):1==a&&(a=f[d],a||(f[d]=a=new h(this),a.interval=this.interval,a._ids=this._ids,a.basePath=this.basePath,a._setData(l,b),a._initState(),a.play(0)),a.alpha=1);l.pos=this._Pos;break;case 3:if(b=f[l.getUint16()])this.addChild(b),b.zOrder=l.getUint16(),k=!0;break;case 4:(b=f[l.getUint16()])&&b.removeSelf();break;case 5:f[l.getUint16()][h._ValueList[l.getUint16()]]=l.getFloat32();break;case 6:f[l.getUint16()].visible=0<l.getUint8();break;case 7:b=f[l.getUint16()];d=b.transform||y.create();d.setTo(l.getFloat32(),l.getFloat32(),l.getFloat32(),l.getFloat32(),l.getFloat32(),l.getFloat32());b.transform=d;break;case 8:f[l.getUint16()].setPos(l.getFloat32(),l.getFloat32());break;case 9:f[l.getUint16()].setSize(l.getFloat32(),l.getFloat32());break;case 10:f[l.getUint16()].alpha=l.getFloat32();break;case 11:f[l.getUint16()].setScale(l.getFloat32(),l.getFloat32());break;case 98:b=l.getString();this.event(b);"stop"==b&&this.stop();break;case 99:this._curIndex=l.getUint16();k&&this.updateZOrder();break;case 100:this._count=this._curIndex+1,this._ended=!0,this._playing&&(this.event("enterframe"),this.event("end"),this.event("complete")),this._reset(!1)}this._playing&&!this._ended&&this.event("enterframe");this._Pos=l.pos};a._setData=function(c,a){this._data=c;this._start=a+3};a.load=function(c,a,b){void 0===a&&(a=!1);this._url=c;a&&(this._atlasPath=b?b:c.split(".swf")[0]+".json");this.stop();this._clear();this._movieClipList=[this];c=[{url:c,type:"arraybuffer"}];this._atlasPath&&c.push({url:this._atlasPath,type:"atlas"});F.loader.load(c,P.create(this,this._onLoaded))};a._onLoaded=function(){var c;(c=J.getRes(this._url))?this._atlasPath&&!J.getAtlas(this._atlasPath)?this.event("error","Atlas not find"):(this.basePath=this._atlasPath?J.getAtlas(this._atlasPath).dir:this._url.split(".swf")[0]+"/image/",this._initData(c)):this.event("error","file not find")};a._initState=function(){this._reset();this._ended=!1;var c=this._playing;this._playing=!1;for(this._curIndex=0;!this._ended;)this._parseFrame(++this._curIndex);this._playing=c};a._initData=function(c){this._data=new N(c);var a=this._data.getUint16();for(c=0;c<a;c++)this._ids[this._data.getInt16()]=this._data.getInt32();this.interval=1E3/this._data.getUint16();this._setData(this._data,this._ids[32767]);this._initState();this.play(0);this.event("loaded");this._parentMovieClip||this.timer.loop(this.interval,this,this.updates,null,!0)};a.playTo=function(c,a,b){this._completeHandler=b;this._endFrame=a;this.play(c,!1)};D(0,a,"index",function(){return this._playIndex},function(c){this._playIndex=c;this._data&&this._displayFrame(this._playIndex);this._labels&&this._labels[c]&&this.event("label",this._labels[c])});D(0,a,"count",function(){return this._count});D(0,a,"playing",function(){return this._playing});D(0,a,"url",null,function(c){this.load(c)});h._ValueList="x y width height scaleX scaleY rotation alpha".split(" ");return h})(O);var Ha=function(b){function h(c,a){this._curOriginalData=this._player=this._templet=null;this._boneMatrixArray=[];this._lastTime=0;this._currAniName=null;this._currAniIndex=-1;this._pause=!0;this._clipIndex=this._aniClipIndex=-1;this._skinIndex=0;this._skinName="default";this._aniMode=0;this._boneSlotArray=this._bindBoneBoneSlotDic=this._boneSlotDic=this._graphicsCache=null;this._total=this._index=-1;this._indexControl=!1;this._complete=this._texturePath=this._aniPath=null;this._loadAniMode=0;this._aniSectionDic=this._boneList=this._rootBone=this._pathDic=this._tfArr=this._ikArr=this._yReverseMatrix=null;this._drawOrderIndex=this._eventIndex=0;this._drawOrder=null;this._lastUpdateAniClipIndex=this._lastAniClipIndex=-1;this._playAudio=!0;this._soundChannelArr=[];h.__super.call(this);void 0===a&&(a=0);c&&this.init(c,a)}A(h,"laya.ani.bone.Skeleton",b);var a=h.prototype;a.init=function(c,a){void 0===a&&(a=0);var b,g;if(1==a)for(this._graphicsCache=[],b=0,g=c.getAnimationCount();b<g;b++)this._graphicsCache.push([]);this._yReverseMatrix=c.yReverseMatrix;this._aniMode=a;this._templet=c;this._templet._addReference(1);this._player=new Ga;this._player.cacheFrameRate=c.rate;this._player.templet=c;this._player.play();this._parseSrcBoneMatrix();this._boneList=c.mBoneArr;this._rootBone=c.mRootBone;this._aniSectionDic=c.aniSectionDic;if(0<c.ikArr.length)for(this._ikArr=[],b=0,g=c.ikArr.length;b<g;b++)this._ikArr.push(new va(c.ikArr[b],this._boneList));if(0<c.pathArr.length){var k,f;null==this._pathDic&&(this._pathDic={});var l;b=0;for(g=c.pathArr.length;b<g;b++){k=c.pathArr[b];f=new ia(k,this._boneList);if(l=this._boneSlotDic[k.name])f=new ia(k,this._boneList),f.target=l;this._pathDic[k.name]=f}}if(0<c.tfArr.length)for(this._tfArr=[],b=0,g=c.tfArr.length;b<g;b++)this._tfArr.push(new qa(c.tfArr[b],this._boneList));0<c.skinDataArray.length&&(this._skinName=this._templet.skinDataArray[this._skinIndex].name);this._player.on("played",this,this._onPlay);this._player.on("stopped",this,this._onStop);this._player.on("paused",this,this._onPause)};a.load=function(a,b,e){void 0===e&&(e=0);this._aniPath=a;this._complete=b;this._loadAniMode=e;F.loader.load([{url:a,type:"arraybuffer"}],P.create(this,this._onLoaded))};a._onLoaded=function(){var a=J.getRes(this._aniPath);if(null!=a){null==Q.TEMPLET_DICTIONARY&&(Q.TEMPLET_DICTIONARY={});var b;(b=Q.TEMPLET_DICTIONARY[this._aniPath])?b.isParseFail?this._parseFail():b.isParserComplete?this._parseComplete():(b.on("complete",this,this._parseComplete),b.on("error",this,this._parseFail)):(b=new Q,b._setCreateURL(this._aniPath),Q.TEMPLET_DICTIONARY[this._aniPath]=b,b.on("complete",this,this._parseComplete),b.on("error",this,this._parseFail),b.isParserComplete=!1,b.parseData(null,a))}};a._parseComplete=function(){var a=Q.TEMPLET_DICTIONARY[this._aniPath];a&&(this.init(a,this._loadAniMode),this.play(0,!0));this._complete&&this._complete.runWith(this)};a._parseFail=function(){console.log("[Error]:"+this._aniPath+"\u89e3\u6790\u5931\u8d25")};a._onPlay=function(){this.event("played")};a._onStop=function(){var a,b=this._templet.eventAniArr[this._aniClipIndex];if(b&&this._eventIndex<b.length)for(;this._eventIndex<b.length;this._eventIndex++)a=b[this._eventIndex],a.time>=this._player.playStart&&a.time<=this._player.playEnd&&this.event("label",a);this._drawOrder=null;this.event("stopped")};a._onPause=function(){this.event("paused")};a._parseSrcBoneMatrix=function(){var a,b;b=this._templet.srcBoneMatrixArr.length;for(a=0;a<b;a++)this._boneMatrixArray.push(new y);if(0==this._aniMode)this._boneSlotDic=this._templet.boneSlotDic,this._bindBoneBoneSlotDic=this._templet.bindBoneBoneSlotDic,this._boneSlotArray=this._templet.boneSlotArray;else{null==this._boneSlotDic&&(this._boneSlotDic={});null==this._bindBoneBoneSlotDic&&(this._bindBoneBoneSlotDic={});null==this._boneSlotArray&&(this._boneSlotArray=[]);var e=this._templet.boneSlotArray,d,k;a=0;for(b=e.length;a<b;a++)d=e[a],k=this._bindBoneBoneSlotDic[d.parent],null==k&&(this._bindBoneBoneSlotDic[d.parent]=k=[]),this._boneSlotDic[d.name]=d=d.copy(),k.push(d),this._boneSlotArray.push(d)}};a._emitMissedEvents=function(a,b,e){void 0===e&&(e=0);if(a=this._templet.eventAniArr[this._player.currentAnimationClipIndex]){var c;for(b=a.length;e<b;e++)c=a[e],c.time>=this._player.playStart&&c.time<=this._player.playEnd&&this.event("label",c)}};a._update=function(a){void 0===a&&(a=!0);if(!(this._pause||a&&this._indexControl)){var c=this.timer.currTimer,b=this._player.currentKeyframeIndex,d=c-this._lastTime;a?this._player._update(d):b=-1;this._lastTime=c;this._player&&(this._index=this._clipIndex=this._player.currentKeyframeIndex,0>this._index||0<d&&this._clipIndex==b&&this._lastUpdateAniClipIndex==this._aniClipIndex||(this._lastUpdateAniClipIndex=this._aniClipIndex,b>this._clipIndex&&0!=this._eventIndex&&(this._emitMissedEvents(this._player.playStart,this._player.playEnd,this._eventIndex),this._eventIndex=0),(a=this._templet.eventAniArr[this._aniClipIndex])&&this._eventIndex<a.length&&(a=a[this._eventIndex],a.time>=this._player.playStart&&a.time<=this._player.playEnd?this._player.currentPlayTime>=a.time&&(this.event("label",a),this._eventIndex++,this._playAudio&&a.audioValue&&"null"!==a.audioValue&&(a=S.playSound(this._player.templet._path+a.audioValue,1,P.create(this,this._onAniSoundStoped)),S.playbackRate=this._player.playbackRate,a&&this._soundChannelArr.push(a))):a.time<this._player.playStart&&this._playAudio&&a.audioValue&&"null"!==a.audioValue&&.1<this._player.playEnd-this._player.currentPlayTime?(this._eventIndex++,a=S.playSound(this._player.templet._path+a.audioValue,1,P.create(this,this._onAniSoundStoped),null,(this._player.currentPlayTime-a.time)/1E3),S.playbackRate=this._player.playbackRate,a&&this._soundChannelArr.push(a)):this._eventIndex++),0==this._aniMode?(a=this._templet.getGrahicsDataWithCache(this._aniClipIndex,this._clipIndex)||this._createGraphics())&&this.graphics!=a&&(this.graphics=a):1==this._aniMode?(a=this._getGrahicsDataWithCache(this._aniClipIndex,this._clipIndex)||this._createGraphics())&&this.graphics!=a&&(this.graphics=a):this._createGraphics()))}};a._onAniSoundStoped=function(a){for(var c,b=this._soundChannelArr.length,d=0;d<b;d++)if(c=this._soundChannelArr[d],c.isStopped||a)!c.isStopped&&c.stop(),this._soundChannelArr.splice(d,1),b--,d--};a._createGraphics=function(a){void 0===a&&(a=-1);-1==a&&(a=this._clipIndex);var c=a*this._player.cacheFrameRateInterval,b,d=this._templet.drawOrderAniArr[this._aniClipIndex];if(d&&0<d.length)for(this._drawOrderIndex=0,b=d[this._drawOrderIndex];c>=b.time;){this._drawOrder=b.drawOrder;this._drawOrderIndex++;if(this._drawOrderIndex>=d.length)break;b=d[this._drawOrderIndex]}0==this._aniMode||1==this._aniMode?this.graphics=X.create():this.graphics instanceof laya.ani.GraphicsAni?this.graphics.clear():this.graphics=X.create();b=this.graphics;var k=this._templet.getNodes(this._aniClipIndex);this._templet.getOriginalData(this._aniClipIndex,this._curOriginalData,null,a,0==this._player.state?c+this._player.cacheFrameRateInterval:c);var f=this._aniSectionDic[this._aniClipIndex],l=0,h,n,m,r,t,u=this._templet.srcBoneMatrixArr.length;m=this._curOriginalData;d=0;for(h=f[0];d<u;d++)t=this._boneList[d],t=t.resultTransform,r=this._templet.srcBoneMatrixArr[d],t.scX=r.scX*m[l++],t.skX=r.skX+m[l++],t.skY=r.skY+m[l++],t.scY=r.scY*m[l++],t.x=r.x+m[l++],t.y=r.y+m[l++],8===this._templet.tMatrixDataLen&&(t.skewX=r.skewX+m[l++],t.skewY=r.skewY+m[l++]);u={};r={};var q;for(h+=f[1];d<h;d++)q=k[d],u[q.name]=m[l++],r[q.name]=m[l++],l+=4;t={};var v={};for(h+=f[2];d<h;d++)q=k[d],t[q.name]=m[l++],v[q.name]=m[l++],l+=4;if(this._pathDic)for(h+=f[3];d<h;d++)if(q=k[d],f=this._pathDic[q.name])switch((new N(q.extenData)).getByte()){case 1:f.position=m[l++];break;case 2:f.spacing=m[l++];break;case 3:f.rotateMix=m[l++],f.translateMix=m[l++]}this._rootBone.update(this._yReverseMatrix||y.TEMP.identity());if(this._ikArr)for(d=0,h=this._ikArr.length;d<h;d++)k=this._ikArr[d],t.hasOwnProperty(k.name)&&(k.bendDirection=t[k.name]),v.hasOwnProperty(k.name)&&(k.mix=v[k.name]),k.apply();if(this._pathDic)for(n in this._pathDic)f=this._pathDic[n],f.apply(this._boneList,b);if(this._tfArr)for(d=0,k=this._tfArr.length;d<k;d++)h=this._tfArr[d],h.apply();d=0;for(k=this._boneList.length;d<k;d++)if(t=this._boneList[d],m=this._bindBoneBoneSlotDic[t.name],t.resultMatrix.copyTo(this._boneMatrixArray[d]),m)for(l=0,h=m.length;l<h;l++)(n=m[l])&&n.setParentMatrix(t.resultMatrix);k={};if((l=this._templet.deformAniArr)&&0<l.length){if(this._lastAniClipIndex!=this._aniClipIndex)for(this._lastAniClipIndex=this._aniClipIndex,d=0,h=this._boneSlotArray.length;d<h;d++)n=this._boneSlotArray[d],n.deformData=null;h=l[this._aniClipIndex];d=h["default"];this._setDeform(d,k,this._boneSlotArray,c);for(var w in h)"default"!=w&&w!=this._skinName&&(d=h[w],this._setDeform(d,k,this._boneSlotArray,c));d=h[this._skinName];this._setDeform(d,k,this._boneSlotArray,c)}if(this._drawOrder)for(d=0,h=this._drawOrder.length;d<h;d++)n=this._boneSlotArray[this._drawOrder[d]],w=u[n.name],c=r[n.name],isNaN(c),isNaN(w)||-2==w||(this._templet.attachmentNames?n.showDisplayByName(this._templet.attachmentNames[w]):n.showDisplayByIndex(w)),k[this._drawOrder[d]]?(w=k[this._drawOrder[d]],n.deformData=n.currDisplayData&&w[n.currDisplayData.attachmentName]?w[n.currDisplayData.attachmentName]:null):n.deformData=null,isNaN(c)?n.draw(b,this._boneMatrixArray,2==this._aniMode):n.draw(b,this._boneMatrixArray,2==this._aniMode,c),isNaN(c);else for(d=0,h=this._boneSlotArray.length;d<h;d++)n=this._boneSlotArray[d],w=u[n.name],c=r[n.name],isNaN(c),isNaN(w)||-2==w||(this._templet.attachmentNames?n.showDisplayByName(this._templet.attachmentNames[w]):n.showDisplayByIndex(w)),k[d]?(w=k[d],n.deformData=n.currDisplayData&&w[n.currDisplayData.attachmentName]?w[n.currDisplayData.attachmentName]:null):n.deformData=null,isNaN(c)?n.draw(b,this._boneMatrixArray,2==this._aniMode):n.draw(b,this._boneMatrixArray,2==this._aniMode,c),isNaN(c);0==this._aniMode?(this._templet.setGrahicsDataWithCache(this._aniClipIndex,a,b),this._checkIsAllParsed(this._aniClipIndex)):1==this._aniMode&&this._setGrahicsDataWithCache(this._aniClipIndex,a,b);return b};a._checkIsAllParsed=function(a){var c,b;b=Math.floor(.01+this._templet.getAniDuration(a)/1E3*this._player.cacheFrameRate);for(c=0;c<b;c++)if(!this._templet.getGrahicsDataWithCache(a,c))return;this._templet.getGrahicsDataWithCache(a,b)?this._templet.deleteAniData(a):this._createGraphics(b)};a._setDeform=function(a,b,e,d){if(a){var c,g,h,p,n,m;if(a)for(p=0,n=a.deformSlotDataList.length;p<n;p++)for(c=a.deformSlotDataList[p],m=0;m<c.deformSlotDisplayList.length;m++)g=c.deformSlotDisplayList[m],h=e[g.slotIndex],g.apply(d,h),b[g.slotIndex]||(b[g.slotIndex]={}),b[g.slotIndex][g.attachment]=g.deformData}};a.getAnimNum=function(){return this._templet.getAnimationCount()};a.getAniNameByIndex=function(a){return this._templet.getAniNameByIndex(a)};a.getSlotByName=function(a){return this._boneSlotDic[a]};a.showSkinByName=function(a,b){void 0===b&&(b=!0);this.showSkinByIndex(this._templet.getSkinIndexByName(a),b)};a.showSkinByIndex=function(a,b){void 0===b&&(b=!0);for(var c=0;c<this._boneSlotArray.length;c++)this._boneSlotArray[c].showSlotData(null,b);this._templet.showSkinByIndex(this._boneSlotDic,a,b)&&(c=this._templet.skinDataArray[a],this._skinIndex=a,this._skinName=c.name);this._clearCache()};a.showSlotSkinByIndex=function(a,b){if(0!=this._aniMode){var c=this.getSlotByName(a);c&&c.showDisplayByIndex(b);this._clearCache()}};a.showSlotSkinByName=function(a,b){if(0!=this._aniMode){var c=this.getSlotByName(a);c&&c.showDisplayByName(b);this._clearCache()}};a.replaceSlotSkinName=function(a,b,e){0!=this._aniMode&&((a=this.getSlotByName(a))&&a.replaceDisplayByName(b,e),this._clearCache())};a.replaceSlotSkinByIndex=function(a,b,e){0!=this._aniMode&&((a=this.getSlotByName(a))&&a.replaceDisplayByIndex(b,e),this._clearCache())};a.setSlotSkin=function(a,b){if(0!=this._aniMode){var c=this.getSlotByName(a);c&&c.replaceSkin(b);this._clearCache()}};a._clearCache=function(){if(1==this._aniMode)for(var a=0,b=this._graphicsCache.length;a<b;a++){for(var e=0,d=this._graphicsCache[a].length;e<d;e++){var k=this._graphicsCache[a][e];k&&k!=this.graphics&&X.recycle(k)}this._graphicsCache[a].length=0}};a.play=function(a,b,e,d,k,f,h){void 0===e&&(e=!0);void 0===d&&(d=0);void 0===k&&(k=0);void 0===f&&(f=!0);void 0===h&&(h=!0);this._playAudio=h;this._indexControl=!1;h=-1;b=b?2147483647:0;if("string"==typeof a)for(var c=0,g=this._templet.getAnimationCount();c<g;c++){var l=this._templet.getAnimation(c);if(l&&a==l.name){h=c;break}}else h=a;-1<h&&h<this.getAnimNum()&&(this._aniClipIndex=h,e||this._pause||this._currAniIndex!=h)&&(this._currAniIndex=h,this._curOriginalData=new Float32Array(this._templet.getTotalkeyframesLength(h)),this._drawOrder=null,this._eventIndex=0,this._player.play(h,this._player.playbackRate,b,d,k),f&&this._templet.showSkinByIndex(this._boneSlotDic,this._skinIndex),this._pause&&(this._pause=!1,this._lastTime=ba.now(),this.timer.frameLoop(1,this,this._update,null,!0)),this._update())};a.stop=function(){this._pause||(this._pause=!0,this._player&&this._player.stop(!0),0<this._soundChannelArr.length&&this._onAniSoundStoped(!0),this.timer.clear(this,this._update))};a.playbackRate=function(a){this._player&&(this._player.playbackRate=a)};a.paused=function(){if(!this._pause){this._pause=!0;this._player&&(this._player.paused=!0);if(0<this._soundChannelArr.length)for(var a,b=this._soundChannelArr.length,e=0;e<b;e++)a=this._soundChannelArr[e],a.isStopped||a.pause();this.timer.clear(this,this._update)}};a.resume=function(){this._indexControl=!1;if(this._pause){this._pause=!1;this._player&&(this._player.paused=!1);if(0<this._soundChannelArr.length)for(var a,b=this._soundChannelArr.length,e=0;e<b;e++)a=this._soundChannelArr[e],a.audioBuffer&&a.resume();this._lastTime=ba.now();this.timer.frameLoop(1,this,this._update,null,!0)}};a._getGrahicsDataWithCache=function(a,b){return this._graphicsCache[a][b]};a._setGrahicsDataWithCache=function(a,b,e){this._graphicsCache[a][b]=e};a.destroy=function(a){void 0===a&&(a=!0);b.prototype.destroy.call(this,a);this._templet._removeReference(1);this._templet=null;this._player&&this._player.offAll();this._curOriginalData=this._player=null;this._lastTime=this._boneMatrixArray.length=0;this.timer.clear(this,this._update);0<this._soundChannelArr.length&&this._onAniSoundStoped(!0)};D(0,a,"url",function(){return this._aniPath},function(a){this.load(a)});D(0,a,"index",function(){return this._index},function(a){this.player&&(this._index=a,this._player.currentTime=1E3*this._index/this._player.cacheFrameRate,this._indexControl=!0,this._update(!1))});D(0,a,"total",function(){return this._total=this._templet&&this._player?Math.floor(this._templet.getAniDuration(this._player.currentAnimationClipIndex)/1E3*this._player.cacheFrameRate):-1});D(0,a,"templet",function(){return this._templet});D(0,a,"player",function(){return this._player});h.useSimpleMeshInCanvas=!1;return h}(O),Q=function(b){function h(){this._textureJson=this._mainTexture=null;this._graphicsCache=[];this.srcBoneMatrixArr=[];this.ikArr=[];this.tfArr=[];this.pathArr=[];this.boneSlotDic={};this.bindBoneBoneSlotDic={};this.boneSlotArray=[];this.skinDataArray=[];this.skinDic={};this.subTextureDic={};this.isParseFail=!1;this.yReverseMatrix=null;this.drawOrderAniArr=[];this.eventAniArr=[];this.attachmentNames=null;this.deformAniArr=[];this._isDestroyed=this._isParseAudio=!1;this._rate=30;this.isParserComplete=!1;this.aniSectionDic={};this._skBufferUrl=null;this._textureDic={};this._relativeUrl=this._path=this._loadList=null;this.tMatrixDataLen=0;this.mRootBone=null;h.__super.call(this);this.skinSlotDisplayDataArr=[];this.mBoneArr=[]}A(h,"laya.ani.bone.Templet",b);var a=h.prototype;a.loadAni=function(a){this._skBufferUrl=a;F.loader.load(a,P.create(this,this.onComplete),null,"arraybuffer")};a.onComplete=function(a){this._isDestroyed?this.destroy():(a=J.getRes(this._skBufferUrl))?(this._path=this._skBufferUrl.slice(0,this._skBufferUrl.lastIndexOf("/"))+"/",this.parseData(null,a)):this.event("error","load failed:"+this._skBufferUrl)};a.parseData=function(a,b,e){void 0===e&&(e=30);if(!this._path){var c=this._relativeUrl||this.url;if(c){var g=c.lastIndexOf("/");this._path=0<g?c.slice(0,g)+"/":""}}this._mainTexture=a;this._rate=e;this.parse(b)};a.buildArmature=function(a){void 0===a&&(a=0);return new Ha(this,a)};a.parse=function(a){b.prototype.parse.call(this,a);this.event("loaded",this);this._aniVersion===h.LAYA_ANIMATION_VISION?this._isParseAudio=!0:this._aniVersion!=h.LAYA_ANIMATION_160_VISION&&console.log("[Error] \u7248\u672c\u4e0d\u4e00\u81f4\uff0c\u8bf7\u4f7f\u7528IDE\u7248\u672c\u914d\u5957\u7684\u91cd\u65b0\u5bfc\u51fa"+this._aniVersion+"-\x3e"+h.LAYA_ANIMATION_VISION);this._mainTexture?this._parsePublicExtData():this._parseTexturePath()};a._parseTexturePath=function(){if(this._isDestroyed)this.destroy();else{var a;this._loadList=[];var b=new N(this.getPublicExtData()),e,d=b.getInt32(),k=b.readUTFString().split("\n"),f;for(a=0;a<d;a++)f=this._path+k[2*a],b.getFloat32(),b.getFloat32(),b.getFloat32(),b.getFloat32(),e=b.getFloat32(),isNaN(e),e=b.getFloat32(),isNaN(e),e=b.getFloat32(),isNaN(e),e=b.getFloat32(),isNaN(e),-1==this._loadList.indexOf(f)&&this._loadList.push(f);F.loader.load(this._loadList,P.create(this,this._textureComplete))}};a._textureComplete=function(){for(var a,b=0,e=this._loadList.length;b<e;b++)a=this._loadList[b],this._textureDic[a]=J.getRes(a);this._parsePublicExtData()};a._parsePublicExtData=function(){var a,b,e,d,k;a=0;for(k=this.getAnimationCount();a<k;a++)this._graphicsCache.push([]);e="Dragon"!=this._aniClassName;var f=new N(this.getPublicExtData()),h,p,n,m,r,t,u,q;d=f.getInt32();k=f.readUTFString();var v=k.split("\n");for(a=0;a<d;a++){b=this._mainTexture;h=this._path+v[2*a];k=v[2*a+1];null==this._mainTexture&&(b=this._textureDic[h]);if(!b){this.event("error",this);this.isParseFail=!0;return}h=f.getFloat32();p=f.getFloat32();n=f.getFloat32();m=f.getFloat32();q=f.getFloat32();r=isNaN(q)?0:q;q=f.getFloat32();t=isNaN(q)?0:q;q=f.getFloat32();u=isNaN(q)?n:q;q=f.getFloat32();q=isNaN(q)?m:q;this.subTextureDic[k]=ca.create(b,h,p,n,m,-r,-t,u,q)}this._mainTexture=b;b=f.getUint16();for(a=0;a<b;a++)d=[],d.push(f.getUint16()),d.push(f.getUint16()),d.push(f.getUint16()),d.push(f.getUint16()),this.aniSectionDic[a]=d;k=f.getInt16();var v={},w;for(a=0;a<k;a++)b=new Da,0==a?w=b:b.root=w,b.d=e?-1:1,d=f.readUTFString(),h=f.readUTFString(),b.length=f.getFloat32(),1==f.getByte()&&(b.inheritRotation=!1),1==f.getByte()&&(b.inheritScale=!1),b.name=d,h&&((h=v[h])?h.addChild(b):this.mRootBone=b),v[d]=b,this.mBoneArr.push(b);this.tMatrixDataLen=f.getUint16();a=f.getUint16();d=Math.floor(a/this.tMatrixDataLen);v=this.srcBoneMatrixArr;for(a=0;a<d;a++)k=new W,k.scX=f.getFloat32(),k.skX=f.getFloat32(),k.skY=f.getFloat32(),k.scY=f.getFloat32(),k.x=f.getFloat32(),k.y=f.getFloat32(),8===this.tMatrixDataLen&&(k.skewX=f.getFloat32(),k.skewY=f.getFloat32()),v.push(k),b=this.mBoneArr[a],b.transform=k;k=f.getUint16();for(a=0;a<k;a++){d=new Fa;v=f.getUint16();for(b=0;b<v;b++)d.boneNames.push(f.readUTFString()),d.boneIndexs.push(f.getInt16());d.name=f.readUTFString();d.targetBoneName=f.readUTFString();d.targetBoneIndex=f.getInt16();d.bendDirection=f.getFloat32();d.mix=f.getFloat32();d.isSpine=e;this.ikArr.push(d)}d=f.getUint16();for(a=0;a<d;a++){e=new wa;k=f.getUint16();for(b=0;b<k;b++)e.boneIndexs.push(f.getInt16());e.name=f.getUTFString();e.targetIndex=f.getInt16();e.rotateMix=f.getFloat32();e.translateMix=f.getFloat32();e.scaleMix=f.getFloat32();e.shearMix=f.getFloat32();e.offsetRotation=f.getFloat32();e.offsetX=f.getFloat32();e.offsetY=f.getFloat32();e.offsetScaleX=f.getFloat32();e.offsetScaleY=f.getFloat32();e.offsetShearY=f.getFloat32();this.tfArr.push(e)}d=f.getUint16();for(a=0;a<d;a++){e=new ra;e.name=f.readUTFString();k=f.getUint16();for(b=0;b<k;b++)e.bones.push(f.getInt16());e.target=f.readUTFString();e.positionMode=f.readUTFString();e.spacingMode=f.readUTFString();e.rotateMode=f.readUTFString();e.offsetRotation=f.getFloat32();e.position=f.getFloat32();e.spacing=f.getFloat32();e.rotateMix=f.getFloat32();e.translateMix=f.getFloat32();this.pathArr.push(e)}var x,z;t=f.getInt16();for(a=0;a<t;a++){u=f.getUint8();q={};this.deformAniArr.push(q);for(var A=0;A<u;A++)for(n=new xa,n.skinName=f.getUTFString(),q[n.skinName]=n,v=f.getInt16(),b=0;b<v;b++)for(m=new sa,n.deformSlotDataList.push(m),h=f.getInt16(),e=0;e<h;e++)for(r=new za,m.deformSlotDisplayList.push(r),r.slotIndex=f.getInt16(),r.attachment=f.getUTFString(),p=f.getInt16(),d=0;d<p;d++)for(1==f.getByte()?r.tweenKeyList.push(!0):r.tweenKeyList.push(!1),k=f.getFloat32(),r.timeList.push(k),z=[],r.vectices.push(z),x=f.getInt16(),k=0;k<x;k++)z.push(f.getFloat32())}k=f.getInt16();for(a=0;a<k;a++){v=f.getInt16();d=[];for(b=0;b<v;b++){h=new Ca;h.time=f.getFloat32();p=f.getInt16();for(e=0;e<p;e++)h.drawOrder.push(f.getInt16());d.push(h)}this.drawOrderAniArr.push(d)}d=f.getInt16();for(a=0;a<d;a++){k=f.getInt16();e=[];for(b=0;b<k;b++)v=new Ea,v.name=f.getUTFString(),this._isParseAudio&&(v.audioValue=f.getUTFString()),v.intValue=f.getInt32(),v.floatValue=f.getFloat32(),v.stringValue=f.getUTFString(),v.time=f.getFloat32(),e.push(v);this.eventAniArr.push(e)}b=f.getInt16();if(0<b)for(this.attachmentNames=[],a=0;a<b;a++)this.attachmentNames.push(f.getUTFString());b=f.getInt16();for(a=0;a<b;a++)e=new Ba,e.name=f.readUTFString(),e.parent=f.readUTFString(),e.attachmentName=f.readUTFString(),e.srcDisplayIndex=e.displayIndex=f.getInt16(),e.templet=this,this.boneSlotDic[e.name]=e,d=this.bindBoneBoneSlotDic[e.parent],null==d&&(this.bindBoneBoneSlotDic[e.parent]=d=[]),d.push(e),this.boneSlotArray.push(e);v=f.readUTFString().split("\n");h=0;p=f.getUint8();for(a=0;a<p;a++){n=new ua;n.name=v[h++];t=f.getUint8();for(b=0;b<t;b++){m=new oa;m.name=v[h++];u=f.getUint8();for(e=0;e<u;e++){r=new ya;this.skinSlotDisplayDataArr.push(r);r.name=v[h++];r.attachmentName=v[h++];r.transform=new W;r.transform.scX=f.getFloat32();r.transform.skX=f.getFloat32();r.transform.skY=f.getFloat32();r.transform.scY=f.getFloat32();r.transform.x=f.getFloat32();r.transform.y=f.getFloat32();m.displayArr.push(r);r.width=f.getFloat32();r.height=f.getFloat32();r.type=f.getUint8();r.verLen=f.getUint16();k=f.getUint16();if(0<k)for(r.bones=[],d=0;d<k;d++)q=f.getUint16(),r.bones.push(q);k=f.getUint16();if(0<k)for(r.uvs=[],d=0;d<k;d++)r.uvs.push(f.getFloat32());k=f.getUint16();if(0<k)for(r.weights=[],d=0;d<k;d++)r.weights.push(f.getFloat32());k=f.getUint16();if(0<k)for(r.triangles=[],d=0;d<k;d++)r.triangles.push(f.getUint16());k=f.getUint16();if(0<k)for(r.vertices=[],d=0;d<k;d++)r.vertices.push(f.getFloat32());k=f.getUint16();if(0<k)for(r.lengths=[],d=0;d<k;d++)r.lengths.push(f.getFloat32())}n.slotArr.push(m)}this.skinDic[n.name]=n;this.skinDataArray.push(n)}1==f.getUint8()?(this.yReverseMatrix=new y(1,0,0,-1,0,0),w&&w.setTempMatrix(this.yReverseMatrix)):w&&w.setTempMatrix(new y);this.showSkinByIndex(this.boneSlotDic,0);this.isParserComplete=!0;this.event("complete",this)};a.getTexture=function(a){var b=this.subTextureDic[a];b||(b=this.subTextureDic[a.substr(0,a.length-1)]);return null==b?this._mainTexture:b};a.showSkinByIndex=function(a,b,e){void 0===e&&(e=!0);if(0>b&&b>=this.skinDataArray.length)return!1;var c,g,f,h=this.skinDataArray[b];if(h){b=0;for(c=h.slotArr.length;b<c;b++)if(f=h.slotArr[b])if(g=a[f.name])g.showSlotData(f,e),e&&"undefined"!=g.attachmentName&&"null"!=g.attachmentName?g.showDisplayByName(g.attachmentName):g.showDisplayByIndex(g.displayIndex);return!0}return!1};a.getSkinIndexByName=function(a){for(var b,c=0,d=this.skinDataArray.length;c<d;c++)if(b=this.skinDataArray[c],b.name==a)return c;return-1};a.getGrahicsDataWithCache=function(a,b){return this._graphicsCache[a]&&this._graphicsCache[a][b]?this._graphicsCache[a][b]:null};a._setCreateURL=function(a){this._relativeUrl=a;laya.resource.Resource.prototype._setCreateURL.call(this,a)};a.setGrahicsDataWithCache=function(a,b,e){this._graphicsCache[a][b]=e};a.deleteAniData=function(a){this._anis[a]&&(a=this._anis[a],a.bone3DMap=null,a.nodes=null)};a.destroy=function(){this._isDestroyed=!0;var a,b;for(b in this.subTextureDic)(a=this.subTextureDic[b])&&a.destroy();for(b in this._textureDic)(a=this._textureDic[b])&&a.destroy();b=0;for(var e=this.skinSlotDisplayDataArr.length;b<e;b++)a=this.skinSlotDisplayDataArr[b],a.destory();this.skinSlotDisplayDataArr.length=0;this.url&&delete h.TEMPLET_DICTIONARY[this.url];laya.resource.Resource.prototype.destroy.call(this)};a.getAniNameByIndex=function(a){return(a=this.getAnimation(a))?a.name:null};D(0,a,"rate",function(){return this._rate},function(a){this._rate=a});h.LAYA_ANIMATION_160_VISION="LAYAANIMATION:1.6.0";h.LAYA_ANIMATION_VISION="LAYAANIMATION:1.7.0";h.TEMPLET_DICTIONARY=null;return h}(V)})(window,document,Laya);