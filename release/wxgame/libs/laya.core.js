var Laya=window.Laya=function(G,Ga){var l={__internals:[],__packages:{},__classmap:{Object:Object,Function:Function,Array:Array,String:String},__sysClass:{object:"Object",array:"Array",string:"String",dictionary:"Dictionary"},__propun:{writable:!0,enumerable:!1,configurable:!0},__presubstr:String.prototype.substr,__substr:function(t,p){return 1==arguments.length?l.__presubstr.call(this,t):l.__presubstr.call(this,t,0<p?p:this.length+p)},__init:function(l){l.forEach(function(l){l.__init$&&l.__init$()})},__isClass:function(l){return l&&(l.__isclass||l==Object||l==String||l==Array)},__newvec:function(l,p){var m=[];m.length=l;for(var t=0;t<l;t++)m[t]=p;return m},__extend:function(t,p){function m(){l.un(this,"constructor",t)}for(var D in p)if(p.hasOwnProperty(D)){var x=Object.getOwnPropertyDescriptor(p,D),G=x.get,z=x.set;G||z?G&&z?Object.defineProperty(t,D,x):(G&&Object.defineProperty(t,D,G),z&&Object.defineProperty(t,D,z)):t[D]=p[D]}m.prototype=p.prototype;t.prototype=new m;l.un(t.prototype,"__imps",l.__copy({},p.prototype.__imps))},__copy:function(l,p){if(!p)return null;l=l||{};for(var m in p)l[m]=p[m];return l},__package:function(t,p){if(!l.__packages[t]){l.__packages[t]=!0;var m=G,D=t.split(".");if(1<D.length)for(var x=0,R=D.length-1;x<R;x++)var z=m[D[x]],m=z?z:m[D[x]]={};m[D[D.length-1]]||(m[D[D.length-1]]=p||{})}},__hasOwnProperty:function(l,p){function m(l,p){if(Object.hasOwnProperty.call(p.prototype,l))return!0;var t=p.prototype.__super;return null==t?null:m(l,t)}p=p||this;return Object.hasOwnProperty.call(p,l)||m(l,p.__class)},__typeof:function(l,p){if(!l||!p)return!1;if(p===String)return"string"===typeof l;if(p===Number)return"number"===typeof l;if(p.__interface__)p=p.__interface__;else if("string"!=typeof p)return l instanceof p;return l.__imps&&l.__imps[p]||l.__class==p},__as:function(l,p){return this.__typeof(l,p)?l:null},__int:function(l){return l?parseInt(l):0},"interface":function(t,p){l.__package(t,{});var m=l.__internals,D=m[t]=m[t]||{self:t};if(p){var x=p.split(",");D.extend=[];for(var R=0;R<x.length;R++){var z=x[R];m[z]=m[z]||{self:z};D.extend.push(m[z])}}m=G;D=t.split(".");for(R=0;R<D.length-1;R++)m=m[D[R]];m[D[D.length-1]]={__interface__:t}},"class":function(t,p,m,D){m&&l.__extend(t,m);if(p)if(l.__package(p,t),l.__classmap[p]=t,0<p.indexOf(".")){if(0==p.indexOf("laya.")){var x=p.split(".");D=D||x[x.length-1];l[D]&&console.log("Warning!,this class["+D+"] already exist:",l[D]);l[D]=t}}else"Main"==p?G.Main=t:(l[p]&&console.log("Error!,this class["+p+"] already exist:",l[p]),l[p]=t);D=l.un;x=t.prototype;D(x,"hasOwnProperty",l.__hasOwnProperty);D(x,"__class",t);D(x,"__super",m);D(x,"__className",p);D(t,"__super",m);D(t,"__className",p);D(t,"__isclass",!0);D(t,"super",function(l){this.__super.call(l)})},imps:function(t,p){function m(p){var t;if(t=l.__internals[p])if(D[p]=!0,p=t.extend)for(t=0;t<p.length;t++)m(p[t].self)}if(!p)return null;var D=t.__imps||l.un(t,"__imps",{}),x;for(x in p)m(x)},superSet:function(l,p,m,D){(l=l.prototype["_$set_"+m])&&l.call(p,D)},superGet:function(l,p,m){return(l=l.prototype["_$get_"+m])?l.call(p):null},getset:function(t,p,m,D,x){t?(D&&(p["_$GET_"+m]=D),x&&(p["_$SET_"+m]=x)):(D&&l.un(p,"_$get_"+m,D),x&&l.un(p,"_$set_"+m,x));D&&x?Object.defineProperty(p,m,{get:D,set:x,enumerable:!1,configurable:!0}):(D&&Object.defineProperty(p,m,{get:D,enumerable:!1,configurable:!0}),x&&Object.defineProperty(p,m,{set:x,enumerable:!1,configurable:!0}))},"static":function(l,p){for(var m=0,t=p.length;m<t;m+=2)"length"==p[m]?l.length=p[m+1].call(l):function(){var t=p[m],D=p[m+1];Object.defineProperty(l,t,{get:function(){delete this[t];return this[t]=D.call(this)},set:function(l){delete this[t];this[t]=l},enumerable:!0,configurable:!0})}()},un:function(t,p,m){m||(m=t[p]);l.__propun.value=m;Object.defineProperty(t,p,l.__propun);return m},uns:function(t,p){p.forEach(function(m){l.un(t,m)})}};G.console=G.console||{log:function(){}};G.trace=G.console.log;Error.prototype.throwError=function(){throw arguments;};Object.defineProperty(Array.prototype,"fixed",{enumerable:!1});return l}(window,document);(function(G,Ga,l){})(window,document,Laya);(function(G,Ga,l){var t=l["static"],p=l["class"],m=l.getset;l["interface"]("laya.filters.IFilter");l["interface"]("laya.resource.IDispose");l["interface"]("laya.resource.IDestroy");l["interface"]("laya.webgl.submit.ISubmit");l["interface"]("laya.resource.ICreateResource");l["interface"]("laya.webgl.canvas.save.ISaveData");l["interface"]("laya.resource.ISingletonElement");(function(){m(1,l,"alertGlobalError",null,function(a){var c=0;r.window.onerror=a?function(b,d,a,f,g){5>c++&&g&&alert("\u51fa\u9519\u5566\uff0c\u8bf7\u628a\u6b64\u4fe1\u606f\u622a\u56fe\u7ed9\u7814\u53d1\u5546\n"+b+"\n"+g.stack)}:null});l.init=function(a,c,b){for(var d=[],e=2,f=arguments.length;e<f;e++)d.push(arguments[e]);if(!l._isinit){l._isinit=!0;ArrayBuffer.prototype.slice||(ArrayBuffer.prototype.slice=l._arrayBufferSlice);r.__init__();l.systemTimer=new ga(!1);l.startTimer=new ga(!1);l.physicsTimer=new ga(!1);l.updateTimer=new ga(!1);l.lateTimer=new ga(!1);l.timer=new ga(!1);l.loader=new Ra;db.__init__();E.inner_enable();e=0;for(f=d.length;e<f;e++)d[e]&&d[e].enable&&d[e].enable();v.isConchApp&&Z.enableNative();Sa.beginCheck();l._currentStage=l.stage=new Ha;M.rootPath=M._basePath=l._getUrlPath();l.render=new v(0,0);l.stage.size(a,c);G.stage=l.stage;ta.__init__();Db.__init__();ha.instance.__init__(l.stage,v.canvas);ia.__init__();Q.autoStopMusic=!0;return v.canvas}};l._getUrlPath=function(){var a=r.window.location,c=a.pathname,c=":"==c.charAt(2)?c.substring(1):c;return M.getPath("file:"==a.protocol?c:a.protocol+"//"+a.host+a.pathname)};l._arrayBufferSlice=function(a,c){var b=new Uint8Array(this,a,c-a),d=new Uint8Array(b.length);d.set(b);return d.buffer};l._runScript=function(a){return r.window[l._evcode](a)};l.enableDebugPanel=function(a){void 0===a&&(a="libs/laya.debugtool.js");if(l.DebugPanel)l.DebugPanel.enable();else{var c=r.createElement("script");c.onload=function(){l.DebugPanel.enable()};c.src=a;r.document.body.appendChild(c)}};l.stage=null;l.systemTimer=null;l.startTimer=null;l.physicsTimer=null;l.updateTimer=null;l.lateTimer=null;l.timer=null;l.loader=null;l.version="2.1.1";l.render=null;l._currentStage=null;l._isinit=!1;l.isWXOpenDataContext=!1;l.isWXPosMsg=!1;t(l,["_evcode",function(){return this._evcode="eval"}]);return l})();var D=function(){function a(){}p(a,"laya.renders.LayaGLQuickRunner");a.__init__=function(){a.map[515]=a.alpha_transform_drawLayaGL;a.map[513]=a.alpha_drawLayaGL;a.map[514]=a.transform_drawLayaGL;a.map[8194]=a.transform_drawNodes;a.map[259]=a.alpha_transform_drawTexture;a.map[257]=a.alpha_drawTexture;a.map[258]=a.transform_drawTexture;a.map[8704]=a.drawLayaGL_drawNodes};a.transform_drawTexture=function(c,b,d,e){var f=c.texture;b.saveTransform(a.curMat);b.transformByMatrix(c.transform,d,e);b.drawTexture(f,-c.pivotX,-c.pivotY,c._width||f.width,c._height||f.height);b.restoreTransform(a.curMat)};a.alpha_drawTexture=function(a,b,d,e){var c=a._style,g,h=a.texture;if(.01<(g=c.alpha)||a._needRepaint()){var k=b.globalAlpha;b.globalAlpha*=g;b.drawTexture(h,d-c.pivotX+h.offsetX,e-c.pivotY+h.offsetY,a._width||h.width,a._height||h.height);b.globalAlpha=k}};a.alpha_transform_drawTexture=function(c,b,d,e){var f=c._style,g,h=c.texture;if(.01<(g=f.alpha)||c._needRepaint()){var k=b.globalAlpha;b.globalAlpha*=g;b.saveTransform(a.curMat);b.transformByMatrix(c.transform,d,e);b.drawTexture(h,-f.pivotX+h.offsetX,-f.pivotY+h.offsetY,c._width||h.width,c._height||h.height);b.restoreTransform(a.curMat);b.globalAlpha=k}};a.alpha_transform_drawLayaGL=function(c,b,d,e){var f=c._style,g;if(.01<(g=f.alpha)||c._needRepaint()){var h=b.globalAlpha;b.globalAlpha*=g;b.saveTransform(a.curMat);b.transformByMatrix(c.transform,d,e);c._graphics&&c._graphics._render(c,b,-f.pivotX,-f.pivotY);b.restoreTransform(a.curMat);b.globalAlpha=h}};a.alpha_drawLayaGL=function(a,b,d,e){var c=a._style,g;if(.01<(g=c.alpha)||a._needRepaint()){var h=b.globalAlpha;b.globalAlpha*=g;a._graphics&&a._graphics._render(a,b,d-c.pivotX,e-c.pivotY);b.globalAlpha=h}};a.transform_drawLayaGL=function(c,b,d,e){var f=c._style;b.saveTransform(a.curMat);b.transformByMatrix(c.transform,d,e);c._graphics&&c._graphics._render(c,b,-f.pivotX,-f.pivotY);b.restoreTransform(a.curMat)};a.transform_drawNodes=function(c,b,d,e){var f=c._getBit(256)&&b.drawCallOptimize(!0),g=c._style;b.saveTransform(a.curMat);b.transformByMatrix(c.transform,d,e);d=-g.pivotX;e=-g.pivotY;c=c._children;var h=c.length,k;if(g.viewport)for(var n=g.viewport,g=n.x,q=n.y,u=n.right,n=n.bottom,B=NaN,l=NaN,m=0;m<h;++m)(k=c[m])._visible&&(B=k._x)<u&&B+k.width>g&&(l=k._y)<n&&l+k.height>q&&k.render(b,d,e);else for(var m=0;m<h;++m)(k=c[m])._visible&&k.render(b,d,e);b.restoreTransform(a.curMat);f&&b.drawCallOptimize(!1)};a.drawLayaGL_drawNodes=function(a,b,d,e){var c=a._getBit(256)&&b.drawCallOptimize(!0),g=a._style;d-=g.pivotX;e-=g.pivotY;a._graphics&&a._graphics._render(a,b,d,e);a=a._children;var h=a.length,k;if(g.viewport)for(var n=g.viewport,g=n.x,q=n.y,u=n.right,n=n.bottom,B=NaN,l=NaN,m=0;m<h;++m)(k=a[m])._visible&&(B=k._x)<u&&B+k.width>g&&(l=k._y)<n&&l+k.height>q&&k.render(b,d,e);else for(var m=0;m<h;++m)(k=a[m])._visible&&k.render(b,d,e);c&&b.drawCallOptimize(!1)};a.map={};t(a,["curMat",function(){return this.curMat=new I}]);return a}(),x=function(){function a(c){this.arrColor=[];if(null==c)this.strColor="#00000000",this.numColor=0,this.arrColor=[0,0,0,0];else{var b,d;if("string"==typeof c)if(0<=c.indexOf("rgba(")||0<=c.indexOf("rgb(")){b=c;var e;d=b.indexOf("(");e=b.indexOf(")");b=b.substring(d+1,e);this.arrColor=b.split(",");d=this.arrColor.length;for(b=0;b<d;b++)this.arrColor[b]=parseFloat(this.arrColor[b]),3>b&&(this.arrColor[b]=Math.round(this.arrColor[b]));b=4==this.arrColor.length?256*(256*(256*this.arrColor[0]+this.arrColor[1])+this.arrColor[2])+Math.round(255*this.arrColor[3]):256*(256*this.arrColor[0]+this.arrColor[1])+this.arrColor[2];this.strColor=c}else{this.strColor=c;"#"===c.charAt(0)&&(c=c.substr(1));d=c.length;if(3===d||4===d){e="";for(b=0;b<d;b++)e+=c[b]+c[b];c=e}b=parseInt(c,16)}else b=c,this.strColor=L.toHexColor(b);0<=this.strColor.indexOf("rgba")||9===this.strColor.length?(this.arrColor=[((4278190080&b)>>>24)/255,((16711680&b)>>16)/255,((65280&b)>>8)/255,(255&b)/255],this.numColor=(4278190080&b)>>>24|(b&16711680)>>8|(b&65280)<<8|(b&255)<<24):(this.arrColor=[((16711680&b)>>16)/255,((65280&b)>>8)/255,(255&b)/255,1],this.numColor=4278190080|(b&16711680)>>16|b&65280|(b&255)<<16);this.arrColor.__id=++a._COLODID}}p(a,"laya.utils.ColorUtils");a._initDefault=function(){a._DEFAULT={};for(var c in a._COLOR_MAP)a._SAVE[c]=a._DEFAULT[c]=new a(a._COLOR_MAP[c]);return a._DEFAULT};a._initSaveMap=function(){a._SAVE_SIZE=0;a._SAVE={};for(var c in a._DEFAULT)a._SAVE[c]=a._DEFAULT[c]};a.create=function(c){var b=c+"",d=a._SAVE[b];if(null!=d)return d;1E3>a._SAVE_SIZE&&a._initSaveMap();return a._SAVE[b]=new a(c)};a._SAVE={};a._SAVE_SIZE=0;a._COLOR_MAP={purple:"#800080",orange:"#ffa500",white:"#FFFFFF",red:"#FF0000",green:"#00FF00",blue:"#0000FF",black:"#000000",yellow:"#FFFF00",gray:"#808080"};a._DEFAULT=a._initDefault();a._COLODID=1;return a}(),R=function(){function a(){}p(a,"laya.webgl.canvas.save.SaveBase");var c=a.prototype;l.imps(c,{"laya.webgl.canvas.save.ISaveData":!0});c.isSaveMark=function(){return!1};c.restore=function(b){this._dataObj[this._valueName]=this._value;a.POOL[a.POOL._length++]=this;this._newSubmit&&(b._curSubmit=z.RENDERBASE)};a._createArray=function(){var b=[];b._length=0;return b};a._init=function(){var b=a._namemap={};b[1]="ALPHA";b[2]="fillStyle";b[8]="font";b[256]="lineWidth";b[512]="strokeStyle";b[8192]="_mergeID";b[1024]=b[2048]=b[4096]=[];b[16384]="textBaseline";b[32768]="textAlign";b[65536]="_nBlendType";b[1048576]="shader";b[2097152]="filters";b[8388608]="_colorFiler";return b};a.save=function(b,d,e,c){if((b._saveMark._saveuse&d)!==d){b._saveMark._saveuse|=d;var f=a.POOL,f=0<f._length?f[--f._length]:new a;f._value=e[f._valueName=a._namemap[d]];f._dataObj=e;f._newSubmit=c;b=b._save;b[b._length++]=f}};a.POOL=laya.webgl.canvas.save.SaveBase._createArray();a._namemap=a._init();return a}(),z=function(){function a(b){this.clipInfoID=-1;this._blendFn=this._mesh=null;this._renderType=this._id=0;this._parent=null;this._numEle=this._startIdx=0;this._ref=1;this.shaderValue=null;this._key=new Ia;void 0===b&&(b=1E4);this._renderType=b;this._id=++a.ID}p(a,"laya.webgl.submit.Submit");var c=a.prototype;l.imps(c,{"laya.webgl.submit.ISubmit":!0});c.getID=function(){return this._id};c.releaseRender=function(){a.RENDERBASE!=this&&1>--this._ref&&(a.POOL[a._poolSize++]=this,this.shaderValue.release(),this._mesh=this.shaderValue=null,this._parent&&(this._parent.releaseRender(),this._parent=null))};c.getRenderType=function(){return this._renderType};c.renderSubmit=function(){if(0===this._numEle||!this._mesh||0==this._numEle)return 1;var b=this.shaderValue.textureHost;if(b){b=b._getSource();if(!b)return 1;this.shaderValue.texture=b}b=E.mainContext;this._mesh.useMesh(b);this.shaderValue.upload();T.activeBlendFunction!==this._blendFn&&(C.setBlend(b,!0),this._blendFn(b),T.activeBlendFunction=this._blendFn);b.drawElements(4,this._numEle,5123,this._startIdx);J.renderBatches++;J.trianglesFaces+=this._numEle/3;return 1};c._cloneInit=function(b,d,a,c){b._ref=1;b._mesh=a;b._id=this._id;b._key.copyFrom(this._key);b._parent=this;b._blendFn=this._blendFn;b._renderType=this._renderType;b._startIdx=c*ja.BYTES_PIDX;b._numEle=this._numEle;b.shaderValue=this.shaderValue;this.shaderValue.ref++;this._ref++};c.clone=function(b,d,a){return null};c.reUse=function(b,d){return 0};c.toString=function(){return"ibindex:"+this._startIdx+" num:"+this._numEle+" key\x3d"+this._key};a.__init__=function(){var b=a.RENDERBASE=new a(-1);b.shaderValue=new U(0,0);b.shaderValue.ALPHA=1;b._ref=4294967295};a.create=function(b,d,e){var c=a._poolSize?a.POOL[--a._poolSize]:new a;c._ref=1;c._mesh=d;c._key.clear();c._startIdx=d.indexNum*ja.BYTES_PIDX;c._numEle=0;d=b._nBlendType;c._blendFn=b._targets?T.targetFns[d]:T.fns[d];c.shaderValue=e;c.shaderValue.setValue(b._shader2D);(b=b._shader2D.filters)&&c.shaderValue.setFilters(b);return c};a.createShape=function(b,d,e,c){var f=a._poolSize?a.POOL[--a._poolSize]:new a;f._mesh=d;f._numEle=e;f._startIdx=2*d.indexNum;f._ref=1;f.shaderValue=c;f.shaderValue.setValue(b._shader2D);d=b._nBlendType;f._key.blendShader=d;f._blendFn=b._targets?T.targetFns[d]:T.fns[d];return f};a.TYPE_2D=1E4;a.TYPE_CANVAS=10003;a.TYPE_CMDSETRT=10004;a.TYPE_CUSTOM=10005;a.TYPE_BLURRT=10006;a.TYPE_CMDDESTORYPRERT=10007;a.TYPE_DISABLESTENCIL=10008;a.TYPE_OTHERIBVB=10009;a.TYPE_PRIMITIVE=10010;a.TYPE_RT=10011;a.TYPE_BLUR_RT=10012;a.TYPE_TARGET=10013;a.TYPE_CHANGE_VALUE=10014;a.TYPE_SHAPE=10015;a.TYPE_TEXTURE=10016;a.TYPE_FILLTEXTURE=10017;a.KEY_ONCE=-1;a.KEY_FILLRECT=1;a.KEY_DRAWTEXTURE=2;a.KEY_VG=3;a.KEY_TRIANGLES=4;a.RENDERBASE=null;a.ID=1;a.preRender=null;a._poolSize=0;a.POOL=[];return a}(),Eb=function(){function a(){}p(a,"laya.display.cmd.FillTextureCmd");var c=a.prototype;c.recover=function(){this.other=this.offset=this.texture=null;w.recover("FillTextureCmd",this)};c.run=function(b,d,a){b.fillTexture(this.texture,this.x+d,this.y+a,this.width,this.height,this.type,this.offset,this.other)};m(0,c,"cmdID",function(){return"FillTexture"});a.create=function(b,d,e,c,g,h,k,n){var f=w.getItemByClass("FillTextureCmd",a);f.texture=b;f.x=d;f.y=e;f.width=c;f.height=g;f.type=h;f.offset=k;f.other=n;return f};a.ID="FillTexture";return a}(),Ja=function(){function a(){this._glRender=null}p(a,"laya.filters.Filter");var c=a.prototype;l.imps(c,{"laya.filters.IFilter":!0});m(0,c,"type",function(){return-1});a.BLUR=16;a.COLOR=32;a.GLOW=8;a._filter=function(b,d,a,c){var e=this._next;if(e){var f=b.filters,k=f.length;if(1==k&&32==f[0].type)d.save(),d.setColorFilter(f[0]),e._fun.call(e,b,d,a,c),d.restore();else{var n=U.create(1,0),q,u=N.TEMP,B=d._curMat,l=I.create();B.copyTo(l);var m=0,p=0;q=!1;var B=null,r=b._cacheStyle.filterCache||null;if(r&&0==b.getRepaint()){if(q=b._cacheStyle.hasGlowFilter||!1)m=50,p=25;q=b.getBounds();if(0>=q.width||0>=q.height)return;q.width+=m;q.height+=m;u.x=q.x*l.a+q.y*l.c;u.y=q.y*l.d+q.x*l.b;q.x=u.x;q.y=u.y;u.x=q.width*l.a+q.height*l.c;u.y=q.height*l.d+q.width*l.b;q.width=u.x;q.height=u.y}else{if(q=b._isHaveGlowFilter())m=50,p=25;q=new K;q.copyFrom(b.getSelfBounds());q.x+=b.x;q.y+=b.y;q.x-=b.pivotX+4;q.y-=b.pivotY+4;var t=q.x,v=q.y;q.width+=m+8;q.height+=m+8;u.x=q.x*l.a+q.y*l.c;u.y=q.y*l.d+q.x*l.b;q.x=u.x;q.y=u.y;u.x=q.width*l.a+q.height*l.c;u.y=q.height*l.d+q.width*l.b;q.width=u.x;q.height=u.y;if(0>=q.width||0>=q.height)return;r&&wa.releaseRT(r);B=wa.getRT(q.width,q.height);m=r=wa.getRT(q.width,q.height);b._getCacheStyle().filterCache=r;d.pushRT();d.useRT(B);e._fun.call(e,b,d,b.x-t+p,b.y-v+p);d.useRT(m);for(e=0;e<k;e++)switch(0!=e&&(d.useRT(B),d.drawTarget(m,0,0,q.width,q.height,I.TEMP.identity(),n,null,T.TOINT.overlay),d.useRT(m)),t=f[e],t.type){case 16:t._glRender&&t._glRender.render(B,d,q.width,q.height,t);break;case 8:t._glRender&&t._glRender.render(B,d,q.width,q.height,t);break;case 32:d.setColorFilter(t),d.drawTarget(B,0,0,q.width,q.height,I.EMPTY.identity(),U.create(1,0)),d.setColorFilter(null)}d.popRT()}a=a-p-b.x;c=c-p-b.y;u.setTo(a,c);l.transformPoint(u);a=u.x+q.x;c=u.y+q.y;d._drawRenderTexture(r,a,c,q.width,q.height,I.TEMP.identity(),1,ca.defuv);B&&(b=ba.create([B],function(d){d.destroy()},this),B=null,d.addRenderObject(b));l.destroy()}}};return a}();(function(){function a(){}p(a,"laya.utils.Log");a.enable=function(){a._logdiv||(a._logdiv=r.createElement("div"),a._logdiv.style.cssText="border:white;padding:4px;overflow-y:auto;z-index:1000000;background:rgba(100,100,100,0.6);color:white;position: absolute;left:0px;top:0px;width:50%;height:50%;",r.document.body.appendChild(a._logdiv),a._btn=r.createElement("button"),a._btn.innerText="Hide",a._btn.style.cssText="z-index:1000001;position: absolute;left:10px;top:10px;",a._btn.onclick=a.toggle,r.document.body.appendChild(a._btn))};a.toggle=function(){var c=a._logdiv.style;""===c.display?(a._btn.innerText="Show",c.display="none"):(a._btn.innerText="Hide",c.display="")};a.print=function(c){a._logdiv&&(a._count>=a.maxCount&&a.clear(),a._count++,a._logdiv.innerText+=c+"\n",a.autoScrollToBottom&&50>a._logdiv.scrollHeight-a._logdiv.scrollTop-a._logdiv.clientHeight&&(a._logdiv.scrollTop=a._logdiv.scrollHeight))};a.clear=function(){a._logdiv.innerText="";a._count=0};a._logdiv=null;a._btn=null;a._count=0;a.maxCount=50;a.autoScrollToBottom=!0;return a})();var ua=function(){function a(){this.preOvers=[];this.preDowns=[];this.preRightDowns=[];this.enable=!0;this._lastClickTime=0;this._event=new Ta}p(a,"laya.events.TouchManager");var c=a.prototype;c._clearTempArrs=function(){a._oldArr.length=0;a._newArr.length=0;a._tEleArr.length=0};c.getTouchFromArr=function(b,d){var a,c;c=d.length;var g;for(a=0;a<c;a++)if(g=d[a],g.id==b)return g;return null};c.removeTouchFromArr=function(b,d){var a;for(a=d.length-1;0<=a;a--)d[a].id==b&&d.splice(a,1)};c.createTouchO=function(b,d){var a;a=w.getItem("TouchData")||{};a.id=d;a.tar=b;return a};c.onMouseDown=function(b,d,e){void 0===e&&(e=!1);if(this.enable){var c,g;c=this.getTouchFromArr(d,this.preOvers);g=this.getEles(b,null,a._tEleArr);c?c.tar=b:(c=this.createTouchO(b,d),this.preOvers.push(c));r.onMobile&&this.sendEvents(g,"mouseover");var h;h=e?this.preDowns:this.preRightDowns;(c=this.getTouchFromArr(d,h))?c.tar=b:(c=this.createTouchO(b,d),h.push(c));this.sendEvents(g,e?"mousedown":"rightmousedown");this._clearTempArrs()}};c.sendEvents=function(b,d){var a,c;c=b.length;this._event._stoped=!1;var g;g=b[0];var h;for(a=0;a<c;a++){h=b[a];if(h.destroyed)break;h.event(d,this._event.setTo(d,h,g));if(this._event._stoped)break}};c.getEles=function(b,d,a){for(a?a.length=0:a=[];b&&b!=d;)a.push(b),b=b.parent;return a};c.checkMouseOutAndOverOfMove=function(b,d,e){if(d!=b){var c,g;if(d.contains(b))e=this.getEles(b,d,a._tEleArr),this.sendEvents(e,"mouseover");else if(b.contains(d))e=this.getEles(d,b,a._tEleArr),this.sendEvents(e,"mouseout");else{e=a._tEleArr;e.length=0;d=this.getEles(d,null,a._oldArr);var h;h=this.getEles(b,null,a._newArr);g=d.length;var k;for(c=0;c<g;c++)if(b=d[c],k=h.indexOf(b),0<=k){h.splice(k,h.length-k);break}else e.push(b);0<e.length&&this.sendEvents(e,"mouseout");0<h.length&&this.sendEvents(h,"mouseover")}}};c.onMouseMove=function(b,d){if(this.enable){var e;(e=this.getTouchFromArr(d,this.preOvers))?(this.checkMouseOutAndOverOfMove(b,e.tar),e.tar=b,e=this.getEles(b,null,a._tEleArr)):(e=this.getEles(b,null,a._tEleArr),this.sendEvents(e,"mouseover"),this.preOvers.push(this.createTouchO(b,d)));this.sendEvents(e,"mousemove");this._clearTempArrs()}};c.getLastOvers=function(){a._tEleArr.length=0;if(0<this.preOvers.length&&this.preOvers[0].tar)return this.getEles(this.preOvers[0].tar,null,a._tEleArr);a._tEleArr.push(l.stage);return a._tEleArr};c.stageMouseOut=function(){var b;b=this.getLastOvers();this.preOvers.length=0;this.sendEvents(b,"mouseout")};c.onMouseUp=function(b,d,e){void 0===e&&(e=!1);if(this.enable){var c,g,h,k,n,q,u=r.onMobile;g=this.getEles(b,null,a._tEleArr);this.sendEvents(g,e?"mouseup":"rightmouseup");var B;B=e?this.preDowns:this.preRightDowns;if(c=this.getTouchFromArr(d,B)){var l;q=r.now();l=300>q-this._lastClickTime;this._lastClickTime=q;if(b==c.tar)q=g;else for(b=this.getEles(c.tar,null,a._oldArr),q=a._newArr,q.length=0,k=b.length,h=0;h<k;h++)n=b[h],0<=g.indexOf(n)&&q.push(n);0<q.length&&this.sendEvents(q,e?"click":"rightclick");e&&l&&this.sendEvents(q,"doubleclick");this.removeTouchFromArr(d,B);c.tar=null;w.recover("TouchData",c)}(c=this.getTouchFromArr(d,this.preOvers))&&u&&((q=this.getEles(c.tar,null,q))&&0<q.length&&this.sendEvents(q,"mouseout"),this.removeTouchFromArr(d,this.preOvers),c.tar=null,w.recover("TouchData",c));this._clearTempArrs()}};a._oldArr=[];a._newArr=[];a._tEleArr=[];t(a,["I",function(){return this.I=new a}]);return a}(),eb=function(){function a(){this._mesh=null;this._numEle=this._startIdx=0;this.shaderValue=null;this.blendType=0;this._ref=1;this.srcRT=null;this._key=new Ia}p(a,"laya.webgl.submit.SubmitTarget");var c=a.prototype;l.imps(c,{"laya.webgl.submit.ISubmit":!0});c.renderSubmit=function(){this._mesh.useMesh(E.mainContext);var b=this.srcRT;b&&(this.shaderValue.texture=b._getSource(),this.shaderValue.upload(),this.blend(),J.renderBatches++,J.trianglesFaces+=this._numEle/3,E.mainContext.drawElements(4,this._numEle,5123,this._startIdx));return 1};c.blend=function(){if(T.activeBlendFunction!==T.fns[this.blendType]){var b=E.mainContext;b.enable(3042);T.fns[this.blendType](b);T.activeBlendFunction=T.fns[this.blendType]}};c.getRenderType=function(){return 0};c.releaseRender=function(){if(1>--this._ref){var b=a.POOL;b[b._length++]=this}};c.reUse=function(b,d){this._startIdx=d;this._ref++;return d};a.create=function(b,d,e,c){var f=a.POOL._length?a.POOL[--a.POOL._length]:new a;f._mesh=d;f.srcRT=c;f._startIdx=d.indexNum*ja.BYTES_PIDX;f._ref=1;f._key.clear();f._numEle=0;f.blendType=b._nBlendType;f._key.blendShader=f.blendType;f.shaderValue=e;f.shaderValue.setValue(b._shader2D);b._colorFiler&&(b=b._colorFiler,e.defines.add(b.type),e.colorMat=b._mat,e.colorAlpha=b._alpha);return f};a.POOL=[];a.__init$=function(){a.POOL._length=0};return a}(),Fb=function(){function a(){}p(a,"laya.display.cmd.DrawImageCmd");var c=a.prototype;c.recover=function(){this.texture._removeReference();this.texture=null;w.recover("DrawImageCmd",this)};c.run=function(b,d,a){b.drawTexture(this.texture,this.x+d,this.y+a,this.width,this.height)};m(0,c,"cmdID",function(){return"DrawImage"});a.create=function(b,d,e,c,g){var f=w.getItemByClass("DrawImageCmd",a);f.texture=b;b._addReference();f.x=d;f.y=e;f.width=c;f.height=g;return f};a.ID="DrawImage";return a}(),fb=function(){function a(){this._id=L.getGID();this._resetComp()}p(a,"laya.components.Component");var c=a.prototype;l.imps(c,{"laya.resource.ISingletonElement":!0,"laya.resource.IDestroy":!0});c._isScript=function(){return!1};c._resetComp=function(){this._indexInList=-1;this._enabled=!0;this._awaked=!1;this.owner=null};c._getIndexInList=function(){return this._indexInList};c._setIndexInList=function(b){this._indexInList=b};c._onAdded=function(){};c._onAwake=function(){};c._onEnable=function(){};c._onDisable=function(){};c._onEnableInScene=function(){};c._onDisableInScene=function(){};c._onDestroy=function(){};c.onReset=function(){};c._parse=function(b){};c._cloneTo=function(b){};c._setActive=function(b){b?(this._awaked||(this._awaked=!0,this._onAwake()),this._enabled&&this._onEnable()):this._enabled&&this._onDisable()};c._setActiveInScene=function(b){b?this._onEnableInScene():this._onDisableInScene()};c.destroy=function(){this.owner&&this.owner._destroyComponent(this)};c._destroy=function(){this.owner.activeInHierarchy&&this._enabled&&(this._setActive(!1),this._isScript()&&this.onDisable());this.owner._scene&&this._setActiveInScene(!1);this._onDestroy();this._destroyed=!0;this.onReset!==laya.components.Component.prototype.onReset?(this.onReset(),this._resetComp(),w.recoverByClass(this)):this._resetComp()};m(0,c,"id",function(){return this._id});m(0,c,"enabled",function(){return this._enabled},function(b){this._enabled=b;this.owner&&(b?this.owner.activeInHierarchy&&this._onEnable():this.owner.activeInHierarchy&&this._onDisable())});m(0,c,"isSingleton",function(){return!0});m(0,c,"destroyed",function(){return this._destroyed});return a}(),W=function(){function a(){this._$0__events=null}var c;p(a,"laya.events.EventDispatcher");var b=a.prototype;b.hasListener=function(d){return!(!this._$0__events||!this._$0__events[d])};b.event=function(d,b){if(!this._$0__events||!this._$0__events[d])return!1;var a=this._$0__events[d];if(a.run)a.once&&delete this._$0__events[d],null!=b?a.runWith(b):a.run();else{for(var e=0,c=a.length;e<c;e++){var k=a[e];k&&(null!=b?k.runWith(b):k.run());if(!k||k.once)a.splice(e,1),e--,c--}0===a.length&&this._$0__events&&delete this._$0__events[d]}return!0};b.on=function(d,b,a,c){return this._createListener(d,b,a,c,!1)};b.once=function(d,b,a,c){return this._createListener(d,b,a,c,!0)};b._createListener=function(d,b,a,g,h,k){void 0===k&&(k=!0);k&&this.off(d,b,a,h);b=c.create(b||this,a,g,h);this._$0__events||(this._$0__events={});a=this._$0__events;a[d]?a[d].run?a[d]=[a[d],b]:a[d].push(b):a[d]=b;return this};b.off=function(d,b,a,c){void 0===c&&(c=!1);if(!this._$0__events||!this._$0__events[d])return this;var e=this._$0__events[d];if(null!=e)if(e.run)b&&e.caller!==b||null!=a&&e.method!==a||c&&!e.once||(delete this._$0__events[d],e.recover());else{for(var f=0,g=0,q=e.length;g<q;g++){var u=e[g];u?!u||b&&u.caller!==b||null!=a&&u.method!==a||c&&!u.once||(f++,e[g]=null,u.recover()):f++}f===q&&delete this._$0__events[d]}return this};b.offAll=function(d){var b=this._$0__events;if(!b)return this;if(d)this._recoverHandlers(b[d]),delete b[d];else{for(var a in b)this._recoverHandlers(b[a]);this._$0__events=null}return this};b.offAllCaller=function(d){if(d&&this._$0__events)for(var b in this._$0__events)this.off(b,d,null);return this};b._recoverHandlers=function(d){if(d)if(d.run)d.recover();else for(var b=d.length-1;-1<b;b--)d[b]&&(d[b].recover(),d[b]=null)};b.isMouseEvent=function(d){return a.MOUSE_EVENTS[d]||!1};a.MOUSE_EVENTS={rightmousedown:!0,rightmouseup:!0,rightclick:!0,mousedown:!0,mouseup:!0,mousemove:!0,mouseover:!0,mouseout:!0,click:!0,doubleclick:!0};a.__init$=function(){Object.defineProperty(laya.events.EventDispatcher.prototype,"_events",{enumerable:!1,writable:!0});c=function(d){function b(d,a,e,c){b.__super.call(this,d,a,e,c)}p(b,"",d);b.prototype.recover=function(){0<this._id&&(this._id=0,b._pool.push(this.clear()))};b.create=function(d,a,e,c){void 0===c&&(c=!0);return b._pool.length?b._pool.pop().setTo(d,a,e,c):new b(d,a,e,c)};b._pool=[];return b}(S)};return a}(),S=function(){function a(b,d,a,c){this.once=!1;this._id=0;void 0===c&&(c=!1);this.setTo(b,d,a,c)}p(a,"laya.utils.Handler");var c=a.prototype;c.setTo=function(b,d,e,c){this._id=a._gid++;this.caller=b;this.method=d;this.args=e;this.once=c;return this};c.run=function(){if(null==this.method)return null;var b=this._id,d=this.method.apply(this.caller,this.args);this._id===b&&this.once&&this.recover();return d};c.runWith=function(b){if(null==this.method)return null;var d=this._id;b=null==b?this.method.apply(this.caller,this.args):this.args||b.unshift?this.args?this.method.apply(this.caller,this.args.concat(b)):this.method.apply(this.caller,b):this.method.call(this.caller,b);this._id===d&&this.once&&this.recover();return b};c.clear=function(){this.args=this.method=this.caller=null;return this};c.recover=function(){0<this._id&&(this._id=0,a._pool.push(this.clear()))};a.create=function(b,d,e,c){void 0===c&&(c=!0);return a._pool.length?a._pool.pop().setTo(b,d,e,c):new a(b,d,e,c)};a._pool=[];a._gid=1;return a}(),ib=function(){function a(){this.vb=this.ib=null;this.ib=gb.create(35048);this.vb=hb.create(8)}p(a,"laya.webgl.shader.d2.skinAnishader.SkinMeshBuffer");var c=a.prototype;c.addSkinMesh=function(b){b.getData2(this.vb,this.ib,this.vb._byteLength/32)};c.reset=function(){this.vb.clear();this.ib.clear()};a.getInstance=function(){return a.instance=a.instance||new a};a.instance=null;return a}(),Gb=function(){function a(){}p(a,"laya.display.cmd.DrawTrianglesCmd");var c=a.prototype;c.recover=function(){this.matrix=this.indices=this.uvs=this.vertices=this.texture=null;w.recover("DrawTrianglesCmd",this)};c.run=function(b,d,a){b.drawTriangles(this.texture,this.x+d,this.y+a,this.vertices,this.uvs,this.indices,this.matrix,this.alpha,this.color,this.blendMode)};m(0,c,"cmdID",function(){return"DrawTriangles"});a.create=function(b,d,e,c,g,h,k,n,q,u){var f=w.getItemByClass("DrawTrianglesCmd",a);f.texture=b;f.x=d;f.y=e;f.vertices=c;f.uvs=g;f.indices=h;f.matrix=k;f.alpha=n;q&&(f.color=new jb,b=x.create(q).arrColor,f.color.color(255*b[0],255*b[1],255*b[2],255*b[3]));f.blendMode=u;return f};a.ID="DrawTriangles";return a}(),Hb=function(){function a(){}p(a,"laya.display.cmd.DrawPieCmd");var c=a.prototype;c.recover=function(){this.lineColor=this.fillColor=null;w.recover("DrawPieCmd",this)};c.run=function(b,d,a){b._drawPie(this.x+d,this.y+a,this.radius,this._startAngle,this._endAngle,this.fillColor,this.lineColor,this.lineWidth,this.vid)};m(0,c,"startAngle",function(){return 180*this._startAngle/Math.PI},function(b){this._startAngle=b*Math.PI/180});m(0,c,"cmdID",function(){return"DrawPie"});m(0,c,"endAngle",function(){return 180*this._endAngle/Math.PI},function(b){this._endAngle=b*Math.PI/180});a.create=function(b,d,e,c,g,h,k,n,q){var f=w.getItemByClass("DrawPieCmd",a);f.x=b;f.y=d;f.radius=e;f._startAngle=c;f._endAngle=g;f.fillColor=h;f.lineColor=k;f.lineWidth=n;f.vid=q;return f};a.ID="DrawPie";return a}(),Ib=function(){function a(){this.id=NaN;this.save=[];this.toUpperCase=null;this.changed=!1;this._text=null;this.width=-1;this.pageChars=[];this.lastGCCnt=this.startIDStroke=this.startID=0;this.splitRender=!1}p(a,"laya.utils.WordText");var c=a.prototype;c.setText=function(b){this.changed=!0;this._text=b;this.width=-1;this.cleanCache()};c.toString=function(){return this._text};c.charCodeAt=function(b){return this._text?this._text.charCodeAt(b):NaN};c.charAt=function(b){return this._text?this._text.charAt(b):null};c.cleanCache=function(){this.pageChars.forEach(function(b){var d=b.tex;1==b.words.length&&d&&d.ri&&d.destroy()});this.pageChars=[];this.startID=0};m(0,c,"length",function(){return this._text?this._text.length:0});return a}(),Ka=function(){function a(b,d,a){this.indexNum=this.vertNum=this._stride=0;this._applied=!1;this._attribInfo=this._vao=this._ib=this._vb=null;this._quadNum=0;this.canReuse=!1;this._stride=b;this._vb=new hb(b,35048);d?this._vb._resizeBuffer(d,!1):da.webGL2D_MeshAllocMaxMem&&this._vb._resizeBuffer(65536*b,!1);this._ib=new gb;a&&this._ib._resizeBuffer(a,!1)}p(a,"laya.webgl.utils.Mesh2D");var c=a.prototype;c.cloneWithNewVB=function(){var b=new a(this._stride,0,0);b._ib=this._ib;b._quadNum=this._quadNum;b._attribInfo=this._attribInfo;return b};c.cloneWithNewVBIB=function(){var b=new a(this._stride,0,0);b._attribInfo=this._attribInfo;return b};c.getVBW=function(){this._vb.setNeedUpload();return this._vb};c.getVBR=function(){return this._vb};c.getIBR=function(){return this._ib};c.getIBW=function(){this._ib.setNeedUpload();return this._ib};c.createQuadIB=function(b){this._quadNum=b;this._ib._resizeBuffer(12*b,!1);this._ib.byteLength=this._ib.bufferLength;for(var d=this._ib.getUint16Array(),a=0,c=0,g=0;g<b;g++)d[a++]=c,d[a++]=c+2,d[a++]=c+1,d[a++]=c,d[a++]=c+3,d[a++]=c+2,c+=4;this._ib.setNeedUpload()};c.setAttributes=function(b){this._attribInfo=b;if(0!=this._attribInfo.length%3)throw"Mesh2D setAttributes error!";};c.configVAO=function(b){if(!this._applied){this._applied=!0;this._vao||(this._vao=new Jb);this._vao.bind();this._vb._bindForVAO();this._ib.setNeedUpload();this._ib._bind_uploadForVAO();for(var d=this._attribInfo.length/3,a=0,c=0;c<d;c++){var g=this._attribInfo[a+1],h=this._attribInfo[a],k=this._attribInfo[a+2];b.enableVertexAttribArray(c);b.vertexAttribPointer(c,g,h,!1,this._stride,k);a+=3}this._vao.unBind()}};c.useMesh=function(b){this._applied||this.configVAO(b);this._vao.bind();this._vb.bind();this._ib._bind_upload()||this._ib.bind();this._vb._bind_upload()||this._vb.bind()};c.getEleNum=function(){return this._ib.getBuffer().byteLength/2};c.releaseMesh=function(){};c.destroy=function(){};c.clearVB=function(){this._vb.clear()};a._gvaoid=0;return a}(),Ta=function(){function a(){}p(a,"laya.events.Event");var c=a.prototype;c.setTo=function(b,d,a){this.type=b;this.currentTarget=d;this.target=a;return this};c.stopPropagation=function(){this._stoped=!0};m(0,c,"stageY",function(){return l.stage.mouseY});m(0,c,"charCode",function(){return this.nativeEvent.charCode});m(0,c,"touches",function(){if(!this.nativeEvent)return null;var b=this.nativeEvent.touches;if(b)for(var d=l.stage,a=0,c=b.length;a<c;a++){var g=b[a],h=N.TEMP;h.setTo(g.clientX,g.clientY);d._canvasTransform.invertTransformPoint(h);d.transform.invertTransformPoint(h);g.stageX=h.x;g.stageY=h.y}return b});m(0,c,"keyLocation",function(){return this.nativeEvent.location||this.nativeEvent.keyLocation});m(0,c,"ctrlKey",function(){return this.nativeEvent.ctrlKey});m(0,c,"altKey",function(){return this.nativeEvent.altKey});m(0,c,"shiftKey",function(){return this.nativeEvent.shiftKey});m(0,c,"stageX",function(){return l.stage.mouseX});a.EMPTY=new a;a.MOUSE_DOWN="mousedown";a.MOUSE_UP="mouseup";a.CLICK="click";a.RIGHT_MOUSE_DOWN="rightmousedown";a.RIGHT_MOUSE_UP="rightmouseup";a.RIGHT_CLICK="rightclick";a.MOUSE_MOVE="mousemove";a.MOUSE_OVER="mouseover";a.MOUSE_OUT="mouseout";a.MOUSE_WHEEL="mousewheel";a.ROLL_OVER="mouseover";a.ROLL_OUT="mouseout";a.DOUBLE_CLICK="doubleclick";a.CHANGE="change";a.CHANGED="changed";a.RESIZE="resize";a.ADDED="added";a.REMOVED="removed";a.DISPLAY="display";a.UNDISPLAY="undisplay";a.ERROR="error";a.COMPLETE="complete";a.LOADED="loaded";a.READY="ready";a.PROGRESS="progress";a.INPUT="input";a.RENDER="render";a.OPEN="open";a.MESSAGE="message";a.CLOSE="close";a.KEY_DOWN="keydown";a.KEY_PRESS="keypress";a.KEY_UP="keyup";a.FRAME="enterframe";a.DRAG_START="dragstart";a.DRAG_MOVE="dragmove";a.DRAG_END="dragend";a.ENTER="enter";a.SELECT="select";a.BLUR="blur";a.FOCUS="focus";a.VISIBILITY_CHANGE="visibilitychange";a.FOCUS_CHANGE="focuschange";a.PLAYED="played";a.PAUSED="paused";a.STOPPED="stopped";a.START="start";a.END="end";a.COMPONENT_ADDED="componentadded";a.COMPONENT_REMOVED="componentremoved";a.RELEASED="released";a.LINK="link";a.LABEL="label";a.FULL_SCREEN_CHANGE="fullscreenchange";a.DEVICE_LOST="devicelost";a.TRANSFORM_CHANGED="transformchanged";a.ANIMATION_CHANGED="animationchanged";a.TRAIL_FILTER_CHANGE="trailfilterchange";a.TRIGGER_ENTER="triggerenter";a.TRIGGER_STAY="triggerstay";a.TRIGGER_EXIT="triggerexit";return a}(),Y=function(){function a(){this.fontSizeInfo={};this.charRender=null;this.mapFont={};this.fontID=0;this.mapColor=[];this.colorID=0;this.fontScaleY=this.fontScaleX=1;this._curStrPos=0;this.lastFont=this.bmpData32=null;this.fontSizeOffY=this.fontSizeOffX=this.fontSizeH=this.fontSizeW=0;this.renderPerChar=!0;this.textureMem=0;this.fontStr=null;this.textAtlases=[];this.isoTextures=[];this.tmpAtlasPos=new N;var b=!1,d=l.MiniAdpter;d&&d.systemInfo&&d.systemInfo.system&&(b="ios 10.1.1"===d.systemInfo.system.toLowerCase());r.onMiniGame&&!b&&(a.isWan1Wan=!0);r.onLimixiu&&(a.isWan1Wan=!0);this.charRender=v.isConchApp?new Kb:new Lb(a.atlasWidth,a.atlasWidth,a.scaleFontWithCtx,!a.isWan1Wan,!1);a.textRenderInst=this;l.textRender=this;a.atlasWidth2=a.atlasWidth*a.atlasWidth}p(a,"laya.webgl.text.TextRender");var c=a.prototype;c.setFont=function(b){if(this.lastFont!=b){this.lastFont=b;var d=this.getFontSizeInfo(b._family),e=b._size/a.standardFontSize;this.fontSizeOffX=Math.ceil((d>>24)*e);this.fontSizeOffY=Math.ceil((d>>16&255)*e);this.fontSizeW=Math.ceil((d>>8&255)*e);this.fontSizeH=Math.ceil((d&255)*e);0<=b._font.indexOf("italic")?this.fontStr=b._font.replace("italic",""):this.fontStr=b._font}};c.getNextChar=function(b){var d=b.length,a=this._curStrPos;if(a>=d)return null;for(var c=a,g=0;c<d;c++){var h=b.charCodeAt(c);if(27==h>>>11){if(1==g)break;g=1;c++}else if(65038!==h&&65039!==h)if(8205==h)g=2;else if(0==g)g=1;else if(1==g)break}this._curStrPos=c;return b.substring(a,c)};c.filltext=function(b,d,a,c,g,h,k,n,q,u){void 0===u&&(u=0);if(!(0>=d.length)){g=xa.Parse(g);var e=0;switch(q){case "center":e=V.ENUM_TEXTALIGN_CENTER;break;case "right":e=V.ENUM_TEXTALIGN_RIGHT}this._fast_filltext(b,d,null,a,c,g,h,k,n,e,u)}};c.fillWords=function(b,d,a,c,g,h,k,n){!d||0>=d.length||(g=xa.Parse(g),this._fast_filltext(b,null,d,a,c,g,h,k,n,0,0))};c._fast_filltext=function(b,d,e,c,g,h,k,n,q,u,B){if(!(d&&1>d.length||e&&1>e.length)){0>q&&(q=0);this.setFont(h);this.fontScaleX=this.fontScaleY=1;if(!v.isConchApp&&a.scaleFontWithCtx){var f;v.isConchApp?(B=b._curMat.getScaleX(),f=b._curMat.getScaleY()):(B=b.getMatScaleX(),f=b.getMatScaleY());if(1E-4>B||.1>f)return;1<B&&(this.fontScaleX=B);1<f&&(this.fontScaleY=f)}h._italic&&(b._italicDeg=13);var l=!e&&d instanceof laya.utils.WordText;B=d;f=!!e;var m=l?d.pageChars:[],p;l?(B=d._text,p=d.width,0>p&&(p=d.width=this.charRender.getWidth(this.fontStr,B))):p=B?this.charRender.getWidth(this.fontStr,B):0;switch(u){case V.ENUM_TEXTALIGN_CENTER:c-=p/2;break;case V.ENUM_TEXTALIGN_RIGHT:c-=p}d&&m&&this.hasFreedText(m)&&(m=d.pageChars=[]);d=this.renderPerChar=!l||a.forceSplitRender||f||l&&d.splitRender;if(!m||1>m.length)if(d)for(this._curStrPos=u=d=0;;){f?(l=e[this._curStrPos++])?(p=l["char"],d=l.x,u=l.y):p=null:p=this.getNextChar(B);if(!p)break;p=this.getCharRenderInfo(p,h,k,n,q,!1);if(!p)break;p.isSpace||(l=m[p.tex.id],l||(l={texgen:p.tex.genID,tex:p.tex,words:[]},m[p.tex.id]=l),l=l.words,v.isConchApp?l.push({ri:p,x:d,y:u,w:p.bmpWidth/this.fontScaleX,h:p.bmpHeight/this.fontScaleY}):l.push({ri:p,x:d+1/this.fontScaleX,y:u,w:(p.bmpWidth-2)/this.fontScaleX,h:(p.bmpHeight-1)/this.fontScaleY}),d+=p.width)}else p=this.getCharRenderInfo(B,h,k,n,q,a.noAtlas||p*this.fontScaleX>a.atlasWidth),m[0]=v.isConchApp?{texgen:p.tex.genID,tex:p.tex,words:[{ri:p,x:0,y:0,w:p.bmpWidth/this.fontScaleX,h:p.bmpHeight/this.fontScaleY}]}:{texgen:p.tex.genID,tex:p.tex,words:[{ri:p,x:1/this.fontScaleX,y:0/this.fontScaleY,w:(p.bmpWidth-2)/this.fontScaleX,h:(p.bmpHeight-1)/this.fontScaleY}]};this._drawResortedWords(b,c,g,m);b._italicDeg=0}};c._drawResortedWords=function(b,d,a,c){for(var e=b._charSubmitCache&&b._charSubmitCache._enbale,f=b._curMat,k=c.length,n=0;n<k;n++){var q=c[n];if(q){var q=q.words,u=q.length;if(!(0>=u))for(var B=c[n].tex,l=0;l<u;l++){var m=q[l],p=m.ri;p.isSpace||(p.touch(),b.drawTexAlign=!0,v.isConchApp?b._drawTextureM(B.texture,d+m.x-p.orix,a+m.y-p.oriy,m.w,m.h,null,1,p.uv):b._inner_drawTexture(B.texture,B.texture.bitmap.id,d+m.x-p.orix,a+m.y-p.oriy,m.w,m.h,f,p.uv,1,e),b.touches&&b.touches.push(p))}}}};c.hasFreedText=function(b){for(var d=b.length,a=0;a<d;a++){var c=b[a];if(c){var g=c.tex;if(g.__destroyed||g.genID!=c.texgen)return!0}}return!1};c.getCharRenderInfo=function(b,d,e,c,g,h){void 0===h&&(h=!1);var f=this.mapFont[d._family];void 0==f&&(this.mapFont[d._family]=f=this.fontID++);var n=b+"_"+f+"_"+d._size+"_"+e;0<g&&(n+="_"+c+g);d._bold&&(n+="P");if(1!=this.fontScaleX||1!=this.fontScaleY)n+=(20*this.fontScaleX|0)+"_"+(20*this.fontScaleY|0);var q,u=this.textAtlases.length,B;if(!h)for(q=0;q<u;q++)if(B=this.textAtlases[q],f=B.charMaps[n])return f.touch(),f;f=new kb;this.charRender.scale(this.fontScaleX,this.fontScaleY);f["char"]=b;f.height=d._size;d=d._size/3|0;B=Math.ceil(this.charRender.getWidth(this.fontStr,b)*this.fontScaleX);B>this.charRender.canvasWidth&&(this.charRender.canvasWidth=Math.min(2048,B+2*d));if(h)b=this.charRender.getCharBmp(b,this.fontStr,g,e,c,f,d,d,d,d,null),e=Ua.getTextTexture(b.width,b.height),e.addChar(b,0,0,f.uv),f.tex=e,f.orix=d,f.oriy=d,e.ri=f,this.isoTextures.push(e);else{q=b.length;h=1*g;var u=Math.ceil((this.fontSizeW+2*h)*this.fontScaleX),l=Math.ceil((this.fontSizeH+2*h)*this.fontScaleY);a.imgdtRect[0]=(d-this.fontSizeOffX-h)*this.fontScaleX|0;a.imgdtRect[1]=(d-this.fontSizeOffY-h)*this.fontScaleY|0;this.renderPerChar||1==q?(a.imgdtRect[2]=Math.max(B,u),a.imgdtRect[3]=Math.max(B,l)):(a.imgdtRect[2]=-1,a.imgdtRect[3]=l);b=this.charRender.getCharBmp(b,this.fontStr,g,e,c,f,d,d,d,d,a.imgdtRect);B=this.addBmpData(b,f);a.isWan1Wan?(f.orix=d,f.oriy=d):(f.orix=this.fontSizeOffX+h,f.oriy=this.fontSizeOffY+h);B.charMaps[n]=f}return f};c.addBmpData=function(b,d){for(var a=b.width,c=b.height,g=this.textAtlases.length,h=null,k=!1,n=0;n<g&&!(h=this.textAtlases[n],k=h.getAEmpty(a,c,this.tmpAtlasPos));n++);if(!k){h=new ya;this.textAtlases.push(h);k=h.getAEmpty(a,c,this.tmpAtlasPos);if(!k)throw"err1";this.cleanAtlases()}k&&(h.texture.addChar(b,this.tmpAtlasPos.x,this.tmpAtlasPos.y,d.uv),d.tex=h.texture);return h};c.GC=function(){for(var b=0,d=this.textAtlases.length,e,c=a.destroyAtlasDt,g=0,h=J.loopCount,k=-1,n=0,q,u;b<d;b++){u=this.textAtlases[b];if(q=u.texture)g+=q.curUsedCovRateAtlas,e=u.usedRate-q.curUsedCovRateAtlas,n<e&&(n=e,k=b);e=h-u.texture.lastTouchTm;e>c&&(a.showLog&&console.log("TextRender GC delete atlas "+q?u.texture.id:"unk"),u.destroy(),this.textAtlases[b]=this.textAtlases[d-1],d--,b--,k=-1)}this.textAtlases.length=d;d=this.isoTextures.length;for(b=0;b<d;b++)q=this.isoTextures[b],e=h-q.lastTouchTm,e>a.destroyUnusedTextureDt&&(q.ri.deleted=!0,q.ri.tex=null,q.destroy(),this.isoTextures[b]=this.isoTextures[d-1],d--,b--);this.isoTextures.length=d;b=1<this.textAtlases.length&&2<=this.textAtlases.length-g;if(a.atlasWidth*a.atlasWidth*4*this.textAtlases.length>a.cleanMem||b||a.simClean)a.simClean=!1,a.showLog&&console.log("\u6e05\u7406\u4f7f\u7528\u7387\u4f4e\u7684\u8d34\u56fe\u3002\u603b\u4f7f\u7528\u7387:",g,":",this.textAtlases.length,"\u6700\u5dee\u8d34\u56fe:"+k),0<=k&&(u=this.textAtlases[k],u.destroy(),this.textAtlases[k]=this.textAtlases[this.textAtlases.length-1],--this.textAtlases.length);Ua.clean()};c.cleanAtlases=function(){};c.getCharBmp=function(b){};c.checkBmpLine=function(b,d,a,c){this.bmpData32.buffer!=b.data.buffer&&(this.bmpData32=new Uint32Array(b.data.buffer));for(b=b.width*d+a;a<c;a++)if(0!=this.bmpData32[b++])return!0;return!1};c.updateBbx=function(b,d,a){void 0===a&&(a=!1);var e=b.width,c=b.height,h=d[1],k=0,n;if(this.checkBmpLine(b,h,0,e))for(;;){n=(h+k)/2|0;if(n+1>=h){d[1]=n;break}this.checkBmpLine(b,n,0,e)?h=n:k=n}if(d[3]>c)d[3]=c;else if(h=d[3],k=c,this.checkBmpLine(b,h,0,e))for(;;){n=(h+k)/2|0;if(n-1<=h){d[3]=n;break}this.checkBmpLine(b,n,0,e)?h=n:k=n}if(!a){c=d[0];a=e*d[1];for(n=d[1];n<d[3];n++){for(b=0;b<c;b++)if(0!=this.bmpData32[a+b]){c=b;break}a+=e}d[0]=c;c=d[2];a=e*d[1];for(n=d[1];n<d[3];n++){for(b=c;b<e;b++)if(0!=this.bmpData32[a+b]){c=b;break}a+=e}d[2]=c}};c.getFontSizeInfo=function(b){var d=this.fontSizeInfo[b];if(void 0!=d)return d;d="bold "+a.standardFontSize+"px "+b;if(a.isWan1Wan)return this.fontSizeW=1.5*this.charRender.getWidth(d,"\u6709"),this.fontSizeH=1.5*a.standardFontSize,d=this.fontSizeW<<8|this.fontSizeH,this.fontSizeInfo[b]=d;a.pixelBBX[0]=a.standardFontSize/2;a.pixelBBX[1]=a.standardFontSize/2;a.pixelBBX[2]=a.standardFontSize;a.pixelBBX[3]=a.standardFontSize;var e=16,c=16;this.charRender.scale(1,1);a.tmpRI.height=a.standardFontSize;var g=this.charRender.getCharBmp("g",d,0,"red",null,a.tmpRI,e,c,16,16);v.isConchApp&&(g.data=new Uint8ClampedArray(g.data));this.bmpData32=new Uint32Array(g.data.buffer);this.updateBbx(g,a.pixelBBX,!1);g=this.charRender.getCharBmp("\u6709",d,0,"red",null,a.tmpRI,c,c,16,16);v.isConchApp&&(g.data=new Uint8ClampedArray(g.data));this.bmpData32=new Uint32Array(g.data.buffer);a.pixelBBX[2]<e+a.tmpRI.width&&(a.pixelBBX[2]=e+a.tmpRI.width);this.updateBbx(g,a.pixelBBX,!1);v.isConchApp&&(c=e=0);d=Math.max(e-a.pixelBBX[0],0)<<24|Math.max(c-a.pixelBBX[1],0)<<16|a.pixelBBX[2]-a.pixelBBX[0]<<8|a.pixelBBX[3]-a.pixelBBX[1]+2;return this.fontSizeInfo[b]=d};c.printDbgInfo=function(){console.log("\u56fe\u96c6\u4e2a\u6570:"+this.textAtlases.length+",\u6bcf\u4e2a\u56fe\u96c6\u5927\u5c0f:"+a.atlasWidth+"x"+a.atlasWidth," \u7528canvas:",a.isWan1Wan);console.log("\u56fe\u96c6\u5360\u7528\u7a7a\u95f4:"+a.atlasWidth*a.atlasWidth*4/1024/1024*this.textAtlases.length+"M");console.log("\u7f13\u5b58\u7528\u5230\u7684\u5b57\u4f53:");for(var b in this.mapFont){var d=this.getFontSizeInfo(b);console.log("    "+b," off:",d>>24,d>>16&255," size:",d>>8&255,d&255)}var e=0;console.log("\u7f13\u5b58\u6570\u636e:");var c=0,g=0;this.textAtlases.forEach(function(d){var b=d.texture.id,f=J.loopCount-d.texture.lastTouchTm;c+=d.texture.curUsedCovRate;g+=d.texture.curUsedCovRateAtlas;console.log("--\u56fe\u96c6(id:"+b+",\u5f53\u524d\u4f7f\u7528\u7387:"+(1E3*d.texture.curUsedCovRate|0)+"\u2030","\u5f53\u524d\u56fe\u96c6\u4f7f\u7528\u7387:",(100*d.texture.curUsedCovRateAtlas|0)+"%","\u56fe\u96c6\u4f7f\u7528\u7387:",100*d.usedRate|0,"%, \u4f7f\u7528\u4e8e:"+(0<f?""+f+"\u5e27\u4ee5\u524d":"\u5f53\u524d\u5e27")+")--:");for(var h in d.charMaps)b=d.charMaps[h],console.log("     off:",b.orix,b.oriy," bmp\u5bbd\u9ad8:",b.bmpWidth,b.bmpHeight,"\u65e0\u6548:",b.deleted,"touchdt:",J.loopCount-b.touchTick,"\u4f4d\u7f6e:",b.uv[0]*a.atlasWidth|0,b.uv[1]*a.atlasWidth|0,"\u5b57\u7b26:",b["char"],"key:",h),e++});console.log("\u72ec\u7acb\u8d34\u56fe\u6587\u5b57("+this.isoTextures.length+"\u4e2a):");this.isoTextures.forEach(function(d){console.log("    size:",d._texW,d._texH,"touch\u95f4\u9694:",J.loopCount-d.lastTouchTm,"char:",d.ri["char"])});console.log("\u603b\u7f13\u5b58:",e,"\u603b\u4f7f\u7528\u7387:",c,"\u603b\u5f53\u524d\u56fe\u96c6\u4f7f\u7528\u7387:",g)};c.showAtlas=function(b,d,e,c,g,h){if(!this.textAtlases[b])return console.log("\u6ca1\u6709\u8fd9\u4e2a\u56fe\u96c6"),null;var f=new P,n=this.textAtlases[b].texture,q={width:a.atlasWidth,height:a.atlasWidth,sourceWidth:a.atlasWidth,sourceHeight:a.atlasWidth,offsetX:0,offsetY:0,getIsReady:function(){return!0},_addReference:function(){},_removeReference:function(){},_getSource:function(){return n._getSource()},bitmap:{id:n.id},_uv:X.DEF_UV};f.size=function(b,a){this.width=b;this.height=a;f.graphics.clear();f.graphics.drawRect(0,0,f.width,f.height,d);f.graphics.drawTexture(q,0,0,f.width,f.height);return this};f.graphics.drawRect(0,0,g,h,d);f.graphics.drawTexture(q,0,0,g,h);f.pos(e,c);l.stage.addChild(f);return f};c.filltext_native=function(b,d,a,c,g,h,k,n,q,u,l){void 0===l&&(l=0);if(!(d&&0>=d.length||a&&1>a.length)){h=xa.Parse(h);var e=0;switch(u){case "center":e=V.ENUM_TEXTALIGN_CENTER;break;case "right":e=V.ENUM_TEXTALIGN_RIGHT}return this._fast_filltext(b,d,a,c,g,h,k,n,q,e,l)}};a.useOldCharBook=!1;a.atlasWidth=2048;a.noAtlas=!1;a.forceSplitRender=!1;a.forceWholeRender=!1;a.scaleFontWithCtx=!0;a.standardFontSize=32;a.destroyAtlasDt=10;a.checkCleanTextureDt=2E3;a.destroyUnusedTextureDt=3E3;a.cleanMem=104857600;a.isWan1Wan=!1;a.showLog=!1;a.debugUV=!1;a.atlasWidth2=4194304;a.textRenderInst=null;a.simClean=!1;t(a,["tmpRI",function(){return this.tmpRI=new kb},"pixelBBX",function(){return this.pixelBBX=[0,0,0,0]},"imgdtRect",function(){return this.imgdtRect=[0,0,0,0]}]);return a}(),J=function(){function a(){}p(a,"laya.utils.Stat");m(1,a,"onclick",null,function(c){if(a._sp)a._sp.on("click",a._sp,c);a._canvas&&(a._canvas.source.onclick=c,a._canvas.source.style.pointerEvents="")});a.show=function(c,b){void 0===c&&(c=0);void 0===b&&(b=0);r.onMiniGame||r.onLimixiu||v.isConchApp||r.onBDMiniGame||r.onKGMiniGame||r.onQGMiniGame||r.onVVMiniGame||r.onAlipayMiniGame||r.onBLMiniGame||(a._useCanvas=!0);a._show=!0;a._fpsData.length=60;a._view[0]={title:"FPS(Canvas)",value:"_fpsStr",color:"yellow",units:"int"};a._view[1]={title:"Sprite",value:"_spriteStr",color:"white",units:"int"};a._view[2]={title:"RenderBatches",value:"renderBatches",color:"white",units:"int"};a._view[3]={title:"SavedRenderBatches",value:"savedRenderBatches",color:"white",units:"int"};a._view[4]={title:"CPUMemory",value:"cpuMemory",color:"yellow",units:"M"};a._view[5]={title:"GPUMemory",value:"gpuMemory",color:"yellow",units:"M"};a._view[6]={title:"Shader",value:"shaderCall",color:"white",units:"int"};v.is3DMode?(a._view[0].title="FPS(3D)",a._view[7]={title:"TriFaces",value:"trianglesFaces",color:"white",units:"int"},a._view[8]={title:"FrustumCulling",value:"frustumCulling",color:"white",units:"int"},a._view[9]={title:"OctreeNodeCulling",value:"octreeNodeCulling",color:"white",units:"int"}):(a._view[0].title="FPS(WebGL)",a._view[7]={title:"Canvas",value:"_canvasStr",color:"white",units:"int"});a._useCanvas?a.createUIPre(c,b):a.createUI(c,b);a.enable()};a.createUIPre=function(c,b){var d=r.pixelRatio;if(r.onQGMiniGame||r.onVVMiniGame)d=3;a._width=180*d;a._vx=120*d;a._height=d*(12*a._view.length+3*d)+4;a._fontSize=12*d;for(var e=0;e<a._view.length;e++)a._view[e].x=4,a._view[e].y=e*a._fontSize+2*d;a._canvas||(a._canvas=new ea(!0),a._canvas.size(a._width,a._height),a._ctx=a._canvas.getContext("2d"),a._ctx.textBaseline="top",a._ctx.font=a._fontSize+"px Arial",a._canvas.source.style.cssText="pointer-events:none;background:rgba(150,150,150,0.8);z-index:100000;position: absolute;direction:ltr;left:"+c+"px;top:"+b+"px;width:"+a._width/d+"px;height:"+a._height/d+"px;");r.onKGMiniGame||r.container.appendChild(a._canvas.source);a._first=!0;a.loop();a._first=!1};a.createUI=function(c,b){var d=a._sp,e=r.pixelRatio;if(r.onQGMiniGame||r.onVVMiniGame)e=3;d||(d=new P,a._leftText=new O,a._leftText.pos(5,5),a._leftText.color="#ffffff",d.addChild(a._leftText),a._txt=new O,a._txt.pos(80*e,5),a._txt.color="#ffffff",d.addChild(a._txt),a._sp=d);d.pos(c,b);for(var f="",g=0;g<a._view.length;g++)f+=a._view[g].title+"\n";a._leftText.text=f;f=138*e;g=e*(12*a._view.length+3*e)+4;a._txt.fontSize=a._fontSize*e;a._leftText.fontSize=a._fontSize*e;d.size(f,g);d.graphics.clear();d.graphics.alpha(.5);d.graphics.drawRect(0,0,f,g,"#999999");d.graphics.alpha(2);a.loop()};a.enable=function(){l.systemTimer.frameLoop(1,a,a.loop)};a.hide=function(){a._show=!1;l.systemTimer.clear(a,a.loop);a._canvas&&r.removeElement(a._canvas.source)};a.clear=function(){a.trianglesFaces=a.renderBatches=a.savedRenderBatches=a.shaderCall=a.spriteRenderUseCacheCount=a.frustumCulling=a.octreeNodeCulling=a.canvasNormal=a.canvasBitmap=a.canvasReCache=0};a.loop=function(){a._count++;var c=r.now();if(!(1E3>c-a._timer)){var b=a._count;a.FPS=Math.round(1E3*b/(c-a._timer));a._show&&(a.trianglesFaces=Math.round(a.trianglesFaces/b),a.renderBatches=a._useCanvas?Math.round(a.renderBatches/b):Math.round(a.renderBatches/b)-1,a.savedRenderBatches=Math.round(a.savedRenderBatches/b),a.shaderCall=Math.round(a.shaderCall/b),a.spriteRenderUseCacheCount=Math.round(a.spriteRenderUseCacheCount/b),a.canvasNormal=Math.round(a.canvasNormal/b),a.canvasBitmap=Math.round(a.canvasBitmap/b),a.canvasReCache=Math.ceil(a.canvasReCache/b),a.frustumCulling=Math.round(a.frustumCulling/b),a.octreeNodeCulling=Math.round(a.octreeNodeCulling/b),a._fpsStr=a.FPS+(a.renderSlow?" slow":"")+" "+(0<a.FPS?Math.floor(1E3/a.FPS).toString():" "),a._spriteStr=a._useCanvas?a.spriteCount-1+(a.spriteRenderUseCacheCount?"/"+a.spriteRenderUseCacheCount:""):a.spriteCount-4+(a.spriteRenderUseCacheCount?"/"+a.spriteRenderUseCacheCount:""),a._canvasStr=a.canvasReCache+"/"+a.canvasNormal+"/"+a.canvasBitmap,a.cpuMemory=va.cpuMemory,a.gpuMemory=va.gpuMemory,a._useCanvas?a.renderInfoPre():a.renderInfo(),a.clear());a._count=0;a._timer=c}};a.renderInfoPre=function(){var c,b,d;if(a._canvas){var e=a._ctx;e.clearRect(a._first?0:a._vx,0,a._width,a._height);for(c=0;c<a._view.length;c++)b=a._view[c],a._first&&(e.fillStyle="white",e.fillText(b.title,b.x,b.y)),e.fillStyle=b.color,d=a[b.value],"M"==b.units&&(d=Math.floor(d/1048576*100)/100+" M"),e.fillText(d+"",b.x+a._vx,b.y)}};a.renderInfo=function(){for(var c="",b=0;b<a._view.length;b++){var d=a._view[b],e=a[d.value];"M"==d.units&&(e=Math.floor(e/1048576*100)/100+" M");"K"==d.units&&(e=Math.floor(e/1024*100)/100+" K");c+=e+"\n"}a._txt.text=c};a.FPS=0;a.loopCount=0;a.shaderCall=0;a.renderBatches=0;a.savedRenderBatches=0;a.trianglesFaces=0;a.spriteCount=0;a.spriteRenderUseCacheCount=0;a.frustumCulling=0;a.octreeNodeCulling=0;a.canvasNormal=0;a.canvasBitmap=0;a.canvasReCache=0;a.renderSlow=!1;a.gpuMemory=0;a.cpuMemory=0;a._fpsStr=null;a._canvasStr=null;a._spriteStr=null;a._fpsData=[];a._timer=0;a._count=0;a._view=[];a._fontSize=12;a._txt=null;a._leftText=null;a._sp=null;a._titleSp=null;a._bgSp=null;a._show=!1;a._useCanvas=!1;a._canvas=null;a._ctx=null;a._first=!1;a._vx=NaN;a._width=0;a._height=100;return a}(),lb=function(){function a(){this._lastOriY=this._lastOriX=0;this.paths=[];this._curPath=null}var c;p(a,"laya.webgl.canvas.Path");var b=a.prototype;b.beginPath=function(d){this.paths.length=1;this._curPath=this.paths[0]=new c;this._curPath.convex=d};b.closePath=function(){this._curPath.loop=!0};b.newPath=function(){this._curPath=new c;this.paths.push(this._curPath)};b.addPoint=function(d,b){this._curPath.path.push(d,b)};b.push=function(d,b){this._curPath?0<this._curPath.path.length&&(this._curPath=new c,this.paths.push(this._curPath)):(this._curPath=new c,this.paths.push(this._curPath));var a=this._curPath;a.path=d.slice();a.convex=b};b.reset=function(){this.paths.length=0};a.__init$=function(){c=function(){function d(){this.path=[];this.convex=this.loop=!1}p(d,"");return d}()};return a}(),ha=function(){function a(){this.mouseY=this.mouseX=0;this.disableMouseEvent=!1;this.mouseDownTime=0;this.mouseMoveAccuracy=2;this._captureSp=this._stage=null;this._hitCaputreSp=this._captureExlusiveMode=!1;this._target=null;this._lastMoveTimer=0;this._isLeftMouse=!1;this._touchIDs={};this._id=1;this._tTouchID=0;this._event=new Ta;this._captureChain=[];this._matrix=new I;this._point=new N;this._rect=new K;this._prePoint=new N;this._curTouchID=NaN}p(a,"laya.events.MouseManager");var c=a.prototype;c.__init__=function(b,d){var c=this;this._stage=b;var f=this;d.oncontextmenu=function(d){if(a.enabled)return!1};d.addEventListener("mousedown",function(d){a.enabled&&(r.onIE||d.preventDefault(),f.mouseDownTime=r.now(),c.runEvent(d))});d.addEventListener("mouseup",function(d){a.enabled&&(d.preventDefault(),f.mouseDownTime=-r.now(),c.runEvent(d))},!0);d.addEventListener("mousemove",function(d){if(a.enabled){d.preventDefault();var b=r.now();10>b-f._lastMoveTimer||(f._lastMoveTimer=b,c.runEvent(d))}},!0);d.addEventListener("mouseout",function(d){a.enabled&&c.runEvent(d)});d.addEventListener("mouseover",function(d){a.enabled&&c.runEvent(d)});d.addEventListener("touchstart",function(d){a.enabled&&(a._isFirstTouch||ia.isInputting||d.preventDefault(),f.mouseDownTime=r.now(),c.runEvent(d))});d.addEventListener("touchend",function(d){a.enabled?(a._isFirstTouch||ia.isInputting||d.preventDefault(),a._isFirstTouch=!1,f.mouseDownTime=-r.now(),c.runEvent(d)):c._curTouchID=NaN},!0);d.addEventListener("touchmove",function(d){a.enabled&&(d.preventDefault(),c.runEvent(d))},!0);d.addEventListener("touchcancel",function(d){a.enabled?(d.preventDefault(),c.runEvent(d)):c._curTouchID=NaN},!0);d.addEventListener("mousewheel",function(d){a.enabled&&c.runEvent(d)});d.addEventListener("DOMMouseScroll",function(d){a.enabled&&c.runEvent(d)})};c.initEvent=function(b,d){this._event._stoped=!1;this._event.nativeEvent=d||b;this._target=null;this._point.setTo(b.pageX||b.clientX,b.pageY||b.clientY);this._stage._canvasTransform&&(this._stage._canvasTransform.invertTransformPoint(this._point),this.mouseX=this._point.x,this.mouseY=this._point.y);this._event.touchId=b.identifier||0;this._tTouchID=this._event.touchId;var a;a=ua.I._event;a._stoped=!1;a.nativeEvent=this._event.nativeEvent;a.touchId=this._event.touchId};c.checkMouseWheel=function(b){this._event.delta=b.wheelDelta?.025*b.wheelDelta:-b.detail;b=ua.I.getLastOvers();for(var d=0,a=b.length;d<a;d++){var c=b[d];c.event("mousewheel",this._event.setTo("mousewheel",c,this._target))}};c.onMouseMove=function(b){ua.I.onMouseMove(b,this._tTouchID)};c.onMouseDown=function(b){if(ia.isInputting&&l.stage.focus&&l.stage.focus.focus&&!l.stage.focus.contains(this._target)){var d=l.stage.focus._tf||l.stage.focus,a=b._tf||b;a instanceof laya.display.Input&&a.multiline==d.multiline?d._focusOut():d.focus=!1}ua.I.onMouseDown(b,this._tTouchID,this._isLeftMouse)};c.onMouseUp=function(b){ua.I.onMouseUp(b,this._tTouchID,this._isLeftMouse)};c.check=function(b,d,a,c){this._point.setTo(d,a);b.fromParentPoint(this._point);d=this._point.x;a=this._point.y;var e=b._style.scrollRect;if(e&&(this._rect.setTo(e.x,e.y,e.width,e.height),!this._rect.contains(d,a)))return!1;if(!this.disableMouseEvent){if(b.hitTestPrior&&!b.mouseThrough&&!this.hitTest(b,d,a))return!1;for(e=b._children.length-1;-1<e;e--){var f=b._children[e];if(!f.destroyed&&1<f._mouseState&&f._visible&&this.check(f,d,a,c))return!0}for(e=b._extUIChild.length-1;0<=e;e--)if(f=b._extUIChild[e],!f.destroyed&&1<f._mouseState&&f._visible&&this.check(f,d,a,c))return!0}(d=!b.hitTestPrior||b.mouseThrough||this.disableMouseEvent?this.hitTest(b,d,a):!0)?(this._target=b,c.call(this,b),this._target==this._hitCaputreSp&&(this._hitCaputreSp=!0)):c===this.onMouseUp&&b===this._stage&&(this._target=this._stage,c.call(this,this._target));return d};c.hitTest=function(b,d,a){var c=!1;b.scrollRect&&(d-=b._style.scrollRect.x,a-=b._style.scrollRect.y);var e=b._style.hitArea;if(e&&e._hit)return e.contains(d,a);if(0<b.width&&0<b.height||b.mouseThrough||e)c=b.mouseThrough?b.getGraphicBounds().contains(d,a):(e?e:this._rect.setTo(0,0,b.width,b.height)).contains(d,a);return c};c._checkAllBaseUI=function(b,d,a){if(b=this.handleExclusiveCapture(this.mouseX,this.mouseY,a))return!0;b=this.check(this._stage,this.mouseX,this.mouseY,a);return this.handleCapture(this.mouseX,this.mouseY,a)||b};c.check3DUI=function(b,d,a){b=this._stage._3dUI;d=0;for(var c=!1;d<b.length;d++){var e=b[d];this._stage._curUIBase=e;!e.destroyed&&1<e._mouseState&&e._visible&&(c=c||this.check(e,this.mouseX,this.mouseY,a))}this._stage._curUIBase=this._stage;return c};c.handleExclusiveCapture=function(b,d,a){if(this._captureExlusiveMode&&this._captureSp&&0<this._captureChain.length){var c;this._point.setTo(b,d);for(b=0;b<this._captureChain.length;b++)c=this._captureChain[b],c.fromParentPoint(this._point);this._target=c;a.call(this,c);return!0}return!1};c.handleCapture=function(b,d,a){if(!this._hitCaputreSp&&this._captureSp&&0<this._captureChain.length){var c;this._point.setTo(b,d);for(b=0;b<this._captureChain.length;b++)c=this._captureChain[b],c.fromParentPoint(this._point);this._target=c;a.call(this,c);return!0}return!1};c.runEvent=function(b){var d,c,f;"mousemove"!==b.type&&(this._prePoint.x=this._prePoint.y=-1E6);switch(b.type){case "mousedown":this._touchIDs[0]=this._id++;a._isTouchRespond?a._isTouchRespond=!1:(this._isLeftMouse=0===b.button,this.initEvent(b),this._checkAllBaseUI(this.mouseX,this.mouseY,this.onMouseDown));break;case "mouseup":this._isLeftMouse=0===b.button;this.initEvent(b);this._checkAllBaseUI(this.mouseX,this.mouseY,this.onMouseUp);break;case "mousemove":Math.abs(this._prePoint.x-b.clientX)+Math.abs(this._prePoint.y-b.clientY)>=this.mouseMoveAccuracy&&(this._prePoint.x=b.clientX,this._prePoint.y=b.clientY,this.initEvent(b),this._checkAllBaseUI(this.mouseX,this.mouseY,this.onMouseMove));break;case "touchstart":this._isLeftMouse=a._isTouchRespond=!0;var g=b.changedTouches;d=0;for(c=g.length;d<c;d++)if(f=g[d],a.multiTouchEnabled||isNaN(this._curTouchID))this._curTouchID=f.identifier,0===this._id%200&&(this._touchIDs={}),this._touchIDs[f.identifier]=this._id++,this.initEvent(f,b),this._checkAllBaseUI(this.mouseX,this.mouseY,this.onMouseDown);break;case "touchend":case "touchcancel":this._isLeftMouse=a._isTouchRespond=!0;g=b.changedTouches;d=0;for(c=g.length;d<c;d++)if(f=g[d],a.multiTouchEnabled||f.identifier==this._curTouchID)if(this._curTouchID=NaN,this.initEvent(f,b),!this._checkAllBaseUI(this.mouseX,this.mouseY,this.onMouseUp))this.onMouseUp(null);break;case "touchmove":g=b.changedTouches;d=0;for(c=g.length;d<c;d++)if(f=g[d],a.multiTouchEnabled||f.identifier==this._curTouchID)this.initEvent(f,b),this._checkAllBaseUI(this.mouseX,this.mouseY,this.onMouseMove);break;case "wheel":case "mousewheel":case "DOMMouseScroll":this.checkMouseWheel(b);break;case "mouseout":ua.I.stageMouseOut();break;case "mouseover":this._stage.event("mouseover",this._event.setTo("mouseover",this._stage,this._stage))}};c.setCapture=function(b,d){void 0===d&&(d=!1);this._captureSp=b;this._captureExlusiveMode=d;this._captureChain.length=0;this._captureChain.push(b);for(var a=b;a!=l.stage&&a!=l.stage._curUIBase;){a=a.parent;if(!a)break;this._captureChain.splice(0,0,a)}};c.releaseCapture=function(){console.log("release capture");this._captureSp=null};a.enabled=!0;a.multiTouchEnabled=!0;a._isTouchRespond=!1;a._isFirstTouch=!0;t(a,["instance",function(){return this.instance=new a}]);return a}(),za=function(){function a(){this.useDic={};this.shapeDic={};this.shapeLineDic={};this._id=0;this._checkKey=!1;this._freeIdArray=[];Sa.regCacheByFunction(L.bind(this.startDispose,this),L.bind(this.getCacheList,this))}p(a,"laya.utils.VectorGraphManager");var c=a.prototype;c.getId=function(){return this._id++};c.addShape=function(b,d){this.shapeDic[b]=d;this.useDic[b]||(this.useDic[b]=!0)};c.addLine=function(b,d){this.shapeLineDic[b]=d;this.shapeLineDic[b]||(this.shapeLineDic[b]=!0)};c.getShape=function(b){this._checkKey&&null!=this.useDic[b]&&(this.useDic[b]=!0)};c.deleteShape=function(b){this.shapeDic[b]&&(this.shapeDic[b]=null,delete this.shapeDic[b]);this.shapeLineDic[b]&&(this.shapeLineDic[b]=null,delete this.shapeLineDic[b]);null!=this.useDic[b]&&delete this.useDic[b]};c.getCacheList=function(){var b,d=[];for(b in this.shapeDic)d.push(this.shapeDic[b]);for(b in this.shapeLineDic)d.push(this.shapeLineDic[b]);return d};c.startDispose=function(b){for(var d in this.useDic)this.useDic[d]=!1;this._checkKey=!0};c.endDispose=function(){if(this._checkKey){for(var b in this.useDic)this.useDic[b]||this.deleteShape(b);this._checkKey=!1}};a.getInstance=function(){return a.instance=a.instance||new a};a.instance=null;return a}(),Mb=function(){function a(){}p(a,"laya.maths.MathUtil");a.subtractVector3=function(a,b,d){d[0]=a[0]-b[0];d[1]=a[1]-b[1];d[2]=a[2]-b[2]};a.lerp=function(a,b,d){return a*(1-d)+b*d};a.scaleVector3=function(a,b,d){d[0]=a[0]*b;d[1]=a[1]*b;d[2]=a[2]*b};a.lerpVector3=function(a,b,d,e){var c=a[0],g=a[1];a=a[2];e[0]=c+d*(b[0]-c);e[1]=g+d*(b[1]-g);e[2]=a+d*(b[2]-a)};a.lerpVector4=function(a,b,d,e){var c=a[0],g=a[1],h=a[2];a=a[3];e[0]=c+d*(b[0]-c);e[1]=g+d*(b[1]-g);e[2]=h+d*(b[2]-h);e[3]=a+d*(b[3]-a)};a.slerpQuaternionArray=function(a,b,d,e,f,g,h){var c=a[b+0],n=a[b+1],q=a[b+2];a=a[b+3];b=d[e+0];var u=d[e+1],l=d[e+2];d=d[e+3];var m,p;e=c*b+n*u+q*l+a*d;0>e&&(e=-e,b=-b,u=-u,l=-l,d=-d);1E-6<1-e?(m=Math.acos(e),p=Math.sin(m),e=Math.sin((1-f)*m)/p,f=Math.sin(f*m)/p):e=1-f;g[h+0]=e*c+f*b;g[h+1]=e*n+f*u;g[h+2]=e*q+f*l;g[h+3]=e*a+f*d;return g};a.getRotation=function(a,b,d,e){return Math.atan2(e-b,d-a)/Math.PI*180};a.sortBigFirst=function(a,b){return a==b?0:b>a?1:-1};a.sortSmallFirst=function(a,b){return a==b?0:b>a?-1:1};a.sortNumBigFirst=function(a,b){return parseFloat(b)-parseFloat(a)};a.sortNumSmallFirst=function(a,b){return parseFloat(a)-parseFloat(b)};a.sortByKey=function(c,b,d){void 0===b&&(b=!1);void 0===d&&(d=!0);var e;e=b?d?a.sortNumBigFirst:a.sortBigFirst:d?a.sortNumSmallFirst:a.sortSmallFirst;return function(d,b){return e(d[c],b[c])}};return a}(),ta=function(){function a(b,d){if(D.map[b])this._fun=D.map[b],this._next=a.NORENDER;else{this._next=d||a.NORENDER;switch(b){case 0:this._fun=this._no;return;case 1:this._fun=this._alpha;return;case 2:this._fun=this._transform;return;case 4:this._fun=this._blend;return;case 8:this._fun=this._canvas;return;case 32:this._fun=this._mask;return;case 64:this._fun=this._clip;return;case 128:this._fun=this._style;return;case 512:this._fun=this._graphics;return;case 8192:this._fun=this._children;return;case 2048:this._fun=this._custom;return;case 256:this._fun=this._texture;return;case 16:this._fun=Ja._filter;return;case 69905:this._fun=a._initRenderFun;return}this.onCreate(b)}}p(a,"laya.renders.RenderSprite");var c=a.prototype;c.onCreate=function(b){};c._style=function(b,d,a,c){var e=b._style;null!=e.render&&e.render(b,d,a,c);e=this._next;e._fun.call(e,b,d,a,c)};c._no=function(b,d,a,c){};c._custom=function(b,d,a,c){b.customRender(d,a,c);this._next._fun.call(this._next,b,d,a-b.pivotX,c-b.pivotY)};c._clip=function(b,d,c,f){var e=this._next;if(e!=a.NORENDER){var h=b._style.scrollRect;d.save();d.clipRect(c,f,h.width,h.height);e._fun.call(e,b,d,c-h.x,f-h.y);d.restore()}};c._texture=function(b,d,c,f){var e=b.texture;e._getSource()&&d.drawTexture(e,c-b.pivotX+e.offsetX,f-b.pivotY+e.offsetY,b._width||e.width,b._height||e.height);e=this._next;e!=a.NORENDER&&e._fun.call(e,b,d,c,f)};c._graphics=function(b,d,c,f){var e=b._style,h=b._graphics;h&&h._render(b,d,c-e.pivotX,f-e.pivotY);e=this._next;e!=a.NORENDER&&e._fun.call(e,b,d,c,f)};c._image=function(b,d,a,c){var e=b._style;d.drawTexture2(a,c,e.pivotX,e.pivotY,b.transform,b._graphics._one)};c._image2=function(b,d,a,c){var e=b._style;d.drawTexture2(a,c,e.pivotX,e.pivotY,b.transform,b._graphics._one)};c._alpha=function(b,d,a,c){var e;if(.01<(e=b._style.alpha)||b._needRepaint()){var f=d.globalAlpha;d.globalAlpha*=e;e=this._next;e._fun.call(e,b,d,a,c);d.globalAlpha=f}};c._transform=function(b,d,c,f){var e=b.transform,h=this._next;e&&h!=a.NORENDER?(d.save(),d.transform(e.a,e.b,e.c,e.d,e.tx+c,e.ty+f),h._fun.call(h,b,d,0,0),d.restore()):h!=a.NORENDER&&h._fun.call(h,b,d,c,f)};c._children=function(b,d,a,c){var e=b._style,f=b._children,k=f.length,n;a-=b.pivotX;c-=b.pivotY;b=b._getBit(256)&&d.drawCallOptimize(!0);if(e.viewport)for(var q=e.viewport,e=q.x,u=q.y,l=q.right,q=q.bottom,m=NaN,p=NaN,r=0;r<k;++r)(n=f[r])._visible&&(m=n._x)<l&&m+n.width>e&&(p=n._y)<q&&p+n.height>u&&n.render(d,a,c);else for(var r=0;r<k;++r)(n=f[r])._visible&&n.render(d,a,c);b&&d.drawCallOptimize(!1)};c._canvas=function(b,d,a,c){var e=b._cacheStyle,f=this._next;if(e.enableCanvasRender){"bitmap"===e.cacheAs?J.canvasBitmap++:J.canvasNormal++;var k=!1,n=!1;if(e.canvas){var k=e.canvas,q=k.touches;if(q)for(var u=0;u<q.length;u++)if(q[u].deleted){n=!0;break}k=k.isCacheValid&&!k.isCacheValid()}if(b._needRepaint()||!e.canvas||n||k||l.stage.isGlobalRepaint())if("normal"===e.cacheAs){if(d._targets){f._fun.call(f,b,d,a,c);return}this._canvas_webgl_normal_repaint(b,d)}else this._canvas_repaint(b,d,a,c);b=e.cacheRect;d.drawCanvas(e.canvas,a+b.x,c+b.y,b.width,b.height)}else f._fun.call(f,b,d,a,c)};c._canvas_repaint=function(b,d,a,c){var e=b._cacheStyle,f=this._next,k=e.canvas,n,q,u=e.cacheAs,l,m,p,r;n=e._calculateCacheRect(b,u,a,c);p=n.x;r=n.y;q=e.cacheRect;l=q.width*p;m=q.height*r;n=q.x;q=q.y;"bitmap"===u&&(2048<l||2048<m)?(console.warn("cache bitmap size larger than 2048,cache ignored"),e.releaseContext(),f._fun.call(f,b,d,a,c)):(k||(e.createContext(),k=e.canvas),d=k.context,d.sprite=b,k.width==l&&k.height==m||k.size(l,m),"bitmap"===u?d.asBitmap=!0:"normal"===u&&(d.asBitmap=!1),d.clear(),1!=p||1!=r?(d.save(),d.scale(p,r),f._fun.call(f,b,d,-n,-q),d.restore()):f._fun.call(f,b,d,-n,-q),b._applyFilters(),e.staticCache&&(e.reCache=!1),J.canvasReCache++)};c._canvas_webgl_normal_repaint=function(b,d){var a=b._cacheStyle,c=this._next,g=a.canvas;a._calculateCacheRect(b,a.cacheAs,0,0);g||(g=a.canvas=new l.WebGLCacheAsNormalCanvas(d,b));a=g.context;g.startRec();c._fun.call(c,b,a,b.pivotX,b.pivotY);b._applyFilters();J.canvasReCache++;g.endRec()};c._blend=function(b,d,a,c){var e=b._style,f=this._next;e.blendMode?(d.save(),d.globalCompositeOperation=e.blendMode,f._fun.call(f,b,d,a,c),d.restore()):f._fun.call(f,b,d,a,c)};c._mask=function(b,d,c,f){var e=this._next,h=b.mask;if(h){d.save();var k=new K;k.copyFrom(h.getBounds());k.width=Math.round(k.width);k.height=Math.round(k.height);k.x=Math.round(k.x);k.y=Math.round(k.y);if(0<k.width&&0<k.height){var n=k.width,q=k.height,u=wa.getRT(n,q);d.breakNextMerge();d.pushRT();d.addRenderObject(ba.create([d,u,n,q],a.tmpTarget,this));h.render(d,-k.x,-k.y);d.breakNextMerge();d.popRT();d.save();d.clipRect(c+k.x-b.getStyle().pivotX,f+k.y-b.getStyle().pivotY,n,q);e._fun.call(e,b,d,c,f);d.restore();e=d.globalCompositeOperation;d.addRenderObject(ba.create(["mask"],a.setBlendMode,this));var h=U.create(1,0),l=X.INV_UV;d.drawTarget(u,c+k.x-b.getStyle().pivotX,f+k.y-b.getStyle().pivotY,n,q,I.TEMP.identity(),h,l,6);d.addRenderObject(ba.create([u],a.recycleTarget,this));d.addRenderObject(ba.create([e],a.setBlendMode,this))}d.restore()}else e._fun.call(e,b,d,c,f)};a.__init__=function(){D.__init__();var b,d,c;c=new a(69905,null);d=a.renders.length=16384;for(b=0;b<d;b++)a.renders[b]=c;a.renders[0]=new a(0,null)};a._initRenderFun=function(b,d,c,f){var e=b._renderType;(a.renders[e]=a._getTypeRender(e))._fun(b,d,c,f)};a._getTypeRender=function(b){if(D.map[b])return new a(b,null);for(var d=null,c=8192;0<c;)c&b&&(d=new a(c,d)),c>>=1;return d};a.tmpTarget=function(b,d,a,c){d.start();d.clear(0,0,0,0)};a.recycleTarget=function(b){wa.releaseRT(b)};a.setBlendMode=function(b){T.targetFns[T.TOINT[b]](E.mainContext)};a.INIT=69905;a.renders=[];a.NORENDER=new a(0,null);t(a,["tempUV",function(){return this.tempUV=Array(8)}]);return a}();(function(){function a(){}p(a,"laya.events.Keyboard");a.NUMBER_0=48;a.NUMBER_1=49;a.NUMBER_2=50;a.NUMBER_3=51;a.NUMBER_4=52;a.NUMBER_5=53;a.NUMBER_6=54;a.NUMBER_7=55;a.NUMBER_8=56;a.NUMBER_9=57;a.A=65;a.B=66;a.C=67;a.D=68;a.E=69;a.F=70;a.G=71;a.H=72;a.I=73;a.J=74;a.K=75;a.L=76;a.M=77;a.N=78;a.O=79;a.P=80;a.Q=81;a.R=82;a.S=83;a.T=84;a.U=85;a.V=86;a.W=87;a.X=88;a.Y=89;a.Z=90;a.F1=112;a.F2=113;a.F3=114;a.F4=115;a.F5=116;a.F6=117;a.F7=118;a.F8=119;a.F9=120;a.F10=121;a.F11=122;a.F12=123;a.F13=124;a.F14=125;a.F15=126;a.NUMPAD=21;a.NUMPAD_0=96;a.NUMPAD_1=97;a.NUMPAD_2=98;a.NUMPAD_3=99;a.NUMPAD_4=100;a.NUMPAD_5=101;a.NUMPAD_6=102;a.NUMPAD_7=103;a.NUMPAD_8=104;a.NUMPAD_9=105;a.NUMPAD_ADD=107;a.NUMPAD_DECIMAL=110;a.NUMPAD_DIVIDE=111;a.NUMPAD_ENTER=108;a.NUMPAD_MULTIPLY=106;a.NUMPAD_SUBTRACT=109;a.SEMICOLON=186;a.EQUAL=187;a.COMMA=188;a.MINUS=189;a.PERIOD=190;a.SLASH=191;a.BACKQUOTE=192;a.LEFTBRACKET=219;a.BACKSLASH=220;a.RIGHTBRACKET=221;a.QUOTE=222;a.ALTERNATE=18;a.BACKSPACE=8;a.CAPS_LOCK=20;a.COMMAND=15;a.CONTROL=17;a.DELETE=46;a.ENTER=13;a.ESCAPE=27;a.PAGE_UP=33;a.PAGE_DOWN=34;a.END=35;a.HOME=36;a.LEFT=37;a.UP=38;a.RIGHT=39;a.DOWN=40;a.SHIFT=16;a.SPACE=32;a.TAB=9;a.INSERT=45;return a})();var Nb=function(){function a(){}p(a,"laya.display.cmd.RestoreCmd");var c=a.prototype;c.recover=function(){w.recover("RestoreCmd",this)};c.run=function(b,d,a){b.restore()};m(0,c,"cmdID",function(){return"Restore"});a.create=function(){return w.getItemByClass("RestoreCmd",a)};a.ID="Restore";return a}(),La=function(){function a(b,d,a){this._value=0;this._name2int=b;this._int2name=d;this._int2nameMap=a}p(a,"laya.webgl.shader.ShaderDefinesBase");var c=a.prototype;c.add=function(b){"string"==typeof b&&(b=this._name2int[b]);return this._value|=b};c.addInt=function(b){return this._value|=b};c.remove=function(b){"string"==typeof b&&(b=this._name2int[b]);return this._value&=~b};c.isDefine=function(b){return(this._value&b)===b};c.getValue=function(){return this._value};c.setValue=function(b){this._value=b};c.toNameDic=function(){var b=this._int2nameMap[this._value];return b?b:a._toText(this._value,this._int2name,this._int2nameMap)};a._reg=function(b,d,a,c){a[b]=d;c[d]=b};a._toText=function(b,d,a){var c=a[b];if(c)return c;for(var c={},e,h=0;32>h;h++){e=1<<h;if(e>b)break;b&e&&(e=d[e])&&(c[e]="")}return a[b]=c};a._toInt=function(b,d){for(var a=b.split("."),c=0,g=0,h=a.length;g<h;g++){var k=d[a[g]];if(!k)throw Error("Defines to int err:"+b+"/"+a[g]);c|=k}return c};return a}(),Ob=function(){function a(){this._texture=null;this._fontCharDic={};this._fontWidthMap={};this._path=this._complete=null;this._maxWidth=0;this._spaceWidth=10;this._padding=null;this.fontSize=12;this.autoScaleSize=!1;this.letterSpacing=0}p(a,"laya.display.BitmapFont");var c=a.prototype;c.loadFont=function(b,d){this._path=b;this._complete=d;b&&-1!==b.indexOf(".fnt")?l.loader.load([{url:b,type:"xml"},{url:b.replace(".fnt",".png"),type:"image"}],S.create(this,this._onLoaded)):console.error('Bitmap font configuration information must be a ".fnt" file')};c._onLoaded=function(){this.parseFont(H.getRes(this._path),H.getRes(this._path.replace(".fnt",".png")));this._complete&&this._complete.run()};c.parseFont=function(b,d){if(null!=b&&null!=d){this._texture=d;var a=b.getElementsByTagName("info");if(!a[0].getAttributeNode)return this.parseFont2(b,d);this.fontSize=parseInt(a[0].getAttributeNode("size").nodeValue);a=a[0].getAttributeNode("padding").nodeValue.split(",");this._padding=[parseInt(a[0]),parseInt(a[1]),parseInt(a[2]),parseInt(a[3])];var a=b.getElementsByTagName("char"),c;for(c=0;c<a.length;c++){var g=a[c],h=parseInt(g.getAttributeNode("id").nodeValue),k=parseInt(g.getAttributeNode("xoffset").nodeValue)/1,n=parseInt(g.getAttributeNode("yoffset").nodeValue)/1,q=parseInt(g.getAttributeNode("xadvance").nodeValue)/1,u=new K;u.x=parseInt(g.getAttributeNode("x").nodeValue);u.y=parseInt(g.getAttributeNode("y").nodeValue);u.width=parseInt(g.getAttributeNode("width").nodeValue);u.height=parseInt(g.getAttributeNode("height").nodeValue);g=X.create(d,u.x,u.y,u.width,u.height,k,n);this._maxWidth=Math.max(this._maxWidth,q+this.letterSpacing);this._fontCharDic[h]=g;this._fontWidthMap[h]=q}}};c.parseFont2=function(b,d){if(null!=b&&null!=d){this._texture=d;var a=b.getElementsByTagName("info");this.fontSize=parseInt(a[0].attributes.size.nodeValue);a=a[0].attributes.padding.nodeValue.split(",");this._padding=[parseInt(a[0]),parseInt(a[1]),parseInt(a[2]),parseInt(a[3])];var a=b.getElementsByTagName("char"),c;for(c=0;c<a.length;c++){var g=a[c].attributes,h=parseInt(g.id.nodeValue),k=parseInt(g.xoffset.nodeValue)/1,n=parseInt(g.yoffset.nodeValue)/1,q=parseInt(g.xadvance.nodeValue)/1,u=new K;u.x=parseInt(g.x.nodeValue);u.y=parseInt(g.y.nodeValue);u.width=parseInt(g.width.nodeValue);u.height=parseInt(g.height.nodeValue);g=X.create(d,u.x,u.y,u.width,u.height,k,n);this._maxWidth=Math.max(this._maxWidth,q+this.letterSpacing);this._fontCharDic[h]=g;this._fontWidthMap[h]=q}}};c.getCharTexture=function(b){return this._fontCharDic[b.charCodeAt(0)]};c.destroy=function(){if(this._texture){for(var b in this._fontCharDic){var d=this._fontCharDic[b];d&&d.destroy()}this._texture.destroy();this._padding=this._complete=this._texture=this._fontWidthMap=this._fontCharDic=null}};c.setSpaceWidth=function(b){this._spaceWidth=b};c.getCharWidth=function(b){var d=b.charCodeAt(0);return this._fontWidthMap[d]?this._fontWidthMap[d]+this.letterSpacing:" "===b?this._spaceWidth+this.letterSpacing:0};c.getTextWidth=function(b){for(var d=0,a=0,c=b.length;a<c;a++)d+=this.getCharWidth(b.charAt(a));return d};c.getMaxWidth=function(){return this._maxWidth};c.getMaxHeight=function(){return this.fontSize};c._drawText=function(b,d,a,c,g,h){var e=this.getTextWidth(b),f=0;"center"===g&&(f=(h-e)/2);"right"===g&&(f=h-e);for(var e=h=0,q=b.length;e<q;e++)if(g=this.getCharTexture(b.charAt(e)))d.graphics.drawImage(g,a+h+f,c),h+=this.getCharWidth(b.charAt(e))};return a}(),Pb=function(){function a(){}p(a,"laya.display.cmd.ClipRectCmd");var c=a.prototype;c.recover=function(){w.recover("ClipRectCmd",this)};c.run=function(b,d,a){b.clipRect(this.x+d,this.y+a,this.width,this.height)};m(0,c,"cmdID",function(){return"ClipRect"});a.create=function(b,d,c,f){var e=w.getItemByClass("ClipRectCmd",a);e.x=b;e.y=d;e.width=c;e.height=f;return e};a.ID="ClipRect";return a}(),Va=function(){function a(){this.ALPHA=1;this.shaderType=0;this.defines=new Ma;this.strokeStyle=this.fillStyle=Aa.DEFAULT}p(a,"laya.webgl.shader.d2.Shader2D");a.prototype.destroy=function(){this.filters=this.defines=null};a.__init__=function(){ka.preCompile2D(0,1,"/*\n\ttexture\u548cfillrect\u4f7f\u7528\u7684\u3002\n*/\nattribute vec4 posuv;\nattribute vec4 attribColor;\nattribute vec4 attribFlags;\n//attribute vec4 clipDir;\n//attribute vec2 clipRect;\nuniform vec4 clipMatDir;\nuniform vec2 clipMatPos;\t\t// \u8fd9\u4e2a\u662f\u5168\u5c40\u7684\uff0c\u4e0d\u7528\u518d\u5e94\u7528\u77e9\u9635\u4e86\u3002\nvarying vec2 cliped;\nuniform vec2 size;\nuniform vec2 clipOff;\t\t\t// \u4f7f\u7528\u8981\u628aclip\u504f\u79fb\u3002cacheas normal\u7528. \u53ea\u7528\u4e86[0]\n#ifdef WORLDMAT\n\tuniform mat4 mmat;\n#endif\n#ifdef MVP3D\n\tuniform mat4 u_MvpMatrix;\n#endif\nvarying vec4 v_texcoordAlpha;\nvarying vec4 v_color;\nvarying float v_useTex;\n\nvoid main() {\n\n\tvec4 pos \x3d vec4(posuv.xy,0.,1.);\n#ifdef WORLDMAT\n\tpos\x3dmmat*pos;\n#endif\n\tvec4 pos1  \x3dvec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,0.,1.0);\n#ifdef MVP3D\n\tgl_Position\x3du_MvpMatrix*pos1;\n#else\n\tgl_Position\x3dpos1;\n#endif\n\tv_texcoordAlpha.xy \x3d posuv.zw;\n\t//v_texcoordAlpha.z \x3d attribColor.a/255.0;\n\tv_color \x3d attribColor/255.0;\n\tv_color.xyz*\x3dv_color.w;//\u53cd\u6b63\u540e\u9762\u4e5f\u8981\u9884\u4e58\n\t\n\tv_useTex \x3d attribFlags.r/255.0;\n\tfloat clipw \x3d length(clipMatDir.xy);\n\tfloat cliph \x3d length(clipMatDir.zw);\n\t\n\tvec2 clpos \x3d clipMatPos.xy;\n\t#ifdef WORLDMAT\n\t\t// \u5982\u679c\u6709mmat\uff0c\u9700\u8981\u4fee\u6539clipMatPos,\u56e0\u4e3a \u8fd9\u662fcacheas normal \uff08\u5982\u679c\u4e0d\u662f\u5c31\u9519\u4e86\uff09\uff0c clipMatPos\u88ab\u53bb\u6389\u4e86\u504f\u79fb\n\t\tif(clipOff[0]\x3e0.0){\n\t\t\tclpos.x+\x3dmmat[3].x;\t//tx\t\u6700\u7b80\u5355\u5904\u7406\n\t\t\tclpos.y+\x3dmmat[3].y;\t//ty\n\t\t}\n\t#endif\n\tvec2 clippos \x3d pos.xy - clpos;\t//pos\u5df2\u7ecf\u5e94\u7528\u77e9\u9635\u4e86\uff0c\u4e3a\u4e86\u51cf\u7684\u6709\u610f\u4e49\uff0cclip\u7684\u4f4d\u7f6e\u4e5f\u8981\u7f29\u653e\n\tif(clipw\x3e20000. \x26\x26 cliph\x3e20000.)\n\t\tcliped \x3d vec2(0.5,0.5);\n\telse {\n\t\t//\u8f6c\u62100\u52301\u4e4b\u95f4\u3002/clipw/clipw \u8868\u793aclippos\u4e0enormalize\u4e4b\u540e\u7684clip\u671d\u5411\u70b9\u79ef\u4e4b\u540e\uff0c\u518d\u9664\u4ee5clipw\n\t\tcliped\x3dvec2( dot(clippos,clipMatDir.xy)/clipw/clipw, dot(clippos,clipMatDir.zw)/cliph/cliph);\n\t}\n\n}","/*\n\ttexture\u548cfillrect\u4f7f\u7528\u7684\u3002\n*/\n#ifdef FSHIGHPRECISION\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n\nvarying vec4 v_texcoordAlpha;\nvarying vec4 v_color;\nvarying float v_useTex;\nuniform sampler2D texture;\nvarying vec2 cliped;\n\n#ifdef BLUR_FILTER\nuniform vec4 strength_sig2_2sig2_gauss1;\nuniform vec2 blurInfo;\n\n#define PI 3.141593\n\nfloat getGaussian(float x, float y){\n    return strength_sig2_2sig2_gauss1.w*exp(-(x*x+y*y)/strength_sig2_2sig2_gauss1.z);\n}\n\nvec4 blur(){\n    const float blurw \x3d 9.0;\n    vec4 vec4Color \x3d vec4(0.0,0.0,0.0,0.0);\n    vec2 halfsz\x3dvec2(blurw,blurw)/2.0/blurInfo;    \n    vec2 startpos\x3dv_texcoordAlpha.xy-halfsz;\n    vec2 ctexcoord \x3d startpos;\n    vec2 step \x3d 1.0/blurInfo;  //\u6bcf\u4e2a\u50cf\u7d20      \n    \n    for(float y \x3d 0.0;y\x3c\x3dblurw; ++y){\n        ctexcoord.x\x3dstartpos.x;\n        for(float x \x3d 0.0;x\x3c\x3dblurw; ++x){\n            //TODO \u7eb9\u7406\u5750\u6807\u7684\u56fa\u5b9a\u504f\u79fb\u5e94\u8be5\u5728vs\u4e2d\u5904\u7406\n            vec4Color +\x3d texture2D(texture, ctexcoord)*getGaussian(x-blurw/2.0,y-blurw/2.0);\n            ctexcoord.x+\x3dstep.x;\n        }\n        ctexcoord.y+\x3dstep.y;\n    }\n    return vec4Color;\n}\n#endif\n\n#ifdef COLOR_FILTER\nuniform vec4 colorAlpha;\nuniform mat4 colorMat;\n#endif\n\n#ifdef GLOW_FILTER\nuniform vec4 u_color;\nuniform vec4 u_blurInfo1;\nuniform vec4 u_blurInfo2;\n#endif\n\n#ifdef COLOR_ADD\nuniform vec4 colorAdd;\n#endif\n\n#ifdef FILLTEXTURE\t\nuniform vec4 u_TexRange;//startu,startv,urange, vrange\n#endif\nvoid main() {\n\tif(cliped.x\x3c0.) discard;\n\tif(cliped.x\x3e1.) discard;\n\tif(cliped.y\x3c0.) discard;\n\tif(cliped.y\x3e1.) discard;\n\t\n#ifdef FILLTEXTURE\t\n   vec4 color\x3d texture2D(texture, fract(v_texcoordAlpha.xy)*u_TexRange.zw + u_TexRange.xy);\n#else\n   vec4 color\x3d texture2D(texture, v_texcoordAlpha.xy);\n#endif\n\n   if(v_useTex\x3c\x3d0.)color \x3d vec4(1.,1.,1.,1.);\n   color.a*\x3dv_color.w;\n   //color.rgb*\x3dv_color.w;\n   color.rgb*\x3dv_color.rgb;\n   gl_FragColor\x3dcolor;\n   \n   #ifdef COLOR_ADD\n\tgl_FragColor \x3d vec4(colorAdd.rgb,colorAdd.a*gl_FragColor.a);\n\tgl_FragColor.xyz *\x3d colorAdd.a;\n   #endif\n   \n   #ifdef BLUR_FILTER\n\tgl_FragColor \x3d   blur();\n\tgl_FragColor.w*\x3dv_color.w;   \n   #endif\n   \n   #ifdef COLOR_FILTER\n\tmat4 alphaMat \x3dcolorMat;\n\n\talphaMat[0][3] *\x3d gl_FragColor.a;\n\talphaMat[1][3] *\x3d gl_FragColor.a;\n\talphaMat[2][3] *\x3d gl_FragColor.a;\n\n\tgl_FragColor \x3d gl_FragColor * alphaMat;\n\tgl_FragColor +\x3d colorAlpha/255.0*gl_FragColor.a;\n   #endif\n   \n   #ifdef GLOW_FILTER\n\tconst float c_IterationTime \x3d 10.0;\n\tfloat floatIterationTotalTime \x3d c_IterationTime * c_IterationTime;\n\tvec4 vec4Color \x3d vec4(0.0,0.0,0.0,0.0);\n\tvec2 vec2FilterDir \x3d vec2(-(u_blurInfo1.z)/u_blurInfo2.x,-(u_blurInfo1.w)/u_blurInfo2.y);\n\tvec2 vec2FilterOff \x3d vec2(u_blurInfo1.x/u_blurInfo2.x/c_IterationTime * 2.0,u_blurInfo1.y/u_blurInfo2.y/c_IterationTime * 2.0);\n\tfloat maxNum \x3d u_blurInfo1.x * u_blurInfo1.y;\n\tvec2 vec2Off \x3d vec2(0.0,0.0);\n\tfloat floatOff \x3d c_IterationTime/2.0;\n\tfor(float i \x3d 0.0;i\x3c\x3dc_IterationTime; ++i){\n\t\tfor(float j \x3d 0.0;j\x3c\x3dc_IterationTime; ++j){\n\t\t\tvec2Off \x3d vec2(vec2FilterOff.x * (i - floatOff),vec2FilterOff.y * (j - floatOff));\n\t\t\tvec4Color +\x3d texture2D(texture, v_texcoordAlpha.xy + vec2FilterDir + vec2Off)/floatIterationTotalTime;\n\t\t}\n\t}\n\tgl_FragColor \x3d vec4(u_color.rgb,vec4Color.a * u_blurInfo2.z);\n\tgl_FragColor.rgb *\x3d gl_FragColor.a;   \n   #endif\n   \n}",null);ka.preCompile2D(0,4,"attribute vec4 position;\nattribute vec4 attribColor;\n//attribute vec4 clipDir;\n//attribute vec2 clipRect;\nuniform vec4 clipMatDir;\nuniform vec2 clipMatPos;\n#ifdef WORLDMAT\n\tuniform mat4 mmat;\n#endif\nuniform mat4 u_mmat2;\n//uniform vec2 u_pos;\nuniform vec2 size;\nvarying vec4 color;\n//vec4 dirxy\x3dvec4(0.9,0.1, -0.1,0.9);\n//vec4 clip\x3dvec4(100.,30.,300.,600.);\nvarying vec2 cliped;\nvoid main(){\n\t\n#ifdef WORLDMAT\n\tvec4 pos\x3dmmat*vec4(position.xy,0.,1.);\n\tgl_Position \x3dvec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n#else\n\tgl_Position \x3dvec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\n#endif\t\n\tfloat clipw \x3d length(clipMatDir.xy);\n\tfloat cliph \x3d length(clipMatDir.zw);\n\tvec2 clippos \x3d position.xy - clipMatPos.xy;\t//pos\u5df2\u7ecf\u5e94\u7528\u77e9\u9635\u4e86\uff0c\u4e3a\u4e86\u51cf\u7684\u6709\u610f\u4e49\uff0cclip\u7684\u4f4d\u7f6e\u4e5f\u8981\u7f29\u653e\n\tif(clipw\x3e20000. \x26\x26 cliph\x3e20000.)\n\t\tcliped \x3d vec2(0.5,0.5);\n\telse {\n\t\t//clipdir\u662f\u5e26\u7f29\u653e\u7684\u65b9\u5411\uff0c\u7531\u4e8e\u4e0a\u9762clippos\u662f\u5728\u7f29\u653e\u540e\u7684\u7a7a\u95f4\u8ba1\u7b97\u7684\uff0c\u6240\u4ee5\u9700\u8981\u628a\u65b9\u5411\u5148normalize\u4e00\u4e0b\n\t\tcliped\x3dvec2( dot(clippos,clipMatDir.xy)/clipw/clipw, dot(clippos,clipMatDir.zw)/cliph/cliph);\n\t}\n  //pos2d.x \x3d dot(clippos,dirx);\n  color\x3dattribColor/255.;\n}","precision mediump float;\n//precision mediump float;\nvarying vec4 color;\n//uniform float alpha;\nvarying vec2 cliped;\nvoid main(){\n\t//vec4 a\x3dvec4(color.r, color.g, color.b, 1);\n\t//a.a*\x3dalpha;\n    gl_FragColor\x3d color;// vec4(color.r, color.g, color.b, alpha);\n\tgl_FragColor.rgb*\x3dcolor.a;\n\tif(cliped.x\x3c0.) discard;\n\tif(cliped.x\x3e1.) discard;\n\tif(cliped.y\x3c0.) discard;\n\tif(cliped.y\x3e1.) discard;\n}",null);ka.preCompile2D(0,512,"attribute vec2 position;\nattribute vec2 texcoord;\nattribute vec4 color;\nuniform vec2 size;\nuniform float offsetX;\nuniform float offsetY;\nuniform mat4 mmat;\nuniform mat4 u_mmat2;\nvarying vec2 v_texcoord;\nvarying vec4 v_color;\nvoid main() {\n  vec4 pos\x3dmmat*u_mmat2*vec4(offsetX+position.x,offsetY+position.y,0,1 );\n  gl_Position \x3d vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  v_color \x3d color;\n  v_color.rgb *\x3d v_color.a;\n  v_texcoord \x3d texcoord;  \n}","precision mediump float;\nvarying vec2 v_texcoord;\nvarying vec4 v_color;\nuniform sampler2D texture;\nuniform float alpha;\nvoid main() {\n\tvec4 t_color \x3d texture2D(texture, v_texcoord);\n\tgl_FragColor \x3d t_color.rgba * v_color;\n\tgl_FragColor *\x3d alpha;\n}",null)};return a}(),Qb=function(){function a(){}p(a,"laya.display.cmd.DrawPolyCmd");var c=a.prototype;c.recover=function(){this.lineColor=this.fillColor=this.points=null;w.recover("DrawPolyCmd",this)};c.run=function(b,d,a){b._drawPoly(this.x+d,this.y+a,this.points,this.fillColor,this.lineColor,this.lineWidth,this.isConvexPolygon,this.vid)};m(0,c,"cmdID",function(){return"DrawPoly"});a.create=function(b,d,c,f,g,h,k,n){var e=w.getItemByClass("DrawPolyCmd",a);e.x=b;e.y=d;e.points=c;e.fillColor=f;e.lineColor=g;e.lineWidth=h;e.isConvexPolygon=k;e.vid=n;return e};a.ID="DrawPoly";return a}(),Rb=function(){function a(){this._div=this._url=this._fontTxt=this.err=this.complete=this.fontName=null;this._txtWidth=NaN;this._http=null}p(a,"laya.net.TTFLoader");var c=a.prototype;c.load=function(b){this._url=b;b=b.split(".ttf")[0].split("/");this.fontName=b[b.length-1];v.isConchApp?this._loadConch():r.window.FontFace?this._loadWithFontFace():this._loadWithCSS()};c._loadConch=function(){this._http=new Na;this._http.on("error",this,this._onErr);this._http.on("complete",this,this._onHttpLoaded);this._http.send(this._url,null,"get","arraybuffer")};c._onHttpLoaded=function(b){r.window.conchTextCanvas.setFontFaceFromBuffer(this.fontName,b);this._clearHttp();this._complete()};c._clearHttp=function(){this._http&&(this._http.off("error",this,this._onErr),this._http.off("complete",this,this._onHttpLoaded),this._http=null)};c._onErr=function(){this._clearHttp();this.err&&(this.err.runWith("fail:"+this._url),this.err=null)};c._complete=function(){l.systemTimer.clear(this,this._complete);l.systemTimer.clear(this,this._checkComplete);this._div&&this._div.parentNode&&(this._div.parentNode.removeChild(this._div),this._div=null);this.complete&&(this.complete.runWith(this),this.complete=null)};c._checkComplete=function(){Z.measureText("LayaTTFFont",this._fontTxt).width!=this._txtWidth&&this._complete()};c._loadWithFontFace=function(){var b=new r.window.FontFace(this.fontName,"url('"+this._url+"')");r.window.document.fonts.add(b);var d=this;b.loaded.then(function(){d._complete()});b.load()};c._createDiv=function(){this._div=r.createElement("div");this._div.innerHTML="laya";var b=this._div.style;b.fontFamily=this.fontName;b.position="absolute";b.left="-100px";b.top="-100px";r.document.body.appendChild(this._div)};c._loadWithCSS=function(){var b=this,d=r.createElement("style");d.type="text/css";r.document.body.appendChild(d);d.textContent="@font-face { font-family:'"+this.fontName+"'; src:url('"+this._url+"');}";this._fontTxt="40px "+this.fontName;this._txtWidth=Z.measureText("LayaTTFFont",this._fontTxt).width;var a=this;d.onload=function(){l.systemTimer.once(1E4,a,b._complete)};l.systemTimer.loop(20,this,this._checkComplete);this._createDiv()};a._testString="LayaTTFFont";return a}(),Ia=function(){function a(){this.other=this.submitType=this.blendShader=0;this.clear()}p(a,"laya.webgl.submit.SubmitKey");var c=a.prototype;c.clear=function(){this.submitType=-1;this.blendShader=this.other=0};c.copyFrom=function(b){this.other=b.other;this.blendShader=b.blendShader;this.submitType=b.submitType};c.copyFrom2=function(b,d,a){this.other=a;this.submitType=d};c.equal3_2=function(b,d,a){return this.submitType===d&&this.other===a&&this.blendShader===b.blendShader};c.equal4_2=function(b,d,a){return this.submitType===d&&this.other===a&&this.blendShader===b.blendShader};c.equal_3=function(b){return this.submitType===b.submitType&&this.blendShader===b.blendShader};c.equal=function(b){return this.other===b.other&&this.submitType===b.submitType&&this.blendShader===b.blendShader};return a}();(function(){function a(){this._graphicsCmdEncoder=null;this._index=0;this.texture=this._paramData=null;this.height=this.width=this.y=this.x=NaN}p(a,"laya.display.cmd.DrawCanvasCmd");var c=a.prototype;c.recover=function(){this._graphicsCmdEncoder=null;w.recover("DrawCanvasCmd",this)};m(0,c,"cmdID",function(){return"DrawCanvasCmd"});a.create=function(b,d,a,c,g){return null};a.ID="DrawCanvasCmd";a._DRAW_IMAGE_CMD_ENCODER_=null;a._PARAM_TEXTURE_POS_=2;a._PARAM_VB_POS_=5;return a})();var w=function(){function a(){}p(a,"laya.utils.Pool");a.getPoolBySign=function(c){return a._poolDic[c]||(a._poolDic[c]=[])};a.clearBySign=function(c){a._poolDic[c]&&(a._poolDic[c].length=0)};a.recover=function(c,b){b.__InPool||(b.__InPool=!0,a.getPoolBySign(c).push(b))};a.recoverByClass=function(c){if(c){var b=c.__className||c.constructor._$gid;b&&a.recover(b,c)}};a._getClassSign=function(a){var b=a.__className||a._$gid;b||(a._$gid=b=L.getGID()+"");return b};a.createByClass=function(c){return a.getItemByClass(a._getClassSign(c),c)};a.getItemByClass=function(c,b){if(!a._poolDic[c])return new b;var d=a.getPoolBySign(c);d.length?(d=d.pop(),d.__InPool=!1):d=new b;return d};a.getItemByCreateFun=function(c,b,d){c=a.getPoolBySign(c);b=c.length?c.pop():b.call(d);b.__InPool=!1;return b};a.getItem=function(c){c=a.getPoolBySign(c);(c=c.length?c.pop():null)&&(c.__InPool=!1);return c};a.POOLSIGN="__InPool";a._poolDic={};return a}(),Sb=function(){function a(b){this.script=null;this.codes={};this.funs={};this.curUseID=-1;this.funnames="";this.script=b;for(var d=0,a,c;;){d=b.indexOf("#begin",d);if(0>d)break;for(c=d+5;;){c=b.indexOf("#end",c);if(0>c)break;if("i"===b.charAt(c+4))c+=5;else break}if(0>c)throw"add include err,no #end:"+b;a=b.indexOf("\n",d);var g=Ba.splitToWords(b.substr(d,a-d),null);"code"==g[1]?this.codes[g[2]]=b.substr(a+1,c-a-1):"function"==g[1]&&(a=b.indexOf("function",d),a+=8,this.funs[g[3]]=b.substr(a+1,c-a-1),this.funnames+=g[3]+";");d=c+1}}p(a,"laya.webgl.utils.InlcudeFile");var c=a.prototype;c.getWith=function(b){var d=b?this.codes[b]:this.script;if(!d)throw"get with error:"+b;return d};c.getFunsScript=function(b){var d="",a;for(a in this.funs)0<=b.indexOf(a+";")&&(d+=this.funs[a]);return d};return a}();(function(){function a(){}p(a,"laya.display.SpriteConst");a.ALPHA=1;a.TRANSFORM=2;a.BLEND=4;a.CANVAS=8;a.FILTERS=16;a.MASK=32;a.CLIP=64;a.STYLE=128;a.TEXTURE=256;a.GRAPHICS=512;a.LAYAGL3D=1024;a.CUSTOM=2048;a.ONECHILD=4096;a.CHILDS=8192;a.REPAINT_NONE=0;a.REPAINT_NODE=1;a.REPAINT_CACHE=2;a.REPAINT_ALL=3;return a})();var fa=function(){function a(){this._buffer=this._glBuffer=null;this._byteLength=this._bufferUsage=this._bufferType=0;this._glBuffer=y.instance.createBuffer()}p(a,"laya.webgl.utils.Buffer");var c=a.prototype;c._bindForVAO=function(){};c.bind=function(){return!1};c.destroy=function(){this._glBuffer&&(y.instance.deleteBuffer(this._glBuffer),this._glBuffer=null)};m(0,c,"bufferUsage",function(){return this._bufferUsage});a._bindedVertexBuffer=null;a._bindedIndexBuffer=null;return a}(),Tb=function(){function a(){this.colorFlt=null}p(a,"laya.display.cmd.DrawTextureCmd");var c=a.prototype;c.recover=function(){this.texture._removeReference();this.matrix=this.texture=null;w.recover("DrawTextureCmd",this)};c.run=function(b,d,a){b.drawTextureWithTransform(this.texture,this.x,this.y,this.width,this.height,this.matrix,d,a,this.alpha,this.blendMode,this.colorFlt)};m(0,c,"cmdID",function(){return"DrawTexture"});a.create=function(b,d,c,f,g,h,k,n,q){var e=w.getItemByClass("DrawTextureCmd",a);e.texture=b;b._addReference();e.x=d;e.y=c;e.width=f;e.height=g;e.matrix=h;e.alpha=k;e.color=n;e.blendMode=q;n&&(e.colorFlt=new jb,e.colorFlt.setColor(n));return e};a.ID="DrawTexture";return a}(),U=function(){function a(b,d){this.size=[0,0];this.ALPHA=this.alpha=1;this.subID=0;this.ref=1;this._cacheID=0;this.clipMatDir=[99999999,0,0,99999999];this.clipMatPos=[0,0];this.clipOff=[0,0];this.defines=new Ma;this.mainID=b;this.subID=d;this.u_mmat2=this.colorAdd=this.color=this.texture=this.textureHost=null;this._cacheID=b|d;this._inClassCache=a._cache[this._cacheID];0<b&&!this._inClassCache&&(this._inClassCache=a._cache[this._cacheID]=[],this._inClassCache._length=0);this.clear()}p(a,"laya.webgl.shader.d2.value.Value2D");var c=a.prototype;c.setValue=function(b){};c._ShaderWithCompile=function(){return ka.withCompile2D(0,this.mainID,this.defines.toNameDic(),this.mainID|this.defines._value,Ub.create,this._attribLocation)};c.upload=function(){var b=F;F.worldMatrix4===F.TEMPMAT4_ARRAY||this.defines.addInt(128);this.mmat=b.worldMatrix4;F.matWVP&&(this.defines.addInt(2048),this.u_MvpMatrix=F.matWVP.elements);var d=ka.sharders[this.mainID|this.defines._value]||this._ShaderWithCompile();d._shaderValueWidth!==b.width||d._shaderValueHeight!==b.height?(this.size[0]=b.width,this.size[1]=b.height,d._shaderValueWidth=b.width,d._shaderValueHeight=b.height,d.upload(this,null)):d.upload(this,d._params2dQuick2||d._make2dQuick2())};c.setFilters=function(b){if(this.filters=b)for(var d=b.length,a,c=0;c<d;c++)if(a=b[c])this.defines.add(a.type),a.action.setValue(this)};c.clear=function(){this.defines._value=this.subID+(E.shaderHighPrecision?1024:0);this.clipOff[0]=0};c.release=function(){1>--this.ref&&(this._inClassCache&&(this._inClassCache[this._inClassCache._length++]=this),this.clear(),this.filters=null,this.ref=1,this.clipOff[0]=0)};a._initone=function(b,d){a._typeClass[b]=d;a._cache[b]=[];a._cache[b]._length=0};a.__init__=function(){a._initone(4,Vb);a._initone(512,Wb);a._initone(1,mb);a._initone(9,mb)};a.create=function(b,d){var c=a._cache[b|d];return c._length?c[--c._length]:new a._typeClass[b|d](d)};a._cache=[];a._typeClass=[];a.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];return a}(),nb=function(){function a(){}p(a,"laya.maths.GrahamScan");a.multiply=function(a,b,d){return(a.x-d.x)*(b.y-d.y)-(b.x-d.x)*(a.y-d.y)};a.dis=function(a,b){return(a.x-b.x)*(a.x-b.x)+(a.y-b.y)*(a.y-b.y)};a._getPoints=function(c,b,d){void 0===b&&(b=!1);a._mPointList||(a._mPointList=[]);for(;a._mPointList.length<c;)a._mPointList.push(new N);d||(d=[]);d.length=0;b?a.getFrom(d,a._mPointList,c):a.getFromR(d,a._mPointList,c);return d};a.getFrom=function(a,b,d){var c;for(c=0;c<d;c++)a.push(b[c]);return a};a.getFromR=function(a,b,d){var c;for(c=0;c<d;c++)a.push(b.pop());return a};a.pListToPointList=function(c,b){void 0===b&&(b=!1);var d,e=c.length/2,f=a._getPoints(e,b,a._tempPointList);for(d=0;d<e;d++)f[d].setTo(c[d+d],c[d+d+1]);return f};a.pointListToPlist=function(c){var b,d=c.length,e=a._temPList,f;for(b=e.length=0;b<d;b++)f=c[b],e.push(f.x,f.y);return e};a.scanPList=function(c){return L.copyArray(c,a.pointListToPlist(a.scan(a.pListToPointList(c,!0))))};a.scan=function(c){var b,d,e=0,f,g,h={};g=a._temArr;g.length=0;f=c.length;for(b=f-1;0<=b;b--)d=c[b],f=d.x+"_"+d.y,h.hasOwnProperty(f)||(h[f]=!0,g.push(d));f=g.length;L.copyArray(c,g);for(b=1;b<f;b++)if(c[b].y<c[e].y||c[b].y==c[e].y&&c[b].x<c[e].x)e=b;d=c[0];c[0]=c[e];c[e]=d;for(b=1;b<f-1;b++){e=b;for(d=b+1;d<f;d++)if(0<a.multiply(c[d],c[e],c[0])||0==a.multiply(c[d],c[e],c[0])&&a.dis(c[0],c[d])<a.dis(c[0],c[e]))e=d;d=c[b];c[b]=c[e];c[e]=d}g=a._temArr;g.length=0;if(3>c.length)return L.copyArray(g,c);g.push(c[0],c[1],c[2]);for(b=3;b<f;b++){for(;2<=g.length&&0<=a.multiply(c[b],g[g.length-1],g[g.length-2]);)g.pop();c[b]&&g.push(c[b])}return g};a._mPointList=null;a._tempPointList=[];a._temPList=[];a._temArr=[];return a}(),ob=function(){function a(){this._saveuse=0}p(a,"laya.webgl.canvas.save.SaveMark");var c=a.prototype;l.imps(c,{"laya.webgl.canvas.save.ISaveData":!0});c.isSaveMark=function(){return!0};c.restore=function(b){b._saveMark=this._preSaveMark;a.POOL[a.POOL._length++]=this};a.Create=function(b){var d=a.POOL,d=0<d._length?d[--d._length]:new a;d._saveuse=0;d._preSaveMark=b._saveMark;return b._saveMark=d};a.POOL=R._createArray();return a}(),Wa=function(){function a(){this.gid=0;this.repeat=1;this._count=0}p(a,"laya.utils.Tween");var c=a.prototype;c.to=function(b,d,a,c,g,h,k){void 0===h&&(h=0);void 0===k&&(k=!1);return this._create(b,d,a,c,g,h,k,!0,!1,!0)};c.from=function(b,d,a,c,g,h,k){void 0===h&&(h=0);void 0===k&&(k=!1);return this._create(b,d,a,c,g,h,k,!1,!1,!0)};c._create=function(b,d,c,f,g,h,k,n,q,u){if(!b)throw Error("Tween:target is null");this._target=b;this._duration=c;this._ease=f||d.ease||a.easeNone;this._complete=g||d.complete;this._delay=h;this._props=[];this._usedTimer=0;this._startTimer=r.now();this._usedPool=q;this._delayParam=null;this.update=d.update;c=b.$_GID||(b.$_GID=L.getGID());a.tweenMap[c]?(k&&a.clearTween(b),a.tweenMap[c].push(this)):a.tweenMap[c]=[this];u?0>=h?this.firstStart(b,d,n):(this._delayParam=[b,d,n],l.timer.once(h,this,this.firstStart,this._delayParam)):this._initProps(b,d,n);return this};c.firstStart=function(b,d,a){this._delayParam=null;b.destroyed?this.clear():(this._initProps(b,d,a),this._beginLoop())};c._initProps=function(b,d,a){for(var c in d)if("number"==typeof b[c]){var e=a?b[c]:d[c];this._props.push([c,e,(a?d[c]:b[c])-e]);a||(b[c]=e)}};c._beginLoop=function(){l.timer.frameLoop(1,this,this._doEase)};c._doEase=function(){this._updateEase(r.now())};c._updateEase=function(b){var d=this._target;if(d){if(d.destroyed)return a.clearTween(d);b=this._usedTimer=b-this._startTimer-this._delay;if(!(0>b)){if(b>=this._duration)return this.complete();b=0<b?this._ease(b,0,1,this._duration):0;for(var c=this._props,f=0,g=c.length;f<g;f++){var h=c[f];d[h[0]]=h[1]+b*h[2]}this.update&&this.update.run()}}};c.complete=function(){if(this._target){l.timer.runTimer(this,this.firstStart);for(var b=this._target,d=this._props,a=this._complete,c=0,g=d.length;c<g;c++){var h=d[c];b[h[0]]=h[1]+h[2]}this.update&&this.update.run();this._count++;0!=this.repeat&&this._count>=this.repeat?(this.clear(),a&&a.run()):this.restart()}};c.pause=function(){l.timer.clear(this,this._beginLoop);l.timer.clear(this,this._doEase);l.timer.clear(this,this.firstStart);var b;b=r.now()-this._startTimer-this._delay;0>b&&(this._usedTimer=b)};c.setStartTime=function(b){this._startTimer=b};c.clear=function(){this._target&&(this._remove(),this._clear())};c._clear=function(){this.pause();l.timer.clear(this,this.firstStart);this._delayParam=this._props=this._ease=this._target=this._complete=null;this._usedPool&&(this.update=null,w.recover("tween",this))};c.recover=function(){this._usedPool=!0;this._clear()};c._remove=function(){var b=a.tweenMap[this._target.$_GID];if(b)for(var d=0,c=b.length;d<c;d++)if(b[d]===this){b.splice(d,1);break}};c.restart=function(){this.pause();this._usedTimer=0;this._startTimer=r.now();if(this._delayParam)l.timer.once(this._delay,this,this.firstStart,this._delayParam);else{for(var b=this._props,d=0,a=b.length;d<a;d++){var c=b[d];this._target[c[0]]=c[1]}l.timer.once(this._delay,this,this._beginLoop)}};c.resume=function(){if(!(this._usedTimer>=this._duration))if(this._startTimer=r.now()-this._usedTimer-this._delay,this._delayParam)if(0>this._usedTimer)l.timer.once(-this._usedTimer,this,this.firstStart,this._delayParam);else this.firstStart.apply(this,this._delayParam);else this._beginLoop()};m(0,c,"progress",null,function(b){b*=this._duration;this._startTimer=r.now()-this._delay-b});a.to=function(b,d,c,f,g,h,k,n){void 0===h&&(h=0);void 0===k&&(k=!1);void 0===n&&(n=!0);return w.getItemByClass("tween",a)._create(b,d,c,f,g,h,k,!0,n,!0)};a.from=function(b,d,c,f,g,h,k,n){void 0===h&&(h=0);void 0===k&&(k=!1);void 0===n&&(n=!0);return w.getItemByClass("tween",a)._create(b,d,c,f,g,h,k,!1,n,!0)};a.clearAll=function(b){if(b&&b.$_GID&&(b=a.tweenMap[b.$_GID])){for(var d=0,c=b.length;d<c;d++)b[d]._clear();b.length=0}};a.clear=function(b){b.clear()};a.clearTween=function(b){a.clearAll(b)};a.easeNone=function(b,d,a,c){return a*b/c+d};a.tweenMap=[];return a}(),Xb=function(){function a(){}p(a,"laya.display.cmd.DrawRectCmd");var c=a.prototype;c.recover=function(){this.lineColor=this.fillColor=null;w.recover("DrawRectCmd",this)};c.run=function(b,d,a){b.drawRect(this.x+d,this.y+a,this.width,this.height,this.fillColor,this.lineColor,this.lineWidth)};m(0,c,"cmdID",function(){return"DrawRect"});a.create=function(b,d,c,f,g,h,k){var e=w.getItemByClass("DrawRectCmd",a);e.x=b;e.y=d;e.width=c;e.height=f;e.fillColor=g;e.lineColor=h;e.lineWidth=k;return e};a.ID="DrawRect";return a}(),Xa=function(){function a(a,b,d){this.steiner=this.nextZ=this.prevZ=this.z=this.next=this.prev=this.y=this.x=this.i=null;this.i=a;this.x=b;this.y=d;this.nextZ=this.prevZ=this.z=this.next=this.prev=null;this.steiner=!1}p(a,"laya.webgl.shapes.EarcutNode");return a}(),ba=function(){function a(){this.args=this._this=this.fun=null;this._ref=1;this._key=new Ia}p(a,"laya.webgl.submit.SubmitCMD");var c=a.prototype;l.imps(c,{"laya.webgl.submit.ISubmit":!0});c.renderSubmit=function(){this.fun.apply(this._this,this.args);return 1};c.getRenderType=function(){return 0};c.reUse=function(b,d){this._ref++;return d};c.releaseRender=function(){if(1>--this._ref){var b=a.POOL;b[b._length++]=this}};c.clone=function(b,d,a){return null};a.create=function(b,d,c){var e=a.POOL._length?a.POOL[--a.POOL._length]:new a;e.fun=d;e.args=b;e._this=c;e._ref=1;e._key.clear();return e};a.POOL=[];a.__init$=function(){a.POOL._length=0};return a}(),M=function(){function a(b){this._path=this._url=null;this._url=a.formatURL(b);this._path=a.getPath(b)}p(a,"laya.net.URL");var c=a.prototype;m(0,c,"path",function(){return this._path});m(0,c,"url",function(){return this._url});m(1,a,"basePath",function(){return a._basePath},function(b){a._basePath=l._getUrlPath();a._basePath=a.formatURL(b)});a.formatURL=function(b){if(!b)return"null path";if(0<b.indexOf(":"))return b;null!=a.customFormat&&(b=a.customFormat(b));if(0<b.indexOf(":"))return b;var d=b.charAt(0);if("."===d)return a._formatRelativePath(a._basePath+b);if("~"===d)return a.rootPath+b.substring(1);if("d"===d){if(0===b.indexOf("data:image"))return b}else if("/"===d)return b;return a._basePath+b};a._formatRelativePath=function(b){b=b.split("/");for(var d=0,a=b.length;d<a;d++)".."==b[d]&&(b.splice(d-1,2),d-=2);return b.join("/")};a.getPath=function(b){var d=b.lastIndexOf("/");return 0<d?b.substr(0,d+1):""};a.getFileName=function(b){var d=b.lastIndexOf("/");return 0<d?b.substr(d+1):b};a.getAdptedFilePath=function(b){if(!a.exportSceneToJson||!b)return b;var d,c;c=a._adpteTypeList.length;var f;for(d=0;d<c;d++)f=a._adpteTypeList[d],b=b.replace(f[0],f[1]);return b};a.version={};a.exportSceneToJson=!1;a._basePath="";a.rootPath="";a.customFormat=function(b){var d=a.version[b];!v.isConchApp&&d&&(b+="?v\x3d"+d);return b};t(a,["_adpteTypeList",function(){return this._adpteTypeList=[[".scene3d",".json"],[".scene",".json"],[".taa",".json"],[".prefab",".json"]]}]);return a}(),Sa=function(){function a(){}p(a,"laya.utils.CacheManger");a.regCacheByFunction=function(c,b){a.unRegCacheByFunction(c,b);a._cacheList.push({tryDispose:c,getCacheList:b})};a.unRegCacheByFunction=function(c,b){var d,e;e=a._cacheList.length;for(d=0;d<e;d++)if(a._cacheList[d].tryDispose==c&&a._cacheList[d].getCacheList==b){a._cacheList.splice(d,1);break}};a.forceDispose=function(){var c,b=a._cacheList.length;for(c=0;c<b;c++)a._cacheList[c].tryDispose(!0)};a.beginCheck=function(c){void 0===c&&(c=15E3);l.systemTimer.loop(c,null,a._checkLoop)};a.stopCheck=function(){l.systemTimer.clear(null,a._checkLoop)};a._checkLoop=function(){var c=a._cacheList;if(!(1>c.length)){var b=r.now(),d,e;for(e=d=c.length;0<d;){a._index++;a._index%=e;c[a._index].tryDispose(!1);if(r.now()-b>a.loopTimeLimit)break;d--}}};a.loopTimeLimit=2;a._cacheList=[];a._index=0;return a}(),Oa=function(){function a(){this.reset()}p(a,"laya.display.css.SpriteStyle");var c=a.prototype;c.reset=function(){this.scaleX=this.scaleY=1;this.pivotX=this.pivotY=this.rotation=this.skewX=this.skewY=0;this.alpha=1;this.scrollRect&&this.scrollRect.recover();this.scrollRect=null;this.viewport&&this.viewport.recover();this.blendMode=this.dragging=this.hitArea=this.viewport=null;return this};c.recover=function(){this!==a.EMPTY&&w.recover("SpriteStyle",this.reset())};a.create=function(){return w.getItemByClass("SpriteStyle",a)};a.EMPTY=new a;return a}(),Yb=function(){function a(b,d){this.submitEndPos=this.submitStartPos=0;this.context=null;this.touches=[];this.submits=[];this._triangleMesh=this._pathMesh=this._mesh=this.sprite=null;this.meshlist=[];this._oldMeshList=this._oldTriMesh=this._oldPathMesh=this._oldMesh=null;this.oldTy=this.oldTx=0;this.cachedClipInfo=new I;this.invMat=new I;this.context=b;this.sprite=d;b._globalClipMatrix.copyTo(this.cachedClipInfo)}p(a,"laya.webgl.canvas.WebGLCacheAsNormalCanvas");var c=a.prototype;c.startRec=function(){this.context._charSubmitCache._enbale&&(this.context._charSubmitCache.enable(!1,this.context),this.context._charSubmitCache.enable(!0,this.context));this.context._incache=!0;this.touches.length=0;this.context.touches=this.touches;this.context._globalClipMatrix.copyTo(this.cachedClipInfo);this.submits.length=0;this.submitStartPos=this.context._submits._length;for(var b=0,d=this.meshlist.length;b<d;b++){var a=this.meshlist[b];a.canReuse?a.releaseMesh():a.destroy()}this.meshlist.length=0;this._mesh=la.getAMesh(!1);this._pathMesh=Ca.getAMesh(!1);this._triangleMesh=Pa.getAMesh(!1);this.meshlist.push(this._mesh);this.meshlist.push(this._pathMesh);this.meshlist.push(this._triangleMesh);this.context._curSubmit=z.RENDERBASE;this._oldMesh=this.context._mesh;this._oldPathMesh=this.context._pathMesh;this._oldTriMesh=this.context._triangleMesh;this._oldMeshList=this.context.meshlist;this.context._mesh=this._mesh;this.context._pathMesh=this._pathMesh;this.context._triangleMesh=this._triangleMesh;this.context.meshlist=this.meshlist;this.oldTx=this.context._curMat.tx;this.oldTy=this.context._curMat.ty;this.context._curMat.tx=0;this.context._curMat.ty=0;this.context._curMat.copyTo(this.invMat);this.invMat.invert()};c.endRec=function(){this.context._charSubmitCache._enbale&&(this.context._charSubmitCache.enable(!1,this.context),this.context._charSubmitCache.enable(!0,this.context));var b=this.context._submits;this.submitEndPos=b._length;for(var d=this.submitEndPos-this.submitStartPos,a=0;a<d;a++)this.submits.push(b[this.submitStartPos+a]);b._length-=d;this.context._mesh=this._oldMesh;this.context._pathMesh=this._oldPathMesh;this.context._triangleMesh=this._oldTriMesh;this.context.meshlist=this._oldMeshList;this.context._curSubmit=z.RENDERBASE;this.context._curMat.tx=this.oldTx;this.context._curMat.ty=this.oldTy;this.context.touches=null;this.context._incache=!1};c.isCacheValid=function(){var b=this.context._globalClipMatrix;return b.a!=this.cachedClipInfo.a||b.b!=this.cachedClipInfo.b||b.c!=this.cachedClipInfo.c||b.d!=this.cachedClipInfo.d||b.tx!=this.cachedClipInfo.tx||b.ty!=this.cachedClipInfo.ty?!1:!0};c.flushsubmit=function(){var b=z.RENDERBASE;this.submits.forEach(function(d){d!=z.RENDERBASE&&(z.preRender=b,b=d,d.renderSubmit())})};c.releaseMem=function(){};t(a,["matI",function(){return this.matI=new I}]);return a}(),ga=function(){function a(d){this.scale=1;this._delta=this.currFrame=0;this._map=[];this._handlers=[];this._temp=[];this._count=0;this.currTimer=r.now();this._lastTimer=r.now();void 0===d&&(d=!0);d&&l.systemTimer&&l.systemTimer.frameLoop(1,this,this._update)}var c;p(a,"laya.utils.Timer");var b=a.prototype;b._update=function(){if(0>=this.scale)this._lastTimer=r.now();else{var d=this.currFrame+=this.scale,b=r.now();this._delta=(b-this._lastTimer)*this.scale;var a=this.currTimer+=this._delta;this._lastTimer=b;for(var b=this._handlers,c=this._count=0,h=b.length;c<h;c++){var k=b[c];if(null!==k.method){var n=k.userFrame?d:a;if(n>=k.exeTime)if(k.repeat)if(k.jumpFrame)for(;n>=k.exeTime;)k.exeTime+=k.delay,k.run(!1);else k.exeTime+=k.delay,k.run(!1),n>k.exeTime&&(k.exeTime+=Math.ceil((n-k.exeTime)/k.delay)*k.delay);else k.run(!0)}else this._count++}(30<this._count||0===d%200)&&this._clearHandlers()}};b._clearHandlers=function(){for(var d=this._handlers,b=0,a=d.length;b<a;b++){var c=d[b];null!==c.method?this._temp.push(c):this._recoverHandler(c)}this._handlers=this._temp;d.length=0;this._temp=d};b._recoverHandler=function(d){this._map[d.key]==d&&(this._map[d.key]=null);d.clear();a._pool.push(d)};b._create=function(d,b,f,g,h,k,n){if(!f)return h.apply(g,k),null;if(n&&(n=this._getHandler(g,h)))return n.repeat=b,n.userFrame=d,n.delay=f,n.caller=g,n.method=h,n.args=k,n.exeTime=f+(d?this.currFrame:this.currTimer+r.now()-this._lastTimer),n;n=0<a._pool.length?a._pool.pop():new c;n.repeat=b;n.userFrame=d;n.delay=f;n.caller=g;n.method=h;n.args=k;n.exeTime=f+(d?this.currFrame:this.currTimer+r.now()-this._lastTimer);this._indexHandler(n);this._handlers.push(n);return n};b._indexHandler=function(d){var b=d.caller,c=d.method,b=b?b.$_GID||(b.$_GID=L.getGID()):0,c=c.$_TID||(c.$_TID=1E5*a._mid++);d.key=b+c;this._map[d.key]=d};b.once=function(d,b,a,c,h){void 0===h&&(h=!0);this._create(!1,!1,d,b,a,c,h)};b.loop=function(d,b,a,c,h,k){void 0===h&&(h=!0);void 0===k&&(k=!1);if(d=this._create(!1,!0,d,b,a,c,h))d.jumpFrame=k};b.frameOnce=function(d,b,a,c,h){void 0===h&&(h=!0);this._create(!0,!1,d,b,a,c,h)};b.frameLoop=function(d,b,a,c,h){void 0===h&&(h=!0);this._create(!0,!0,d,b,a,c,h)};b.toString=function(){return" handlers:"+this._handlers.length+" pool:"+a._pool.length};b.clear=function(d,b){var a=this._getHandler(d,b);a&&(this._map[a.key]=null,a.key=0,a.clear())};b.clearAll=function(d){if(d)for(var b=0,a=this._handlers.length;b<a;b++){var c=this._handlers[b];c.caller===d&&(this._map[c.key]=null,c.key=0,c.clear())}};b._getHandler=function(d,b){var c=d?d.$_GID||(d.$_GID=L.getGID()):0,e=b.$_TID||(b.$_TID=1E5*a._mid++);return this._map[c+e]};b.callLater=function(d,b,a){oa.I.callLater(d,b,a)};b.runCallLater=function(d,b){oa.I.runCallLater(d,b)};b.runTimer=function(d,b){var a=this._getHandler(d,b);a&&null!=a.method&&(this._map[a.key]=null,a.run(!0))};b.pause=function(){this.scale=0};b.resume=function(){this.scale=1};m(0,b,"delta",function(){return this._delta});a._pool=[];a._mid=1;a.__init$=function(){c=function(){function d(){this.key=0;this.repeat=!1;this.delay=0;this.userFrame=!1;this.exeTime=0;this.args=this.method=this.caller=null;this.jumpFrame=!1}p(d,"");var b=d.prototype;b.clear=function(){this.args=this.method=this.caller=null};b.run=function(d){var b=this.caller;if(b&&b.destroyed)return this.clear();var a=this.method,c=this.args;d&&this.clear();null!=a&&(c?a.apply(b,c):a.call(b))};return d}()};return a}(),Ya=function(){function a(){this.reset()}p(a,"laya.display.css.CacheStyle");var c=a.prototype;c.needBitmapCache=function(){return this.cacheForFilters||!!this.mask};c.needEnableCanvasRender=function(){return"none"!=this.userSetCache||this.cacheForFilters||!!this.mask};c.releaseContext=function(){this.canvas&&this.canvas.size&&(w.recover("CacheCanvas",this.canvas),this.canvas.size(0,0),this.canvas.width=0,this.canvas.height=0);this.canvas=null};c.createContext=function(){this.canvas||(this.canvas=w.getItem("CacheCanvas")||new ea(!1),this.canvas.context||this.canvas.getContext("2d"))};c.releaseFilterCache=function(){var b=this.filterCache;b&&(b.destroy(),b.recycle(),this.filterCache=null)};c.recover=function(){this!==a.EMPTY&&w.recover("SpriteCache",this.reset())};c.reset=function(){this.releaseContext();this.releaseFilterCache();this.cacheAs="none";this.enableCanvasRender=!1;this.userSetCache="none";this.staticCache=this.cacheForFilters=!1;this.reCache=!0;this.filters=this.filterCache=this.maskParent=this.mask=null;this.hasGlowFilter=!1;this.cacheRect&&this.cacheRect.recover();this.cacheRect=null;return this};c._calculateCacheRect=function(b,d,c,f){var e=b._cacheStyle;e.cacheRect||(e.cacheRect=K.create());"bitmap"===d?(d=b.getSelfBounds(),d.width+=32,d.height+=32,d.x-=b.pivotX,d.y-=b.pivotY,d.x-=16,d.y-=16,d.x=Math.floor(d.x+c)-c,d.y=Math.floor(d.y+f)-f,d.width=Math.floor(d.width),d.height=Math.floor(d.height),e.cacheRect.copyFrom(d)):e.cacheRect.setTo(-b._style.pivotX,-b._style.pivotY,1,1);d=e.cacheRect;b._style.scrollRect&&(b=b._style.scrollRect,d.x-=b.x,d.y-=b.y);a._scaleInfo.setTo(1,1);return a._scaleInfo};a.create=function(){return w.getItemByClass("SpriteCache",a)};a.EMPTY=new a;a.CANVAS_EXTEND_EDGE=16;t(a,["_scaleInfo",function(){return this._scaleInfo=new N}]);return a}(),Zb=function(){function a(){this._mat=new I}p(a,"laya.webgl.canvas.save.SaveTranslate");var c=a.prototype;l.imps(c,{"laya.webgl.canvas.save.ISaveData":!0});c.isSaveMark=function(){return!1};c.restore=function(b){this._mat.copyTo(b._curMat);a.POOL[a.POOL._length++]=this};a.save=function(b){var d=a.POOL,d=0<d._length?d[--d._length]:new a;b._curMat.copyTo(d._mat);b=b._save;b[b._length++]=d};a.POOL=R._createArray();return a}(),$b=function(){function a(){}p(a,"laya.display.cmd.DrawLineCmd");var c=a.prototype;c.recover=function(){w.recover("DrawLineCmd",this)};c.run=function(b,d,a){b._drawLine(d,a,this.fromX,this.fromY,this.toX,this.toY,this.lineColor,this.lineWidth,this.vid)};m(0,c,"cmdID",function(){return"DrawLine"});a.create=function(b,d,c,f,g,h,k){var e=w.getItemByClass("DrawLineCmd",a);e.fromX=b;e.fromY=d;e.toX=c;e.toY=f;e.lineColor=g;e.lineWidth=h;e.vid=k;return e};a.ID="DrawLine";return a}(),C=function(){function a(){}p(a,"laya.webgl.WebGLContext");var c=a.prototype;c.getContextAttributes=function(){return null};c.isContextLost=function(){};c.getSupportedExtensions=function(){return null};c.getExtension=function(b){return null};c.activeTexture=function(b){};c.attachShader=function(b,d){};c.bindAttribLocation=function(b,d,a){};c.bindBuffer=function(b,d){};c.bindFramebuffer=function(b,d){};c.bindRenderbuffer=function(b,d){};c.bindTexture=function(b,d){};c.useTexture=function(b){};c.blendColor=function(b,d,a,c){};c.blendEquation=function(b){};c.blendEquationSeparate=function(b,d){};c.blendFunc=function(b,d){};c.blendFuncSeparate=function(b,d,a,c){};c.bufferData=function(b,d,a){};c.bufferSubData=function(b,d,a){};c.checkFramebufferStatus=function(b){return null};c.clear=function(b){};c.clearColor=function(b,d,a,c){};c.clearDepth=function(b){};c.clearStencil=function(b){};c.colorMask=function(b,d,a,c){};c.compileShader=function(b){};c.copyTexImage2D=function(b,d,a,c,g,h,k,n){};c.copyTexSubImage2D=function(b,d,a,c,g,h,k,n){};c.createBuffer=function(){};c.createFramebuffer=function(){};c.createProgram=function(){};c.createRenderbuffer=function(){};c.createShader=function(b){};c.createTexture=function(){return null};c.cullFace=function(b){};c.deleteBuffer=function(b){};c.deleteFramebuffer=function(b){};c.deleteProgram=function(b){};c.deleteRenderbuffer=function(b){};c.deleteShader=function(b){};c.deleteTexture=function(b){};c.depthFunc=function(b){};c.depthMask=function(b){};c.depthRange=function(b,d){};c.detachShader=function(b,d){};c.disable=function(b){};c.disableVertexAttribArray=function(b){};c.drawArrays=function(b,d,a){};c.drawElements=function(b,d,a,c){};c.enable=function(b){};c.enableVertexAttribArray=function(b){};c.finish=function(){};c.flush=function(){};c.framebufferRenderbuffer=function(b,d,a,c){};c.framebufferTexture2D=function(b,d,a,c,g){};c.frontFace=function(b){return null};c.generateMipmap=function(b){return null};c.getActiveAttrib=function(b,d){return null};c.getActiveUniform=function(b,d){return null};c.getAttribLocation=function(b,d){return 0};c.getParameter=function(b){return null};c.getBufferParameter=function(b,d){return null};c.getError=function(){return null};c.getFramebufferAttachmentParameter=function(b,d,a){};c.getProgramParameter=function(b,d){return 0};c.getProgramInfoLog=function(b){return null};c.getRenderbufferParameter=function(b,d){return null};c.getShaderPrecisionFormat=function(b){return null};c.getShaderParameter=function(b,d){};c.getShaderInfoLog=function(b){return null};c.getShaderSource=function(b){return null};c.getTexParameter=function(b,d){};c.getUniform=function(b,d){};c.getUniformLocation=function(b,d){return null};c.getVertexAttrib=function(b,d){return null};c.getVertexAttribOffset=function(b,d){return null};c.hint=function(b,d){};c.isBuffer=function(b){};c.isEnabled=function(b){};c.isFramebuffer=function(b){};c.isProgram=function(b){};c.isRenderbuffer=function(b){};c.isShader=function(b){};c.isTexture=function(b){};c.lineWidth=function(b){};c.linkProgram=function(b){};c.pixelStorei=function(b,d){};c.polygonOffset=function(b,d){};c.readPixels=function(b,d,a,c,g,h,k){};c.renderbufferStorage=function(b,d,a,c){};c.sampleCoverage=function(b,d){};c.scissor=function(b,d,a,c){};c.shaderSource=function(b,d){};c.stencilFunc=function(b,d,a){};c.stencilFuncSeparate=function(b,d,a,c){};c.stencilMask=function(b){};c.stencilMaskSeparate=function(b,d){};c.stencilOp=function(b,d,a){};c.stencilOpSeparate=function(b,d,a,c){};c.texImage2D=function(b){};c.texParameterf=function(b,d,a){};c.texParameteri=function(b,d,a){};c.texSubImage2D=function(b){};c.uniform1f=function(b,d){};c.uniform1fv=function(b,d){};c.uniform1i=function(b,d){};c.uniform1iv=function(b,d){};c.uniform2f=function(b,d,a){};c.uniform2fv=function(b,d){};c.uniform2i=function(b,d,a){};c.uniform2iv=function(b,d){};c.uniform3f=function(b,d,a,c){};c.uniform3fv=function(b,d){};c.uniform3i=function(b,d,a,c){};c.uniform3iv=function(b,d){};c.uniform4f=function(b,d,a,c,g){};c.uniform4fv=function(b,d){};c.uniform4i=function(b,d,a,c,g){};c.uniform4iv=function(b,d){};c.uniformMatrix2fv=function(b,d,a){};c.uniformMatrix3fv=function(b,d,a){};c.uniformMatrix4fv=function(b,d,a){};c.useProgram=function(b){};c.validateProgram=function(b){};c.vertexAttrib1f=function(b,d){};c.vertexAttrib1fv=function(b,d){};c.vertexAttrib2f=function(b,d,a){};c.vertexAttrib2fv=function(b,d){};c.vertexAttrib3f=function(b,d,a,c){};c.vertexAttrib3fv=function(b,d){};c.vertexAttrib4f=function(b,d,a,c,g){};c.vertexAttrib4fv=function(b,d){};c.vertexAttribPointer=function(b,d,a,c,g,h){};c.viewport=function(b,d,a,c){};c.configureBackBuffer=function(b,d,a,c,g){};c.compressedTexImage2D=function(b){};c.createVertexArray=function(){throw"not implemented";};c.bindVertexArray=function(b){throw"not implemented";};c.deleteVertexArray=function(b){throw"not implemented";};c.isVertexArray=function(b){throw"not implemented";};a._forceSupportVAOPlatform=function(){return r.onMiniGame&&r.onIOS||r.onBDMiniGame||r.onQGMiniGame};a.__init__=function(b){laya.webgl.WebGLContext._checkExtensions(b);if(!E._isWebGL2&&!v.isConchApp){ac;G._setupVertexArrayObject&&(a._forceSupportVAOPlatform()?G._forceSetupVertexArrayObject(b):G._setupVertexArrayObject(b));var d=(b.rawgl||b).getExtension("OES_vertex_array_object");d&&(b.createVertexArray=function(){return d.createVertexArrayOES()},b.bindVertexArray=function(b){d.bindVertexArrayOES(b)},b.deleteVertexArray=function(b){d.deleteVertexArrayOES(b)},b.isVertexArray=function(b){d.isVertexArrayOES(b)})}};a._getExtension=function(b,d){var c=a._extentionVendorPrefixes,f;for(f in c){var g=b.getExtension(c[f]+d);if(g)return g}return null};a._checkExtensions=function(b){a._extTextureFilterAnisotropic=a._getExtension(b,"EXT_texture_filter_anisotropic");a._compressedTextureS3tc=a._getExtension(b,"WEBGL_compressed_texture_s3tc");a._compressedTexturePvrtc=a._getExtension(b,"WEBGL_compressed_texture_pvrtc");a._compressedTextureEtc1=a._getExtension(b,"WEBGL_compressed_texture_etc1");a._forceSupportVAOPlatform()||(a._angleInstancedArrays=a._getExtension(b,"ANGLE_instanced_arrays"))};a.__init_native=function(){v.supportWebGLPlusRendering&&(a.activeTexture=a.activeTextureForNative,a.bindTexture=a.bindTextureForNative)};a.useProgram=function(b,d){if(a._useProgram===d)return!1;b.useProgram(d);a._useProgram=d;return!0};a.setDepthTest=function(b,d){d!==a._depthTest&&(a._depthTest=d,d?b.enable(2929):b.disable(2929))};a.setDepthMask=function(b,d){d!==a._depthMask&&(a._depthMask=d,b.depthMask(d))};a.setDepthFunc=function(b,d){d!==a._depthFunc&&(a._depthFunc=d,b.depthFunc(d))};a.setBlend=function(b,d){d!==a._blend&&(a._blend=d,d?b.enable(3042):b.disable(3042))};a.setBlendFunc=function(b,d,c){d===a._sFactor&&c===a._dFactor||(a._sFactor=a._srcAlpha=d,a._dFactor=a._dstAlpha=c,b.blendFunc(d,c))};a.setBlendFuncSeperate=function(b,d,c,f,g){if(d!==a._sFactor||c!==a._dFactor||f!==a._srcAlpha||g!==a._dstAlpha)a._sFactor=d,a._dFactor=c,a._srcAlpha=f,a._dstAlpha=g,b.blendFuncSeparate(d,c,f,g)};a.setCullFace=function(b,d){d!==a._cullFace&&(a._cullFace=d,d?b.enable(2884):b.disable(2884))};a.setFrontFace=function(b,d){d!==a._frontFace&&(a._frontFace=d,b.frontFace(d))};a.activeTexture=function(b,d){a._activedTextureID!==d&&(b.activeTexture(d),a._activedTextureID=d)};a.bindTexture=function(b,d,c){a._activeTextures[a._activedTextureID-33984]!==c&&(b.bindTexture(d,c),a._activeTextures[a._activedTextureID-33984]=c)};a.useProgramForNative=function(b,d){b.useProgram(d);return!0};a.setDepthTestForNative=function(b,d){d?b.enable(2929):b.disable(2929)};a.setDepthMaskForNative=function(b,d){b.depthMask(d)};a.setDepthFuncForNative=function(b,d){b.depthFunc(d)};a.setBlendForNative=function(b,d){d?b.enable(3042):b.disable(3042)};a.setBlendFuncForNative=function(b,d,a){b.blendFunc(d,a)};a.setCullFaceForNative=function(b,d){d?b.enable(2884):b.disable(2884)};a.setFrontFaceForNative=function(b,d){b.frontFace(d)};a.activeTextureForNative=function(b,d){b.activeTexture(d)};a.bindTextureForNative=function(b,d,a){b.bindTexture(d,a)};a.bindVertexArrayForNative=function(b,d){b.bindVertexArray(d)};a.DEPTH_BUFFER_BIT=256;a.STENCIL_BUFFER_BIT=1024;a.COLOR_BUFFER_BIT=16384;a.POINTS=0;a.LINES=1;a.LINE_LOOP=2;a.LINE_STRIP=3;a.TRIANGLES=4;a.TRIANGLE_STRIP=5;a.TRIANGLE_FAN=6;a.ZERO=0;a.ONE=1;a.SRC_COLOR=768;a.ONE_MINUS_SRC_COLOR=769;a.SRC_ALPHA=770;a.ONE_MINUS_SRC_ALPHA=771;a.DST_ALPHA=772;a.ONE_MINUS_DST_ALPHA=773;a.DST_COLOR=774;a.ONE_MINUS_DST_COLOR=775;a.SRC_ALPHA_SATURATE=776;a.FUNC_ADD=32774;a.BLEND_EQUATION=32777;a.BLEND_EQUATION_RGB=32777;a.BLEND_EQUATION_ALPHA=34877;a.FUNC_SUBTRACT=32778;a.FUNC_REVERSE_SUBTRACT=32779;a.BLEND_DST_RGB=32968;a.BLEND_SRC_RGB=32969;a.BLEND_DST_ALPHA=32970;a.BLEND_SRC_ALPHA=32971;a.CONSTANT_COLOR=32769;a.ONE_MINUS_CONSTANT_COLOR=32770;a.CONSTANT_ALPHA=32771;a.ONE_MINUS_CONSTANT_ALPHA=32772;a.BLEND_COLOR=32773;a.ARRAY_BUFFER=34962;a.ELEMENT_ARRAY_BUFFER=34963;a.ARRAY_BUFFER_BINDING=34964;a.ELEMENT_ARRAY_BUFFER_BINDING=34965;a.STREAM_DRAW=35040;a.STATIC_DRAW=35044;a.DYNAMIC_DRAW=35048;a.BUFFER_SIZE=34660;a.BUFFER_USAGE=34661;a.CURRENT_VERTEX_ATTRIB=34342;a.FRONT=1028;a.BACK=1029;a.CULL_FACE=2884;a.FRONT_AND_BACK=1032;a.BLEND=3042;a.DITHER=3024;a.STENCIL_TEST=2960;a.DEPTH_TEST=2929;a.SCISSOR_TEST=3089;a.POLYGON_OFFSET_FILL=32823;a.SAMPLE_ALPHA_TO_COVERAGE=32926;a.SAMPLE_COVERAGE=32928;a.NO_ERROR=0;a.INVALID_ENUM=1280;a.INVALID_VALUE=1281;a.INVALID_OPERATION=1282;a.OUT_OF_MEMORY=1285;a.CW=2304;a.CCW=2305;a.LINE_WIDTH=2849;a.ALIASED_POINT_SIZE_RANGE=33901;a.ALIASED_LINE_WIDTH_RANGE=33902;a.CULL_FACE_MODE=2885;a.FRONT_FACE=2886;a.DEPTH_RANGE=2928;a.DEPTH_WRITEMASK=2930;a.DEPTH_CLEAR_VALUE=2931;a.DEPTH_FUNC=2932;a.STENCIL_CLEAR_VALUE=2961;a.STENCIL_FUNC=2962;a.STENCIL_FAIL=2964;a.STENCIL_PASS_DEPTH_FAIL=2965;a.STENCIL_PASS_DEPTH_PASS=2966;a.STENCIL_REF=2967;a.STENCIL_VALUE_MASK=2963;a.STENCIL_WRITEMASK=2968;a.STENCIL_BACK_FUNC=34816;a.STENCIL_BACK_FAIL=34817;a.STENCIL_BACK_PASS_DEPTH_FAIL=34818;a.STENCIL_BACK_PASS_DEPTH_PASS=34819;a.STENCIL_BACK_REF=36003;a.STENCIL_BACK_VALUE_MASK=36004;a.STENCIL_BACK_WRITEMASK=36005;a.VIEWPORT=2978;a.SCISSOR_BOX=3088;a.COLOR_CLEAR_VALUE=3106;a.COLOR_WRITEMASK=3107;a.UNPACK_ALIGNMENT=3317;a.PACK_ALIGNMENT=3333;a.MAX_TEXTURE_SIZE=3379;a.MAX_VIEWPORT_DIMS=3386;a.SUBPIXEL_BITS=3408;a.RED_BITS=3410;a.GREEN_BITS=3411;a.BLUE_BITS=3412;a.ALPHA_BITS=3413;a.DEPTH_BITS=3414;a.STENCIL_BITS=3415;a.POLYGON_OFFSET_UNITS=10752;a.POLYGON_OFFSET_FACTOR=32824;a.TEXTURE_BINDING_2D=32873;a.SAMPLE_BUFFERS=32936;a.SAMPLES=32937;a.SAMPLE_COVERAGE_VALUE=32938;a.SAMPLE_COVERAGE_INVERT=32939;a.NUM_COMPRESSED_TEXTURE_FORMATS=34466;a.COMPRESSED_TEXTURE_FORMATS=34467;a.DONT_CARE=4352;a.FASTEST=4353;a.NICEST=4354;a.GENERATE_MIPMAP_HINT=33170;a.BYTE=5120;a.UNSIGNED_BYTE=5121;a.SHORT=5122;a.UNSIGNED_SHORT=5123;a.INT=5124;a.UNSIGNED_INT=5125;a.FLOAT=5126;a.DEPTH_COMPONENT=6402;a.ALPHA=6406;a.RGB=6407;a.RGBA=6408;a.LUMINANCE=6409;a.LUMINANCE_ALPHA=6410;a.UNSIGNED_SHORT_4_4_4_4=32819;a.UNSIGNED_SHORT_5_5_5_1=32820;a.UNSIGNED_SHORT_5_6_5=33635;a.FRAGMENT_SHADER=35632;a.VERTEX_SHADER=35633;a.MAX_VERTEX_ATTRIBS=34921;a.MAX_VERTEX_UNIFORM_VECTORS=36347;a.MAX_VARYING_VECTORS=36348;a.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661;a.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660;a.MAX_TEXTURE_IMAGE_UNITS=34930;a.MAX_FRAGMENT_UNIFORM_VECTORS=36349;a.SHADER_TYPE=35663;a.DELETE_STATUS=35712;a.LINK_STATUS=35714;a.VALIDATE_STATUS=35715;a.ATTACHED_SHADERS=35717;a.ACTIVE_UNIFORMS=35718;a.ACTIVE_ATTRIBUTES=35721;a.SHADING_LANGUAGE_VERSION=35724;a.CURRENT_PROGRAM=35725;a.NEVER=512;a.LESS=513;a.EQUAL=514;a.LEQUAL=515;a.GREATER=516;a.NOTEQUAL=517;a.GEQUAL=518;a.ALWAYS=519;a.KEEP=7680;a.REPLACE=7681;a.INCR=7682;a.DECR=7683;a.INVERT=5386;a.INCR_WRAP=34055;a.DECR_WRAP=34056;a.VENDOR=7936;a.RENDERER=7937;a.VERSION=7938;a.NEAREST=9728;a.LINEAR=9729;a.NEAREST_MIPMAP_NEAREST=9984;a.LINEAR_MIPMAP_NEAREST=9985;a.NEAREST_MIPMAP_LINEAR=9986;a.LINEAR_MIPMAP_LINEAR=9987;a.TEXTURE_MAG_FILTER=10240;a.TEXTURE_MIN_FILTER=10241;a.TEXTURE_WRAP_S=10242;a.TEXTURE_WRAP_T=10243;a.TEXTURE_2D=3553;a.TEXTURE_3D=32879;a.TEXTURE=5890;a.TEXTURE_CUBE_MAP=34067;a.TEXTURE_BINDING_CUBE_MAP=34068;a.TEXTURE_CUBE_MAP_POSITIVE_X=34069;a.TEXTURE_CUBE_MAP_NEGATIVE_X=34070;a.TEXTURE_CUBE_MAP_POSITIVE_Y=34071;a.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072;a.TEXTURE_CUBE_MAP_POSITIVE_Z=34073;a.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074;a.MAX_CUBE_MAP_TEXTURE_SIZE=34076;a.TEXTURE0=33984;a.TEXTURE1=33985;a.TEXTURE2=33986;a.TEXTURE3=33987;a.TEXTURE4=33988;a.TEXTURE5=33989;a.TEXTURE6=33990;a.TEXTURE7=33991;a.TEXTURE8=33992;a.TEXTURE9=33993;a.TEXTURE10=33994;a.TEXTURE11=33995;a.TEXTURE12=33996;a.TEXTURE13=33997;a.TEXTURE14=33998;a.TEXTURE15=33999;a.TEXTURE16=34E3;a.TEXTURE17=34001;a.TEXTURE18=34002;a.TEXTURE19=34003;a.TEXTURE20=34004;a.TEXTURE21=34005;a.TEXTURE22=34006;a.TEXTURE23=34007;a.TEXTURE24=34008;a.TEXTURE25=34009;a.TEXTURE26=34010;a.TEXTURE27=34011;a.TEXTURE28=34012;a.TEXTURE29=34013;a.TEXTURE30=34014;a.TEXTURE31=34015;a.ACTIVE_TEXTURE=34016;a.REPEAT=10497;a.CLAMP_TO_EDGE=33071;a.MIRRORED_REPEAT=33648;a.FLOAT_VEC2=35664;a.FLOAT_VEC3=35665;a.FLOAT_VEC4=35666;a.INT_VEC2=35667;a.INT_VEC3=35668;a.INT_VEC4=35669;a.BOOL=35670;a.BOOL_VEC2=35671;a.BOOL_VEC3=35672;a.BOOL_VEC4=35673;a.FLOAT_MAT2=35674;a.FLOAT_MAT3=35675;a.FLOAT_MAT4=35676;a.SAMPLER_2D=35678;a.SAMPLER_CUBE=35680;a.VERTEX_ATTRIB_ARRAY_ENABLED=34338;a.VERTEX_ATTRIB_ARRAY_SIZE=34339;a.VERTEX_ATTRIB_ARRAY_STRIDE=34340;a.VERTEX_ATTRIB_ARRAY_TYPE=34341;a.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922;a.VERTEX_ATTRIB_ARRAY_POINTER=34373;a.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975;a.COMPILE_STATUS=35713;a.LOW_FLOAT=36336;a.MEDIUM_FLOAT=36337;a.HIGH_FLOAT=36338;a.LOW_INT=36339;a.MEDIUM_INT=36340;a.HIGH_INT=36341;a.FRAMEBUFFER=36160;a.RENDERBUFFER=36161;a.RGBA4=32854;a.RGB5_A1=32855;a.RGB565=36194;a.DEPTH_COMPONENT16=33189;a.STENCIL_INDEX=6401;a.STENCIL_INDEX8=36168;a.DEPTH_STENCIL=34041;a.RENDERBUFFER_WIDTH=36162;a.RENDERBUFFER_HEIGHT=36163;a.RENDERBUFFER_INTERNAL_FORMAT=36164;a.RENDERBUFFER_RED_SIZE=36176;a.RENDERBUFFER_GREEN_SIZE=36177;a.RENDERBUFFER_BLUE_SIZE=36178;a.RENDERBUFFER_ALPHA_SIZE=36179;a.RENDERBUFFER_DEPTH_SIZE=36180;a.RENDERBUFFER_STENCIL_SIZE=36181;a.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048;a.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049;a.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050;a.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051;a.COLOR_ATTACHMENT0=36064;a.DEPTH_ATTACHMENT=36096;a.STENCIL_ATTACHMENT=36128;a.DEPTH_STENCIL_ATTACHMENT=33306;a.NONE=0;a.FRAMEBUFFER_COMPLETE=36053;a.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054;a.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055;a.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057;a.FRAMEBUFFER_UNSUPPORTED=36061;a.FRAMEBUFFER_BINDING=36006;a.RENDERBUFFER_BINDING=36007;a.MAX_RENDERBUFFER_SIZE=34024;a.INVALID_FRAMEBUFFER_OPERATION=1286;a.UNPACK_FLIP_Y_WEBGL=37440;a.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441;a.CONTEXT_LOST_WEBGL=37442;a.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443;a.BROWSER_DEFAULT_WEBGL=37444;a._extTextureFilterAnisotropic=null;a._compressedTextureS3tc=null;a._compressedTexturePvrtc=null;a._compressedTextureEtc1=null;a._angleInstancedArrays=null;a._glTextureIDs=[33984,33985,33986,33987,33988,33989,33990,33991];a._useProgram=null;a._depthTest=!0;a._depthMask=!0;a._blend=!1;a._cullFace=!1;a._activedTextureID=33984;t(a,["_extentionVendorPrefixes",function(){return this._extentionVendorPrefixes=["","WEBKIT_","MOZ_"]},"_activeTextures",function(){return this._activeTextures=Array(8)},"_depthFunc",function(){return this._depthFunc=513},"_sFactor",function(){return this._sFactor=1},"_dFactor",function(){return this._dFactor=0},"_srcAlpha",function(){return this._srcAlpha=1},"_dstAlpha",function(){return this._dstAlpha=0},"_frontFace",function(){return this._frontFace=2305}]);return a}();(function(){function a(){}p(a,"laya.net.ResourceVersion");a.enable=function(c,b,d){void 0===d&&(d=2);laya.net.ResourceVersion.type=d;l.loader.load(c,S.create(null,a.onManifestLoaded,[b]),null,"json");M.customFormat=a.addVersionPrefix};a.onManifestLoaded=function(c,b){a.manifest=b;c.run();b||console.warn("\u8d44\u6e90\u7248\u672c\u6e05\u5355\u6587\u4ef6\u4e0d\u5b58\u5728\uff0c\u4e0d\u4f7f\u7528\u8d44\u6e90\u7248\u672c\u7ba1\u7406\u3002\u5ffd\u7565ERR_FILE_NOT_FOUND\u9519\u8bef\u3002")};a.addVersionPrefix=function(c){c=M.getAdptedFilePath(c);return a.manifest&&a.manifest[c]?2==a.type?a.manifest[c]:a.manifest[c]+"/"+c:c};a.FOLDER_VERSION=1;a.FILENAME_VERSION=2;a.manifest=null;a.type=1;return a})();var bc=function(){function a(){}p(a,"laya.display.cmd.FillWordsCmd");var c=a.prototype;c.recover=function(){this.words=null;w.recover("FillWordsCmd",this)};c.run=function(b,d,a){b.fillWords(this.words,this.x+d,this.y+a,this.font,this.color)};m(0,c,"cmdID",function(){return"FillWords"});a.create=function(b,d,c,f,g){var e=w.getItemByClass("FillWordsCmd",a);e.words=b;e.x=d;e.y=c;e.font=f;e.color=g;return e};a.ID="FillWords";return a}(),I=function(){function a(b,d,c,f,g,h,k){this._bTransform=!1;void 0===b&&(b=1);void 0===d&&(d=0);void 0===c&&(c=0);void 0===f&&(f=1);void 0===g&&(g=0);void 0===h&&(h=0);void 0===k&&(k=0);if(null!=a._createFun)return a._createFun(b,d,c,f,g,h,k);this.a=b;this.b=d;this.c=c;this.d=f;this.tx=g;this.ty=h;this._checkTransform()}p(a,"laya.maths.Matrix");var c=a.prototype;c.identity=function(){this.a=this.d=1;this.b=this.tx=this.ty=this.c=0;this._bTransform=!1;return this};c._checkTransform=function(){return this._bTransform=1!==this.a||0!==this.b||0!==this.c||1!==this.d};c.setTranslate=function(b,d){this.tx=b;this.ty=d;return this};c.translate=function(b,d){this.tx+=b;this.ty+=d;return this};c.scale=function(b,d){this.a*=b;this.d*=d;this.c*=b;this.b*=d;this.tx*=b;this.ty*=d;this._bTransform=!0;return this};c.rotate=function(b){var d=Math.cos(b);b=Math.sin(b);var a=this.a,c=this.c,g=this.tx;this.a=a*d-this.b*b;this.b=a*b+this.b*d;this.c=c*d-this.d*b;this.d=c*b+this.d*d;this.tx=g*d-this.ty*b;this.ty=g*b+this.ty*d;this._bTransform=!0;return this};c.skew=function(b,d){var a=Math.tan(b),c=Math.tan(d),g=this.a,h=this.b;this.a+=c*this.c;this.b+=c*this.d;this.c+=a*g;this.d+=a*h;return this};c.invertTransformPoint=function(b){var d=this.a,a=this.b,c=this.c,g=this.d,h=this.tx,k=d*g-a*c;return b.setTo(g/k*b.x+-c/k*b.y+(c*this.ty-g*h)/k,-a/k*b.x+d/k*b.y+-(d*this.ty-a*h)/k)};c.transformPoint=function(b){return b.setTo(this.a*b.x+this.c*b.y+this.tx,this.b*b.x+this.d*b.y+this.ty)};c.transformPointN=function(b){return b.setTo(this.a*b.x+this.c*b.y,this.b*b.x+this.d*b.y)};c.getScaleX=function(){return 0===this.b?this.a:Math.sqrt(this.a*this.a+this.b*this.b)};c.getScaleY=function(){return 0===this.c?this.d:Math.sqrt(this.c*this.c+this.d*this.d)};c.invert=function(){var b=this.a,d=this.b,a=this.c,c=this.d,g=this.tx,h=b*c-d*a;this.a=c/h;this.b=-d/h;this.c=-a/h;this.d=b/h;this.tx=(a*this.ty-c*g)/h;this.ty=-(b*this.ty-d*g)/h;return this};c.setTo=function(b,d,a,c,g,h){this.a=b;this.b=d;this.c=a;this.d=c;this.tx=g;this.ty=h;return this};c.concat=function(b){var d=this.a,a=this.c,c=this.tx;this.a=d*b.a+this.b*b.c;this.b=d*b.b+this.b*b.d;this.c=a*b.a+this.d*b.c;this.d=a*b.b+this.d*b.d;this.tx=c*b.a+this.ty*b.c+b.tx;this.ty=c*b.b+this.ty*b.d+b.ty;return this};c.scaleEx=function(b,d){var a=this.a,c=this.b,g=this.c,h=this.d;0!==c||0!==g?(this.a=b*a,this.b=b*c,this.c=d*g):(this.a=b*a,this.b=0*h,this.c=0*a);this.d=d*h;this._bTransform=!0};c.rotateEx=function(b){var d=Math.cos(b);b=Math.sin(b);var a=this.a,c=this.b,g=this.c,h=this.d;0!==c||0!==g?(this.a=d*a+b*g,this.b=d*c+b*h,this.c=-b*a+d*g,this.d=-b*c+d*h):(this.a=d*a,this.b=b*h,this.c=-b*a,this.d=d*h);this._bTransform=!0};c.clone=function(){var b=a.create();b.a=this.a;b.b=this.b;b.c=this.c;b.d=this.d;b.tx=this.tx;b.ty=this.ty;b._bTransform=this._bTransform;return b};c.copyTo=function(b){b.a=this.a;b.b=this.b;b.c=this.c;b.d=this.d;b.tx=this.tx;b.ty=this.ty;b._bTransform=this._bTransform;return b};c.toString=function(){return this.a+","+this.b+","+this.c+","+this.d+","+this.tx+","+this.ty};c.destroy=function(){this.recover()};c.recover=function(){w.recover("Matrix",this.identity())};a.mul=function(b,d,a){var c=b.a,e=b.b,h=b.c,k=b.d,n=b.tx;b=b.ty;var q=d.a,u=d.b,l=d.c,m=d.d,p=d.tx;d=d.ty;0!==u||0!==l?(a.a=c*q+e*l,a.b=c*u+e*m,a.c=h*q+k*l,a.d=h*u+k*m,a.tx=q*n+l*b+p,a.ty=u*n+m*b+d):(a.a=c*q,a.b=e*m,a.c=h*q,a.d=k*m,a.tx=q*n+p,a.ty=m*b+d);return a};a.mul16=function(b,d,a){var c=b.a,e=b.b,h=b.c,k=b.d,n=b.tx;b=b.ty;var q=d.a,u=d.b,l=d.c,m=d.d,p=d.tx;d=d.ty;0!==u||0!==l?(a[0]=c*q+e*l,a[1]=c*u+e*m,a[4]=h*q+k*l,a[5]=h*u+k*m,a[12]=q*n+l*b+p,a[13]=u*n+m*b+d):(a[0]=c*q,a[1]=e*m,a[4]=h*q,a[5]=k*m,a[12]=q*n+p,a[13]=m*b+d);return a};a.create=function(){return w.getItemByClass("Matrix",a)};a.EMPTY=new a;a.TEMP=new a;a._createFun=null;return a}(),cc=function(){function a(a,b,d,e){this.id=0;this.name=null;this.color=0;this.scale=1;this.datapos=0;this.datas=Array(pb.DATANUM);this.id=a;this.color=b;this.name=d;this.scale=e}p(a,"laya.utils.PerfData");a.prototype.addData=function(a){this.datas[this.datapos]=a;this.datapos++;this.datapos%=pb.DATANUM};return a}(),dc=function(){function a(){}p(a,"laya.display.cmd.TransformCmd");var c=a.prototype;c.recover=function(){this.matrix=null;w.recover("TransformCmd",this)};c.run=function(b,d,a){b._transform(this.matrix,this.pivotX+d,this.pivotY+a)};m(0,c,"cmdID",function(){return"Transform"});a.create=function(b,d,c){var e=w.getItemByClass("TransformCmd",a);e.matrix=b;e.pivotX=d;e.pivotY=c;return e};a.ID="Transform";return a}(),ec=function(){function a(){}p(a,"laya.display.cmd.DrawTexturesCmd");var c=a.prototype;c.recover=function(){this.texture._removeReference();this.pos=this.texture=null;w.recover("DrawTexturesCmd",this)};c.run=function(b,d,a){b.drawTextures(this.texture,this.pos,d,a)};m(0,c,"cmdID",function(){return"DrawTextures"});a.create=function(b,d){var c=w.getItemByClass("DrawTexturesCmd",a);c.texture=b;b._addReference();c.pos=d;return c};a.ID="DrawTextures";return a}(),fc=function(){function a(){}p(a,"laya.display.cmd.DrawCircleCmd");var c=a.prototype;c.recover=function(){this.lineColor=this.fillColor=null;w.recover("DrawCircleCmd",this)};c.run=function(b,d,a){b._drawCircle(this.x+d,this.y+a,this.radius,this.fillColor,this.lineColor,this.lineWidth,this.vid)};m(0,c,"cmdID",function(){return"DrawCircle"});a.create=function(b,d,c,f,g,h,k){var e=w.getItemByClass("DrawCircleCmd",a);e.x=b;e.y=d;e.radius=c;e.fillColor=f;e.lineColor=g;e.lineWidth=h;e.vid=k;return e};a.ID="DrawCircle";return a}(),V=function(){function a(){this._drawTriUseAbsMatrix=!1;this._id=++a._COUNT;this._other=null;this._renderNextSubmitIndex=0;this._path=null;this._drawCount=1;this._renderCount=0;this._isConvexCmd=!0;this._triangleMesh=this._pathMesh=this._mesh=this._curSubmit=this._submits=null;this.meshlist=[];this._clipInCache=!1;this._clipInfoID=0;this._curMat=null;this._lastMat_a=this._lastMatScaleY=this._lastMatScaleX=1;this._lastMat_c=this._lastMat_b=0;this._lastMat_d=1;this._nBlendType=0;this.sprite=this._saveMark=this._charSubmitCache=this._targets=this._save=null;this._italicDeg=0;this._lastTex=null;this._flushCnt=this._fillColor=0;this._colorFiler=this.defTexture=null;this.isMain=this._incache=this.drawTexAlign=!1;this._tmpMatrix=new I;this._drawTexToDrawTri_Vert=new Float32Array(8);this._drawTexToDrawTri_Index=new Uint16Array([0,1,2,0,2,3]);this._tempUV=new Float32Array(8);this._height=this._width=99999999;this._submitKey=new Ia;this._transedPoints=Array(8);this._temp4Points=Array(8);this._clipRect=a.MAXCLIPRECT;this._globalClipMatrix=new I(99999999,0,0,99999999,0,0);this._shader2D=new Va;a._contextcount++;if(!this.defTexture){var d=new pa(2,2);d.setPixels(new Uint8Array(16));d.lock=!0;this.defTexture=new X(d)}this._lastTex=this.defTexture;this.clear()}var c;p(a,"laya.resource.Context");var b=a.prototype;b.drawImage=function(d){};b.getImageData=function(d){};b.measureText=function(d){return null};b.setTransform=function(d){};b.$transform=function(d,b,a,c,h,k){};b.clearRect=function(d,b,a,c){};b._drawRect=function(d,b,a,c,h){J.renderBatches++;h&&(this.fillStyle=h);this.fillRect(d,b,a,c)};b.drawTexture2=function(d,b,a,c,h,k){};b.transformByMatrix=function(d,b,a){this.transform(d.a,d.b,d.c,d.d,d.tx+b,d.ty+a)};b.saveTransform=function(d){this.save()};b.restoreTransform=function(d){this.restore()};b.drawRect=function(d,b,a,c,h,k,n){null!=h&&(this.fillStyle=h,this.fillRect(d,b,a,c));null!=k&&(this.strokeStyle=k,this.lineWidth=n,this.strokeRect(d,b,a,c))};b.alpha=function(d){this.globalAlpha*=d};b._transform=function(d,b,a){this.translate(b,a);this.transform(d.a,d.b,d.c,d.d,d.tx,d.ty);this.translate(-b,-a)};b._rotate=function(d,b,a){this.translate(b,a);this.rotate(d);this.translate(-b,-a)};b._scale=function(d,b,a,c){this.translate(a,c);this.scale(d,b);this.translate(-a,-c)};b._drawLine=function(d,b,a,c,h,k,n,q,u){this.beginPath();this.strokeStyle=n;this.lineWidth=q;this.moveTo(d+a,b+c);this.lineTo(d+h,b+k);this.stroke()};b._drawLines=function(d,b,a,c,h,k){this.beginPath();this.strokeStyle=c;this.lineWidth=h;this.addPath(a.slice(),!1,!1,d,b);this.stroke()};b.drawCurves=function(d,b,a,c,h){this.beginPath();this.strokeStyle=c;this.lineWidth=h;this.moveTo(d+a[0],b+a[1]);c=2;for(h=a.length;c<h;)this.quadraticCurveTo(d+a[c++],b+a[c++],d+a[c++],b+a[c++]);this.stroke()};b._fillAndStroke=function(d,b,a,c){null!=d&&(this.fillStyle=d,this.fill());null!=b&&0<a&&(this.strokeStyle=b,this.lineWidth=a,this.stroke())};b._drawCircle=function(d,b,c,g,h,k,n){J.renderBatches++;this.beginPath(!0);this.arc(d,b,c,0,a.PI2);this.closePath();this._fillAndStroke(g,h,k)};b._drawPie=function(d,b,a,c,h,k,n,q,u){this.beginPath();this.moveTo(d,b);this.arc(d,b,a,c,h);this.closePath();this._fillAndStroke(k,n,q)};b._drawPoly=function(d,b,a,c,h,k,n,q){this.beginPath();this.addPath(a.slice(),!0,n,d,b);this.closePath();this._fillAndStroke(c,h,k,n)};b._drawPath=function(d,b,a,c,h){this.beginPath();for(var e=0,f=a.length;e<f;e++){var g=a[e];switch(g[0]){case "moveTo":this.moveTo(d+g[1],b+g[2]);break;case "lineTo":this.lineTo(d+g[1],b+g[2]);break;case "arcTo":this.arcTo(d+g[1],b+g[2],d+g[3],b+g[4],g[5]);break;case "closePath":this.closePath()}}null!=c&&(this.fillStyle=c.fillStyle,this.fill());null!=h&&(this.strokeStyle=h.strokeStyle,this.lineWidth=h.lineWidth||1,this.lineJoin=h.lineJoin,this.lineCap=h.lineCap,this.miterLimit=h.miterLimit,this.stroke())};b.clearBG=function(d,b,a,c){var e=E.mainContext;e.clearColor(d,b,a,c);e.clear(16384)};b._getSubmits=function(){return this._submits};b._releaseMem=function(d){void 0===d&&(d=!1);if(this._submits){this._curMat.destroy();this._curMat=null;this._shader2D.destroy();this._shader2D=null;this._charSubmitCache.clear();for(var b=0,a=this._submits._length;b<a;b++)this._submits[b].releaseRender();this._submits.length=0;this._submits._length=0;this._save=this._path=this._curSubmit=this._submits=null;b=0;for(a=this.meshlist.length;b<a;b++)this.meshlist[b].destroy();this.meshlist.length=0;this.sprite=null;d||(this._targets&&this._targets.destroy(),this._targets=null)}};b.destroy=function(d){void 0===d&&(d=!1);--a._contextcount;this.sprite=null;this._releaseMem(d);this._charSubmitCache.destroy();this._mesh.destroy();d||(this._targets&&this._targets.destroy(),this._targets=null)};b.clear=function(){this._submits||(this._other=c.DEFAULT,this._curMat=I.create(),this._charSubmitCache=new gc,this._mesh=la.getAMesh(this.isMain),this.meshlist.push(this._mesh),this._pathMesh=Ca.getAMesh(this.isMain),this.meshlist.push(this._pathMesh),this._triangleMesh=Pa.getAMesh(this.isMain),this.meshlist.push(this._triangleMesh),this._submits=[],this._save=[ob.Create(this)],this._save.length=10,this._shader2D=new Va);this._submitKey.clear();this._mesh.clearVB();this._renderCount++;this._drawCount=1;this._other=c.DEFAULT;this._other.lineWidth=this._shader2D.ALPHA=1;this._nBlendType=0;this._clipRect=a.MAXCLIPRECT;this._curSubmit=z.RENDERBASE;z.RENDERBASE._ref=16777215;z.RENDERBASE._numEle=0;this._shader2D.fillStyle=this._shader2D.strokeStyle=Aa.DEFAULT;for(var d=0,b=this._submits._length;d<b;d++)this._submits[d].releaseRender();this._submits._length=0;this._curMat.identity();this._other.clear();this._saveMark=this._save[0];this._save._length=1};b.size=function(d,b){if(this._width!=d||this._height!=b)this._width=d,this._height=b,this._targets&&(this._targets.destroy(),this._targets=new ca(d,b,1,-1)),v._context==this&&(E.mainContext.viewport(0,0,d,b),F.width=d,F.height=b);0===d&&0===b&&this._releaseMem()};b.getMatScaleX=function(){if(this._lastMat_a==this._curMat.a&&this._lastMat_b==this._curMat.b)return this._lastMatScaleX;this._lastMatScaleX=this._curMat.getScaleX();this._lastMat_a=this._curMat.a;this._lastMat_b=this._curMat.b;return this._lastMatScaleX};b.getMatScaleY=function(){if(this._lastMat_c==this._curMat.c&&this._lastMat_d==this._curMat.d)return this._lastMatScaleY;this._lastMatScaleY=this._curMat.getScaleY();this._lastMat_c=this._curMat.c;this._lastMat_d=this._curMat.d;return this._lastMatScaleY};b.setFillColor=function(d){this._fillColor=d};b.getFillColor=function(){return this._fillColor};b.translate=function(d,b){if(0!==d||0!==b)Zb.save(this),this._curMat._bTransform?(Qa.save(this),this._curMat.tx+=d*this._curMat.a+b*this._curMat.c,this._curMat.ty+=d*this._curMat.b+b*this._curMat.d):(this._curMat.tx=d,this._curMat.ty=b)};b.save=function(){this._save[this._save._length++]=ob.Create(this)};b.restore=function(){var d=this._save._length,b=this._nBlendType;if(!(1>d)){for(--d;0<=d;d--){var a=this._save[d];a.restore(this);if(a.isSaveMark()){this._save._length=d;return}}b!=this._nBlendType&&(this._curSubmit=z.RENDERBASE)}};b.fillText=function(d,b,a,c,h,k){this._fillText(d,null,b,a,c,h,null,0,null)};b._fillText=function(d,b,c,g,h,k,n,q,u,l){void 0===l&&(l=0);d?a._textRender.filltext(this,d,c,g,h,k,n,q,u,l):b&&a._textRender.fillWords(this,b,c,g,h,k,n,q)};b._fast_filltext=function(d,b,c,g,h,k,n,q,u){void 0===u&&(u=0);a._textRender._fast_filltext(this,d,null,b,c,g,h,k,n,q,u)};b.fillWords=function(d,b,a,c,h){this._fillText(null,d,b,a,c,h,null,-1,null,0)};b.fillBorderWords=function(d,b,a,c,h,k,n){this._fillBorderText(null,d,b,a,c,h,k,n,null)};b.drawText=function(b,a,c,g,h,k){this._fillText(b,null,a,c,g,x.create(h).strColor,null,-1,k)};b.strokeWord=function(b,a,c,g,h,k,n){this._fillText(b,null,a,c,g,null,x.create(h).strColor,k||1,n)};b.fillBorderText=function(b,a,c,g,h,k,n,q){this._fillBorderText(b,null,a,c,g,x.create(h).strColor,x.create(k).strColor,n,q)};b._fillBorderText=function(b,a,c,g,h,k,n,q,u){this._fillText(b,a,c,g,h,k,n,q||1,u)};b._fillRect=function(b,a,c,g,h){var d=this._curSubmit,e=d&&2===d._key.submitType&&d._key.blendShader===this._nBlendType;65535<this._mesh.vertNum+4&&(this._mesh=la.getAMesh(this.isMain),this.meshlist.push(this._mesh),e=!1);e&&(e=e&&this.isSameClipInfo(d));this.transformQuad(b,a,c,g,0,this._curMat,this._transedPoints);this.clipedOff(this._transedPoints)||(this._mesh.addQuad(this._transedPoints,X.NO_UV,h,!1),e||(d=this._curSubmit=qa.create(this,this._mesh,U.create(1,0)),this._submits[this._submits._length++]=d,this._copyClipInfo(d,this._globalClipMatrix),d.shaderValue.textureHost=this._lastTex,d._key.other=this._lastTex&&this._lastTex.bitmap?this._lastTex.bitmap.id:-1,d._renderType=10016),this._curSubmit._numEle+=6,this._mesh.indexNum+=6,this._mesh.vertNum+=4)};b.fillRect=function(b,a,c,g,h){h=h?Aa.create(h):this._shader2D.fillStyle;h=this.mixRGBandAlpha(h.toInt());this._fillRect(b,a,c,g,h)};b.fillTexture=function(b,a,c,g,h,k,n,q){b._getSource()?this._fillTexture(b,b.width,b.height,b.uvrect,a,c,g,h,k,n.x,n.y):this.sprite&&l.systemTimer.callLater(this,this._repaintSprite)};b._fillTexture=function(b,a,c,g,h,k,n,q,u,l,m){65535<this._mesh.vertNum+4&&(this._mesh=la.getAMesh(this.isMain),this.meshlist.push(this._mesh));var d=!0,e=!0;switch(u){case "repeat-x":e=!1;break;case "repeat-y":d=!1;break;case "no-repeat":d=e=!1}u=this._temp4Points;var f=0,B=0,p,na;0>l?(p=h,f=-l%a/a):p=h+l;0>m?(na=k,B=-m%c/c):na=k+m;n=h+n;q=k+q;!d&&(n=Math.min(n,h+l+a));!e&&(q=Math.min(q,k+m+c));n<h||q<k||p>n||na>q||(a=(n-h-l)/a,c=(q-k-m)/c,this.transformQuad(p,na,n-p,q-na,0,this._curMat,this._transedPoints),u[0]=f,u[1]=B,u[2]=a,u[3]=B,u[4]=a,u[5]=c,u[6]=f,u[7]=c,this.clipedOff(this._transedPoints)||(c=this._mixRGBandAlpha(4294967295,this._shader2D.ALPHA),this._mesh.addQuad(this._transedPoints,u,c,!0),u=U.create(1,0),u.defines.add(256),u.u_TexRange=g,g=this._curSubmit=qa.create(this,this._mesh,u),this._submits[this._submits._length++]=g,this._copyClipInfo(g,this._globalClipMatrix),g.shaderValue.textureHost=b,g._renderType=10016,this._curSubmit._numEle+=6,this._mesh.indexNum+=6,this._mesh.vertNum+=4),this.breakNextMerge())};b.setColorFilter=function(b){R.save(this,8388608,this,!0);this._colorFiler=b;this._curSubmit=z.RENDERBASE};b.drawTexture=function(b,a,c,g,h){this._drawTextureM(b,a,c,g,h,null,1,null)};b.drawTextures=function(b,a,c,g){if(b._getSource())for(var d=a.length/2,e=0,f=b.bitmap.id,q=0;q<d;q++)this._inner_drawTexture(b,f,a[e++]+c,a[e++]+g,0,0,null,null,1,!1);else this.sprite&&l.systemTimer.callLater(this,this._repaintSprite)};b._drawTextureAddSubmit=function(b,a){var d;d=qa.create(this,this._mesh,U.create(1,0));this._submits[this._submits._length++]=d;d.shaderValue.textureHost=a;d._key.other=b;d._renderType=10016;this._curSubmit=d};b._drawTextureM=function(b,a,c,g,h,k,n,q){var d=this.sprite;return b._getSource(function(){d&&d.repaint()})?this._inner_drawTexture(b,b.bitmap.id,a,c,g,h,k,q,n,!1):!1};b._drawRenderTexture=function(b,a,c,g,h,k,n,q){return this._inner_drawTexture(b,-1,a,c,g,h,k,q,1,!1)};b.submitDebugger=function(){this._submits[this._submits._length++]=ba.create([],function(){debugger},this)};b._copyClipInfo=function(b,a){var d=b.shaderValue.clipMatDir;d[0]=a.a;d[1]=a.b;d[2]=a.c;d[3]=a.d;d=b.shaderValue.clipMatPos;d[0]=a.tx;d[1]=a.ty;b.clipInfoID=this._clipInfoID;this._clipInCache&&(b.shaderValue.clipOff[0]=1)};b.isSameClipInfo=function(b){return b.clipInfoID===this._clipInfoID};b._useNewTex2DSubmit=function(b,a){65535<this._mesh.vertNum+a&&(this._mesh=la.getAMesh(this.isMain),this.meshlist.push(this._mesh));var d=qa.create(this,this._mesh,U.create(1,0));this._submits[this._submits._length++]=this._curSubmit=d;d.shaderValue.textureHost=b;this._copyClipInfo(d,this._globalClipMatrix)};b._drawTexRect=function(b,a,c,g,h){this.transformQuad(b,a,c,g,this._italicDeg,this._curMat,this._transedPoints);b=this._transedPoints;b[0]=b[0]+.5|0;b[1]=b[1]+.5|0;b[2]=b[2]+.5|0;b[3]=b[3]+.5|0;b[4]=b[4]+.5|0;b[5]=b[5]+.5|0;b[6]=b[6]+.5|0;b[7]=b[7]+.5|0;this.clipedOff(this._transedPoints)||(this._mesh.addQuad(this._transedPoints,h,this._fillColor,!0),this._curSubmit._numEle+=6,this._mesh.indexNum+=6,this._mesh.vertNum+=4)};b.drawCallOptimize=function(b){this._charSubmitCache.enable(b,this);return b};b._inner_drawTexture=function(b,a,c,g,h,k,n,q,u,l){var d=this._curSubmit._key;q=q||b._uv;if(4===d.submitType&&d.other===a){a=this._drawTexToDrawTri_Vert;a[0]=c;a[1]=g;a[2]=c+h;a[3]=g;a[4]=c+h;a[5]=g+k;a[6]=c;a[7]=g+k;this._drawTriUseAbsMatrix=!0;var e=this._tempUV;e[0]=q[0];e[1]=q[1];e[2]=q[2];e[3]=q[3];e[4]=q[4];e[5]=q[5];e[6]=q[6];e[7]=q[7];this.drawTriangles(b,0,0,a,e,this._drawTexToDrawTri_Index,n,u,null,null);this._drawTriUseAbsMatrix=!1;return!0}var e=this._mesh,f=this._curSubmit,m=l?this._charSubmitCache.getPos():this._transedPoints;this.transformQuad(c,g,h||b.width,k||b.height,this._italicDeg,n||this._curMat,m);this.drawTexAlign&&(n=Math.round,m[0]=n(m[0]),m[1]=n(m[1]),m[2]=n(m[2]),m[3]=n(m[3]),m[4]=n(m[4]),m[5]=n(m[5]),m[6]=n(m[6]),m[7]=n(m[7]),this.drawTexAlign=!1);u=this._mixRGBandAlpha(4294967295,this._shader2D.ALPHA*u);if(l)return this._charSubmitCache.add(this,b,a,m,q,u),!0;this._drawCount++;(n=0<=a&&2===d.submitType&&d.other===a)&&(n=n&&this.isSameClipInfo(f));this._lastTex=b;65535<e.vertNum+4&&(e=this._mesh=la.getAMesh(this.isMain),this.meshlist.push(e),n=!1);e.addQuad(m,q,u,!0);n||(this._submits[this._submits._length++]=this._curSubmit=f=qa.create(this,e,U.create(1,0)),f.shaderValue.textureHost=b,f._key.other=a,this._copyClipInfo(f,this._globalClipMatrix));f._numEle+=6;e.indexNum+=6;e.vertNum+=4;return!0};b.transform4Points=function(b,a,c){var d=a.tx,e=a.ty,f=a.a,n=a.b,q=a.c,u=a.d,l=b[0],m=b[1],p=b[2],r=b[3],t=b[4],v=b[5],w=b[6];b=b[7];a._bTransform?(c[0]=l*f+m*q+d,c[1]=l*n+m*u+e,c[2]=p*f+r*q+d,c[3]=p*n+r*u+e,c[4]=t*f+v*q+d,c[5]=t*n+v*u+e,c[6]=w*f+b*q+d,c[7]=w*n+b*u+e):(c[0]=l+d,c[1]=m+e,c[2]=p+d,c[3]=r+e,c[4]=t+d,c[5]=v+e,c[6]=w+d,c[7]=b+e)};b.clipedOff=function(b){return 0>=this._clipRect.width||0>=this._clipRect.height?!0:!1};b.transformQuad=function(b,a,c,g,h,k,n){var d=0;0!=h&&(d=Math.tan(h*Math.PI/180)*g);c=b+c;g=a+g;h=k.tx;var e=k.ty,f=k.a,l=k.b,m=k.c,p=k.d,r=b+d,d=c+d;k._bTransform?(n[0]=r*f+a*m+h,n[1]=r*l+a*p+e,n[2]=d*f+a*m+h,n[3]=d*l+a*p+e,n[4]=c*f+g*m+h,n[5]=c*l+g*p+e,n[6]=b*f+g*m+h,n[7]=b*l+g*p+e):(n[0]=r+h,n[1]=a+e,n[2]=d+h,n[3]=a+e,n[4]=c+h,n[5]=g+e,n[6]=b+h,n[7]=g+e)};b.pushRT=function(){this.addRenderObject(ba.create(null,ca.pushRT,this))};b.popRT=function(){this.addRenderObject(ba.create(null,ca.popRT,this));this.breakNextMerge()};b.useRT=function(b){this.addRenderObject(ba.create([b],function(b){if(b)b.start(),b.clear(0,0,0,0);else throw"error useRT";},this));this.breakNextMerge()};b.RTRestore=function(b){this.addRenderObject(ba.create([b],function(b){b.restore()},this));this.breakNextMerge()};b.breakNextMerge=function(){this._curSubmit=z.RENDERBASE};b._repaintSprite=function(){this.sprite&&this.sprite.repaint()};b.drawTextureWithTransform=function(b,a,c,g,h,k,n,q,u,l,m){var d=null,e=this._curMat;l&&(d=this.globalCompositeOperation,this.globalCompositeOperation=l);var f=this._colorFiler;m&&this.setColorFilter(m);if(k){var B=this._tmpMatrix;B.a=k.a;B.b=k.b;B.c=k.c;B.d=k.d;B.tx=k.tx+n;B.ty=k.ty+q;B._bTransform=k._bTransform;k&&e._bTransform?(I.mul(B,e,B),k=B,k._bTransform=!0):(B.tx+=e.tx,B.ty+=e.ty,k=B);this._drawTextureM(b,a,c,g,h,k,u,null)}else this._drawTextureM(b,a+n,c+q,g,h,e,u,null);l&&(this.globalCompositeOperation=d);m&&this.setColorFilter(f)};b._flushToTarget=function(b,a){F.worldScissorTest=!1;E.mainContext.disable(3089);var d=F.worldAlpha,c=F.worldMatrix4,e=F.worldMatrix;F.worldMatrix=I.EMPTY;F.restoreTempArray();F.worldMatrix4=F.TEMPMAT4_ARRAY;F.worldAlpha=1;aa.activeShader=null;a.start();0<b._submits._length&&a.clear(0,0,0,0);b._curSubmit=z.RENDERBASE;b.flush();b.clear();a.restore();b._curSubmit=z.RENDERBASE;aa.activeShader=null;F.worldAlpha=d;F.worldMatrix4=c;F.worldMatrix=e};b.drawCanvas=function(b,a,c,g,h){if(b){var d=b.context,e;d._targets?(0<d._submits._length&&(e=ba.create([d,d._targets],this._flushToTarget,this),this._submits[this._submits._length++]=e),this._drawRenderTexture(d._targets,a,c,g,h,null,1,ca.flipyuv)):(b.touches&&b.touches.forEach(function(b){b.touch()}),e=qb.create(b,this._shader2D.ALPHA,this._shader2D.filters),this._submits[this._submits._length++]=e,e._key.clear(),g=e._matrix,this._curMat.copyTo(g),h=g.tx,d=g.ty,g.tx=g.ty=0,g.transformPoint(N.TEMP.setTo(a,c)),g.translate(N.TEMP.x+h,N.TEMP.y+d),I.mul(b.invMat,g,g));this._curSubmit=z.RENDERBASE}};b.drawTarget=function(b,a,c,g,h,k,n,q,u){void 0===u&&(u=-1);this._drawCount++;65535<this._mesh.vertNum+4&&(this._mesh=la.getAMesh(this.isMain),this.meshlist.push(this._mesh));this.transformQuad(a,c,g,h,0,k||this._curMat,this._transedPoints);if(!this.clipedOff(this._transedPoints))return this._mesh.addQuad(this._transedPoints,q||X.DEF_UV,4294967295,!0),b=this._curSubmit=eb.create(this,this._mesh,n,b),b.blendType=-1==u?this._nBlendType:u,this._copyClipInfo(b,this._globalClipMatrix),b._numEle=6,this._mesh.indexNum+=6,this._mesh.vertNum+=4,this._submits[this._submits._length++]=b,this._curSubmit=z.RENDERBASE,!0;this._curSubmit=z.RENDERBASE;return!1};b.drawTriangles=function(b,a,c,g,h,k,n,q,u,m){if(b._getSource()){this._drawCount++;m=this._tmpMatrix;var d=this._triangleMesh,e=null,f=!1;u&&(e=this._colorFiler,this._colorFiler=u,this._curSubmit=z.RENDERBASE,f=e!=u);u=b.bitmap;var B=this._curSubmit._key,B=4===B.submitType&&B.other===u.id&&B.blendShader==this._nBlendType;65535<d.vertNum+g.length/2&&(d=this._triangleMesh=Pa.getAMesh(this.isMain),this.meshlist.push(d),B=!1);B||(B=this._curSubmit=qa.create(this,d,U.create(1,0)),B.shaderValue.textureHost=b,B._renderType=10016,B._key.submitType=4,B._key.other=u.id,this._copyClipInfo(B,this._globalClipMatrix),this._submits[this._submits._length++]=B);b=this._mixRGBandAlpha(4294967295,this._shader2D.ALPHA*q);this._drawTriUseAbsMatrix?d.addData(g,h,k,n,b):(n?(m.a=n.a,m.b=n.b,m.c=n.c,m.d=n.d,m.tx=n.tx+a,m.ty=n.ty+c):(m.a=1,m.b=0,m.c=0,m.d=1,m.tx=a,m.ty=c),I.mul(m,this._curMat,m),d.addData(g,h,k,m,b));this._curSubmit._numEle+=k.length;f&&(this._colorFiler=e,this._curSubmit=z.RENDERBASE)}else this.sprite&&l.systemTimer.callLater(this,this._repaintSprite)};b.transform=function(b,a,c,g,h,k){Qa.save(this);I.mul(I.TEMP.setTo(b,a,c,g,h,k),this._curMat,this._curMat);this._curMat._checkTransform()};b._transformByMatrix=function(b,a,c){b.setTranslate(a,c);I.mul(b,this._curMat,this._curMat);b.setTranslate(0,0);this._curMat._bTransform=!0};b.setTransformByMatrix=function(b){b.copyTo(this._curMat)};b.rotate=function(b){Qa.save(this);this._curMat.rotateEx(b)};b.scale=function(b,a){Qa.save(this);this._curMat.scaleEx(b,a)};b.clipRect=function(b,c,f,g){hc.save(this);this._clipRect==a.MAXCLIPRECT?this._clipRect=new K(b,c,f,g):(this._clipRect.width=f,this._clipRect.height=g,this._clipRect.x=b,this._clipRect.y=c);a._clipID_Gen++;a._clipID_Gen%=1E4;this._clipInfoID=a._clipID_Gen;b=this._globalClipMatrix;c=b.tx;f=b.ty;g=c+b.a;var d=f+b.d;99999999<=this._clipRect.width?(b.a=b.d=99999999,b.b=b.c=b.tx=b.ty=0):(this._curMat._bTransform?(b.tx=this._clipRect.x*this._curMat.a+this._clipRect.y*this._curMat.c+this._curMat.tx,b.ty=this._clipRect.x*this._curMat.b+this._clipRect.y*this._curMat.d+this._curMat.ty,b.a=this._clipRect.width*this._curMat.a,b.b=this._clipRect.width*this._curMat.b,b.c=this._clipRect.height*this._curMat.c,b.d=this._clipRect.height*this._curMat.d):(b.tx=this._clipRect.x+this._curMat.tx,b.ty=this._clipRect.y+this._curMat.ty,b.a=this._clipRect.width,b.b=b.c=0,b.d=this._clipRect.height),this._incache&&(this._clipInCache=!0));if(0<b.a&&0<b.d){var e=b.tx+b.a,n=b.ty+b.d;e<=c||n<=f||b.tx>=g||b.ty>=d?(b.a=-.1,b.d=-.1):(b.tx<c&&(b.a-=c-b.tx,b.tx=c),e>g&&(b.a-=e-g),b.ty<f&&(b.d-=f-b.ty,b.ty=f),n>d&&(b.d-=n-d),0>=b.a&&(b.a=-.1),0>=b.d&&(b.d=-.1))}};b.drawMesh=function(b,a,c,g,h,k,n,q,u){};b.addRenderObject=function(b){this._submits[this._submits._length++]=b};b.submitElement=function(b,a){var d=this._submits,c=d._length;0>a&&(a=d._length);for(var e=z.RENDERBASE;b<a;)this._renderNextSubmitIndex=b+1,d[b]===z.RENDERBASE?b++:(z.preRender=e,e=d[b],b+=e.renderSubmit());return c};b.flush=function(){var b=this.submitElement(0,this._submits._length);this._path&&this._path.reset();ib.instance&&ib.getInstance().reset();this._curSubmit=z.RENDERBASE;for(var a=0,c=this.meshlist.length;a<c;a++){var g=this.meshlist[a];g.canReuse?g.releaseMesh():g.destroy()}this.meshlist.length=0;this._mesh=la.getAMesh(this.isMain);this._pathMesh=Ca.getAMesh(this.isMain);this._triangleMesh=Pa.getAMesh(this.isMain);this.meshlist.push(this._mesh,this._pathMesh,this._triangleMesh);this._flushCnt++;0==this._flushCnt%60&&v._context==this&&Y.textRenderInst&&Y.textRenderInst.GC();return b};b.beginPath=function(b){void 0===b&&(b=!1);this._getPath().beginPath(b)};b.closePath=function(){this._path.closePath()};b.addPath=function(b,a,c,g,h){for(var d=a=0,e=b.length/2;d<e;d++){var f=b[a+1]+h;b[a]+=g;b[a+1]=f;a+=2}this._getPath().push(b,c)};b.fill=function(){var b=this._curMat,a=this._getPath(),c=this._curSubmit,g=3===c._key.submitType&&c._key.blendShader===this._nBlendType;g&&(g=g&&this.isSameClipInfo(c));g||(this._curSubmit=this.addVGSubmit(this._pathMesh));for(var c=this.mixRGBandAlpha(this.fillStyle.toInt()),g=0,h,k=0,n=a.paths.length;k<n;k++){h=a.paths[k];var q=h.path.length/2;if(!(3>q||3==q&&!h.convex)){var u=h.path.concat(),l,m,p,r,t;if(b._bTransform)for(l=0;l<q;l++)m=l<<1,p=m+1,r=u[m],t=u[p],u[m]=b.a*r+b.c*t+b.tx,u[p]=b.b*r+b.d*t+b.ty;else for(l=0;l<q;l++)m=l<<1,p=m+1,r=u[m],t=u[p],u[m]=r+b.tx,u[p]=t+b.ty;65535<this._pathMesh.vertNum+q&&(this._curSubmit._numEle+=g,g=0,this._pathMesh=Ca.getAMesh(this.isMain),this._curSubmit=this.addVGSubmit(this._pathMesh));l=this._pathMesh.vertNum;if(h.convex)for(q-=2,h=Array(3*q),p=m=0;p<q;p++)h[m++]=l,h[m++]=p+1+l,h[m++]=p+2+l;else if(h=ic.earcut(u,null,2),0<l)for(q=0;q<h.length;q++)h[q]+=l;this._pathMesh.addVertAndIBToMesh(this,u,c,h);g+=h.length}}this._curSubmit._numEle+=g};b.addVGSubmit=function(b){b=z.createShape(this,b,0,U.create(4,0));b._key.submitType=3;this._submits[this._submits._length++]=b;this._copyClipInfo(b,this._globalClipMatrix);return b};b.stroke=function(){if(0<this.lineWidth){var b=this.mixRGBandAlpha(this.strokeStyle._color.numColor),a=this._getPath(),c=this._curSubmit,g=3===c._key.submitType&&c._key.blendShader===this._nBlendType;g&&(g=g&&this.isSameClipInfo(c));g||(this._curSubmit=this.addVGSubmit(this._pathMesh));for(var g=c=0,h=a.paths.length;g<h;g++){var k=a.paths[g];if(!(0>=k.path.length)){var n=[],q=[],u=2*k.path.length;if(!(2>u)){65535<this._pathMesh.vertNum+u&&(this._curSubmit._numEle+=c,c=0,this._pathMesh=Ca.getAMesh(this.isMain),this.meshlist.push(this._pathMesh),this._curSubmit=this.addVGSubmit(this._pathMesh));jc.createLine2(k.path,n,this.lineWidth,this._pathMesh.vertNum,q,k.loop);var k=q.length/2,u=this._curMat,l,m,p,r,t;if(u._bTransform)for(l=0;l<k;l++)m=l<<1,p=m+1,r=q[m],t=q[p],q[m]=u.a*r+u.c*t+u.tx,q[p]=u.b*r+u.d*t+u.ty;else for(l=0;l<k;l++)m=l<<1,p=m+1,r=q[m],t=q[p],q[m]=r+u.tx,q[p]=t+u.ty;this._pathMesh.addVertAndIBToMesh(this,q,b,n);c+=n.length}}}this._curSubmit._numEle+=c}};b.moveTo=function(b,a){var d=this._getPath();d.newPath();d._lastOriX=b;d._lastOriY=a;d.addPoint(b,a)};b.lineTo=function(b,a){var d=this._getPath();.001>Math.abs(b-d._lastOriX)&&.001>Math.abs(a-d._lastOriY)||(d._lastOriX=b,d._lastOriY=a,d.addPoint(b,a))};b.arcTo=function(b,c,f,g,h){var d,e,q=this._path._lastOriX-b,u=this._path._lastOriY-c,l=Math.sqrt(q*q+u*u);if(!(1E-6>=l)){q/=l;u/=l;f-=b;g-=c;var m=Math.sqrt(f*f+g*g);if(!(1E-6>=m||(f/=m,d=g/m,l=q+f,g=u+d,m=Math.sqrt(l*l+g*g),1E-6>=m))){e=l/m;var p=g/m,r=Math.PI/2-Math.acos(e*q+p*u),l=h/Math.tan(r),m=l*q+b;g=l*u+c;h=Math.sqrt(l*l+h*h);b+=e*h;c+=p*h;u=0<=q*d-u*f?2*r/a.SEGNUM:2*-r/a.SEGNUM;q=Math.sin(u);u=Math.cos(u);h=this._path._lastOriX;f=this._path._lastOriY;if(.1<Math.abs(m-this._path._lastOriX)||.1<Math.abs(g-this._path._lastOriY))h=m,f=g,this._path.addPoint(m,g);d=m-b;l=g-c;for(g=0;g<a.SEGNUM;g++){m=d*u+l*q;l=-d*q+l*u;d=m+b;e=l+c;if(.1<Math.abs(h-d)||.1<Math.abs(f-e))this._path.addPoint(d,e),h=d,f=e;d=m}}}};b.arc=function(b,a,c,g,h,k,n){void 0===k&&(k=!1);var d,e,f;n=h-g;if(k)if(Math.abs(n)>=2*Math.PI)n=2*-Math.PI;else for(;0<n;)n-=2*Math.PI;else if(Math.abs(n)>=2*Math.PI)n=2*Math.PI;else for(;0>n;)n+=2*Math.PI;k=this.getMatScaleX();f=this.getMatScaleY();f=Math.max(2*Math.PI*c*(k>f?k:f)/10,10)|0;var l=this._getPath();for(k=0;k<=f;k++)d=g+k/f*n,e=Math.cos(d),d=Math.sin(d),e=b+e*c,d=a+d*c,e==this._path._lastOriX&&d==this._path._lastOriY||l.addPoint(e,d);e=Math.cos(h);d=Math.sin(h);e=b+e*c;d=a+d*c;e==this._path._lastOriX&&d==this._path._lastOriY||l.addPoint(e,d)};b.quadraticCurveTo=function(b,a,c,g){b=rb.I.getBezierPoints([this._path._lastOriX,this._path._lastOriY,b,a,c,g],30,2);a=0;for(var d=b.length/2;a<d;a++)this.lineTo(b[2*a],b[2*a+1]);this.lineTo(c,g)};b.mixRGBandAlpha=function(b){return this._mixRGBandAlpha(b,this._shader2D.ALPHA)};b._mixRGBandAlpha=function(b,a){if(1<=a)return b;var d=(b&4278190080)>>>24;return b&16777215|(0!=d?d*a:255*a)<<24};b.strokeRect=function(b,a,c,g,h){if(0<this.lineWidth){h=this.mixRGBandAlpha(this.strokeStyle._color.numColor);var d=this.lineWidth/2;this._fillRect(b-d,a-d,c+this.lineWidth,this.lineWidth,h);this._fillRect(b-d,a-d+g,c+this.lineWidth,this.lineWidth,h);this._fillRect(b-d,a+d,this.lineWidth,g-this.lineWidth,h);this._fillRect(b-d+c,a+d,this.lineWidth,g-this.lineWidth,h)}};b.clip=function(){};b.drawParticle=function(b,a,c){c.x=b;c.y=a;this._submits[this._submits._length++]=c};b._getPath=function(){return this._path||(this._path=new lb)};b._fillTexture_h=function(b,c,f,g,h,k,n,q){var d=Math.floor(q/g);q%=g;for(var e=0;e<d;e++)this._inner_drawTexture(b,c,k,n,g,h,this._curMat,f,1,!1),k+=g;0<q&&(g=f[0]+q/g*(f[2]-f[0]),d=a.tmpuv1,d[0]=f[0],d[1]=f[1],d[2]=g,d[3]=f[3],d[4]=g,d[5]=f[5],d[6]=f[6],d[7]=f[7],this._inner_drawTexture(b,c,k,n,q,h,this._curMat,d,1,!1))};b._fillTexture_v=function(b,c,f,g,h,k,n,q){var d=Math.floor(q/h);q%=h;for(var e=0;e<d;e++)this._inner_drawTexture(b,c,k,n,g,h,this._curMat,f,1,!1),n+=h;0<q&&(h=f[1]+q/h*(f[7]-f[1]),d=a.tmpuv1,d[0]=f[0],d[1]=f[1],d[2]=f[2],d[3]=f[3],d[4]=f[4],d[5]=h,d[6]=f[6],d[7]=h,this._inner_drawTexture(b,c,k,n,g,q,this._curMat,d,1,!1))};b.drawTextureWithSizeGrid=function(b,c,f,g,h,k,n,q){if(b._getSource()){c+=n;f+=q;var d=b.uv,e=b.bitmap.width,l=b.bitmap.height;n=k[0];q=k[3];var m=n/l,p=q/e,r=k[1],t=k[2],v=r/e,w=t/l,C=k[4];k=!1;g==e&&(q=r=0);h==l&&(n=t=0);q+r>g&&(e=g,k=!0,g=q+r,this.save(),this.clipRect(0+c,0+f,e,h));var e=b.bitmap.id,l=this._curMat,A=this._tempUV,D=d[0],E=d[1],F=d[4],G=d[5],y,x,z;q&&n&&(x=D+p,z=E+m,A[0]=D,A[1]=E,A[2]=x,A[3]=E,A[4]=x,A[5]=z,A[6]=D,A[7]=z,this._inner_drawTexture(b,e,c,f,q,n,l,A,1,!1));r&&n&&(d=F-v,y=E,x=F,z=E+m,A[0]=d,A[1]=y,A[2]=x,A[3]=y,A[4]=x,A[5]=z,A[6]=d,A[7]=z,this._inner_drawTexture(b,e,g-r+c,0+f,r,n,l,A,1,!1));q&&t&&(d=D,y=G-w,x=D+p,z=G,A[0]=d,A[1]=y,A[2]=x,A[3]=y,A[4]=x,A[5]=z,A[6]=d,A[7]=z,this._inner_drawTexture(b,e,0+c,h-t+f,q,t,l,A,1,!1));r&&t&&(d=F-v,y=G-w,x=F,z=G,A[0]=d,A[1]=y,A[2]=x,A[3]=y,A[4]=x,A[5]=z,A[6]=d,A[7]=z,this._inner_drawTexture(b,e,g-r+c,h-t+f,r,t,l,A,1,!1));n&&(d=D+p,y=E,x=F-v,z=E+m,A[0]=d,A[1]=y,A[2]=x,A[3]=y,A[4]=x,A[5]=z,A[6]=d,A[7]=z,C?this._fillTexture_h(b,e,A,b.width-q-r,n,q+c,f,g-q-r):this._inner_drawTexture(b,e,q+c,f,g-q-r,n,l,A,1,!1));t&&(d=D+p,y=G-w,x=F-v,z=G,A[0]=d,A[1]=y,A[2]=x,A[3]=y,A[4]=x,A[5]=z,A[6]=d,A[7]=z,C?this._fillTexture_h(b,e,A,b.width-q-r,t,q+c,h-t+f,g-q-r):this._inner_drawTexture(b,e,q+c,h-t+f,g-q-r,t,l,A,1,!1));q&&(d=D,y=E+m,x=D+p,z=G-w,A[0]=d,A[1]=y,A[2]=x,A[3]=y,A[4]=x,A[5]=z,A[6]=d,A[7]=z,C?this._fillTexture_v(b,e,A,q,b.height-n-t,c,n+f,h-n-t):this._inner_drawTexture(b,e,c,n+f,q,h-n-t,l,A,1,!1));r&&(d=F-v,y=E+m,x=F,z=G-w,A[0]=d,A[1]=y,A[2]=x,A[3]=y,A[4]=x,A[5]=z,A[6]=d,A[7]=z,C?this._fillTexture_v(b,e,A,r,b.height-n-t,g-r+c,n+f,h-n-t):this._inner_drawTexture(b,e,g-r+c,n+f,r,h-n-t,l,A,1,!1));d=D+p;y=E+m;x=F-v;z=G-w;A[0]=d;A[1]=y;A[2]=x;A[3]=y;A[4]=x;A[5]=z;A[6]=d;A[7]=z;C?(m=a.tmpUVRect,m[0]=d,m[1]=y,m[2]=x-d,m[3]=z-y,this._fillTexture(b,b.width-q-r,b.height-n-t,m,q+c,n+f,g-q-r,h-n-t,"repeat",0,0)):this._inner_drawTexture(b,e,q+c,n+f,g-q-r,h-n-t,l,A,1,!1);k&&this.restore()}};m(0,b,"textAlign",function(){return this._other.textAlign},function(b){this._other.textAlign===b||(this._other=this._other.make(),R.save(this,32768,this._other,!1),this._other.textAlign=b)});m(0,b,"lineJoin",function(){return null},function(b){});m(0,b,"fillStyle",function(){return this._shader2D.fillStyle},function(b){this._shader2D.fillStyle.equal(b)||(R.save(this,2,this._shader2D,!1),this._shader2D.fillStyle=Aa.create(b),this._submitKey.other=-this._shader2D.fillStyle.toInt())});m(0,b,"lineCap",function(){return null},function(b){});m(0,b,"miterLimit",function(){return null},function(b){});m(0,b,"strokeStyle",function(){return this._shader2D.strokeStyle},function(b){this._shader2D.strokeStyle.equal(b)||(R.save(this,512,this._shader2D,!1),this._shader2D.strokeStyle=Aa.create(b),this._submitKey.other=-this._shader2D.strokeStyle.toInt())});m(0,b,"globalCompositeOperation",function(){return T.NAMES[this._nBlendType]},function(b){b=T.TOINT[b];null==b||this._nBlendType===b||(R.save(this,65536,this,!0),this._curSubmit=z.RENDERBASE,this._nBlendType=b)});m(0,b,"globalAlpha",function(){return this._shader2D.ALPHA},function(b){b=Math.floor(1E3*b)/1E3;b!=this._shader2D.ALPHA&&(R.save(this,1,this._shader2D,!1),this._shader2D.ALPHA=b)});m(0,b,"asBitmap",null,function(b){if(b){if(this._targets||(this._targets=new ca(this._width,this._height,1,-1)),!this._width||!this._height)throw Error("asBitmap no size!");}else this._targets&&this._targets.destroy(),this._targets=null});m(0,b,"textBaseline",function(){return this._other.textBaseline},function(b){this._other.textBaseline===b||(this._other=this._other.make(),R.save(this,16384,this._other,!1),this._other.textBaseline=b)});m(0,b,"lineWidth",function(){return this._other.lineWidth},function(b){this._other.lineWidth===b||(this._other=this._other.make(),R.save(this,256,this._other,!1),this._other.lineWidth=b)});m(0,b,"font",null,function(b){this._other=this._other.make();R.save(this,8,this._other,!1)});m(0,b,"canvas",function(){return this._canvas});a.__init__=function(){a.MAXCLIPRECT=new K(0,0,99999999,99999999);c.DEFAULT=new c;Yb};a.set2DRenderConfig=function(){var b=y.instance;C.setBlend(b,!0);C.setBlendFunc(b,1,771);C.setDepthTest(b,!1);C.setCullFace(b,!1);C.setDepthMask(b,!0);C.setFrontFace(b,2305);b.viewport(0,0,F.width,F.height)};a.ENUM_TEXTALIGN_DEFAULT=0;a.ENUM_TEXTALIGN_CENTER=1;a.ENUM_TEXTALIGN_RIGHT=2;a._SUBMITVBSIZE=32E3;a._MAXSIZE=99999999;a._MAXVERTNUM=65535;a.MAXCLIPRECT=null;a._COUNT=0;a.SEGNUM=32;a._contextcount=0;a.PI2=2*Math.PI;a._clipID_Gen=0;t(a,["_textRender",function(){return this._textRender=new Y},"tmpuv1",function(){return this.tmpuv1=[0,0,0,0,0,0,0,0]},"tmpUV",function(){return this.tmpUV=[0,0,0,0,0,0,0,0]},"tmpUVRect",function(){return this.tmpUVRect=[0,0,0,0]}]);a.__init$=function(){c=function(){function b(){this.lineWidth=1;this.textBaseline=this.textAlign=null}p(b,"");var a=b.prototype;a.clear=function(){this.lineWidth=1;this.textAlign=this.textBaseline=null};a.make=function(){return this===b.DEFAULT?new b:this};b.DEFAULT=null;return b}()};return a}(),kc=function(){function a(){}p(a,"laya.filters.BlurFilterGLRender");var c=a.prototype;c.render=function(b,d,a,c,g){var e=U.create(1,0);this.setShaderInfo(e,g,b.width,b.height);d.drawTarget(b,0,0,a,c,I.EMPTY.identity(),e)};c.setShaderInfo=function(b,d,c,f){b.defines.add(16);a.blurinfo[0]=c;a.blurinfo[1]=f;b.blurInfo=a.blurinfo;c=d.strength/3;c*=c;d.strength_sig2_2sig2_gauss1[0]=d.strength;d.strength_sig2_2sig2_gauss1[1]=c;d.strength_sig2_2sig2_gauss1[2]=2*c;d.strength_sig2_2sig2_gauss1[3]=1/(2*Math.PI*c);b.strength_sig2_2sig2_gauss1=d.strength_sig2_2sig2_gauss1};t(a,["blurinfo",function(){return this.blurinfo=Array(2)}]);return a}(),ja=function(){function a(){}p(a,"laya.webgl.utils.CONST3D2D");a.BYTES_PE=4;a.BYTES_PIDX=2;a.defaultMatrix4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];a.defaultMinusYMatrix4=[1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1];a.uniformMatrix3=[1,0,0,0,0,1,0,0,0,0,1,0];a._TMPARRAY=[];a._OFFSETX=0;a._OFFSETY=0;return a}(),kb=function(){function a(){this["char"]="";this.tex=null;this.deleted=!1;this.touchTick=this.oriy=this.orix=this.bmpHeight=this.bmpWidth=this.height=this.width=this.pos=0;this.isSpace=!1;this.uv=Array(8)}p(a,"laya.webgl.text.CharRenderInfo");a.prototype.touch=function(){var a=J.loopCount;this.touchTick!=a&&this.tex.touchRect(this,a);this.touchTick=a};return a}();(function(){function a(){this._repaint=this._renderType=0;this._y=this._x=NaN}p(a,"laya.layagl.QuickTestTool");var c=a.prototype;c.render=function(b,d,c){a._addType(this._renderType);a.showRenderTypeInfo(this._renderType);ta.renders[this._renderType]._fun(this,b,d+this._x,c+this._y);this._repaint=0};c._stageRender=function(b,d,c){a._countStart();a._PreStageRender.call(l.stage,b,d,c);a._countEnd()};a.getMCDName=function(b){return a._typeToNameDic[b]};a.showRenderTypeInfo=function(b,d){void 0===d&&(d=!1);if(d||!a.showedDic[b]){a.showedDic[b]=!0;if(!a._rendertypeToStrDic[b]){var c=[],f;for(f=1;f<=b;)f&b&&c.push(a.getMCDName(f&b)),f<<=1;a._rendertypeToStrDic[b]=c.join(",")}console.log("cmd:",a._rendertypeToStrDic[b])}};a.__init__=function(){a._typeToNameDic[1]="ALPHA";a._typeToNameDic[2]="TRANSFORM";a._typeToNameDic[256]="TEXTURE";a._typeToNameDic[512]="GRAPHICS";a._typeToNameDic[4096]="ONECHILD";a._typeToNameDic[8192]="CHILDS";a._typeToNameDic[3]="TRANSFORM|ALPHA";a._typeToNameDic[8]="CANVAS";a._typeToNameDic[4]="BLEND";a._typeToNameDic[16]="FILTERS";a._typeToNameDic[32]="MASK";a._typeToNameDic[64]="CLIP";a._typeToNameDic[1024]="LAYAGL3D"};a._countStart=function(){for(var b in a._countDic)a._countDic[b]=0};a._countEnd=function(){a._i++;60<a._i&&(a.showCountInfo(),a._i=0)};a._addType=function(b){a._countDic[b]=a._countDic[b]?a._countDic[b]+1:1};a.showCountInfo=function(){console.log("\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d");for(var b in a._countDic)console.log("count:"+a._countDic[b]),a.showRenderTypeInfo(b,!0)};a.enableQuickTest=function(){a.__init__();P.prototype.render=a.prototype.render;a._PreStageRender=Ha.prototype.render;Ha.prototype.render=a.prototype._stageRender};a.showedDic={};a._rendertypeToStrDic={};a._typeToNameDic={};a._PreStageRender=null;a._countDic={};a._i=0;return a})();var F=function(){function a(){}p(a,"laya.webgl.utils.RenderState2D");a.mat2MatArray=function(c,b){b[0]=c.a;b[1]=c.b;b[2]=a.EMPTYMAT4_ARRAY[2];b[3]=a.EMPTYMAT4_ARRAY[3];b[4]=c.c;b[5]=c.d;b[6]=a.EMPTYMAT4_ARRAY[6];b[7]=a.EMPTYMAT4_ARRAY[7];b[8]=a.EMPTYMAT4_ARRAY[8];b[9]=a.EMPTYMAT4_ARRAY[9];b[10]=a.EMPTYMAT4_ARRAY[10];b[11]=a.EMPTYMAT4_ARRAY[11];b[12]=c.tx;b[13]=c.ty;b[14]=a.EMPTYMAT4_ARRAY[14];b[15]=a.EMPTYMAT4_ARRAY[15];return b};a.restoreTempArray=function(){a.TEMPMAT4_ARRAY[0]=1;a.TEMPMAT4_ARRAY[1]=0;a.TEMPMAT4_ARRAY[4]=0;a.TEMPMAT4_ARRAY[5]=1;a.TEMPMAT4_ARRAY[12]=0;a.TEMPMAT4_ARRAY[13]=0};a.clear=function(){a.worldScissorTest=!1;a.worldAlpha=1};a._MAXSIZE=99999999;a.EMPTYMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];a.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];a.worldMatrix4=a.TEMPMAT4_ARRAY;a.matWVP=null;a.worldAlpha=1;a.worldScissorTest=!1;a.worldShaderDefines=null;a.worldFilters=null;a.width=0;a.height=0;t(a,["worldMatrix",function(){return this.worldMatrix=new I}]);return a}(),$a=function(){function a(){}var c,b;p(a,"laya.utils.SceneUtils");a.getBindFun=function(b){var d=a._funMap.get(b);null==d&&(d="(function(data){if(data\x3d\x3dnull)return;with(data){try{\nreturn "+('"'+b+'"').replace(/^"\${|}"$/g,"").replace(/\${/g,'"+').replace(/}/g,'+"')+"\n}catch(e){}}})",d=l._runScript(d),a._funMap.set(b,d));return d};a.createByData=function(d,c){var e=b.create();d=a.createComp(c,d,d,null,e);d._setBit(8,!0);d.hasOwnProperty("_idMap")&&(d._idMap=e._idMap);if(c.animations){var g=[],h=c.animations,k,n=h.length,q,l;for(k=0;k<n;k++){q=new Za;l=h[k];q._setUp(e._idMap,l);d[l.name]=q;q._setControlNode(d);switch(l.action){case 1:q.play(0,!1);break;case 2:q.play(0,!0)}g.push(q)}d._aniList=g}"Scene"===d._$componentType&&0<d._width&&null==c.props.hitTestPrior&&!d.mouseThrough&&(d.hitTestPrior=!0);e.beginLoad(d);return d};a.createInitTool=function(){return b.create()};a.createComp=function(b,c,f,g,h){if("Scene3D"==b.type||"Sprite3D"==b.type)return c=[],h=l.Utils3D._createSceneByJsonForMaker(b,c,h),"Sprite3D"==b.type?l.StaticBatchManager.combine(h,c):l.StaticBatchManager.combine(null,c),h;c=c||a.getCompInstance(b);if(!c)return b.props&&b.props.runtime?console.warn("runtime not found:"+b.props.runtime):console.warn("can not create:"+b.type),null;var d=b.child;if(d)for(var e="List"==c._$componentType,q=0,m=d.length;q<m;q++){var p=d[q];if(!c.hasOwnProperty("itemRender")||"render"!=p.props.name&&"render"!==p.props.renderType)if("Graphic"==p.type)ra._addGraphicsToSprite(p,c);else if(ra._isDrawType(p.type))ra._addGraphicToSprite(p,c,!0);else{if(e){var r=[],t=a.createComp(p,null,f,r,h);r.length&&(t._$bindData=r)}else t=a.createComp(p,null,f,g,h);"Script"==p.type?t instanceof laya.components.Component?c._addComponentInstance(t):"owner"in t?t.owner=c:"target"in t&&(t.target=c):"mask"==p.props.renderType||"mask"==p.props.name?c.mask=t:t instanceof laya.display.Node&&c.addChild(t)}else c.itemRender=p}var d=b.props,v;for(v in d)e=d[v],"string"==typeof e&&(0<=e.indexOf("@node:")||0<=e.indexOf("@Prefab:"))?h&&h.addNodeRef(c,v,e):a.setCompValue(c,v,e,f,g);c._afterInited&&c._afterInited();b.compId&&h&&h._idMap&&(h._idMap[b.compId]=c);return c};a.setCompValue=function(b,e,f,g,h){if("string"==typeof f&&-1<f.indexOf("${"))if(a._sheet||(a._sheet=ra.getClass("laya.data.Table")),!a._sheet)console.warn("Can not find class Sheet");else if(h)h.push(b,e,f);else{if(g)for(-1==f.indexOf("].")&&(f=f.replace(".","[0].")),b=new c(b,e,f),b.exe(g),f=f.replace(/\[.*?\]\./g,".");null!=(e=a._parseWatchData.exec(f));){for(e=e[1];null!=(h=a._parseKeyWord.exec(e));){h=h[0];var d=g._watchMap[h]||(g._watchMap[h]=[]);d.push(b);a._sheet.I.notifer.on(h,g,g.changeData,[h])}d=g._watchMap[e]||(g._watchMap[e]=[]);d.push(b);a._sheet.I.notifer.on(e,g,g.changeData,[e])}}else"var"===e&&g?g[f]=b:b[e]="true"===f?!0:"false"===f?!1:f};a.getCompInstance=function(b){if("UIView"==b.type&&b.props&&b.props.pageData)return a.createByData(null,b.props.pageData);var d=b.props&&b.props.runtime||b.type,c=ra.getClass(d);if(!c)throw"Can not find class "+d;return"Script"===b.type&&c.prototype._doAwake?(b=w.createByClass(c),b._destroyed=!1,b):b.props&&b.props.hasOwnProperty("renderType")&&"instance"==b.props.renderType?(c.instance||(c.instance=new c),c.instance):new c};a._sheet=null;t(a,["_funMap",function(){return this._funMap=new db},"_parseWatchData",function(){return this._parseWatchData=/\${(.*?)}/g},"_parseKeyWord",function(){return this._parseKeyWord=/[a-zA-Z_][a-zA-Z0-9_]*(?:(?:\.[a-zA-Z_][a-zA-Z0-9_]*)+)/g}]);a.__init$=function(){c=function(){function b(b,d,a){this.value=this.prop=this.comp=null;this.comp=b;this.prop=d;this.value=a}p(b,"");b.prototype.exe=function(b){var d=a.getBindFun(this.value);this.comp[this.prop]=d.call(this,b)};return b}();b=function(){function b(){this._scene=this._idMap=this._loadList=this._initList=this._nodeRefList=null}p(b,"");var a=b.prototype;a.reset=function(){this._scene=this._loadList=this._idMap=this._initList=this._nodeRefList=null};a.recover=function(){this.reset();w.recover("InitTool",this)};a.addLoadRes=function(b,d){this._loadList||(this._loadList=[]);d?this._loadList.push({url:b,type:d}):this._loadList.push(b)};a.addNodeRef=function(b,d,a){this._nodeRefList||(this._nodeRefList=[]);this._nodeRefList.push([b,d,a]);0<=a.indexOf("@Prefab:")&&this.addLoadRes(a.replace("@Prefab:",""),"prefab")};a.setNodeRef=function(){if(this._nodeRefList){if(this._idMap){var b,d;d=this._nodeRefList.length;var a;for(b=0;b<d;b++)a=this._nodeRefList[b],a[0][a[1]]=this.getReferData(a[2])}this._nodeRefList=null}};a.getReferData=function(b){if(0<=b.indexOf("@Prefab:"))return H.getRes(b.replace("@Prefab:",""));if(0<=b.indexOf("@arr:")){b=b.replace("@arr:","");b=b.split(",");var d,a,c;a=b.length;for(d=0;d<a;d++)c=b[d],b[d]=c?this._idMap[c.replace("@node:","")]:null;return b}return this._idMap[b.replace("@node:","")]};a.addInitItem=function(b){this._initList||(this._initList=[]);this._initList.push(b)};a.doInits=function(){this._initList&&(this._initList=null)};a.finish=function(){this.setNodeRef();this.doInits();this._scene._setBit(8,!1);this._scene.parent&&this._scene.parent.activeInHierarchy&&this._scene.active&&this._scene._processActive();this._scene.event("onViewCreated");this.recover()};a.beginLoad=function(b){this._scene=b;!this._loadList||1>this._loadList.length?this.finish():l.loader.load(this._loadList,S.create(this,this.finish))};b.create=function(){var d=w.getItemByClass("InitTool",b);d._idMap=[];return d};return b}()};return a}(),K=function(){function a(b,d,a,c){void 0===b&&(b=0);void 0===d&&(d=0);void 0===a&&(a=0);void 0===c&&(c=0);this.x=b;this.y=d;this.width=a;this.height=c}p(a,"laya.maths.Rectangle");var c=a.prototype;c.setTo=function(b,d,a,c){this.x=b;this.y=d;this.width=a;this.height=c;return this};c.reset=function(){this.x=this.y=this.width=this.height=0;return this};c.recover=function(){this==a.TEMP||this==a.EMPTY?console.log("recover Temp or Empty:",this):w.recover("Rectangle",this.reset())};c.copyFrom=function(b){this.x=b.x;this.y=b.y;this.width=b.width;this.height=b.height;return this};c.contains=function(b,d){return 0>=this.width||0>=this.height?!1:b>=this.x&&b<this.right&&d>=this.y&&d<this.bottom?!0:!1};c.intersects=function(b){return!(b.x>this.x+this.width||b.x+b.width<this.x||b.y>this.y+this.height||b.y+b.height<this.y)};c.intersection=function(b,d){if(!this.intersects(b))return null;d||(d=new a);d.x=Math.max(this.x,b.x);d.y=Math.max(this.y,b.y);d.width=Math.min(this.right,b.right)-d.x;d.height=Math.min(this.bottom,b.bottom)-d.y;return d};c.union=function(b,d){d||(d=new a);this.clone(d);if(0>=b.width||0>=b.height)return d;d.addPoint(b.x,b.y);d.addPoint(b.right,b.bottom);return this};c.clone=function(b){b||(b=new a);b.x=this.x;b.y=this.y;b.width=this.width;b.height=this.height;return b};c.toString=function(){return this.x+","+this.y+","+this.width+","+this.height};c.equals=function(b){return b&&b.x===this.x&&b.y===this.y&&b.width===this.width&&b.height===this.height?!0:!1};c.addPoint=function(b,d){this.x>b&&(this.width+=this.x-b,this.x=b);this.y>d&&(this.height+=this.y-d,this.y=d);this.width<b-this.x&&(this.width=b-this.x);this.height<d-this.y&&(this.height=d-this.y);return this};c._getBoundPoints=function(){var b=a._temB;b.length=0;if(0==this.width||0==this.height)return b;b.push(this.x,this.y,this.x+this.width,this.y,this.x,this.y+this.height,this.x+this.width,this.y+this.height);return b};c.isEmpty=function(){return 0>=this.width||0>=this.height?!0:!1};m(0,c,"right",function(){return this.x+this.width});m(0,c,"bottom",function(){return this.y+this.height});a.create=function(){return w.getItemByClass("Rectangle",a)};a._getBoundPointS=function(b,d,c,f){var e=a._temA;e.length=0;if(0==c||0==f)return e;e.push(b,d,b+c,d,b,d+f,b+c,d+f);return e};a._getWrapRec=function(b,d){if(!b||1>b.length)return d?d.setTo(0,0,0,0):a.TEMP.setTo(0,0,0,0);d=d?d:laya.maths.Rectangle.create();var c,f=b.length,g,h,k,n,q=N.TEMP;g=k=99999;h=n=-g;for(c=0;c<f;c+=2)q.x=b[c],q.y=b[c+1],g=g<q.x?g:q.x,k=k<q.y?k:q.y,h=h>q.x?h:q.x,n=n>q.y?n:q.y;return d.setTo(g,k,h-g,n-k)};a.EMPTY=new a;a.TEMP=new a;a._temB=[];a._temA=[];return a}(),Db=function(){function a(){}p(a,"laya.events.KeyBoardManager");a.__init__=function(){a._addEvent("keydown");a._addEvent("keypress");a._addEvent("keyup")};a._addEvent=function(a){r.document.addEventListener(a,function(b){laya.events.KeyBoardManager._dispatch(b,a)},!0)};a._dispatch=function(c,b){if(a.enabled){a._event._stoped=!1;a._event.nativeEvent=c;a._event.keyCode=c.keyCode||c.which||c.charCode;"keydown"===b?a._pressKeys[a._event.keyCode]=!0:"keyup"===b&&(a._pressKeys[a._event.keyCode]=null);for(var d=l.stage.focus&&null!=l.stage.focus.event&&l.stage.focus.displayedInStage?l.stage.focus:l.stage,e=d;e;)e.event(b,a._event.setTo(b,e,d)),e=e.parent}};a.hasKeyDown=function(c){return a._pressKeys[c]};a._pressKeys={};a.enabled=!0;t(a,["_event",function(){return this._event=new Ta}]);return a}(),sb=function(){function a(){}p(a,"laya.layagl.LayaGLRunner");a.uploadShaderUniforms=function(a,b,d,e){a=d._data;b=b.getArrayData();for(var c=d=0,g=b.length;c<g;c++){var h=b[c];if(e||-1!==h.textureID){var k=a[h.dataOffset];null!=k&&(d+=h.fun.call(h.caller,h,k))}}return d};a.uploadCustomUniform=function(a,b,d,e){a=0;(b=b[d])&&null!=e&&(a+=b.fun.call(b.caller,b,e));return a};a.uploadShaderUniformsForNative=function(a,b,d){var c=0;0<d._runtimeCopyValues.length&&(c=1);return a.uploadShaderUniforms(b,d._data,c)};return a}(),lc=function(){function a(){}p(a,"laya.display.cmd.DrawPathCmd");var c=a.prototype;c.recover=function(){this.pen=this.brush=this.paths=null;w.recover("DrawPathCmd",this)};c.run=function(b,d,a){b._drawPath(this.x+d,this.y+a,this.paths,this.brush,this.pen)};m(0,c,"cmdID",function(){return"DrawPath"});a.create=function(b,d,c,f,g){var e=w.getItemByClass("DrawPathCmd",a);e.x=b;e.y=d;e.paths=c;e.brush=f;e.pen=g;return e};a.ID="DrawPath";return a}(),mc=function(){function a(){this._bindedIndexBuffer=this._nativeVertexArrayObject=null;this._nativeVertexArrayObject=y.instance.createVertexArray()}p(a,"laya.webgl.BufferStateBase");var c=a.prototype;c.bind=function(){a._curBindedBufferState!==this&&(y.instance.bindVertexArray(this._nativeVertexArrayObject),a._curBindedBufferState=this)};c.unBind=function(){if(a._curBindedBufferState===this)y.instance.bindVertexArray(null),a._curBindedBufferState=null;else throw"BufferState: must call bind() function first.";};c.bindForNative=function(){y.instance.bindVertexArray(this._nativeVertexArrayObject);a._curBindedBufferState=this};c.unBindForNative=function(){y.instance.bindVertexArray(null);a._curBindedBufferState=null};c.destroy=function(){y.instance.deleteVertexArray(this._nativeVertexArrayObject)};a._curBindedBufferState=null;return a}(),nc=function(){function a(){}p(a,"laya.display.cmd.SaveCmd");var c=a.prototype;c.recover=function(){w.recover("SaveCmd",this)};c.run=function(b,d,a){b.save()};m(0,c,"cmdID",function(){return"Save"});a.create=function(){return w.getItemByClass("SaveCmd",a)};a.ID="Save";return a}(),tb=function(){function a(){}var c;p(a,"laya.net.LocalStorage");a.__init__=function(){a._baseClass||(a._baseClass=c,c.init());a.items=a._baseClass.items;a.support=a._baseClass.support;return a.support};a.setItem=function(b,d){a._baseClass.setItem(b,d)};a.getItem=function(b){return a._baseClass.getItem(b)};a.setJSON=function(b,d){a._baseClass.setJSON(b,d)};a.getJSON=function(b){return a._baseClass.getJSON(b)};a.removeItem=function(b){a._baseClass.removeItem(b)};a.clear=function(){a._baseClass.clear()};a._baseClass=null;a.items=null;a.support=!1;a.__init$=function(){c=function(){function b(){}p(b,"");b.init=function(){try{b.support=!0,b.items=G.localStorage,b.setItem("laya","1"),b.removeItem("laya")}catch(d){b.support=!1}b.support||console.log("LocalStorage is not supprot or browser is private mode.")};b.setItem=function(d,a){try{b.support&&b.items.setItem(d,a)}catch(f){console.warn("set localStorage failed",f)}};b.getItem=function(d){return b.support?b.items.getItem(d):null};b.setJSON=function(d,a){try{b.support&&b.items.setItem(d,JSON.stringify(a))}catch(f){console.warn("set localStorage failed",f)}};b.getJSON=function(d){return JSON.parse(b.support?b.items.getItem(d):null)};b.removeItem=function(d){b.support&&b.items.removeItem(d)};b.clear=function(){b.support&&b.items.clear()};b.items=null;b.support=!1;return b}()};return a}(),E=function(){function a(){}p(a,"laya.webgl.WebGL");a._uint8ArraySlice=function(){for(var a=this.length,b=new Uint8Array(this.length),d=0;d<a;d++)b[d]=this[d];return b};a._float32ArraySlice=function(){for(var a=this.length,b=new Float32Array(this.length),d=0;d<a;d++)b[d]=this[d];return b};a._uint16ArraySlice=function(a){var b=arguments,d,c;if(0===b.length)for(d=this.length,c=new Uint16Array(d),b=0;b<d;b++)c[b]=this[b];else if(2===b.length){d=b[0];var f=b[1];if(f>d)for(c=new Uint16Array(f-d),b=d;b<f;b++)c[b-d]=this[b];else c=new Uint16Array(0)}return c};a._nativeRender_enable=function(){a.isNativeRender_enable||(a.isNativeRender_enable=!0,C.__init_native(),ka.prototype.uploadTexture2D=function(a){var b=C;b.bindTexture(laya.webgl.WebGL.mainContext,b.TEXTURE_2D,a)},F.width=r.window.innerWidth,F.height=r.window.innerHeight,Z.measureText=function(a,b){G.conchTextCanvas.font=b;return G.conchTextCanvas.measureText(a)},Z.enableNative=function(){v.supportWebGLPlusRendering&&(sb.uploadShaderUniforms=sb.uploadShaderUniformsForNative,ub=G.GLCommandEncoder,y=G.LayaGLContext);var a=Ha;a.prototype.render=a.prototype.renderToNative},Z.clear=function(a){V.set2DRenderConfig();a=x.create(a).arrColor;var b=y.instance;a&&b.clearColor(a[0],a[1],a[2],a[3]);b.clear(17664);F.clear()},Z.drawToCanvas=Z.drawToTexture=function(a,b,d,e,f,g){f-=a.x;g-=a.y;f|=0;g|=0;d|=0;e|=0;var c=new ea(!1),k=c.getContext("2d");c.size(d,e);k.asBitmap=!0;k._targets.start();ta.renders[b]._fun(a,k,f,g);k.flush();k._targets.end();k._targets.restore();return c},ca.prototype._uv=ca.flipyuv,Object.defineProperty(ca.prototype,"uv",{get:function(){return this._uv},set:function(a){this._uv=a}}),ea.prototype.getTexture=function(){this._texture||(this._texture=this.context._targets,this._texture.uv=ca.flipyuv,this._texture.bitmap=this._texture);return this._texture})};a.enable=function(){return!0};a.inner_enable=function(){Float32Array.prototype.slice||(Float32Array.prototype.slice=a._float32ArraySlice);Uint16Array.prototype.slice||(Uint16Array.prototype.slice=a._uint16ArraySlice);Uint8Array.prototype.slice||(Uint8Array.prototype.slice=a._uint8ArraySlice);v.isConchApp&&a._nativeRender_enable();return!0};a.onStageResize=function(c,b){null!=a.mainContext&&(a.mainContext.viewport(0,0,c,b),F.width=c,F.height=b)};a.mainContext=null;a.shaderHighPrecision=!1;a._isWebGL2=!1;a.isNativeRender_enable=!1;return a}(),db=function(){function a(){this._obj=null;this._obj=a.supportWeakMap?new r.window.WeakMap:{};a.supportWeakMap||a._maps.push(this)}p(a,"laya.utils.WeakObject");var c=a.prototype;c.set=function(b,d){if(null!=b)if(a.supportWeakMap){var c=b;if("string"==typeof b||"number"==typeof b)(c=a._keys[b])||(c=a._keys[b]={k:b});this._obj.set(c,d)}else"string"==typeof b||"number"==typeof b?this._obj[b]=d:(b.$_GID||(b.$_GID=L.getGID()),this._obj[b.$_GID]=d)};c.get=function(b){return null==b?null:a.supportWeakMap?(b="string"==typeof b||"number"==typeof b?a._keys[b]:b)?this._obj.get(b):null:"string"==typeof b||"number"==typeof b?this._obj[b]:this._obj[b.$_GID]};c.del=function(b){null!=b&&(a.supportWeakMap?(b="string"==typeof b||"number"==typeof b?a._keys[b]:b)&&this._obj["delete"](b):"string"==typeof b||"number"==typeof b?delete this._obj[b]:delete this._obj[this._obj.$_GID])};c.has=function(b){return null==b?!1:a.supportWeakMap?this._obj.has("string"==typeof b||"number"==typeof b?a._keys[b]:b):"string"==typeof b||"number"==typeof b?null!=this._obj[b]:null!=this._obj[this._obj.$_GID]};a.__init__=function(){a.supportWeakMap=null!=r.window.WeakMap;a.supportWeakMap||l.systemTimer.loop(a.delInterval,null,a.clearCache)};a.clearCache=function(){for(var b=0,d=a._maps.length;b<d;b++)a._maps[b]._obj={}};a.supportWeakMap=!1;a.delInterval=6E5;a._keys={};a._maps=[];t(a,["I",function(){return this.I=new a}]);return a}(),oc=function(){function a(){}p(a,"laya.display.css.BoundsStyle");var c=a.prototype;c.reset=function(){this.bounds&&this.bounds.recover();this.userBounds&&this.userBounds.recover();this.temBM=this.userBounds=this.bounds=null;return this};c.recover=function(){w.recover("BoundsStyle",this.reset())};a.create=function(){return w.getItemByClass("BoundsStyle",a)};return a}(),Aa=function(){function a(b){this._color=null;this.setValue(b)}p(a,"laya.webgl.canvas.DrawStyle");var c=a.prototype;c.setValue=function(b){this._color=b?b instanceof laya.utils.ColorUtils?b:x.create(b):x.create("#000000")};c.reset=function(){this._color=x.create("#000000")};c.toInt=function(){return this._color.numColor};c.equal=function(b){return"string"==typeof b?this._color.strColor===b:b instanceof laya.utils.ColorUtils?this._color.numColor===b.numColor:!1};c.toColorStr=function(){return this._color.strColor};a.create=function(b){if(b){var d=b instanceof laya.utils.ColorUtils?b:x.create(b);return d._drawStyle||(d._drawStyle=new a(b))}return a.DEFAULT};t(a,["DEFAULT",function(){return this.DEFAULT=new a("#000000")}]);return a}(),pc=function(){function a(){}p(a,"laya.system.System");a.changeDefinition=function(a,b){l[a]=b;l._runScript(a+"\x3dclassObj")};a.__init__=function(){};return a}();(function(){function a(){}p(a,"laya.display.cmd.DrawParticleCmd");var c=a.prototype;c.recover=function(){this._templ=null;w.recover("DrawParticleCmd",this)};c.run=function(b,d,a){b.drawParticle(d,a,this._templ)};m(0,c,"cmdID",function(){return"DrawParticleCmd"});a.create=function(b){var d=w.getItemByClass("DrawParticleCmd",a);d._templ=b;return d};a.ID="DrawParticleCmd";return a})();var v=function(){function a(b,d){function c(b){l.stage._loop();r.window.requestAnimationFrame(c)}this._timeId=0;a._mainCanvas.source.id="layaCanvas";a._mainCanvas.source.width=b;a._mainCanvas.source.height=d;laya.renders.Render.isConchApp?r.document.body.appendChild(a._mainCanvas.source):r.onKGMiniGame||r.container.appendChild(a._mainCanvas.source);this.initRender(a._mainCanvas,b,d);r.window.requestAnimationFrame(c);l.stage.on("visibilitychange",this,this._onVisibilitychange)}p(a,"laya.renders.Render");var c=a.prototype;c._onVisibilitychange=function(){l.stage.isVisibility?0!=this._timeId&&r.window.clearInterval(this._timeId):this._timeId=r.window.setInterval(this._enterFrame,1E3)};c.initRender=function(b,d,a){var c=y,e=E,h;a:{h=laya.renders.Render._mainCanvas.source;var k,n=["webgl2","webgl","experimental-webgl","webkit-3d","moz-webgl"];da.useWebGL2||n.shift();for(var q=0;q<n.length;q++){try{k=h.getContext(n[q],{stencil:da.isStencil,alpha:da.isAlpha,antialias:da.isAntialias,premultipliedAlpha:da.premultipliedAlpha,preserveDrawingBuffer:da.preserveDrawingBuffer})}catch(u){}if(k){"webgl2"===n[q]&&(E._isWebGL2=!0);new y;h=k;break a}}h=null}c=c.instance=e.mainContext=h;if(!c)return!1;b.size(d,a);C.__init__(c);V.__init__();z.__init__();d=new V;d.isMain=!0;laya.renders.Render._context=d;b._setContext(d);E.shaderHighPrecision=!1;try{c.getShaderPrecisionFormat(35632,36338).precision?E.shaderHighPrecision=!0:E.shaderHighPrecision=!1}catch(u){}y.instance=c;pc.__init__();Ma.__init__();U.__init__();Va.__init__();ab.__int__(c);T._init_(c);return!0};c._enterFrame=function(b){l.stage._loop()};m(1,a,"context",function(){return a._context});m(1,a,"canvas",function(){return a._mainCanvas.source});a._context=null;a._mainCanvas=null;a.supportWebGLPlusCulling=!1;a.supportWebGLPlusAnimation=!1;a.supportWebGLPlusRendering=!1;a.isConchApp=!1;a.is3DMode=!1;a.__init$=function(){a.isConchApp=null!=G.conch;a.isConchApp&&(a.supportWebGLPlusCulling=!0,a.supportWebGLPlusAnimation=!0,a.supportWebGLPlusRendering=!0)};return a}(),ra=function(){function a(){}p(a,"laya.utils.ClassUtils");a.regClass=function(c,b){a._classMap[c]=b};a.regShortClassName=function(c){for(var b=0;b<c.length;b++){var d=c[b];a._classMap[d.name]=d}};a.getRegClass=function(c){return a._classMap[c]};a.getClass=function(c){var b=a._classMap[c]||c;return"string"==typeof b?l.__classmap[b]||l[c]:b};a.getInstance=function(c){var b=a.getClass(c);if(b)return new b;console.warn("[error] Undefined class:",c);return null};a.createByJson=function(c,b,d,e,f){"string"==typeof c&&(c=JSON.parse(c));var g=c.props;if(!b&&(b=f?f.runWith(c):a.getInstance(g.runtime||c.type),!b))return null;var h=c.child;if(h)for(var k=0,n=h.length;k<n;k++){var q=h[k];if("render"!==q.props.name&&"render"!==q.props.renderType||!b._$set_itemRender)if("Graphic"==q.type)a._addGraphicsToSprite(q,b);else if(a._isDrawType(q.type))a._addGraphicToSprite(q,b,!0);else{var l=a.createByJson(q,null,d,e,f);"Script"===q.type?l.hasOwnProperty("owner")?l.owner=b:l.hasOwnProperty("target")&&(l.target=b):"mask"==q.props.renderType?b.mask=l:b.addChild(l)}else b.itemRender=q}if(g)for(var m in g)f=g[m],"var"===m&&d?d[f]=b:f instanceof Array&&"function"==typeof b[m]?b[m].apply(b,f):b[m]=f;e&&c.customProps&&e.runWith([b,c]);b.created&&b.created();return b};a._addGraphicsToSprite=function(c,b){var d=c.child;if(d&&!(1>d.length)){var e=a._getGraphicsFromSprite(c,b),f=0,g=0;c.props&&(f=a._getObjVar(c.props,"x",0),g=a._getObjVar(c.props,"y",0));0!=f&&0!=g&&e.translate(f,g);var h,k;k=d.length;for(h=0;h<k;h++)a._addGraphicToGraphics(d[h],e);0!=f&&0!=g&&e.translate(-f,-g)}};a._addGraphicToSprite=function(c,b,d){void 0===d&&(d=!1);b=d?a._getGraphicsFromSprite(c,b):b.graphics;a._addGraphicToGraphics(c,b)};a._getGraphicsFromSprite=function(a,b){if(!a||!a.props)return b.graphics;var d=a.props.renderType;if("hit"===d||"unHit"===d){var c=b._style.hitArea||(b.hitArea=new qc);c[d]||(c[d]=new sa);c=c[d]}c||(c=b.graphics);return c};a._getTransformData=function(c){var b;if(c.hasOwnProperty("pivotX")||c.hasOwnProperty("pivotY"))b=b||new I,b.translate(-a._getObjVar(c,"pivotX",0),-a._getObjVar(c,"pivotY",0));var d=a._getObjVar(c,"scaleX",1),e=a._getObjVar(c,"scaleY",1),f=a._getObjVar(c,"rotation",0);a._getObjVar(c,"skewX",0);a._getObjVar(c,"skewY",0);if(1!=d||1!=e||0!=f)b=b||new I,b.scale(d,e),b.rotate(.0174532922222222*f);return b};a._addGraphicToGraphics=function(c,b){var d;if(d=c.props){var e;if(e=a.DrawTypeDic[c.type]){d=a._getParams(d,e[1],e[2],e[3]);var f=a._tM;if(f||1!=a._alpha)b.save(),f&&b.transform(f),1!=a._alpha&&b.alpha(a._alpha);b[e[0]].apply(b,d);(f||1!=a._alpha)&&b.restore()}}};a._adptLineData=function(a){a[2]=parseFloat(a[0])+parseFloat(a[2]);a[3]=parseFloat(a[1])+parseFloat(a[3]);return a};a._adptTextureData=function(a){a[0]=H.getRes(a[0]);return a};a._adptLinesData=function(c){c[2]=a._getPointListByStr(c[2]);return c};a._isDrawType=function(c){return"Image"===c?!1:a.DrawTypeDic.hasOwnProperty(c)};a._getParams=function(c,b,d,e){void 0===d&&(d=0);var f=a._temParam;f.length=b.length;var g,h;h=b.length;for(g=0;g<h;g++)f[g]=a._getObjVar(c,b[g][0],b[g][1]);a._alpha=a._getObjVar(c,"alpha",1);(c=a._getTransformData(c))?(d||(d=0),c.translate(f[d],f[d+1]),f[d]=f[d+1]=0,a._tM=c):a._tM=null;e&&a[e]&&(f=a[e](f));return f};a._getPointListByStr=function(a){a=a.split(",");var b,d;d=a.length;for(b=0;b<d;b++)a[b]=parseFloat(a[b]);return a};a._getObjVar=function(a,b,d){return a.hasOwnProperty(b)?a[b]:d};a._temParam=[];a._classMap={Sprite:P,Scene:rc,Text:O,Animation:"laya.display.Animation",Skeleton:"laya.ani.bone.Skeleton",Particle2D:"laya.particle.Particle2D",div:"laya.html.dom.HTMLDivParser",p:"laya.html.dom.HTMLElement",img:"laya.html.dom.HTMLImageElement",span:"laya.html.dom.HTMLElement",br:"laya.html.dom.HTMLBrElement",style:"laya.html.dom.HTMLStyleElement",font:"laya.html.dom.HTMLElement",a:"laya.html.dom.HTMLElement","#text":"laya.html.dom.HTMLElement",link:"laya.html.dom.HTMLLinkElement"};a._tM=null;a._alpha=NaN;t(a,["DrawTypeDic",function(){return this.DrawTypeDic={Rect:["drawRect",[["x",0],["y",0],["width",0],["height",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Circle:["drawCircle",[["x",0],["y",0],["radius",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Pie:["drawPie",[["x",0],["y",0],["radius",0],["startAngle",0],["endAngle",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Image:["drawTexture",[["x",0],["y",0],["width",0],["height",0]]],Texture:["drawTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0]],1,"_adptTextureData"],FillTexture:["fillTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0],["repeat",null]],1,"_adptTextureData"],FillText:["fillText",[["text",""],["x",0],["y",0],["font",null],["color",null],["textAlign",null]],1],Line:["drawLine",[["x",0],["y",0],["toX",0],["toY",0],["lineColor",null],["lineWidth",0]],0,"_adptLineData"],Lines:["drawLines",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],Curves:["drawCurves",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],Poly:["drawPoly",[["x",0],["y",0],["points",""],["fillColor",null],["lineColor",null],["lineWidth",1]],0,"_adptLinesData"]}}]);return a}(),sc=function(){function a(){this._cacheBoundsType=!1}p(a,"laya.display.GraphicsBounds");var c=a.prototype;c.destroy=function(){this._graphics=null;this._cacheBoundsType=!1;this._temp&&(this._temp.length=0);this._rstBoundPoints&&(this._rstBoundPoints.length=0);this._bounds&&this._bounds.recover();this._bounds=null;w.recover("GraphicsBounds",this)};c.reset=function(){this._temp&&(this._temp.length=0)};c.getBounds=function(b){void 0===b&&(b=!1);if(!this._bounds||!this._temp||1>this._temp.length||b!=this._cacheBoundsType)this._bounds=K._getWrapRec(this.getBoundPoints(b),this._bounds);this._cacheBoundsType=b;return this._bounds};c.getBoundPoints=function(b){void 0===b&&(b=!1);if(!this._temp||1>this._temp.length||b!=this._cacheBoundsType)this._temp=this._getCmdPoints(b);this._cacheBoundsType=b;return this._rstBoundPoints=L.copyArray(this._rstBoundPoints,this._temp)};c._getCmdPoints=function(b){void 0===b&&(b=!1);var d=this._graphics.cmds,c;c=this._temp||(this._temp=[]);c.length=0;d||null==this._graphics._one||(a._tempCmds.length=0,a._tempCmds.push(this._graphics._one),d=a._tempCmds);if(!d)return c;var f=a._tempMatrixArrays;f.length=0;var g=a._initMatrix;g.identity();for(var h=a._tempMatrix,k,n,q=0,l=d.length;q<l;q++)switch(k=d[q],k.cmdID){case "Alpha":f.push(g);g=g.clone();break;case "Restore":g=f.pop();break;case "Scale":h.identity();h.translate(-k.pivotX,-k.pivotY);h.scale(k.scaleX,k.scaleY);h.translate(k.pivotX,k.pivotY);this._switchMatrix(g,h);break;case "Rotate":h.identity();h.translate(-k.pivotX,-k.pivotY);h.rotate(k.angle);h.translate(k.pivotX,k.pivotY);this._switchMatrix(g,h);break;case "Translate":h.identity();h.translate(k.tx,k.ty);this._switchMatrix(g,h);break;case "Transform":h.identity();h.translate(-k.pivotX,-k.pivotY);h.concat(k.matrix);h.translate(k.pivotX,k.pivotY);this._switchMatrix(g,h);break;case "DrawImage":case "FillTexture":a._addPointArrToRst(c,K._getBoundPointS(k.x,k.y,k.width,k.height),g);break;case "DrawTexture":g.copyTo(h);k.matrix&&h.concat(k.matrix);a._addPointArrToRst(c,K._getBoundPointS(k.x,k.y,k.width,k.height),h);break;case "DrawImage":n=k.texture;if(b)k.width&&k.height?a._addPointArrToRst(c,K._getBoundPointS(k.x,k.y,k.width,k.height),g):a._addPointArrToRst(c,K._getBoundPointS(k.x,k.y,n.width,n.height),g);else{var m=(k.width||n.sourceWidth)/n.width,p=(k.height||n.sourceHeight)/n.height,r=m*n.sourceWidth,t=p*n.sourceHeight,v=0<n.offsetX?n.offsetX:0;n=0<n.offsetY?n.offsetY:0;v*=m;n*=p;a._addPointArrToRst(c,K._getBoundPointS(k.x-v,k.y-n,r,t),g)}break;case "FillTexture":k.width&&k.height?a._addPointArrToRst(c,K._getBoundPointS(k.x,k.y,k.width,k.height),g):(n=k.texture,a._addPointArrToRst(c,K._getBoundPointS(k.x,k.y,n.width,n.height),g));break;case "DrawTexture":var w;k.matrix?(g.copyTo(h),h.concat(k.matrix),w=h):w=g;b?k.width&&k.height?a._addPointArrToRst(c,K._getBoundPointS(k.x,k.y,k.width,k.height),w):(n=k.texture,a._addPointArrToRst(c,K._getBoundPointS(k.x,k.y,n.width,n.height),w)):(n=k.texture,m=(k.width||n.sourceWidth)/n.width,p=(k.height||n.sourceHeight)/n.height,r=m*n.sourceWidth,t=p*n.sourceHeight,v=0<n.offsetX?n.offsetX:0,n=0<n.offsetY?n.offsetY:0,v*=m,n*=p,a._addPointArrToRst(c,K._getBoundPointS(k.x-v,k.y-n,r,t),w));break;case "DrawRect":a._addPointArrToRst(c,K._getBoundPointS(k.x,k.y,k.width,k.height),g);break;case "DrawCircle":a._addPointArrToRst(c,K._getBoundPointS(k.x-k.radius,k.y-k.radius,k.radius+k.radius,k.radius+k.radius),g);break;case "DrawLine":a._tempPoints.length=0;m=.5*k.lineWidth;k.fromX==k.toX?a._tempPoints.push(k.fromX+m,k.fromY,k.toX+m,k.toY,k.fromX-m,k.fromY,k.toX-m,k.toY):k.fromY==k.toY?a._tempPoints.push(k.fromX,k.fromY+m,k.toX,k.toY+m,k.fromX,k.fromY-m,k.toX,k.toY-m):a._tempPoints.push(k.fromX,k.fromY,k.toX,k.toY);a._addPointArrToRst(c,a._tempPoints,g);break;case "DrawCurves":a._addPointArrToRst(c,rb.I.getBezierPoints(k.points),g,k.x,k.y);break;case "DrawLines":case "DrawPoly":a._addPointArrToRst(c,k.points,g,k.x,k.y);break;case "DrawPath":a._addPointArrToRst(c,this._getPathPoints(k.paths),g,k.x,k.y);break;case "DrawPie":a._addPointArrToRst(c,this._getPiePoints(k.x,k.y,k.radius,k.startAngle,k.endAngle),g)}200<c.length?c=L.copyArray(c,K._getWrapRec(c)._getBoundPoints()):8<c.length&&(c=nb.scanPList(c));return c};c._switchMatrix=function(b,d){d.concat(b);d.copyTo(b)};c._getPiePoints=function(b,d,c,f,g){var e=a._tempPoints;a._tempPoints.length=0;var k=Math.PI/180;g-=f;if(360<=g||-360>=g)return e.push(b-c,d-c),e.push(b+c,d-c),e.push(b+c,d+c),e.push(b-c,d+c),e;e.push(b,d);g%=360;0>g&&(g+=360);g=f+g;var n=f*k,q=g*k;e.push(b+c*Math.cos(n),d+c*Math.sin(n));e.push(b+c*Math.cos(q),d+c*Math.sin(q));g=90*Math.floor(g/90);for(f=90*Math.ceil(f/90);f<=g;f+=90)n=f*k,e.push(b+c*Math.cos(n),d+c*Math.sin(n));return e};c._getPathPoints=function(b){var d,c,f=a._tempPoints;f.length=0;c=b.length;var g;for(d=0;d<c;d++)g=b[d],1<g.length&&(f.push(g[1],g[2]),3<g.length&&f.push(g[3],g[4]));return f};a.create=function(){return w.getItemByClass("GraphicsBounds",a)};a._addPointArrToRst=function(b,d,c,f,g){void 0===f&&(f=0);void 0===g&&(g=0);var e,k;k=d.length;for(e=0;e<k;e+=2)a._addPointToRst(b,d[e]+f,d[e+1]+g,c)};a._addPointToRst=function(b,d,a,c){var e=N.TEMP;e.setTo(d?d:0,a?a:0);c.transformPoint(e);b.push(e.x,e.y)};a._tempPoints=[];a._tempMatrixArrays=[];a._tempCmds=[];t(a,["_tempMatrix",function(){return this._tempMatrix=new I},"_initMatrix",function(){return this._initMatrix=new I}]);return a}(),y=function(){function a(){}p(a,"laya.layagl.LayaGL");var c=a.prototype;c.createCommandEncoder=function(b,d,a){void 0===b&&(b=128);void 0===d&&(d=64);void 0===a&&(a=!1);return new ub(this,b,d,a)};c.beginCommandEncoding=function(b){};c.endCommandEncoding=function(){};c.matrix4x4Multiply=function(b,d,a){};c.evaluateClipDatasRealTime=function(b,d,a,c){};a.getFrameCount=function(){return 0};a.syncBufferToRenderThread=function(b,d){};a.createArrayBufferRef=function(b,d,a){};a.createArrayBufferRefs=function(b,d,a,c){};a.EXECUTE_JS_THREAD_BUFFER=0;a.EXECUTE_RENDER_THREAD_BUFFER=1;a.EXECUTE_COPY_TO_RENDER=2;a.EXECUTE_COPY_TO_RENDER3D=3;a.ARRAY_BUFFER_TYPE_DATA=0;a.ARRAY_BUFFER_TYPE_CMD=1;a.ARRAY_BUFFER_REF_REFERENCE=0;a.ARRAY_BUFFER_REF_COPY=1;a.UPLOAD_SHADER_UNIFORM_TYPE_ID=0;a.UPLOAD_SHADER_UNIFORM_TYPE_DATA=1;a.instance=null;return a}(),r=function(){function a(){}p(a,"laya.utils.Browser");m(1,a,"pixelRatio",function(){if(0>a._pixelRatio)if(a.__init__(),-1<a.userAgent.indexOf("Mozilla/6.0(Linux; Android 6.0; HUAWEI NXT-AL10 Build/HUAWEINXT-AL10)"))a._pixelRatio=2;else{var c=a.context;a._pixelRatio=(a._window.devicePixelRatio||1)/(c.backingStorePixelRatio||c.webkitBackingStorePixelRatio||c.mozBackingStorePixelRatio||c.msBackingStorePixelRatio||c.oBackingStorePixelRatio||c.backingStorePixelRatio||1);1>a._pixelRatio&&(a._pixelRatio=1)}return a._pixelRatio});m(1,a,"height",function(){a.__init__();return(l.stage&&l.stage.canvasRotation?a.clientWidth:a.clientHeight)*a.pixelRatio});m(1,a,"clientWidth",function(){a.__init__();return a._window.innerWidth||a._document.body.clientWidth});m(1,a,"window",function(){return a._window||a.__init__()});m(1,a,"clientHeight",function(){a.__init__();return a._window.innerHeight||a._document.body.clientHeight||a._document.documentElement.clientHeight});m(1,a,"width",function(){a.__init__();return(l.stage&&l.stage.canvasRotation?a.clientHeight:a.clientWidth)*a.pixelRatio});m(1,a,"container",function(){a._container||(a.__init__(),a._container=a.createElement("div"),a._container.id="layaContainer",a._document.body.appendChild(a._container));return a._container},function(c){a._container=c});m(1,a,"document",function(){a.__init__();return a._document});a.__init__=function(){if(a._window)return a._window;var c=a._window=G,b=a._document=c.document,d=a.userAgent=c.navigator.userAgent,e=c._layalibs;if(e){e.sort(function(b,d){return b.i-d.i});for(var f=0;f<e.length;f++)e[f].f(c,b,l)}-1<d.indexOf("MiniGame")&&a.window.hasOwnProperty("wx")&&(laya.utils.Browser.window.hasOwnProperty("bl")?l.BLMiniAdapter?l.BLMiniAdapter.enable():console.error("\u8bf7\u5148\u6dfb\u52a0\u5c0f\u6e38\u620f\u9002\u914d\u5e93,\u8be6\u7ec6\u6559\u7a0b\uff1ahttps://ldc2.layabox.com/doc/?nav\x3dzh-ts-5-0-0"):l.MiniAdpter?l.MiniAdpter.enable():console.error("\u8bf7\u5148\u6dfb\u52a0\u5c0f\u6e38\u620f\u9002\u914d\u5e93,\u8be6\u7ec6\u6559\u7a0b\uff1ahttps://ldc2.layabox.com/doc/?nav\x3dzh-ts-5-0-0"));-1<d.indexOf("SwanGame")&&(l.BMiniAdapter?l.BMiniAdapter.enable():console.error("\u8bf7\u5148\u6dfb\u52a0\u767e\u5ea6\u5c0f\u6e38\u620f\u9002\u914d\u5e93,\u8be6\u7ec6\u6559\u7a0b\uff1ahttps://ldc2.layabox.com/doc/?nav\x3dzh-ts-5-0-0"));"function"==typeof getApp&&(l.KGMiniAdapter?l.KGMiniAdapter.enable():console.error("\u8bf7\u5148\u6dfb\u52a0\u5c0f\u7c73\u5c0f\u6e38\u620f\u9002\u914d\u5e93,\u8be6\u7ec6\u6559\u7a0b\uff1ahttps://ldc2.layabox.com/doc/?nav\x3dzh-ts-5-0-0"));-1<d.indexOf("OPPO")&&-1<d.indexOf("MiniGame")&&(l.QGMiniAdapter?l.QGMiniAdapter.enable():console.error("\u8bf7\u5148\u6dfb\u52a0OPPO\u5c0f\u6e38\u620f\u9002\u914d\u5e93"));-1<d.indexOf("VVGame")&&(l.VVMiniAdapter?l.VVMiniAdapter.enable():console.error("\u8bf7\u5148\u6dfb\u52a0VIVO\u5c0f\u6e38\u620f\u9002\u914d\u5e93"));-1<d.indexOf("AlipayMiniGame")&&(l.ALIMiniAdapter?l.ALIMiniAdapter.enable():console.error("\u8bf7\u5148\u6dfb\u52a0VIVO\u5c0f\u6e38\u620f\u9002\u914d\u5e93"));c.trace=console.log;c.requestAnimationFrame=c.requestAnimationFrame||c.webkitRequestAnimationFrame||c.mozRequestAnimationFrame||c.oRequestAnimationFrame||c.msRequestAnimationFrame||function(b){return c.setTimeout(b,1E3/60)};e=b.body.style;e.margin=0;e.overflow="hidden";e["-webkit-user-select"]="none";e["-webkit-tap-highlight-color"]="rgba(200,200,200,0)";for(var f=b.getElementsByTagName("meta"),e=0,g=!1;e<f.length;){var h=f[e];if("viewport"==h.name){h.content="width\x3ddevice-width,initial-scale\x3d1.0,minimum-scale\x3d1.0,maximum-scale\x3d1.0,user-scalable\x3dno";g=!0;break}e++}g||laya.utils.Browser.window.hasOwnProperty("bl")||(h=b.createElement("meta"),h.name="viewport",h.content="width\x3ddevice-width,initial-scale\x3d1.0,minimum-scale\x3d1.0,maximum-scale\x3d1.0,user-scalable\x3dno",b.getElementsByTagName("head")[0].appendChild(h));a.onMobile=G.isConchApp?!0:-1<d.indexOf("Mobile");a.onIOS=!!d.match(/\(i[^;]+;(U;)? CPU.+Mac OS X/);a.onIPhone=-1<d.indexOf("iPhone");a.onMac=-1<d.indexOf("Mac OS X");a.onIPad=-1<d.indexOf("iPad");a.onAndroid=-1<d.indexOf("Android")||-1<d.indexOf("Adr");a.onWP=-1<d.indexOf("Windows Phone");a.onQQBrowser=-1<d.indexOf("QQBrowser");a.onMQQBrowser=-1<d.indexOf("MQQBrowser")||-1<d.indexOf("Mobile")&&-1<d.indexOf("QQ");a.onIE=!!c.ActiveXObject||"ActiveXObject"in c;a.onWeiXin=-1<d.indexOf("MicroMessenger");a.onSafari=-1<d.indexOf("Safari");a.onPC=!a.onMobile;a.onMiniGame=-1<d.indexOf("MiniGame");a.onBDMiniGame=-1<d.indexOf("SwanGame");-1<d.indexOf("OPPO")&&-1<d.indexOf("MiniGame")&&(a.onQGMiniGame=!0,a.onMiniGame=!1);laya.utils.Browser.window.hasOwnProperty("bl")&&-1<d.indexOf("MiniGame")&&(a.onBLMiniGame=!0,a.onMiniGame=!1);a.onVVMiniGame=-1<d.indexOf("VVGame");a.onLimixiu=-1<d.indexOf("limixiu");a.onKGMiniGame=-1<d.indexOf("QuickGame");-1<d.indexOf("AlipayMiniGame")&&(a.onAlipayMiniGame=!0,a.onMiniGame=!1);a.supportLocalStorage=tb.__init__();a.supportWebAudio=Q.__init__();v._mainCanvas=new ea(!0);b=v._mainCanvas.source.style;b.position="absolute";b.top=b.left="0px";b.background="#000000";a.canvas=new ea(!0);a.context=a.canvas.getContext("2d");b=new ea(!0);if(laya.utils.Browser.onQGMiniGame||laya.utils.Browser.onVVMiniGame)b=v._mainCanvas;d=["webgl","experimental-webgl","webkit-3d","moz-webgl"];f=null;for(e=0;e<d.length;e++){try{f=b.source.getContext(d[e])}catch(k){}if(f){a._supportWebGL=!0;break}}return c};a.createElement=function(c){a.__init__();return a._document.createElement(c)};a.getElementById=function(c){a.__init__();return a._document.getElementById(c)};a.removeElement=function(a){a&&a.parentNode&&a.parentNode.removeChild(a)};a.now=function(){return Date.now()};a.userAgent=null;a.onMobile=!1;a.onIOS=!1;a.onMac=!1;a.onIPhone=!1;a.onIPad=!1;a.onAndroid=!1;a.onWP=!1;a.onQQBrowser=!1;a.onMQQBrowser=!1;a.onSafari=!1;a.onIE=!1;a.onWeiXin=!1;a.onPC=!1;a.onMiniGame=!1;a.onBDMiniGame=!1;a.onVVMiniGame=!1;a.onKGMiniGame=!1;a.onQGMiniGame=!1;a.onBLMiniGame=!1;a.onAlipayMiniGame=!1;a.onLimixiu=!1;a.onFirefox=!1;a.onEdge=!1;a.supportWebAudio=!1;a.supportLocalStorage=!1;a.canvas=null;a.context=null;a._window=null;a._document=null;a._container=null;a._pixelRatio=-1;a._supportWebGL=!1;return a}(),Qa=function(){function a(){this._matrix=new I}p(a,"laya.webgl.canvas.save.SaveTransform");var c=a.prototype;l.imps(c,{"laya.webgl.canvas.save.ISaveData":!0});c.isSaveMark=function(){return!1};c.restore=function(b){b._curMat=this._savematrix;a.POOL[a.POOL._length++]=this};a.save=function(b){var d=b._saveMark;2048!==(d._saveuse&2048)&&(d._saveuse|=2048,d=a.POOL,d=0<d._length?d[--d._length]:new a,d._savematrix=b._curMat,b._curMat=b._curMat.copyTo(d._matrix),b=b._save,b[b._length++]=d)};a.POOL=R._createArray();return a}(),ub=function(){function a(b,d,a,c){this._idata=[]}p(a,"laya.layagl.CommandEncoder");var c=a.prototype;c.getArrayData=function(){return this._idata};c.getPtrID=function(){return 0};c.beginEncoding=function(){};c.endEncoding=function(){};c.clearEncoding=function(){this._idata.length=0};c.getCount=function(){return this._idata.length};c.add_ShaderValue=function(b){this._idata.push(b)};c.addShaderUniform=function(b){this.add_ShaderValue(b)};return a}(),tc=function(){function a(){}p(a,"laya.display.cmd.FillBorderTextCmd");var c=a.prototype;c.recover=function(){w.recover("FillBorderTextCmd",this)};c.run=function(b,d,a){b.fillBorderText(this.text,this.x+d,this.y+a,this.font,this.fillColor,this.borderColor,this.lineWidth,this.textAlign)};m(0,c,"cmdID",function(){return"FillBorderText"});a.create=function(b,d,c,f,g,h,k,n){var e=w.getItemByClass("FillBorderTextCmd",a);e.text=b;e.x=d;e.y=c;e.font=f;e.fillColor=g;e.borderColor=h;e.lineWidth=k;e.textAlign=n;return e};a.ID="FillBorderText";return a}(),rb=function(){function a(){this._controlPoints=[new N,new N,new N];this._calFun=this.getPoint2}p(a,"laya.maths.Bezier");var c=a.prototype;c._switchPoint=function(b,d){var a=this._controlPoints.shift();a.setTo(b,d);this._controlPoints.push(a)};c.getPoint2=function(b,d){var a=this._controlPoints[0],c=this._controlPoints[1],g=this._controlPoints[2];d.push(Math.pow(1-b,2)*a.x+2*b*(1-b)*c.x+Math.pow(b,2)*g.x,Math.pow(1-b,2)*a.y+2*b*(1-b)*c.y+Math.pow(b,2)*g.y)};c.getPoint3=function(b,d){var a=this._controlPoints[0],c=this._controlPoints[1],g=this._controlPoints[2],h=this._controlPoints[3];d.push(Math.pow(1-b,3)*a.x+3*c.x*b*(1-b)*(1-b)+3*g.x*b*b*(1-b)+h.x*Math.pow(b,3),Math.pow(1-b,3)*a.y+3*c.y*b*(1-b)*(1-b)+3*g.y*b*b*(1-b)+h.y*Math.pow(b,3))};c.insertPoints=function(b,d){var a,c;c=1/(0<b?b:5);for(a=0;1>=a;a+=c)this._calFun(a,d)};c.getBezierPoints=function(b,d,a){void 0===d&&(d=5);void 0===a&&(a=2);var c,e;e=b.length;if(e<2*(a+1))return[];var h=[];switch(a){case 2:this._calFun=this.getPoint2;break;case 3:this._calFun=this.getPoint3;break;default:return[]}for(;this._controlPoints.length<=a;)this._controlPoints.push(N.create());for(c=0;c<2*a;c+=2)this._switchPoint(b[c],b[c+1]);for(c=2*a;c<e;c+=2)this._switchPoint(b[c],b[c+1]),0==c/2%a&&this.insertPoints(d,h);return h};t(a,["I",function(){return this.I=new a}]);return a}(),uc=function(){function a(){}p(a,"laya.display.cmd.Draw9GridTexture");var c=a.prototype;c.recover=function(){this.texture._removeReference();w.recover("Draw9GridTexture",this)};c.run=function(b,d,a){b.drawTextureWithSizeGrid(this.texture,this.x,this.y,this.width,this.height,this.sizeGrid,d,a)};m(0,c,"cmdID",function(){return"Draw9GridTexture"});a.create=function(b,d,c,f,g,h){var e=w.getItemByClass("Draw9GridTexture",a);e.texture=b;b._addReference();e.x=d;e.y=c;e.width=f;e.height=g;e.sizeGrid=h;return e};a.ID="Draw9GridTexture";return a}(),ya=function(){function a(){this.texHeight=this.texWidth=1024;this.atlasgrid=null;this.protectDist=1;this.texture=null;this.charMaps={};this.texHeight=this.texWidth=Y.atlasWidth;this.texture=Ua.getTextTexture(this.texWidth,this.texHeight);256<this.texWidth/a.atlasGridW&&(a.atlasGridW=Math.ceil(this.texWidth/256));this.atlasgrid=new vc(this.texWidth/a.atlasGridW,this.texHeight/a.atlasGridW,this.texture.id)}p(a,"laya.webgl.text.TextAtlas");var c=a.prototype;c.setProtecteDist=function(b){this.protectDist=b};c.getAEmpty=function(b,d,c){if(b=this.atlasgrid.addRect(1,Math.ceil(b/a.atlasGridW),Math.ceil(d/a.atlasGridW),c))c.x*=a.atlasGridW,c.y*=a.atlasGridW;return b};c.destroy=function(){for(var b in this.charMaps)this.charMaps[b].deleted=!0;this.texture.discard()};c.printDebugInfo=function(){};m(0,c,"usedRate",function(){return this.atlasgrid._used});a.atlasGridW=16;return a}(),wc=function(){function a(){this._strsToID={};this._idToStrs=[];this._length=0}p(a,"laya.utils.StringKey");var c=a.prototype;c.add=function(b){var d=this._strsToID[b];if(null!=d)return d;this._idToStrs[this._length]=b;return this._strsToID[b]=this._length++};c.getID=function(b){b=this._strsToID[b];return null==b?-1:b};c.getName=function(b){b=this._idToStrs[b];return null==b?void 0:b};return a}(),xc=function(){function a(){this.ratio=.92;this.maxOffset=60;this._dragging=!1;this._clickOnly=!0}p(a,"laya.utils.Dragging");var c=a.prototype;c.start=function(b,d,a,c,g,h,k,n){void 0===n&&(n=.92);this.clearTimer();this.target=b;this.area=d;this.hasInertia=a;this.elasticDistance=d?c:0;this.elasticBackTime=g;this.data=h;this._disableMouseEvent=k;this.ratio=n;this._parent=b.parent;this._dragging=this._clickOnly=!0;this._elasticRateX=this._elasticRateY=1;this._lastX=this._parent.mouseX;this._lastY=this._parent.mouseY;l.stage.on("mouseup",this,this.onStageMouseUp);l.stage.on("mouseout",this,this.onStageMouseUp);l.systemTimer.frameLoop(1,this,this.loop)};c.clearTimer=function(){l.systemTimer.clear(this,this.loop);l.systemTimer.clear(this,this.tweenMove);this._tween&&(this._tween.recover(),this._tween=null)};c.stop=function(){this._dragging&&(ha.instance.disableMouseEvent=!1,l.stage.off("mouseup",this,this.onStageMouseUp),l.stage.off("mouseout",this,this.onStageMouseUp),this._dragging=!1,this.target&&this.area&&this.backToArea(),this.clear())};c.loop=function(){var b=this._parent.getMousePoint(),d=b.x,b=b.y,a=d-this._lastX,c=b-this._lastY;if(this._clickOnly)if(1<Math.abs(a*l.stage._canvasTransform.getScaleX())||1<Math.abs(c*l.stage._canvasTransform.getScaleY()))this._clickOnly=!1,this._offsets||(this._offsets=[]),this._offsets.length=0,this.target.event("dragstart",this.data),ha.instance.disableMouseEvent=this._disableMouseEvent;else return;else this._offsets.push(a,c);if(0!==a||0!==c)this._lastX=d,this._lastY=b,this.target.x+=a*this._elasticRateX,this.target.y+=c*this._elasticRateY,this.area&&this.checkArea(),this.target.event("dragmove",this.data)};c.checkArea=function(){0>=this.elasticDistance?this.backToArea():(this._elasticRateX=Math.max(0,1-(this.target._x<this.area.x?this.area.x-this.target._x:this.target._x>this.area.x+this.area.width?this.target._x-this.area.x-this.area.width:0)/this.elasticDistance),this._elasticRateY=Math.max(0,1-(this.target._y<this.area.y?this.area.y-this.target.y:this.target._y>this.area.y+this.area.height?this.target._y-this.area.y-this.area.height:0)/this.elasticDistance))};c.backToArea=function(){this.target.x=Math.min(Math.max(this.target._x,this.area.x),this.area.x+this.area.width);this.target.y=Math.min(Math.max(this.target._y,this.area.y),this.area.y+this.area.height)};c.onStageMouseUp=function(b){ha.instance.disableMouseEvent=!1;l.stage.off("mouseup",this,this.onStageMouseUp);l.stage.off("mouseout",this,this.onStageMouseUp);l.systemTimer.clear(this,this.loop);if(!this._clickOnly&&this.target)if(this.hasInertia){1>this._offsets.length&&this._offsets.push(this._parent.mouseX-this._lastX,this._parent.mouseY-this._lastY);this._offsetX=this._offsetY=0;var d=this._offsets.length;b=Math.min(d,6);for(var a=this._offsets.length-b,d=d-1;d>a;d--)this._offsetY+=this._offsets[d--],this._offsetX+=this._offsets[d];this._offsetX=this._offsetX/b*2;this._offsetY=this._offsetY/b*2;Math.abs(this._offsetX)>this.maxOffset&&(this._offsetX=0<this._offsetX?this.maxOffset:-this.maxOffset);Math.abs(this._offsetY)>this.maxOffset&&(this._offsetY=0<this._offsetY?this.maxOffset:-this.maxOffset);l.systemTimer.frameLoop(1,this,this.tweenMove)}else 0<this.elasticDistance?this.checkElastic():this.clear()};c.checkElastic=function(){var b=NaN,d=NaN;this.target.x<this.area.x?b=this.area.x:this.target._x>this.area.x+this.area.width&&(b=this.area.x+this.area.width);this.target.y<this.area.y?d=this.area.y:this.target._y>this.area.y+this.area.height&&(d=this.area.y+this.area.height);if(isNaN(b)&&isNaN(d))this.clear();else{var a={};isNaN(b)||(a.x=b);isNaN(d)||(a.y=d);this._tween=Wa.to(this.target,a,this.elasticBackTime,Da.sineOut,S.create(this,this.clear),0,!1,!1)}};c.tweenMove=function(){this._offsetX=this._offsetX*this.ratio*this._elasticRateX;this._offsetY=this._offsetY*this.ratio*this._elasticRateY;this.target.x+=this._offsetX;this.target.y+=this._offsetY;this.area&&this.checkArea();this.target.event("dragmove",this.data);if(1>Math.abs(this._offsetX)&&1>Math.abs(this._offsetY)||.5>this._elasticRateX||.5>this._elasticRateY)l.systemTimer.clear(this,this.tweenMove),0<this.elasticDistance?this.checkElastic():this.clear()};c.clear=function(){if(this.target){this.clearTimer();var b=this.target;this._parent=this.target=null;b.event("dragend",this.data)}};return a}(),ic=function(){function a(){}p(a,"laya.webgl.shapes.Earcut");a.earcut=function(c,b,d){d=d||2;var e=b&&b.length,f=e?b[0]*d:c.length,g=a.linkedList(c,0,f,d,!0),h=[];if(!g)return h;var k,n,q,l;e&&(g=a.eliminateHoles(c,b,g,d));if(c.length>80*d){k=b=c[0];n=e=c[1];for(var m=d;m<f;m+=d)q=c[m],l=c[m+1],q<k&&(k=q),l<n&&(n=l),q>b&&(b=q),l>e&&(e=l);q=Math.max(b-k,e-n);q=0!==q?1/q:0}a.earcutLinked(g,h,d,k,n,q);return h};a.linkedList=function(c,b,d,e,f){var g;if(f===0<a.signedArea(c,b,d,e))for(f=b;f<d;f+=e)g=a.insertNode(f,c[f],c[f+1],g);else for(f=d-e;f>=b;f-=e)g=a.insertNode(f,c[f],c[f+1],g);g&&a.equals(g,g.next)&&(a.removeNode(g),g=g.next);return g};a.filterPoints=function(c,b){if(!c)return c;b||(b=c);var d=c,e;do if(e=!1,d.steiner||!a.equals(d,d.next)&&0!==a.area(d.prev,d,d.next))d=d.next;else{a.removeNode(d);d=b=d.prev;if(d===d.next)break;e=!0}while(e||d!==b);return b};a.earcutLinked=function(c,b,d,e,f,g,h){if(c){!h&&g&&a.indexCurve(c,e,f,g);for(var k=c,n,q;c.prev!==c.next;)if(n=c.prev,q=c.next,g?a.isEarHashed(c,e,f,g):a.isEar(c))b.push(n.i/d),b.push(c.i/d),b.push(q.i/d),a.removeNode(c),k=c=q.next;else if(c=q,c===k){h?1===h?(c=a.cureLocalIntersections(c,b,d),a.earcutLinked(c,b,d,e,f,g,2)):2===h&&a.splitEarcut(c,b,d,e,f,g):a.earcutLinked(a.filterPoints(c,null),b,d,e,f,g,1);break}}};a.isEar=function(c){var b=c.prev,d=c.next;if(0<=a.area(b,c,d))return!1;for(var e=c.next.next;e!==c.prev;){if(a.pointInTriangle(b.x,b.y,c.x,c.y,d.x,d.y,e.x,e.y)&&0<=a.area(e.prev,e,e.next))return!1;e=e.next}return!0};a.isEarHashed=function(c,b,d,e){var f=c.prev,g=c.next;if(0<=a.area(f,c,g))return!1;var h=f.x>c.x?f.x>g.x?f.x:g.x:c.x>g.x?c.x:g.x,k=f.y>c.y?f.y>g.y?f.y:g.y:c.y>g.y?c.y:g.y,n=a.zOrder(f.x<c.x?f.x<g.x?f.x:g.x:c.x<g.x?c.x:g.x,f.y<c.y?f.y<g.y?f.y:g.y:c.y<g.y?c.y:g.y,b,d,e);b=a.zOrder(h,k,b,d,e);for(d=c.nextZ;d&&d.z<=b;){if(d!==c.prev&&d!==c.next&&a.pointInTriangle(f.x,f.y,c.x,c.y,g.x,g.y,d.x,d.y)&&0<=a.area(d.prev,d,d.next))return!1;d=d.nextZ}for(d=c.prevZ;d&&d.z>=n;){if(d!==c.prev&&d!==c.next&&a.pointInTriangle(f.x,f.y,c.x,c.y,g.x,g.y,d.x,d.y)&&0<=a.area(d.prev,d,d.next))return!1;d=d.prevZ}return!0};a.cureLocalIntersections=function(c,b,d){var e=c;do{var f=e.prev,g=e.next.next;!a.equals(f,g)&&a.intersects(f,e,e.next,g)&&a.locallyInside(f,g)&&a.locallyInside(g,f)&&(b.push(f.i/d),b.push(e.i/d),b.push(g.i/d),a.removeNode(e),a.removeNode(e.next),e=c=g);e=e.next}while(e!==c);return e};a.splitEarcut=function(c,b,d,e,f,g){var h=c;do{for(var k=h.next.next;k!==h.prev;){if(h.i!==k.i&&a.isValidDiagonal(h,k)){c=a.splitPolygon(h,k);h=a.filterPoints(h,h.next);c=a.filterPoints(c,c.next);a.earcutLinked(h,b,d,e,f,g);a.earcutLinked(c,b,d,e,f,g);return}k=k.next}h=h.next}while(h!==c)};a.eliminateHoles=function(c,b,d,e){var f=[],g,h,k,n;g=0;for(h=b.length;g<h;g++)k=b[g]*e,n=g<h-1?b[g+1]*e:c.length,k=a.linkedList(c,k,n,e,!1),k===k.next&&(k.steiner=!0),f.push(a.getLeftmost(k));f.sort(a.compareX);for(g=0;g<f.length;g++)a.eliminateHole(f[g],d),d=a.filterPoints(d,d.next);return d};a.compareX=function(a,b){return a.x-b.x};a.eliminateHole=function(c,b){if(b=a.findHoleBridge(c,b)){var d=a.splitPolygon(b,c);a.filterPoints(d,d.next)}};a.findHoleBridge=function(c,b){var d=b,e=c.x,f=c.y,g=-Infinity,h;do{if(f<=d.y&&f>=d.next.y&&d.next.y!==d.y){var k=d.x+(f-d.y)*(d.next.x-d.x)/(d.next.y-d.y);if(k<=e&&k>g){g=k;if(k===e){if(f===d.y)return d;if(f===d.next.y)return d.next}h=d.x<d.next.x?d:d.next}}d=d.next}while(d!==b);if(!h)return null;if(e===g)return h.prev;for(var k=h,n=h.x,q=h.y,l=Infinity,m,d=h.next;d!==k;)e>=d.x&&d.x>=n&&e!==d.x&&a.pointInTriangle(f<q?e:g,f,n,q,f<q?g:e,f,d.x,d.y)&&(m=Math.abs(f-d.y)/(e-d.x),(m<l||m===l&&d.x>h.x)&&a.locallyInside(d,c)&&(h=d,l=m)),d=d.next;return h};a.indexCurve=function(c,b,d,e){var f=c;do null===f.z&&(f.z=a.zOrder(f.x,f.y,b,d,e)),f.prevZ=f.prev,f=f.nextZ=f.next;while(f!==c);f.prevZ.nextZ=null;f.prevZ=null;a.sortLinked(f)};a.sortLinked=function(a){var b,d,c,f,g,h,k,n=1;do{d=a;f=a=null;for(g=0;d;){g++;c=d;for(b=h=0;b<n&&(h++,c=c.nextZ,c);b++);for(k=n;0<h||0<k&&c;)0!==h&&(0===k||!c||d.z<=c.z)?(b=d,d=d.nextZ,h--):(b=c,c=c.nextZ,k--),f?f.nextZ=b:a=b,b.prevZ=f,f=b;d=c}f.nextZ=null;n*=2}while(1<g);return a};a.zOrder=function(a,b,d,e,f){a=32767*(a-d)*f;b=32767*(b-e)*f;a=(a|a<<8)&16711935;a=(a|a<<4)&252645135;a=(a|a<<2)&858993459;b=(b|b<<8)&16711935;b=(b|b<<4)&252645135;b=(b|b<<2)&858993459;return(a|a<<1)&1431655765|((b|b<<1)&1431655765)<<1};a.getLeftmost=function(a){var b=a,d=a;do b.x<d.x&&(d=b),b=b.next;while(b!==a);return d};a.pointInTriangle=function(a,b,d,e,f,g,h,k){return 0<=(f-h)*(b-k)-(a-h)*(g-k)&&0<=(a-h)*(e-k)-(d-h)*(b-k)&&0<=(d-h)*(g-k)-(f-h)*(e-k)};a.isValidDiagonal=function(c,b){return c.next.i!==b.i&&c.prev.i!==b.i&&!a.intersectsPolygon(c,b)&&a.locallyInside(c,b)&&a.locallyInside(b,c)&&a.middleInside(c,b)};a.area=function(a,b,d){return(b.y-a.y)*(d.x-b.x)-(b.x-a.x)*(d.y-b.y)};a.equals=function(a,b){return a.x===b.x&&a.y===b.y};a.intersects=function(c,b,d,e){return a.equals(c,b)&&a.equals(d,e)||a.equals(c,e)&&a.equals(d,b)?!0:0<a.area(c,b,d)!==0<a.area(c,b,e)&&0<a.area(d,e,c)!==0<a.area(d,e,b)};a.intersectsPolygon=function(c,b){var d=c;do{if(d.i!==c.i&&d.next.i!==c.i&&d.i!==b.i&&d.next.i!==b.i&&a.intersects(d,d.next,c,b))return!0;d=d.next}while(d!==c);return!1};a.locallyInside=function(c,b){return 0>a.area(c.prev,c,c.next)?0<=a.area(c,b,c.next)&&0<=a.area(c,c.prev,b):0>a.area(c,b,c.prev)||0>a.area(c,c.next,b)};a.middleInside=function(a,b){var d=a,c=!1,f=(a.x+b.x)/2,g=(a.y+b.y)/2;do d.y>g!==d.next.y>g&&d.next.y!==d.y&&f<(d.next.x-d.x)*(g-d.y)/(d.next.y-d.y)+d.x&&(c=!c),d=d.next;while(d!==a);return c};a.splitPolygon=function(a,b){var d=new Xa(a.i,a.x,a.y),c=new Xa(b.i,b.x,b.y),f=a.next,g=b.prev;a.next=b;b.prev=a;d.next=f;f.prev=d;c.next=d;d.prev=c;g.next=c;c.prev=g;return c};a.insertNode=function(a,b,d,e){a=new Xa(a,b,d);e?(a.next=e.next,a.prev=e,e.next.prev=a,e.next=a):(a.prev=a,a.next=a);return a};a.removeNode=function(a){a.next.prev=a.prev;a.prev.next=a.next;a.prevZ&&(a.prevZ.nextZ=a.nextZ);a.nextZ&&(a.nextZ.prevZ=a.prevZ)};a.signedArea=function(a,b,d,e){for(var c=0,g=d-e;b<d;b+=e)c+=(a[g]-a[b])*(a[b+1]+a[g+1]),g=b;return c};return a}(),vb=function(){function a(b){this.childs=[];this.text="";this.name=this.parent=null;this.noCompile=!1;this.condition=this.includefiles=null;this.conditionType=0;this.useFuns="";this.z=0;this.src=null;this.includefiles=b}p(a,"laya.webgl.utils.ShaderNode");var c=a.prototype;c.setParent=function(b){b.childs.push(this);this.z=b.z+1;this.parent=b};c.setCondition=function(b,d){b&&(this.conditionType=d,b=b.replace(/(\s*$)/g,""),this.condition=function(){return this[b]},this.condition.__condition=b)};c.toscript=function(b,d){return this._toscript(b,d,++a.__id)};c._toscript=function(b,d,a){if(1>this.childs.length&&!this.text)return d;if(this.condition){var c=!!this.condition.call(b);2===this.conditionType&&(c=!c);if(!c)return d}this.text&&d.push(this.text);0<this.childs.length&&this.childs.forEach(function(c,e,f){c._toscript(b,d,a)});if(0<this.includefiles.length&&0<this.useFuns.length)for(var e=0,h=this.includefiles.length;e<h;e++)this.includefiles[e].curUseID!=a&&(c=this.includefiles[e].file.getFunsScript(this.useFuns),0<c.length&&(this.includefiles[e].curUseID=a,d[0]=c+d[0]));return d};a.__id=1;return a}(),yc=function(){function a(){}p(a,"laya.display.cmd.TranslateCmd");var c=a.prototype;c.recover=function(){w.recover("TranslateCmd",this)};c.run=function(b,d,a){b.translate(this.tx,this.ty)};m(0,c,"cmdID",function(){return"Translate"});a.create=function(b,d){var c=w.getItemByClass("TranslateCmd",a);c.tx=b;c.ty=d;return c};a.ID="Translate";return a}(),N=function(){function a(b,d){void 0===b&&(b=0);void 0===d&&(d=0);this.x=b;this.y=d}p(a,"laya.maths.Point");var c=a.prototype;c.setTo=function(b,d){this.x=b;this.y=d;return this};c.reset=function(){this.x=this.y=0;return this};c.recover=function(){w.recover("Point",this.reset())};c.distance=function(b,d){return Math.sqrt((this.x-b)*(this.x-b)+(this.y-d)*(this.y-d))};c.toString=function(){return this.x+","+this.y};c.normalize=function(){var b=Math.sqrt(this.x*this.x+this.y*this.y);0<b&&(b=1/b,this.x*=b,this.y*=b)};c.copy=function(b){return this.setTo(b.x,b.y)};a.create=function(){return w.getItemByClass("Point",a)};a.TEMP=new a;a.EMPTY=new a;return a}();(function(){function a(){}p(a,"laya.Const");a.NOT_ACTIVE=1;a.ACTIVE_INHIERARCHY=2;a.AWAKED=4;a.NOT_READY=8;a.DISPLAY=16;a.HAS_ZORDER=32;a.HAS_MOUSE=64;a.DISPLAYED_INSTAGE=128;a.DRAWCALL_OPTIMIZE=256;return a})();var jc=function(){function a(){}p(a,"laya.webgl.shapes.BasePoly");a.createLine2=function(c,b,d,e,f,g){if(4>c.length)return null;var h=a.tempData.length>c.length+2?a.tempData:Array(c.length+2);h[0]=c[0];h[1]=c[1];var k=2,n,q=c.length;for(n=2;n<q;n+=2).01<Math.abs(c[n]-c[n-2])+Math.abs(c[n+1]-c[n-1])&&(h[k++]=c[n],h[k++]=c[n+1]);g&&.01<Math.abs(c[0]-h[k-2])+Math.abs(c[1]-h[k-1])&&(h[k++]=c[0],h[k++]=c[1]);q=k/2;c=d/2;var l,m,p,r,t,v,w,y,x,z,A;p=h[0];r=h[1];d=h[2];g=h[3];l=-(r-g);m=p-d;x=Math.sqrt(l*l+m*m);l=l/x*c;m=m/x*c;f.push(p-l,r-m,p+l,r+m);for(n=1;n<q-1;n++)p=h[2*(n-1)],r=h[2*(n-1)+1],d=h[2*n],g=h[2*n+1],t=h[2*(n+1)],v=h[2*(n+1)+1],l=-(r-g),m=p-d,x=Math.sqrt(l*l+m*m),l=l/x*c,m=m/x*c,w=-(g-v),y=d-t,x=Math.sqrt(w*w+y*y),w=w/x*c,y=y/x*c,x=-m+r-(-m+g),z=-l+d-(-l+p),p=(-l+p)*(-m+g)-(-l+d)*(-m+r),r=-y+v-(-y+g),A=-w+d-(-w+t),t=(-w+t)*(-y+g)-(-w+d)*(-y+v),v=x*A-r*z,.1>Math.abs(v)?f.push(d-l,g-m,d+l,g+m):(l=(z*t-A*p)/v,m=(r*p-x*t)/v,f.push(l,m,d-(l-d),g-(m-g)));p=h[k-4];r=h[k-3];d=h[k-2];g=h[k-1];l=-(r-g);m=p-d;x=Math.sqrt(l*l+m*m);l=l/x*c;m=m/x*c;f.push(d-l,g-m,d+l,g+m);for(n=1;n<q;n++)b.push(e+2*(n-1),e+2*(n-1)+1,e+2*n+1,e+2*n+1,e+2*n,e+2*(n-1));return f};a.createLineTriangle=function(a,b,d,e,f,g,h){a=a.slice();b=a.length;d=a[0];f=a[1];var c,n,q=c=g=0;h=b/2;if(!(1>=h)&&2!=h){for(var l=Array(4*h),m=0,p=0,r=0;r<h-1;r++)d=a[p++],f=a[p++],c=a[p++],n=a[p++],c-=d,q=n-f,0!=c&&0!=q&&(g=Math.sqrt(c*c+q*q),.001<g&&(n=4*m,l[n]=d,l[n+1]=f,l[n+2]=c/g,l[n+3]=q/g,m++));e?(d=a[b-2],f=a[b-1],c=a[0],n=a[1],c-=d,q=n-f,0!=c&&0!=q&&(g=Math.sqrt(c*c+q*q),.001<g&&(n=4*m,l[n]=d,l[n+1]=f,l[n+2]=c/g,l[n+3]=q/g))):(n=4*m,l[n]=d,l[n+1]=f,l[n+2]=c/g,l[n+3]=q/g);for(r=0;r<h;r++);}};t(a,["tempData",function(){return this.tempData=Array(256)}]);return a}(),zc=function(){function a(){}p(a,"laya.display.cmd.ScaleCmd");var c=a.prototype;c.recover=function(){w.recover("ScaleCmd",this)};c.run=function(b,d,a){b._scale(this.scaleX,this.scaleY,this.pivotX+d,this.pivotY+a)};m(0,c,"cmdID",function(){return"Scale"});a.create=function(b,d,c,f){var e=w.getItemByClass("ScaleCmd",a);e.scaleX=b;e.scaleY=d;e.pivotX=c;e.pivotY=f;return e};a.ID="Scale";return a}(),Ac=function(){function a(){}p(a,"laya.display.cmd.AlphaCmd");var c=a.prototype;c.recover=function(){w.recover("AlphaCmd",this)};c.run=function(b,d,a){b.alpha(this.alpha)};m(0,c,"cmdID",function(){return"Alpha"});a.create=function(b){var d=w.getItemByClass("AlphaCmd",a);d.alpha=b;return d};a.ID="Alpha";return a}(),wb=function(){function a(b){this._xd_=!0;this._allocated_=8;this._length=this._pos_=0;b?(this._u8d_=new Uint8Array(b),this._d_=new DataView(this._u8d_.buffer),this._length=this._d_.byteLength):this._resizeBuffer(this._allocated_)}p(a,"laya.utils.Byte");var c=a.prototype;c._resizeBuffer=function(b){try{var d=new Uint8Array(b);null!=this._u8d_&&(this._u8d_.length<=b?d.set(this._u8d_):d.set(this._u8d_.subarray(0,b)));this._u8d_=d;this._d_=new DataView(d.buffer)}catch(e){throw"Invalid typed array length:"+b;}};c.getString=function(){return this.readString()};c.readString=function(){return this._rUTF(this.getUint16())};c.getFloat32Array=function(b,d){return this.readFloat32Array(b,d)};c.readFloat32Array=function(b,d){var a=b+d,a=a>this._length?this._length:a,c=new Float32Array(this._d_.buffer.slice(b,a));this._pos_=a;return c};c.getUint8Array=function(b,d){return this.readUint8Array(b,d)};c.readUint8Array=function(b,d){var a=b+d,a=a>this._length?this._length:a,c=new Uint8Array(this._d_.buffer.slice(b,a));this._pos_=a;return c};c.getInt16Array=function(b,d){return this.readInt16Array(b,d)};c.readInt16Array=function(b,d){var a=b+d,a=a>this._length?this._length:a,c=new Int16Array(this._d_.buffer.slice(b,a));this._pos_=a;return c};c.getFloat32=function(){return this.readFloat32()};c.readFloat32=function(){if(this._pos_+4>this._length)throw"getFloat32 error - Out of bounds";var b=this._d_.getFloat32(this._pos_,this._xd_);this._pos_+=4;return b};c.getFloat64=function(){return this.readFloat64()};c.readFloat64=function(){if(this._pos_+8>this._length)throw"getFloat64 error - Out of bounds";var b=this._d_.getFloat64(this._pos_,this._xd_);this._pos_+=8;return b};c.writeFloat32=function(b){this._ensureWrite(this._pos_+4);this._d_.setFloat32(this._pos_,b,this._xd_);this._pos_+=4};c.writeFloat64=function(b){this._ensureWrite(this._pos_+8);this._d_.setFloat64(this._pos_,b,this._xd_);this._pos_+=8};c.getInt32=function(){return this.readInt32()};c.readInt32=function(){if(this._pos_+4>this._length)throw"getInt32 error - Out of bounds";var b=this._d_.getInt32(this._pos_,this._xd_);this._pos_+=4;return b};c.getUint32=function(){return this.readUint32()};c.readUint32=function(){if(this._pos_+4>this._length)throw"getUint32 error - Out of bounds";var b=this._d_.getUint32(this._pos_,this._xd_);this._pos_+=4;return b};c.writeInt32=function(b){this._ensureWrite(this._pos_+4);this._d_.setInt32(this._pos_,b,this._xd_);this._pos_+=4};c.writeUint32=function(b){this._ensureWrite(this._pos_+4);this._d_.setUint32(this._pos_,b,this._xd_);this._pos_+=4};c.getInt16=function(){return this.readInt16()};c.readInt16=function(){if(this._pos_+2>this._length)throw"getInt16 error - Out of bounds";var b=this._d_.getInt16(this._pos_,this._xd_);this._pos_+=2;return b};c.getUint16=function(){return this.readUint16()};c.readUint16=function(){if(this._pos_+2>this._length)throw"getUint16 error - Out of bounds";var b=this._d_.getUint16(this._pos_,this._xd_);this._pos_+=2;return b};c.writeUint16=function(b){this._ensureWrite(this._pos_+2);this._d_.setUint16(this._pos_,b,this._xd_);this._pos_+=2};c.writeInt16=function(b){this._ensureWrite(this._pos_+2);this._d_.setInt16(this._pos_,b,this._xd_);this._pos_+=2};c.getUint8=function(){return this.readUint8()};c.readUint8=function(){if(this._pos_+1>this._length)throw"getUint8 error - Out of bounds";return this._u8d_[this._pos_++]};c.writeUint8=function(b){this._ensureWrite(this._pos_+1);this._d_.setUint8(this._pos_,b);this._pos_++};c._getUInt8=function(b){return this._readUInt8(b)};c._readUInt8=function(b){return this._d_.getUint8(b)};c._getUint16=function(b){return this._readUint16(b)};c._readUint16=function(b){return this._d_.getUint16(b,this._xd_)};c._getMatrix=function(){return this._readMatrix()};c._readMatrix=function(){return new I(this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32())};c._rUTF=function(b){b=this._pos_+b;var d,a,c,g=String.fromCharCode,h=this._u8d_,k=0,n=[],q=0;for(n.length=1E3;this._pos_<b;)d=h[this._pos_++],128>d?0!=d&&(n[q++]=g(d)):224>d?n[q++]=g((d&63)<<6|h[this._pos_++]&127):240>d?(a=h[this._pos_++],n[q++]=g((d&31)<<12|(a&127)<<6|h[this._pos_++]&127)):(a=h[this._pos_++],c=h[this._pos_++],n[q++]=g((d&15)<<18|(a&127)<<12|c<<6&127|h[this._pos_++]&127)),k++;n.length=q;return n.join("")};c.getCustomString=function(b){return this.readCustomString(b)};c.readCustomString=function(b){for(var d="",a,c,g,h=String.fromCharCode,k=this._u8d_;0<b;)if(c=k[this._pos_],128>c)d+=h(c),this._pos_++,b--;else for(a=c-128,this._pos_++,b-=a;0<a;)c=k[this._pos_++],g=k[this._pos_++],d+=h(g<<8|c),a--;return d};c.clear=function(){this.length=this._pos_=0};c.__getBuffer=function(){return this._d_.buffer};c.writeUTFBytes=function(b){b+="";for(var d=0,a=b.length;d<a;d++){var c=b.charCodeAt(d);127>=c?this.writeByte(c):2047>=c?(this._ensureWrite(this._pos_+2),this._u8d_.set([192|c>>6,128|c&63],this._pos_),this._pos_+=2):65535>=c?(this._ensureWrite(this._pos_+3),this._u8d_.set([224|c>>12,128|c>>6&63,128|c&63],this._pos_),this._pos_+=3):(this._ensureWrite(this._pos_+4),this._u8d_.set([240|c>>18,128|c>>12&63,128|c>>6&63,128|c&63],this._pos_),this._pos_+=4)}};c.writeUTFString=function(b){var d=this.pos;this.writeUint16(1);this.writeUTFBytes(b);this._d_.setUint16(d,this.pos-d-2,this._xd_)};c.readUTFString=function(){return this.readUTFBytes(this.getUint16())};c.getUTFString=function(){return this.readUTFString()};c.readUTFBytes=function(b){void 0===b&&(b=-1);if(0===b)return"";var d=this.bytesAvailable;if(b>d)throw"readUTFBytes error - Out of bounds";return this._rUTF(0<b?b:d)};c.getUTFBytes=function(b){void 0===b&&(b=-1);return this.readUTFBytes(b)};c.writeByte=function(b){this._ensureWrite(this._pos_+1);this._d_.setInt8(this._pos_,b);this._pos_+=1};c.readByte=function(){if(this._pos_+1>this._length)throw"readByte error - Out of bounds";return this._d_.getInt8(this._pos_++)};c.getByte=function(){return this.readByte()};c._ensureWrite=function(b){this._length<b&&(this._length=b);this._allocated_<b&&(this.length=b)};c.writeArrayBuffer=function(b,d,a){void 0===d&&(d=0);void 0===a&&(a=0);if(0>d||0>a)throw"writeArrayBuffer error - Out of bounds";0==a&&(a=b.byteLength-d);this._ensureWrite(this._pos_+a);b=new Uint8Array(b);this._u8d_.set(b.subarray(d,d+a),this._pos_);this._pos_+=a};c.readArrayBuffer=function(b){var d;d=this._u8d_.buffer.slice(this._pos_,this._pos_+b);this._pos_+=b;return d};m(0,c,"buffer",function(){var b=this._d_.buffer;return b.byteLength===this._length?b:b.slice(0,this._length)});m(0,c,"endian",function(){return this._xd_?"littleEndian":"bigEndian"},function(b){this._xd_="littleEndian"===b});m(0,c,"length",function(){return this._length},function(b){this._allocated_<b?this._resizeBuffer(this._allocated_=Math.floor(Math.max(b,2*this._allocated_))):this._allocated_>b&&this._resizeBuffer(this._allocated_=b);this._length=b});m(0,c,"pos",function(){return this._pos_},function(b){this._pos_=b});m(0,c,"bytesAvailable",function(){return this._length-this._pos_});a.getSystemEndian=function(){if(!a._sysEndian){var b=new ArrayBuffer(2);(new DataView(b)).setInt16(0,256,!0);a._sysEndian=256===(new Int16Array(b))[0]?"littleEndian":"bigEndian"}return a._sysEndian};a.BIG_ENDIAN="bigEndian";a.LITTLE_ENDIAN="littleEndian";a._sysEndian=null;return a}(),oa=function(){function a(){this._pool=[];this._map=[];this._laters=[]}var c;p(a,"laya.utils.CallLater");var b=a.prototype;b._update=function(){var b=this._laters,a=b.length;if(0<a){for(var c=0,a=a-1;c<=a;c++){var g=b[c];this._map[g.key]=null;null!==g.method&&(g.run(),g.clear());this._pool.push(g);c===a&&(a=b.length-1)}b.length=0}};b._getHandler=function(b,a){var d=b?b.$_GID||(b.$_GID=L.getGID()):0,c=a.$_TID||(a.$_TID=1E5*ga._mid++);return this._map[d+c]};b.callLater=function(b,a,f){if(null==this._getHandler(b,a)){var d=this._pool.length?this._pool.pop():new c;d.caller=b;d.method=a;d.args=f;d.key=(b?b.$_GID:0)+a.$_TID;this._map[d.key]=d;this._laters.push(d)}};b.runCallLater=function(b,a){var d=this._getHandler(b,a);d&&null!=d.method&&(this._map[d.key]=null,d.run(),d.clear())};a.I=new a;a.__init$=function(){c=function(){function b(){this.key=0;this.args=this.method=this.caller=null}p(b,"");var a=b.prototype;a.clear=function(){this.args=this.method=this.caller=null};a.run=function(){var b=this.caller;if(b&&b.destroyed)return this.clear();var d=this.method,a=this.args;null!=d&&(a?d.apply(b,a):d.call(b))};return b}()};return a}(),sa=function(){function a(){this._graphicBounds=this._vectorgraphArray=this._cmds=this._one=this._sp=null;this.autoDestroy=!1;this._render=this._renderEmpty;this._createData()}p(a,"laya.display.Graphics");var c=a.prototype;c._createData=function(){};c._clearData=function(){};c._destroyData=function(){};c.destroy=function(){this.clear(!0);this._graphicBounds&&this._graphicBounds.destroy();this._vectorgraphArray=this._graphicBounds=null;this._sp&&(this._sp._renderType=0,this._sp._setRenderType(0),this._sp=null);this._destroyData()};c.clear=function(b){void 0===b&&(b=!0);if(b)if(b=this._one,this._cmds){var d,a=this._cmds.length;for(d=0;d<a;d++)b=this._cmds[d],b.recover();this._cmds.length=0}else b&&b.recover();else this._cmds=null;this._one=null;this._render=this._renderEmpty;this._clearData();this._sp&&(this._sp._renderType&=-513,this._sp._setRenderType(this._sp._renderType));this._repaint();if(this._vectorgraphArray){d=0;for(a=this._vectorgraphArray.length;d<a;d++)za.getInstance().deleteShape(this._vectorgraphArray[d]);this._vectorgraphArray.length=0}};c._clearBoundsCache=function(){this._graphicBounds&&this._graphicBounds.reset()};c._initGraphicBounds=function(){this._graphicBounds||(this._graphicBounds=sc.create(),this._graphicBounds._graphics=this)};c._repaint=function(){this._clearBoundsCache();this._sp&&this._sp.repaint()};c._isOnlyOne=function(){return!this._cmds||0===this._cmds.length};c.getBounds=function(b){void 0===b&&(b=!1);this._initGraphicBounds();return this._graphicBounds.getBounds(b)};c.getBoundPoints=function(b){void 0===b&&(b=!1);this._initGraphicBounds();return this._graphicBounds.getBoundPoints(b)};c.drawImage=function(b,d,a,c,g){void 0===d&&(d=0);void 0===a&&(a=0);void 0===c&&(c=0);void 0===g&&(g=0);if(!b)return null;c||(c=b.sourceWidth);g||(g=b.sourceHeight);if(b.getIsReady()){var e=c/b.sourceWidth,f=g/b.sourceHeight;c=b.width*e;g=b.height*f;if(0>=c||0>=g)return null;d+=b.offsetX*e;a+=b.offsetY*f}this._sp&&(this._sp._renderType|=512,this._sp._setRenderType(this._sp._renderType));b=Fb.create.call(this,b,d,a,c,g);null==this._one?(this._one=b,this._render=this._renderOneImg):this._saveToCmd(null,b);this._repaint();return b};c.drawTexture=function(b,d,a,c,g,h,k,n,q){void 0===d&&(d=0);void 0===a&&(a=0);void 0===c&&(c=0);void 0===g&&(g=0);void 0===k&&(k=1);if(!b||.01>k||!b.getIsReady())return null;c||(c=b.sourceWidth);g||(g=b.sourceHeight);if(b.getIsReady()){var e=c/b.sourceWidth,f=g/b.sourceHeight;c=b.width*e;g=b.height*f;if(0>=c||0>=g)return null;d+=b.offsetX*e;a+=b.offsetY*f}this._sp&&(this._sp._renderType|=512,this._sp._setRenderType(this._sp._renderType));b=Tb.create.call(this,b,d,a,c,g,h,k,n,q);this._repaint();return this._saveToCmd(null,b)};c.drawTextures=function(b,d){return b?this._saveToCmd(v._context.drawTextures,ec.create.call(this,b,d)):null};c.drawTriangles=function(b,d,a,c,g,h,k,n,q,l){void 0===n&&(n=1);return this._saveToCmd(v._context.drawTriangles,Gb.create.call(this,b,d,a,c,g,h,k,n,q,l))};c.fillTexture=function(b,d,a,c,g,h,k){void 0===c&&(c=0);void 0===g&&(g=0);void 0===h&&(h="repeat");return b&&b.getIsReady()?this._saveToCmd(v._context._fillTexture,Eb.create.call(this,b,d,a,c,g,h,k||N.EMPTY,{})):null};c._saveToCmd=function(b,d){this._sp&&(this._sp._renderType|=512,this._sp._setRenderType(this._sp._renderType));null==this._one?(this._one=d,this._render=this._renderOne):(this._render=this._renderAll,0===(this._cmds||(this._cmds=[])).length&&this._cmds.push(this._one),this._cmds.push(d));this._repaint();return d};c.clipRect=function(b,d,a,c){return this._saveToCmd(v._context.clipRect,Pb.create.call(this,b,d,a,c))};c.fillText=function(b,d,a,c,g,h){return this._saveToCmd(v._context.fillText,Bc.create.call(this,b,d,a,c||O.defaultFontStr(),g,h))};c.fillBorderText=function(b,d,a,c,g,h,k,n){return this._saveToCmd(v._context.fillBorderText,tc.create.call(this,b,d,a,c||O.defaultFontStr(),g,h,k,n))};c.fillWords=function(b,d,a,c,g){return this._saveToCmd(v._context.fillWords,bc.create.call(this,b,d,a,c||O.defaultFontStr(),g))};c.fillBorderWords=function(b,d,a,c,g,h,k){return this._saveToCmd(v._context.fillBorderWords,Cc.create.call(this,b,d,a,c||O.defaultFontStr(),g,h,k))};c.strokeText=function(b,d,a,c,g,h,k){return this._saveToCmd(v._context.fillBorderText,Dc.create.call(this,b,d,a,c||O.defaultFontStr(),null,g,h,k))};c.alpha=function(b){return this._saveToCmd(v._context.alpha,Ac.create.call(this,b))};c.transform=function(b,d,a){void 0===d&&(d=0);void 0===a&&(a=0);return this._saveToCmd(v._context._transform,dc.create.call(this,b,d,a))};c.rotate=function(b,d,a){void 0===d&&(d=0);void 0===a&&(a=0);return this._saveToCmd(v._context._rotate,Ec.create.call(this,b,d,a))};c.scale=function(b,d,a,c){void 0===a&&(a=0);void 0===c&&(c=0);return this._saveToCmd(v._context._scale,zc.create.call(this,b,d,a,c))};c.translate=function(b,d){return this._saveToCmd(v._context.translate,yc.create.call(this,b,d))};c.save=function(){return this._saveToCmd(v._context._save,nc.create.call(this))};c.restore=function(){return this._saveToCmd(v._context.restore,Nb.create.call(this))};c.replaceText=function(b){this._repaint();var d=this._cmds;if(d)for(var a=d.length-1;-1<a;a--){if(this._isTextCmd(d[a]))return d[a].text=b,!0}else if(this._one&&this._isTextCmd(this._one))return this._one.text=b,!0;return!1};c._isTextCmd=function(b){b=b.cmdID;return"FillText"==b||"StrokeText"==b||"FillBorderText"==b};c.replaceTextColor=function(b){this._repaint();var d=this._cmds;if(d)for(var a=d.length-1;-1<a;a--)this._isTextCmd(d[a])&&this._setTextCmdColor(d[a],b);else this._one&&this._isTextCmd(this._one)&&this._setTextCmdColor(this._one,b)};c._setTextCmdColor=function(b,d){switch(b.cmdID){case "FillText":case "StrokeText":b.color=d;break;case "FillBorderText":case "FillBorderWords":case "FillBorderText":b.fillColor=d}};c.loadImage=function(b,d,a,c,g,h){void 0===d&&(d=0);void 0===a&&(a=0);void 0===c&&(c=0);void 0===g&&(g=0);var e=H.getRes(b);if(e)if(e.getIsReady())this.drawImage(e,d,a,c,g);else e.once("ready",this,this.drawImage,[e,d,a,c,g]);else e=new X,e.load(b),H.cacheRes(b,e),e.once("ready",this,this.drawImage,[e,d,a,c,g]);null!=h&&(e.getIsReady()?h.call(this._sp):e.on("ready",this._sp,h))};c._renderEmpty=function(b,d,a,c){};c._renderAll=function(b,d,a,c){b=this._cmds;for(var e=0,f=b.length;e<f;e++)b[e].run(d,a,c)};c._renderOne=function(b,d,a,c){d.sprite=b;this._one.run(d,a,c)};c._renderOneImg=function(b,d,a,c){d.sprite=b;this._one.run(d,a,c)};c.drawLine=function(b,d,a,c,g,h){void 0===h&&(h=1);var e=1>h||0===h%2?0:.5;return this._saveToCmd(v._context._drawLine,$b.create.call(this,b+e,d+e,a+e,c+e,g,h,0))};c.drawLines=function(b,a,c,f,g){void 0===g&&(g=1);if(!c||4>c.length)return null;var d=1>g||0===g%2?0:.5;return this._saveToCmd(v._context._drawLines,Fc.create.call(this,b+d,a+d,c,f,g,0))};c.drawCurves=function(b,a,c,f,g){void 0===g&&(g=1);return this._saveToCmd(v._context.drawCurves,Gc.create.call(this,b,a,c,f,g))};c.drawRect=function(b,a,c,f,g,h,k){void 0===k&&(k=1);var d=1<=k&&h?k/2:0,e=h?k:0;return this._saveToCmd(v._context.drawRect,Xb.create.call(this,b+d,a+d,c-e,f-e,g,h,k))};c.drawCircle=function(b,a,c,f,g,h){void 0===h&&(h=1);return this._saveToCmd(v._context._drawCircle,fc.create.call(this,b,a,c-(1<=h&&g?h/2:0),f,g,h,0))};c.drawPie=function(b,a,c,f,g,h,k,n){void 0===n&&(n=1);var d=1<=n&&k?n/2:0;return this._saveToCmd(v._context._drawPie,Hb.create.call(this,b+d,a+d,c-(k?n:0),L.toRadian(f),L.toRadian(g),h,k,n,0))};c.drawPoly=function(b,a,c,f,g,h){void 0===h&&(h=1);var d=1<=h&&g?0===h%2?0:.5:0;return this._saveToCmd(v._context._drawPoly,Qb.create.call(this,b+d,a+d,c,f,g,h,6<c.length?!1:!0,0))};c.drawPath=function(b,a,c,f,g){return this._saveToCmd(v._context._drawPath,lc.create.call(this,b,a,c,f,g))};c.draw9Grid=function(b,a,c,f,g,h){void 0===a&&(a=0);void 0===c&&(c=0);void 0===f&&(f=0);void 0===g&&(g=0);this._saveToCmd(null,uc.create(b,a,c,f,g,h))};m(0,c,"cmds",function(){return this._cmds},function(b){this._sp&&(this._sp._renderType|=512,this._sp._setRenderType(this._sp._renderType));this._cmds=b;this._render=this._renderAll;this._repaint()});return a}();(function(){function a(){this.reset()}p(a,"laya.utils.HTMLChar");var c=a.prototype;c.setData=function(b,d,c,f){this["char"]=b;this.charNum=b.charCodeAt(0);this.x=this.y=0;this.width=d;this.height=c;this.style=f;this.isWord=!a._isWordRegExp.test(b);return this};c.reset=function(){this.x=this.y=this.width=this.height=0;this.isWord=!1;this["char"]=null;this.charNum=0;this.style=null;return this};c.recover=function(){w.recover("HTMLChar",this.reset())};c._isChar=function(){return!0};c._getCSSStyle=function(){return this.style};a.create=function(){return w.getItemByClass("HTMLChar",a)};a._isWordRegExp=/[\w.]/;return a})();var vc=function(){function a(b,a,c){this._texCount=this._height=this._width=this.atlasID=0;this._cells=this._rowInfo=null;this._used=0;void 0===b&&(b=0);void 0===a&&(a=0);void 0===c&&(c=0);this._rowInfo=this._cells=null;this.atlasID=c;this._init(b,a)}p(a,"laya.webgl.text.AtlasGrid");var c=a.prototype;c.addRect=function(b,a,c,f){if(!this._get(a,c,f))return!1;this._fill(f.x,f.y,a,c,b);this._texCount++;return!0};c._release=function(){this._rowInfo=this._cells=null};c._init=function(b,a){this._width=b;this._height=a;this._release();if(0==this._width)return!1;this._cells=new Uint8Array(this._width*this._height*3);this._rowInfo=new Uint8Array(this._height);this._used=0;this._clear();return!0};c._get=function(b,a,c){if(b>this._width||a>this._height)return!1;for(var d,e,h=this._width,k=this._height,n=this._cells,q=0;q<k;q++)if(!(this._rowInfo[q]<b))for(var l=0;l<h;){var m=3*(q*h+l);if(0!=n[m]||n[m+1]<b||n[m+2]<a)l+=n[m+1];else{d=l;e=q;for(var p=0;p<b;p++)if(n[3*p+m+2]<a){d=-1;break}if(0>d)l+=n[m+1];else return c.x=d,c.y=e,!0}}return!1};c._fill=function(b,a,c,f,g){var d=this._width,e=this._height;this._check(b+c<=d&&a+f<=e);for(e=a;e<f+a;++e){this._check(this._rowInfo[e]>=c);this._rowInfo[e]-=c;for(var n=0;n<c;n++){var q=3*(b+e*d+n);this._check(0==this._cells[q]);this._cells[q]=g;this._cells[q+1]=c;this._cells[q+2]=f}}if(0<b)for(e=0;e<f;++e){g=0;for(n=b-1;0<=n&&0==this._cells[3*((a+e)*d+n)];--n,++g);for(n=g;0<n;--n)this._cells[3*((a+e)*d+b-n)+1]=n,this._check(0<n)}if(0<a)for(n=b;n<b+c;++n){g=0;for(e=a-1;0<=e&&0==this._cells[3*(n+e*d)];--e,g++);for(e=g;0<e;--e)this._cells[3*(n+(a-e)*d)+2]=e,this._check(0<e)}this._used+=c*f/(this._width*this._height)};c._check=function(b){0==b&&console.log("xtexMerger \u9519\u8bef\u5566")};c._clear=function(){for(var b=this._texCount=0;b<this._height;b++)this._rowInfo[b]=this._width;for(b=0;b<this._height;b++)for(var a=0;a<this._width;a++){var c=3*(b*this._width+a);this._cells[c]=0;this._cells[c+1]=this._width-a;this._cells[c+2]=this._width-b}};return a}(),Dc=function(){function a(){}p(a,"laya.display.cmd.StrokeTextCmd");var c=a.prototype;c.recover=function(){w.recover("StrokeTextCmd",this)};c.run=function(b,a,c){b.strokeWord(this.text,this.x+a,this.y+c,this.font,this.color,this.lineWidth,this.textAlign)};m(0,c,"cmdID",function(){return"StrokeText"});a.create=function(b,d,c,f,g,h,k){var e=w.getItemByClass("StrokeTextCmd",a);e.text=b;e.x=d;e.y=c;e.font=f;e.color=g;e.lineWidth=h;e.textAlign=k;return e};a.ID="StrokeText";return a}(),xb=function(){function a(){}p(a,"laya.webgl.text.ICharRender");var c=a.prototype;c.getWidth=function(b,a){return 0};c.scale=function(b,a){};c.getCharBmp=function(b,a,c,f,g,h,k,n,q,l,m){return null};m(0,c,"canvasWidth",function(){return 0},function(b){});return a}(),Da=function(){function a(){}p(a,"laya.utils.Ease");a.linearNone=function(a,b,d,e){return d*a/e+b};a.linearIn=function(a,b,d,e){return d*a/e+b};a.linearInOut=function(a,b,d,e){return d*a/e+b};a.linearOut=function(a,b,d,e){return d*a/e+b};a.bounceIn=function(c,b,d,e){return d-a.bounceOut(e-c,0,d,e)+b};a.bounceInOut=function(c,b,d,e){return c<.5*e?.5*a.bounceIn(2*c,0,d,e)+b:.5*a.bounceOut(2*c-e,0,d,e)+.5*d+b};a.bounceOut=function(a,b,d,e){return(a/=e)<1/2.75?7.5625*d*a*a+b:a<2/2.75?d*(7.5625*(a-=1.5/2.75)*a+.75)+b:a<2.5/2.75?d*(7.5625*(a-=2.25/2.75)*a+.9375)+b:d*(7.5625*(a-=2.625/2.75)*a+.984375)+b};a.backIn=function(a,b,d,e,f){void 0===f&&(f=1.70158);return d*(a/=e)*a*((f+1)*a-f)+b};a.backInOut=function(a,b,d,e,f){void 0===f&&(f=1.70158);return 1>(a/=.5*e)?.5*d*a*a*(((f*=1.525)+1)*a-f)+b:d/2*((a-=2)*a*(((f*=1.525)+1)*a+f)+2)+b};a.backOut=function(a,b,d,e,f){void 0===f&&(f=1.70158);return d*((a=a/e-1)*a*((f+1)*a+f)+1)+b};a.elasticIn=function(c,b,d,e,f,g){void 0===f&&(f=0);void 0===g&&(g=0);if(0==c)return b;if(1==(c/=e))return b+d;g||(g=.3*e);!f||0<d&&f<d||0>d&&f<-d?(f=d,d=g/4):d=g/a.PI2*Math.asin(d/f);return-(f*Math.pow(2,10*--c)*Math.sin((c*e-d)*a.PI2/g))+b};a.elasticInOut=function(c,b,d,e,f,g){void 0===f&&(f=0);void 0===g&&(g=0);var h;if(0==c)return b;if(2==(c/=.5*e))return b+d;g||(g=.3*e*1.5);!f||0<d&&f<d||0>d&&f<-d?(f=d,h=g/4):h=g/a.PI2*Math.asin(d/f);return 1>c?-.5*f*Math.pow(2,10*--c)*Math.sin((c*e-h)*a.PI2/g)+b:f*Math.pow(2,-10*--c)*Math.sin((c*e-h)*a.PI2/g)*.5+d+b};a.elasticOut=function(c,b,d,e,f,g){void 0===f&&(f=0);void 0===g&&(g=0);var h;if(0==c)return b;if(1==(c/=e))return b+d;g||(g=.3*e);!f||0<d&&f<d||0>d&&f<-d?(f=d,h=g/4):h=g/a.PI2*Math.asin(d/f);return f*Math.pow(2,-10*c)*Math.sin((c*e-h)*a.PI2/g)+d+b};a.strongIn=function(a,b,d,e){return d*(a/=e)*a*a*a*a+b};a.strongInOut=function(a,b,d,e){return 1>(a/=.5*e)?.5*d*a*a*a*a*a+b:.5*d*((a-=2)*a*a*a*a+2)+b};a.strongOut=function(a,b,d,e){return d*((a=a/e-1)*a*a*a*a+1)+b};a.sineInOut=function(a,b,d,e){return.5*-d*(Math.cos(Math.PI*a/e)-1)+b};a.sineIn=function(c,b,d,e){return-d*Math.cos(c/e*a.HALF_PI)+d+b};a.sineOut=function(c,b,d,e){return d*Math.sin(c/e*a.HALF_PI)+b};a.quintIn=function(a,b,d,e){return d*(a/=e)*a*a*a*a+b};a.quintInOut=function(a,b,d,e){return 1>(a/=.5*e)?.5*d*a*a*a*a*a+b:.5*d*((a-=2)*a*a*a*a+2)+b};a.quintOut=function(a,b,d,e){return d*((a=a/e-1)*a*a*a*a+1)+b};a.quartIn=function(a,b,d,e){return d*(a/=e)*a*a*a+b};a.quartInOut=function(a,b,d,e){return 1>(a/=.5*e)?.5*d*a*a*a*a+b:.5*-d*((a-=2)*a*a*a-2)+b};a.quartOut=function(a,b,d,e){return-d*((a=a/e-1)*a*a*a-1)+b};a.cubicIn=function(a,b,d,e){return d*(a/=e)*a*a+b};a.cubicInOut=function(a,b,d,e){return 1>(a/=.5*e)?.5*d*a*a*a+b:.5*d*((a-=2)*a*a+2)+b};a.cubicOut=function(a,b,d,e){return d*((a=a/e-1)*a*a+1)+b};a.quadIn=function(a,b,d,e){return d*(a/=e)*a+b};a.quadInOut=function(a,b,d,e){return 1>(a/=.5*e)?.5*d*a*a+b:.5*-d*(--a*(a-2)-1)+b};a.quadOut=function(a,b,d,e){return-d*(a/=e)*(a-2)+b};a.expoIn=function(a,b,d,e){return 0==a?b:d*Math.pow(2,10*(a/e-1))+b-.001*d};a.expoInOut=function(a,b,d,e){return 0==a?b:a==e?b+d:1>(a/=.5*e)?.5*d*Math.pow(2,10*(a-1))+b:.5*d*(-Math.pow(2,-10*--a)+2)+b};a.expoOut=function(a,b,d,e){return a==e?b+d:d*(-Math.pow(2,-10*a/e)+1)+b};a.circIn=function(a,b,d,e){return-d*(Math.sqrt(1-(a/=e)*a)-1)+b};a.circInOut=function(a,b,d,e){return 1>(a/=.5*e)?.5*-d*(Math.sqrt(1-a*a)-1)+b:.5*d*(Math.sqrt(1-(a-=2)*a)+1)+b};a.circOut=function(a,b,d,e){return d*Math.sqrt(1-(a=a/e-1)*a)+b};a.HALF_PI=.5*Math.PI;a.PI2=2*Math.PI;return a}();(function(){function a(){this.sign=null;this.maxCount=1E3}p(a,"laya.utils.PoolCache");var c=a.prototype;c.getCacheList=function(){return w.getPoolBySign(this.sign)};c.tryDispose=function(b){b=w.getPoolBySign(this.sign);b.length>this.maxCount&&b.splice(this.maxCount,b.length-this.maxCount)};a.addPoolCacheManager=function(b,d){void 0===d&&(d=100);var c;c=new a;c.sign=b;c.maxCount=d;Sa.regCacheByFunction(L.bind(c.tryDispose,c),L.bind(c.getCacheList,c))};return a})();(function(){function a(){}p(a,"laya.webgl.utils.MatirxArray");a.ArrayMul=function(c,b,d){if(c)if(b)for(var e,f,g,h,k=0;4>k;k++)e=c[k],f=c[k+4],g=c[k+8],h=c[k+12],d[k]=e*b[0]+f*b[1]+g*b[2]+h*b[3],d[k+4]=e*b[4]+f*b[5]+g*b[6]+h*b[7],d[k+8]=e*b[8]+f*b[9]+g*b[10]+h*b[11],d[k+12]=e*b[12]+f*b[13]+g*b[14]+h*b[15];else a.copyArray(c,d);else a.copyArray(b,d)};a.copyArray=function(a,b){if(a&&b)for(var d=0;d<a.length;d++)b[d]=a[d]};return a})();(function(){function a(){}p(a,"laya.utils.Mouse");m(1,a,"cursor",function(){return a._style.cursor},function(c){a._style.cursor=c});a.hide=function(){"none"!=a.cursor&&(a._preCursor=a.cursor,a.cursor="none")};a.show=function(){"none"==a.cursor&&(a.cursor=a._preCursor?a._preCursor:"auto")};a._preCursor=null;t(a,["_style",function(){return this._style=r.document.body.style}]);return a})();var ac=function(){function a(){}p(a,"laya.webgl.VertexArrayObject");return a}()(function(){function a(b){var a=b.getError;b.getError=function(){var d;do d=a.apply(b),d!=b.NO_ERROR&&(c[d]=!0);while(d!=b.NO_ERROR);for(d in c)if(c[d])return delete c[d],parseInt(d);return b.NO_ERROR}}var c={},b=function f(b){var a=b.gl;this.ext=b;this.isAlive=!0;this.hasBeenBound=!1;this.elementArrayBuffer=null;this.attribs=Array(b.maxVertexAttribs);for(b=0;b<this.attribs.length;b++){var d=new f.VertexAttrib(a);this.attribs[b]=d}this.maxAttrib=0};b.VertexAttrib=function(b){this.enabled=!1;this.buffer=null;this.size=4;this.type=b.FLOAT;this.normalized=!1;this.stride=16;this.offset=0;this.cached="";this.recache()};b.VertexAttrib.prototype.recache=function(){this.cached=[this.size,this.type,this.normalized,this.stride,this.offset].join(":")};var d=function(b){var d=this;this.gl=b;a(b);var c=this.original={getParameter:b.getParameter,enableVertexAttribArray:b.enableVertexAttribArray,disableVertexAttribArray:b.disableVertexAttribArray,bindBuffer:b.bindBuffer,getVertexAttrib:b.getVertexAttrib,vertexAttribPointer:b.vertexAttribPointer};b.getParameter=function(b){return b==d.VERTEX_ARRAY_BINDING_OES?d.currentVertexArrayObject==d.defaultVertexArrayObject?null:d.currentVertexArrayObject:c.getParameter.apply(this,arguments)};b.enableVertexAttribArray=function(b){var a=d.currentVertexArrayObject;a.maxAttrib=Math.max(a.maxAttrib,b);a.attribs[b].enabled=!0;return c.enableVertexAttribArray.apply(this,arguments)};b.disableVertexAttribArray=function(b){var a=d.currentVertexArrayObject;a.maxAttrib=Math.max(a.maxAttrib,b);a.attribs[b].enabled=!1;return c.disableVertexAttribArray.apply(this,arguments)};b.bindBuffer=function(a,f){switch(a){case b.ARRAY_BUFFER:d.currentArrayBuffer=f;break;case b.ELEMENT_ARRAY_BUFFER:d.currentVertexArrayObject.elementArrayBuffer=f}return c.bindBuffer.apply(this,arguments)};b.getVertexAttrib=function(a,f){var g=d.currentVertexArrayObject.attribs[a];switch(f){case b.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING:return g.buffer;case b.VERTEX_ATTRIB_ARRAY_ENABLED:return g.enabled;case b.VERTEX_ATTRIB_ARRAY_SIZE:return g.size;case b.VERTEX_ATTRIB_ARRAY_STRIDE:return g.stride;case b.VERTEX_ATTRIB_ARRAY_TYPE:return g.type;case b.VERTEX_ATTRIB_ARRAY_NORMALIZED:return g.normalized;default:return c.getVertexAttrib.apply(this,arguments)}};b.vertexAttribPointer=function(b,a,f,g,h,l){var k=d.currentVertexArrayObject;k.maxAttrib=Math.max(k.maxAttrib,b);k=k.attribs[b];k.buffer=d.currentArrayBuffer;k.size=a;k.type=f;k.normalized=g;k.stride=h;k.offset=l;k.recache();return c.vertexAttribPointer.apply(this,arguments)};b.instrumentExtension&&b.instrumentExtension(this,"OES_vertex_array_object");b.canvas&&b.canvas.addEventListener&&b.canvas.addEventListener("webglcontextrestored",function(){G.console&&G.console.log&&G.console.log("OESVertexArrayObject emulation library context restored");d.reset_()},!0);this.reset_()};d.prototype.VERTEX_ARRAY_BINDING_OES=34229;d.prototype.reset_=function(){if(void 0!==this.vertexArrayObjects)for(var a=0;a<this.vertexArrayObjects.length;++a)this.vertexArrayObjects.isAlive=!1;a=this.gl;this.maxVertexAttribs=a.getParameter(a.MAX_VERTEX_ATTRIBS);this.defaultVertexArrayObject=new b(this);this.currentArrayBuffer=this.currentVertexArrayObject=null;this.vertexArrayObjects=[this.defaultVertexArrayObject];this.bindVertexArrayOES(null)};d.prototype.createVertexArrayOES=function(){var a=new b(this);this.vertexArrayObjects.push(a);return a};d.prototype.deleteVertexArrayOES=function(b){b.isAlive=!1;this.vertexArrayObjects.splice(this.vertexArrayObjects.indexOf(b),1);this.currentVertexArrayObject==b&&this.bindVertexArrayOES(null)};d.prototype.isVertexArrayOES=function(a){return a&&a instanceof b&&a.hasBeenBound&&a.ext==this?!0:!1};d.prototype.bindVertexArrayOES=function(b){var a=this.gl;if(b&&!b.isAlive)c[a.INVALID_OPERATION]=!0,G.console&&G.console.error&&G.console.error("bindVertexArrayOES: attempt to bind deleted arrayObject");else{var d=this.original,f=this.currentVertexArrayObject;this.currentVertexArrayObject=b||this.defaultVertexArrayObject;this.currentVertexArrayObject.hasBeenBound=!0;b=this.currentVertexArrayObject;if(f!=b){f&&b.elementArrayBuffer==f.elementArrayBuffer||d.bindBuffer.call(a,a.ELEMENT_ARRAY_BUFFER,b.elementArrayBuffer);for(var n=this.currentArrayBuffer,q=Math.max(f?f.maxAttrib:0,b.maxAttrib),l=0;l<=q;l++){var m=b.attribs[l],p=f?f.attribs[l]:null;f&&m.enabled==p.enabled||(m.enabled?d.enableVertexAttribArray.call(a,l):d.disableVertexAttribArray.call(a,l));if(m.enabled){var r=!1;f&&m.buffer==p.buffer||(n!=m.buffer&&(d.bindBuffer.call(a,a.ARRAY_BUFFER,m.buffer),n=m.buffer),r=!0);(r||m.cached!=p.cached)&&d.vertexAttribPointer.call(a,l,m.size,m.type,m.normalized,m.stride,m.offset)}}this.currentArrayBuffer!=n&&d.bindBuffer.call(a,a.ARRAY_BUFFER,this.currentArrayBuffer)}}};G._setupVertexArrayObject=function(b){var a=b.getSupportedExtensions;b.getSupportedExtensions=function(){var b=a.call(this)||[];0>b.indexOf("OES_vertex_array_object")&&b.push("OES_vertex_array_object");return b};var c=b.getExtension;b.getExtension=function(b){var a=c.call(this,b);if(a)return a;if("OES_vertex_array_object"!==b)return null;this.__OESVertexArrayObject||(console.log("Setup OES_vertex_array_object polyfill"),this.__OESVertexArrayObject=new d(this));return this.__OESVertexArrayObject}};G._forceSetupVertexArrayObject=function(b){var a=b.getSupportedExtensions;b.getSupportedExtensions=function(){var b=a.call(this)||[];0>b.indexOf("OES_vertex_array_object")&&b.push("OES_vertex_array_object");return b};var c=b.getExtension;b.getExtension=function(b){return"OES_vertex_array_object"===b?(this.__OESVertexArrayObject||(console.log("Setup OES_vertex_array_object polyfill"),this.__OESVertexArrayObject=new d(this)),this.__OESVertexArrayObject):(b=c.call(this,b))?b:null}}}()),wa=function(){function a(){}p(a,"laya.resource.WebGLRTMgr");a.getRT=function(c,b){c|=0;b|=0;1E4<=c&&console.error("getRT error! w too big");var d=1E4*b+c,e=a.dict[d];if(e&&0<e.length)return e=e.pop(),e._mgrKey=d,e;e=new ca(c,b,1,-1);e._mgrKey=d;return e};a.releaseRT=function(c){if(!(0>=c._mgrKey)){var b=a.dict[c._mgrKey];!b&&(b=[],a.dict[c._mgrKey]=b);c._mgrKey=0;b.push(c)}};a.dict={};return a}(),L=function(){function a(){}p(a,"laya.utils.Utils");a.toRadian=function(c){return c*a._pi2};a.toAngle=function(c){return c*a._pi};a.toHexColor=function(a){if(0>a||isNaN(a))return null;for(a=a.toString(16);6>a.length;)a="0"+a;return"#"+a};a.getGID=function(){return a._gid++};a.concatArray=function(a,b){if(!b)return a;if(!a)return b;var d,c=b.length;for(d=0;d<c;d++)a.push(b[d]);return a};a.clearArray=function(a){if(!a)return a;a.length=0;return a};a.copyArray=function(a,b){a||(a=[]);if(!b)return a;a.length=b.length;var d,c=b.length;for(d=0;d<c;d++)a[d]=b[d];return a};a.getGlobalRecByPoints=function(a,b,d,e,f){b=N.create().setTo(b,d);b=a.localToGlobal(b);e=N.create().setTo(e,f);e=a.localToGlobal(e);a=K._getWrapRec([b.x,b.y,e.x,e.y]);b.recover();e.recover();return a};a.getGlobalPosAndScale=function(c){return a.getGlobalRecByPoints(c,0,0,1,1)};a.bind=function(a,b){return a.bind(b)};a.measureText=function(a,b){return Z.measureText(a,b)};a.updateOrder=function(a){if(!a||2>a.length)return!1;for(var b=1,d,c=a.length,f,g;b<c;){d=b;g=a[d];for(f=a[d]._zOrder;-1<--d;)if(a[d]._zOrder>f)a[d+1]=a[d];else break;a[d+1]=g;b++}return!0};a.transPointList=function(a,b,d){var c,f=a.length;for(c=0;c<f;c+=2)a[c]+=b,a[c+1]+=d};a.parseInt=function(a,b){void 0===b&&(b=0);var d=r.window.parseInt(a,b);return isNaN(d)?0:d};a.getFileExtension=function(c){a._extReg.lastIndex=c.lastIndexOf(".");return(c=a._extReg.exec(c))&&1<c.length?c[1].toLowerCase():null};a.getTransformRelativeToWindow=function(a,b,d){var c=l.stage;a=laya.utils.Utils.getGlobalPosAndScale(a);var f=c._canvasTransform.clone(),g=f.tx,h=f.ty;f.rotate(-Math.PI/180*l.stage.canvasDegree);f.scale(l.stage.clientScaleX,l.stage.clientScaleY);var k=0!=l.stage.canvasDegree%180;k?(c=d+a.y,b+=a.x,c*=f.d,b*=f.a,90==l.stage.canvasDegree?(c=g-c,b+=h):(c+=g,b=h-b)):(c=b+a.x,b=d+a.y,c*=f.a,b*=f.d,c+=g,b+=h);b+=l.stage._safariOffsetY;k?(d=f.d*a.height,a=f.a*a.width):(d=f.a*a.width,a=f.d*a.height);return{x:c,y:b,scaleX:d,scaleY:a}};a.fitDOMElementInArea=function(c,b,d,e,f,g){c._fitLayaAirInitialized||(c._fitLayaAirInitialized=!0,c.style.transformOrigin=c.style.webKittransformOrigin="left top",c.style.position="absolute");b=a.getTransformRelativeToWindow(b,d,e);c.style.transform=c.style.webkitTransform="scale("+b.scaleX+","+b.scaleY+") rotate("+l.stage.canvasDegree+"deg)";c.style.width=f+"px";c.style.height=g+"px";c.style.left=b.x+"px";c.style.top=b.y+"px"};a.isOkTextureList=function(a){if(!a)return!1;var b,d=a.length,c;for(b=0;b<d;b++)if(c=a[b],!c||!c._getSource())return!1;return!0};a.isOKCmdList=function(a){if(!a)return!1;var b=a.length;for(a=0;a<b;a++);return!0};a.getQueryString=function(a){if(r.onMiniGame||!G.location||!G.location.search)return null;a=new RegExp("(^|\x26)"+a+"\x3d([^\x26]*)(\x26|$)");a=G.location.search.substr(1).match(a);return null!=a?unescape(a[2]):null};a._gid=1;a._pi=180/Math.PI;a._pi2=Math.PI/180;a._extReg=/\.(\w+)\??/g;a.parseXMLFromString=function(a){a=a.replace(/>\s+</g,"\x3e\x3c");a=(new DOMParser).parseFromString(a,"text/xml");if(-1<a.firstChild.textContent.indexOf("This page contains the following errors"))throw Error(a.firstChild.firstChild.textContent);return a};return a}();(function(){function a(){}p(a,"laya.webgl.text.ArabicReshaper");var c=a.prototype;c.characterMapContains=function(b){for(var d=0;d<a.charsMap.length;++d)if(a.charsMap[d][0]===b)return!0;return!1};c.getCharRep=function(b){for(var d=0;d<a.charsMap.length;++d)if(a.charsMap[d][0]===b)return a.charsMap[d];return!1};c.getCombCharRep=function(b,d){for(var c=0;c<a.combCharsMap.length;++c)if(a.combCharsMap[c][0][0]===b&&a.combCharsMap[c][0][1]===d)return a.combCharsMap[c];return!1};c.isTransparent=function(b){for(var d=0;d<a.transChars.length;++d)if(a.transChars[d]===b)return!0;return!1};c.getOriginalCharsFromCode=function(b){var d;for(d=0;d<a.charsMap.length;++d)if(-1<a.charsMap[d].indexOf(b))return String.fromCharCode(a.charsMap[d][0]);for(d=0;d<a.combCharsMap.length;++d)if(-1<a.combCharsMap[d].indexOf(b))return String.fromCharCode(a.combCharsMap[d][0][0])+String.fromCharCode(a.combCharsMap[d][0][1]);return String.fromCharCode(b)};c.convertArabic=function(b){for(var a,c,f="",g=0;g<b.length;++g)if(c=b.charCodeAt(g),this.characterMapContains(c)){var h,k;h=g-1;for(k=g+1;0<=h&&this.isTransparent(b.charCodeAt(h));--h);a=(h=0<=h?b.charCodeAt(h):null)?this.getCharRep(h):!1;if(!a||null==a[2]&&null==a[3])h=null;for(;k<b.length&&this.isTransparent(b.charCodeAt(k));++k);a=(k=k<b.length?b.charCodeAt(k):null)?this.getCharRep(k):!1;if(!a||null==a[3]&&null==a[4])k=null;1604!==c||null==k||1570!==k&&1571!==k&&1573!==k&&1575!==k?(a=this.getCharRep(c),f=null!=h&&null!=k&&null!=a[3]?f+String.fromCharCode(a[3]):null!=h&&null!=a[4]?f+String.fromCharCode(a[4]):null!=k&&null!=a[2]?f+String.fromCharCode(a[2]):f+String.fromCharCode(a[1])):(c=this.getCombCharRep(c,k),f=null!=h?f+String.fromCharCode(c[4]):f+String.fromCharCode(c[1]),++g)}else f+=String.fromCharCode(c);return f};c.convertArabicBack=function(b){var a="",c,f;for(f=0;f<b.length;++f)c=b.charCodeAt(f),a+=this.getOriginalCharsFromCode(c);return a};t(a,["charsMap",function(){return this.charsMap=[[1569,65152,null,null,null],[1570,65153,null,null,65154],[1571,65155,null,null,65156],[1572,65157,null,null,65158],[1573,65159,null,null,65160],[1574,65161,65163,65164,65162],[1575,65165,null,null,65166],[1576,65167,65169,65170,65168],[1577,65171,null,null,65172],[1578,65173,65175,65176,65174],[1579,65177,65179,65180,65178],[1580,65181,65183,65184,65182],[1581,65185,65187,65188,65186],[1582,65189,65191,65192,65190],[1583,65193,null,null,65194],[1584,65195,null,null,65196],[1585,65197,null,null,65198],[1586,65199,null,null,65200],[1587,65201,65203,65204,65202],[1588,65205,65207,65208,65206],[1589,65209,65211,65212,65210],[1590,65213,65215,65216,65214],[1591,65217,65219,65220,65218],[1592,65221,65223,65224,65222],[1593,65225,65227,65228,65226],[1594,65229,65231,65232,65230],[1600,1600,1600,1600,1600],[1601,65233,65235,65236,65234],[1602,65237,65239,65240,65238],[1603,65241,65243,65244,65242],[1604,65245,65247,65248,65246],[1605,65249,65251,65252,65250],[1606,65253,65255,65256,65254],[1607,65257,65259,65260,65258],[1608,65261,null,null,65262],[1609,65263,null,null,65264],[1610,65265,65267,65268,65266],[1662,64342,64344,64345,64343],[1740,64508,64510,64511,64509],[1670,64378,64380,64381,64379],[1705,64398,64400,64401,64399],[1711,64402,64404,64405,64403],[1688,64394,null,null,64395]]},"combCharsMap",function(){return this.combCharsMap=[[[1604,1570],65269,null,null,65270],[[1604,1571],65271,null,null,65272],[[1604,1573],65273,null,null,65274],[[1604,1575],65275,null,null,65276]]},"transChars",function(){return this.transChars=[1552,1554,1555,1556,1557,1611,1612,1613,1614,1615,1616,1617,1618,1619,1620,1621,1622,1623,1624,1648,1750,1751,1752,1753,1754,1755,1756,1759,1760,1761,1762,1763,1764,1767,1768,1770,1771,1772,1773]}]);return a})();var Fc=function(){function a(){}p(a,"laya.display.cmd.DrawLinesCmd");var c=a.prototype;c.recover=function(){this.lineColor=this.points=null;w.recover("DrawLinesCmd",this)};c.run=function(b,a,c){b._drawLines(this.x+a,this.y+c,this.points,this.lineColor,this.lineWidth,this.vid)};m(0,c,"cmdID",function(){return"DrawLines"});a.create=function(b,d,c,f,g,h){var e=w.getItemByClass("DrawLinesCmd",a);e.x=b;e.y=d;e.points=c;e.lineColor=f;e.lineWidth=g;e.vid=h;return e};a.ID="DrawLines";return a}(),gc=function(){function a(){this._data=[];this._ndata=0;this._tex=null;this._imgId=0;this._clipid=-1;this._enbale=!1;this._colorFiler=null;this._clipMatrix=new I}p(a,"laya.webgl.text.CharSubmitCache");var c=a.prototype;c.clear=function(){this._tex=null;this._imgId=-1;this._ndata=0;this._enbale=!1;this._colorFiler=null};c.destroy=function(){this.clear();this._data.length=0;this._data=null};c.add=function(b,a,c,f,g,h){0<this._ndata&&(this._tex!=a||this._imgId!=c||0<=this._clipid&&this._clipid!=b._clipInfoID)&&this.submit(b);this._clipid=b._clipInfoID;b._globalClipMatrix.copyTo(this._clipMatrix);this._tex=a;this._imgId=c;this._colorFiler=b._colorFiler;this._data[this._ndata]=f;this._data[this._ndata+1]=g;this._data[this._ndata+2]=h;this._ndata+=3};c.getPos=function(){return 0==a.__nPosPool?Array(8):a.__posPool[--a.__nPosPool]};c.enable=function(b,a){b!==this._enbale&&((this._enbale=b)||this.submit(a))};c.submit=function(b){var d=this._ndata;if(d){var c=b._mesh,f=b._colorFiler;b._colorFiler=this._colorFiler;var g=qa.create(b,c,U.create(1,0));b._submits[b._submits._length++]=b._curSubmit=g;g.shaderValue.textureHost=this._tex;g._key.other=this._imgId;b._colorFiler=f;b._copyClipInfo(g,this._clipMatrix);g.clipInfoID=this._clipid;for(f=0;f<d;f+=3)c.addQuad(this._data[f],this._data[f+1],this._data[f+2],!0),a.__posPool[a.__nPosPool++]=this._data[f];d/=3;g._numEle+=6*d;c.indexNum+=6*d;c.vertNum+=4*d;b._drawCount+=d;this._ndata=0;0==J.loopCount%100&&(this._data.length=0)}};a.__posPool=[];a.__nPosPool=0;return a}(),da=function(){function a(){}p(a,"Config");a.animationInterval=50;a.isAntialias=!1;a.isAlpha=!1;a.premultipliedAlpha=!0;a.isStencil=!0;a.preserveDrawingBuffer=!1;a.webGL2D_MeshAllocMaxMem=!0;a.is2DPixelArtGame=!1;a.useWebGL2=!1;a.useRetinalCanvas=!1;return a}(),Gc=function(){function a(){}p(a,"laya.display.cmd.DrawCurvesCmd");var c=a.prototype;c.recover=function(){this.lineColor=this.points=null;w.recover("DrawCurvesCmd",this)};c.run=function(b,a,c){b.drawCurves(this.x+a,this.y+c,this.points,this.lineColor,this.lineWidth)};m(0,c,"cmdID",function(){return"DrawCurves"});a.create=function(b,d,c,f,g){var e=w.getItemByClass("DrawCurvesCmd",a);e.x=b;e.y=d;e.points=c;e.lineColor=f;e.lineWidth=g;return e};a.ID="DrawCurves";return a}(),Bc=function(){function a(){this._textIsWorldText=!1;this._fontColor=4294967295;this._nTexAlign=this._strokeColor=0;this._fontObj=a._defFontObj}p(a,"laya.display.cmd.FillTextCmd");var c=a.prototype;c.recover=function(){w.recover("FillTextCmd",this)};c.run=function(b,a,c){l.stage.isGlobalRepaint()&&this._textIsWorldText&&this._text.cleanCache();this._textIsWorldText?b._fast_filltext(this._text,this.x+a,this.y+c,this._fontObj,this._color,null,0,this._nTexAlign,0):b.drawText(this._text,this.x+a,this.y+c,this._font,this._color,this._textAlign)};m(0,c,"text",function(){return this._text},function(b){this._text=b;(this._textIsWorldText=b instanceof laya.utils.WordText)&&this._text.cleanCache()});m(0,c,"cmdID",function(){return"FillText"});m(0,c,"color",function(){return this._color},function(b){this._color=b;this._fontColor=x.create(b).numColor;this._textIsWorldText&&this._text.cleanCache()});m(0,c,"font",function(){return this._font},function(b){this._font=b;this._fontObj=xa.Parse(b);this._textIsWorldText&&this._text.cleanCache()});m(0,c,"textAlign",function(){return this._textAlign},function(b){this._textAlign=b;switch(b){case "center":this._nTexAlign=V.ENUM_TEXTALIGN_CENTER;break;case "right":this._nTexAlign=V.ENUM_TEXTALIGN_RIGHT;break;default:this._nTexAlign=V.ENUM_TEXTALIGN_DEFAULT}this._textIsWorldText&&this._text.cleanCache()});a.create=function(b,d,c,f,g,h){var e=w.getItemByClass("FillTextCmd",a);e.text=b;e._textIsWorldText=b instanceof laya.utils.WordText;e.x=d;e.y=c;e.font=f;e.color=g;e.textAlign=h;return e};a.ID="FillText";t(a,["_defFontObj",function(){return this._defFontObj=new xa(null)}]);return a}();(function(){function a(){}p(a,"laya.webgl.shader.ShaderValue");return a})();(function(){function a(){}p(a,"laya.events.KeyLocation");a.STANDARD=0;a.LEFT=1;a.RIGHT=2;a.NUM_PAD=3;return a})();var hc=function(){function a(){this._clipInfoID=-1;this.incache=!1;this._globalClipMatrix=new I;this._clipRect=new K}p(a,"laya.webgl.canvas.save.SaveClipRect");var c=a.prototype;l.imps(c,{"laya.webgl.canvas.save.ISaveData":!0});c.isSaveMark=function(){return!1};c.restore=function(b){this._globalClipMatrix.copyTo(b._globalClipMatrix);this._clipRect.clone(b._clipRect);b._clipInfoID=this._clipInfoID;a.POOL[a.POOL._length++]=this;b._clipInCache=this.incache};a.save=function(b){if(131072!=(b._saveMark._saveuse&131072)){b._saveMark._saveuse|=131072;var d=a.POOL,d=0<d._length?d[--d._length]:new a;b._globalClipMatrix.copyTo(d._globalClipMatrix);b._clipRect.clone(d._clipRect);d._clipInfoID=b._clipInfoID;d.incache=b._clipInCache;b=b._save;b[b._length++]=d}};a.POOL=R._createArray();return a}(),Hc=function(){function a(){}p(a,"laya.filters.GlowFilterGLRender");var c=a.prototype;c.setShaderInfo=function(b,a,c,f){b.defines.add(f.type);b.u_blurInfo1=f._sv_blurInfo1;var d=f._sv_blurInfo2;d[0]=a;d[1]=c;b.u_blurInfo2=d;b.u_color=f.getColor()};c.render=function(b,a,c,f,g){var d=U.create(1,0);this.setShaderInfo(d,c,f,g);g=U.create(1,0);var e=I.TEMP.identity();a.drawTarget(b,0,0,c,f,e,d);a.drawTarget(b,0,0,c,f,e,g)};return a}(),Z=function(){function a(){}p(a,"laya.utils.RunDriver");a.createShaderCondition=function(a){return l._runScript("(function() {return "+a+";})")};a.fontMap=[];a.measureText=function(c,b){var d=a.hanzi.test(c);if(d&&a.fontMap[b])return a.fontMap[b];var e=r.context;e.font=b;e=e.measureText(c);d&&(a.fontMap[b]=e);return e};a.drawToCanvas=function(a,b,d,e,f,g){f-=a.x;g-=a.y;f|=0;g|=0;d|=0;e|=0;var c=new V;c.size(d,e);c.asBitmap=!0;c._targets.start();ta.renders[b]._fun(a,c,f,g);c.flush();c._targets.end();c._targets.restore();a=c._targets.getData(0,0,d,e);c.destroy();c=new ImageData(d,e);b=4*d;new Uint8Array(b);f=c.data;g=e-1;for(var k=g*b,n=0;0<=g;g--)f.set(a.subarray(n,n+b),k),k-=b,n+=b;a=new ea(!0);a.size(d,e);a.getContext("2d").putImageData(c,0,0);return a};a.drawToTexture=function(a,b,d,e,f,g){f-=a.x;g-=a.y;f|=0;g|=0;d|=0;e|=0;var c=new V;c.size(d,e);c.asBitmap=!0;c._targets.start();ta.renders[b]._fun(a,c,f,g);c.flush();c._targets.end();c._targets.restore();a=new X(c._targets,X.INV_UV);c.destroy(!0);return a};a.changeWebGLSize=function(a,b){E.onStageResize(a,b)};a.clear=function(a){V.set2DRenderConfig();F.worldScissorTest&&E.mainContext.disable(3089);var b=v.context;(a=0==b._submits._length||da.preserveDrawingBuffer?x.create(a).arrColor:l.stage._wgColor)?b.clearBG(a[0],a[1],a[2],a[3]):b.clearBG(0,0,0,0);F.clear()};a.enableNative=null;t(a,["hanzi",function(){return this.hanzi=RegExp("^[\u4e00-\u9fa5]$")}]);return a}(),yb=function(){function a(){}p(a,"laya.net.AtlasInfoManager");a.enable=function(c,b){l.loader.load(c,S.create(null,a._onInfoLoaded,[b]),null,"json")};a._onInfoLoaded=function(c,b){var d,e,f,g,h;for(d in b)for(f=b[d],e=f[0],f=f[1],h=f.length,g=0;g<h;g++)a._fileLoadDic[e+f[g]]=d;c&&c.run()};a.getFileLoadPath=function(c){return a._fileLoadDic[c]||c};a._fileLoadDic={};return a}(),T=function(){function a(){}p(a,"laya.webgl.canvas.BlendMode");a._init_=function(c){a.fns=[a.BlendNormal,a.BlendAdd,a.BlendMultiply,a.BlendScreen,a.BlendOverlay,a.BlendLight,a.BlendMask,a.BlendDestinationOut];a.targetFns=[a.BlendNormalTarget,a.BlendAddTarget,a.BlendMultiplyTarget,a.BlendScreenTarget,a.BlendOverlayTarget,a.BlendLightTarget,a.BlendMask,a.BlendDestinationOut]};a.BlendNormal=function(a){C.setBlendFunc(a,1,771)};a.BlendAdd=function(a){C.setBlendFunc(a,1,772)};a.BlendMultiply=function(a){C.setBlendFunc(a,774,771)};a.BlendScreen=function(a){C.setBlendFunc(a,1,1)};a.BlendOverlay=function(a){C.setBlendFunc(a,1,769)};a.BlendLight=function(a){C.setBlendFunc(a,1,1)};a.BlendNormalTarget=function(a){C.setBlendFunc(a,1,771)};a.BlendAddTarget=function(a){C.setBlendFunc(a,1,772)};a.BlendMultiplyTarget=function(a){C.setBlendFunc(a,774,771)};a.BlendScreenTarget=function(a){C.setBlendFunc(a,1,1)};a.BlendOverlayTarget=function(a){C.setBlendFunc(a,1,769)};a.BlendLightTarget=function(a){C.setBlendFunc(a,1,1)};a.BlendMask=function(a){C.setBlendFunc(a,0,770)};a.BlendDestinationOut=function(a){C.setBlendFunc(a,0,0)};a.activeBlendFunction=null;a.NAMES="normal add multiply screen overlay light mask destination-out".split(" ");a.TOINT={normal:0,add:1,multiply:2,screen:3,overlay:4,light:5,mask:6,"destination-out":7,lighter:1};a.NORMAL="normal";a.ADD="add";a.MULTIPLY="multiply";a.SCREEN="screen";a.OVERLAY="overlay";a.LIGHT="light";a.MASK="mask";a.DESTINATIONOUT="destination-out";a.LIGHTER="lighter";a.fns=[];a.targetFns=[];return a}(),Ec=function(){function a(){}p(a,"laya.display.cmd.RotateCmd");var c=a.prototype;c.recover=function(){w.recover("RotateCmd",this)};c.run=function(b,a,c){b._rotate(this.angle,this.pivotX+a,this.pivotY+c)};m(0,c,"cmdID",function(){return"Rotate"});a.create=function(b,d,c){var e=w.getItemByClass("RotateCmd",a);e.angle=b;e.pivotX=d;e.pivotY=c;return e};a.ID="Rotate";return a}(),xa=function(){function a(c){this._font="14px Arial";this._family="Arial";this._size=14;this._bold=this._italic=!1;this._id=a._gfontID++;this.setFont(c||this._font)}p(a,"laya.utils.FontInfo");a.prototype.setFont=function(a){this._font=a;var b=a.split(" "),d=b.length;if(2>d)1==d&&0<b[0].indexOf("px")&&(this._size=parseInt(b[0]));else{for(var c=-1,f=0;f<d;f++)if(0<b[f].indexOf("px")||0<b[f].indexOf("pt")){c=f;this._size=parseInt(b[f]);0>=this._size&&(console.error("font parse error:"+a),this._size=14);break}a=c+1;c=b[a];for(a++;a<d;a++)c+=" "+b[a];this._family=c.split(",")[0];this._italic=0<=b.indexOf("italic");this._bold=0<=b.indexOf("bold")}};a.Parse=function(c){if(c===a._lastFont)return a._lastFontInfo;var b=a._cache[c];b||(b=a._cache[c]=new a(c));a._lastFont=c;return a._lastFontInfo=b};a.EMPTY=new a(null);a._cache={};a._gfontID=0;a._lastFont="";a._lastFontInfo=null;return a}(),Ba=function(){function a(b,a,c,f){function d(b){b=b.replace(e._clearCR,"");var a=[],d=new vb(a);e._compileToTree(d,b.split("\n"),0,a,f);return d}this._clearCR=RegExp("\r","g");var e=this,k=r.now();this._VS=d(b);this._PS=d(a);this._nameMap=c;2<r.now()-k&&console.log("ShaderCompile use time:"+(r.now()-k)+"  size:"+b.length+"/"+a.length)}p(a,"laya.webgl.utils.ShaderCompile");var c=a.prototype;c._compileToTree=function(b,d,c,f,g){var e,k,n,q,l,m,p;for(m=c;m<d.length;m++)if(k=d[m],!(1>k.length)&&(e=k.indexOf("//"),0!==e)){0<=e&&(k=k.substr(0,e));c=l||new vb(f);l=null;c.text=k;c.noCompile=!0;if(0<=(e=k.indexOf("#"))){n="#";p=e+1;for(q=k.length;p<q;p++){var r=k.charAt(p);if(" "===r||"\t"===r||"?"===r)break;n+=r}c.name=n;switch(n){case "#ifdef":case "#ifndef":c.src=k;c.noCompile=null!=k.match(/[!&|()=<>]/);c.noCompile?console.log("function():Boolean{return "+k.substr(e+c.name.length)+"}"):(q=k.replace(/^\s*/,"").split(/\s+/),c.setCondition(q[1],"#ifdef"===n?1:2),c.text="//"+c.text);c.setParent(b);b=c;if(g)for(q=k.substr(p).split(a._splitToWordExps3),p=0;p<q.length;p++)k=q[p],k.length&&(g[k]=!0);continue;case "#if":c.src=k;c.noCompile=!0;c.setParent(b);b=c;if(g)for(q=k.substr(p).split(a._splitToWordExps3),p=0;p<q.length;p++)k=q[p],k.length&&"defined"!=k&&(g[k]=!0);continue;case "#else":c.src=k;b=b.parent;e=b.childs[b.childs.length-1];c.noCompile=e.noCompile;c.noCompile||(c.condition=e.condition,c.conditionType=1==e.conditionType?2:1,c.text="//"+c.text+" "+e.text+" "+c.conditionType);c.setParent(b);b=c;continue;case "#endif":b=b.parent;e=b.childs[b.childs.length-1];c.noCompile=e.noCompile;c.noCompile||(c.text="//"+c.text);c.setParent(b);continue;case "#include":q=a.splitToWords(k,null);k=a.includes[q[1]];if(!k)throw"ShaderCompile error no this include file:"+q[1];if(0>(e=q[0].indexOf("?"))){c.setParent(b);k=k.getWith("with"==q[2]?q[3]:null);this._compileToTree(c,k.split("\n"),0,f,g);c.text="";continue}c.setCondition(q[0].substr(e+1),1);c.text=k.getWith("with"==q[2]?q[3]:null);break;case "#import":q=a.splitToWords(k,null);k=q[1];f.push({node:c,file:a.includes[k],ofs:c.text.length});continue}}else{if((e=b.childs[b.childs.length-1])&&!e.name){0<f.length&&a.splitToWords(k,e);l=c;e.text+="\n"+k;continue}0<f.length&&a.splitToWords(k,c)}c.setParent(b)}};c.createShader=function(b,a,c,f){var d={},e="";if(b)for(var k in b)e+="#define "+k+"\n",d[k]=!0;b=this._VS.toscript(d,[]);d=this._PS.toscript(d,[]);return(c||ka.create)(e+b.join("\n"),e+d.join("\n"),a,this._nameMap,f)};a._parseOne=function(b,d,c,f,g,h){var e={type:a.shaderParamsMap[c[f+1]],name:c[f+2],size:isNaN(parseInt(c[f+3]))?1:parseInt(c[f+3])};h&&("attribute"==g?b.push(e):d.push(e));":"==c[f+3]&&(e.type=c[f+4],f+=2);return f+2};a.addInclude=function(b,d){if(!d||0===d.length)throw Error("add shader include file err:"+b);if(a.includes[b])throw Error("add shader include file err, has add:"+b);a.includes[b]=new Sb(d)};a.preGetParams=function(b,d){var c=[b,d],f={},g=[],h=[],k={},n=[];f.attributes=g;f.uniforms=h;f.defines=k;for(var q,l,m=0;2>m;m++){c[m]=c[m].replace(a._removeAnnotation,"");var p=c[m].match(a._reg),r;q=0;for(l=p.length;q<l;q++){var t=p[q];if("attribute"!=t&&"uniform"!=t)if("#define"==t)t=p[++q],n[t]=1;else{if("#ifdef"==t)for(r=p[++q],k[r]=k[r]||[],q++;q<l;q++)if(t=p[q],"attribute"!=t&&"uniform"!=t){if("#else"==t)for(q++;q<l;q++)if(t=p[q],"attribute"!=t&&"uniform"!=t){if("#endif"==t)break}else q=a._parseOne(g,h,p,q,t,!n[r])}else q=a._parseOne(g,h,p,q,t,n[r])}else q=a._parseOne(g,h,p,q,t,!0)}}return f};a.splitToWords=function(b,a){for(var d=[],c,g=-1,h=0,k=b.length;h<k;h++)if(c=b.charAt(h),0<=" \t\x3d+-*/\x26%!\x3c\x3e()'\",;".indexOf(c)){0<=g&&1<h-g&&(g=b.substr(g,h-g),d.push(g));if('"'==c||"'"==c){c=b.indexOf(c,h+1);if(0>c)throw"Sharder err:"+b;d.push(b.substr(h+1,c-h-1));h=c}else"("==c&&a&&0<d.length&&(g=d[d.length-1]+";",0>"vec4;main;".indexOf(g)&&(a.useFuns+=g));g=-1}else 0>g&&(g=h);g<k&&1<k-g&&(g=b.substr(g,k-g),d.push(g));return d};a.IFDEF_NO=0;a.IFDEF_YES=1;a.IFDEF_ELSE=2;a.IFDEF_PARENT=3;a._removeAnnotation=RegExp("(/\\*([^*]|[\\r\\\n]|(\\*+([^*/]|[\\r\\n])))*\\*+/)|(//.*)","g");a._reg=RegExp("(\".*\")|('.*')|([#\\w\\*-\\.+/()\x3d\x3c\x3e{}\\\\]+)|([,;:\\\\])","g");a._splitToWordExps=RegExp("[(\".*\")]+|[('.*')]+|([ \\t\x3d\\+\\-*/\x26%!\x3c\x3e!%(),;])","g");a.includes={};t(a,["shaderParamsMap",function(){return this.shaderParamsMap={"float":5126,"int":5124,bool:35670,vec2:35664,vec3:35665,vec4:35666,ivec2:35667,ivec3:35668,ivec4:35669,bvec2:35671,bvec3:35672,bvec4:35673,mat2:35674,mat3:35675,mat4:35676,sampler2D:35678,samplerCube:35680}},"_splitToWordExps3",function(){return this._splitToWordExps3=RegExp("[ \\t\x3d\\+\\-*/\x26%!\x3c\x3e!%(),;\\|]","g")}]);return a}(),Ic=function(){function a(){this.json=null}p(a,"laya.components.Prefab");a.prototype.create=function(){return this.json?$a.createByData(null,this.json):null};return a}(),Cc=function(){function a(){}p(a,"laya.display.cmd.FillBorderWordsCmd");var c=a.prototype;c.recover=function(){this.words=null;w.recover("FillBorderWordsCmd",this)};c.run=function(b,a,c){b.fillBorderWords(this.words,this.x+a,this.y+c,this.font,this.fillColor,this.borderColor,this.lineWidth)};m(0,c,"cmdID",function(){return"FillBorderWords"});a.create=function(b,d,c,f,g,h,k){var e=w.getItemByClass("FillBorderWordsCmd",a);e.words=b;e.x=d;e.y=c;e.font=f;e.fillColor=g;e.borderColor=h;e.lineWidth=k;return e};a.ID="FillBorderWords";return a}(),qc=function(){function a(){this._unHit=this._hit=null}p(a,"laya.utils.HitArea");var c=a.prototype;c.contains=function(b,d){return a._isHitGraphic(b,d,this.hit)?!a._isHitGraphic(b,d,this.unHit):!1};m(0,c,"hit",function(){this._hit||(this._hit=new sa);return this._hit},function(b){this._hit=b});m(0,c,"unHit",function(){this._unHit||(this._unHit=new sa);return this._unHit},function(b){this._unHit=b});a._isHitGraphic=function(b,d,c){if(!c)return!1;var e=c.cmds;!e&&c._one&&(e=a._cmds,e.length=1,e[0]=c._one);if(!e)return!1;var g;g=e.length;var h;for(c=0;c<g;c++)if(h=e[c]){switch(h.cmdID){case "Translate":b-=h.tx,d-=h.ty}if(a._isHitCmd(b,d,h))return!0}return!1};a._isHitCmd=function(b,d,c){if(!c)return!1;var e=!1;switch(c.cmdID){case "DrawRect":a._rect.setTo(c.x,c.y,c.width,c.height);e=a._rect.contains(b,d);break;case "DrawCircle":b-=c.x;d-=c.y;e=b*b+d*d<c.radius*c.radius;break;case "DrawPoly":b-=c.x,d-=c.y,e=a._ptInPolygon(b,d,c.points)}return e};a._ptInPolygon=function(b,d,c){var e=a._ptPoint;e.setTo(b,d);b=0;var g,h,k,n;n=c.length;for(var q=0;q<n;q+=2)d=c[q],g=c[q+1],h=c[(q+2)%n],k=c[(q+3)%n],g!=k&&(e.y<Math.min(g,k)||e.y>=Math.max(g,k)||(e.y-g)*(h-d)/(k-g)+d>e.x&&b++);return 1==b%2};a._cmds=[];t(a,["_rect",function(){return this._rect=new K},"_ptPoint",function(){return this._ptPoint=new N}]);return a}(),Q=function(){function a(){}p(a,"laya.media.SoundManager");m(1,a,"useAudioMusic",function(){return a._useAudioMusic},function(c){a._useAudioMusic=c;a._musicClass=c?Ea:null});m(1,a,"autoStopMusic",function(){return a._autoStopMusic},function(c){l.stage.off("blur",null,a._stageOnBlur);l.stage.off("focus",null,a._stageOnFocus);l.stage.off("visibilitychange",null,a._visibilityChange);if(a._autoStopMusic=c)l.stage.on("blur",null,a._stageOnBlur),l.stage.on("focus",null,a._stageOnFocus),l.stage.on("visibilitychange",null,a._visibilityChange)});m(1,a,"muted",function(){return a._muted},function(c){c!=a._muted&&(c&&a.stopAllSound(),a.musicMuted=c,a._muted=c)});m(1,a,"musicMuted",function(){return a._musicMuted},function(c){c!=a._musicMuted&&(c?(a._bgMusic?a._musicChannel&&!a._musicChannel.isStopped?v.isConchApp?a._musicChannel._audio&&(a._musicChannel._audio.muted=!0):a._musicChannel.pause():a._musicChannel=null:a._musicChannel=null,a._musicMuted=c):(a._musicMuted=c,a._bgMusic&&a._musicChannel&&(v.isConchApp?a._musicChannel._audio&&(a._musicChannel._audio.muted=!1):a._musicChannel.resume())))});m(1,a,"soundMuted",function(){return a._soundMuted},function(c){a._soundMuted=c});a.__init__=function(){var c=r.window;(c=c.AudioContext||c.webkitAudioContext||c.mozAudioContext?!0:!1)&&ma.initWebAudio();a._soundClass=c?ma:Ea;Ea._initMusicAudio();a._musicClass=Ea;return c};a.addChannel=function(c){0<=a._channels.indexOf(c)||a._channels.push(c)};a.removeChannel=function(c){var b;for(b=a._channels.length-1;0<=b;b--)a._channels[b]==c&&a._channels.splice(b,1)};a.disposeSoundLater=function(c){a._lastSoundUsedTimeDic[c]=r.now();a._isCheckingDispose||(a._isCheckingDispose=!0,l.timer.loop(5E3,null,a._checkDisposeSound))};a._checkDisposeSound=function(){var c,b=r.now(),d=!1;for(c in a._lastSoundUsedTimeDic)3E4<b-a._lastSoundUsedTimeDic[c]?(delete a._lastSoundUsedTimeDic[c],a.disposeSoundIfNotUsed(c)):d=!0;d||(a._isCheckingDispose=!1,l.timer.clear(null,a._checkDisposeSound))};a.disposeSoundIfNotUsed=function(c){var b;for(b=a._channels.length-1;0<=b;b--)if(a._channels[b].url==c)return;a.destroySound(c)};a._visibilityChange=function(){l.stage.isVisibility?a._stageOnFocus():a._stageOnBlur()};a._stageOnBlur=function(){a._isActive=!1;a._musicChannel&&!a._musicChannel.isStopped&&(a._blurPaused=!0,a._musicChannel.pause());a.stopAllSound();l.stage.once("mousedown",null,a._stageOnFocus)};a._recoverWebAudio=function(){ma.ctx&&"running"!=ma.ctx.state&&ma.ctx.resume&&ma.ctx.resume()};a._stageOnFocus=function(){a._isActive=!0;a._recoverWebAudio();l.stage.off("mousedown",null,a._stageOnFocus);a._blurPaused&&a._musicChannel&&a._musicChannel.isStopped&&(a._blurPaused=!1,a._musicChannel.resume())};a.playSound=function(c,b,d,e,f){void 0===b&&(b=1);void 0===f&&(f=0);if(!a._isActive||!c||a._muted)return null;a._recoverWebAudio();c=M.formatURL(c);if(c==a._bgMusic){if(a._musicMuted)return null}else{if(v.isConchApp){var g=L.getFileExtension(c);if("wav"!=g&&"ogg"!=g)return alert("The sound only supports wav or ogg format,for optimal performance reason,please refer to the official website document."),null}if(a._soundMuted)return null}var h;r.onMiniGame||(h=l.loader.getRes(c));e||(e=a._soundClass);h||(h=new e,h.load(c),r.onMiniGame||H.cacheRes(c,h));b=h.play(f,b);if(!b)return null;b.url=c;b.volume=c==a._bgMusic?a.musicVolume:a.soundVolume;b.completeHandler=d;return b};a.destroySound=function(a){var b=l.loader.getRes(a);b&&(H.clearRes(a),b.dispose())};a.playMusic=function(c,b,d,e){void 0===b&&(b=0);void 0===e&&(e=0);c=M.formatURL(c);a._bgMusic=c;a._musicChannel&&a._musicChannel.stop();return a._musicChannel=a.playSound(c,b,d,a._musicClass,e)};a.stopSound=function(c){c=M.formatURL(c);var b,d;for(b=a._channels.length-1;0<=b;b--)d=a._channels[b],d.url==c&&d.stop()};a.stopAll=function(){a._bgMusic=null;var c,b;for(c=a._channels.length-1;0<=c;c--)b=a._channels[c],b.stop()};a.stopAllSound=function(){var c,b;for(c=a._channels.length-1;0<=c;c--)b=a._channels[c],b.url!=a._bgMusic&&b.stop()};a.stopMusic=function(){a._musicChannel&&a._musicChannel.stop();a._bgMusic=null};a.setSoundVolume=function(c,b){if(b)b=M.formatURL(b),a._setVolume(b,c);else{a.soundVolume=c;var d,e;for(d=a._channels.length-1;0<=d;d--)e=a._channels[d],e.url!=a._bgMusic&&(e.volume=c)}};a.setMusicVolume=function(c){a.musicVolume=c;a._setVolume(a._bgMusic,c)};a._setVolume=function(c,b){c=M.formatURL(c);var d,e;for(d=a._channels.length-1;0<=d;d--)e=a._channels[d],e.url==c&&(e.volume=b)};a.musicVolume=1;a.soundVolume=1;a.playbackRate=1;a._useAudioMusic=!0;a._muted=!1;a._soundMuted=!1;a._musicMuted=!1;a._bgMusic=null;a._musicChannel=null;a._channels=[];a._autoStopMusic=!1;a._blurPaused=!1;a._isActive=!0;a._soundClass=null;a._musicClass=null;a._lastSoundUsedTimeDic={};a._isCheckingDispose=!1;a.autoReleaseSound=!0;return a}(),qa=function(a){function c(b){void 0===b&&(b=1E4);c.__super.call(this,b)}p(c,"laya.webgl.submit.SubmitTexture",a);a=c.prototype;a.clone=function(b,a,e){var d=c._poolSize?c.POOL[--c._poolSize]:new c;this._cloneInit(d,b,a,e);return d};a.releaseRender=function(){1>--this._ref&&(c.POOL[c._poolSize++]=this,this.shaderValue.release(),this._mesh=null,this._parent&&(this._parent.releaseRender(),this._parent=null))};a.renderSubmit=function(){if(0===this._numEle)return 1;var b=this.shaderValue.textureHost;if(b){var a=b?b._getSource():null;if(!a)return 1}b=E.mainContext;this._mesh.useMesh(b);var c=z.preRender,f=z.preRender._key;0===this._key.blendShader&&this._key.submitType===f.submitType&&this._key.blendShader===f.blendShader&&aa.activeShader&&z.preRender.clipInfoID==this.clipInfoID&&c.shaderValue.defines._value===this.shaderValue.defines._value&&0==(this.shaderValue.defines._value&Ma.NOOPTMASK)?aa.activeShader.uploadTexture2D(a):(T.activeBlendFunction!==this._blendFn&&(C.setBlend(b,!0),this._blendFn(b),T.activeBlendFunction=this._blendFn),this.shaderValue.texture=a,this.shaderValue.upload());b.drawElements(4,this._numEle,5123,this._startIdx);J.renderBatches++;J.trianglesFaces+=this._numEle/3;return 1};c.create=function(b,a,e){var d=c._poolSize?c.POOL[--c._poolSize]:new c(10016);d._mesh=a;d._key.clear();d._key.submitType=2;d._ref=1;d._startIdx=a.indexNum*ja.BYTES_PIDX;d._numEle=0;a=b._nBlendType;d._key.blendShader=a;d._blendFn=b._targets?T.targetFns[a]:T.fns[a];d.shaderValue=e;b._colorFiler&&(b=b._colorFiler,e.defines.add(b.type),e.colorMat=b._mat,e.colorAlpha=b._alpha);return d};c._poolSize=0;c.POOL=[];return c}(z),jb=function(a){function c(b){c.__super.call(this);b||(b=this._copyMatrix(c.IDENTITY_MATRIX));this._mat=new Float32Array(16);this._alpha=new Float32Array(4);this.setByMatrix(b)}p(c,"laya.filters.ColorFilter",a);a=c.prototype;l.imps(a,{"laya.filters.IFilter":!0});a.gray=function(){return this.setByMatrix(c.GRAY_MATRIX)};a.color=function(b,a,c,f){void 0===b&&(b=0);void 0===a&&(a=0);void 0===c&&(c=0);void 0===f&&(f=1);return this.setByMatrix([1,0,0,0,b,0,1,0,0,a,0,0,1,0,c,0,0,0,1,f])};a.setColor=function(b){b=x.create(b).arrColor;return this.setByMatrix([0,0,0,0,256*b[0],0,0,0,0,256*b[1],0,0,0,0,256*b[2],0,0,0,1,0])};a.setByMatrix=function(b){this._matrix!=b&&this._copyMatrix(b);for(var a=0,c=0,f=0;20>f;f++)4!=f%5?this._mat[a++]=b[f]:this._alpha[c++]=b[f];return this};a.adjustColor=function(b,a,c,f){this.adjustHue(f);this.adjustContrast(a);this.adjustBrightness(b);this.adjustSaturation(c);return this};a.adjustBrightness=function(b){b=this._clampValue(b,100);return 0==b||isNaN(b)?this:this._multiplyMatrix([1,0,0,0,b,0,1,0,0,b,0,0,1,0,b,0,0,0,1,0,0,0,0,0,1])};a.adjustContrast=function(b){b=this._clampValue(b,100);if(0==b||isNaN(b))return this;var a;0>b?a=127+b/100*127:(a=b%1,a=0==a?c.DELTA_INDEX[b]:c.DELTA_INDEX[b<<0]*(1-a)+c.DELTA_INDEX[(b<<0)+1]*a,a=127*a+127);b=a/127;a=.5*(127-a);return this._multiplyMatrix([b,0,0,0,a,0,b,0,0,a,0,0,b,0,a,0,0,0,1,0,0,0,0,0,1])};a.adjustSaturation=function(b){b=this._clampValue(b,100);if(0==b||isNaN(b))return this;b=1+(0<b?3*b/100:b/100);var a=1-b,c=.3086*a,f=.6094*a,a=.082*a;return this._multiplyMatrix([c+b,f,a,0,0,c,f+b,a,0,0,c,f,a+b,0,0,0,0,0,1,0,0,0,0,0,1])};a.adjustHue=function(b){b=this._clampValue(b,180)/180*Math.PI;if(0==b||isNaN(b))return this;var a=Math.cos(b);b=Math.sin(b);return this._multiplyMatrix([.213+.787*a+-.213*b,.715+-.715*a+-.715*b,.072+-.072*a+.928*b,0,0,.213+-.213*a+.143*b,.715+a*(1-.715)+.14*b,.072+-.072*a+-.283*b,0,0,.213+-.213*a+-.787*b,.715+-.715*a+.715*b,.072+.928*a+.072*b,0,0,0,0,0,1,0,0,0,0,0,1])};a.reset=function(){return this.setByMatrix(this._copyMatrix(c.IDENTITY_MATRIX))};a._multiplyMatrix=function(b){var a=[];this._matrix=this._fixMatrix(this._matrix);for(var c=0;5>c;c++){for(var f=0;5>f;f++)a[f]=this._matrix[f+5*c];for(f=0;5>f;f++){for(var g=0,h=0;5>h;h++)g+=b[f+5*h]*a[h];this._matrix[f+5*c]=g}}return this.setByMatrix(this._matrix)};a._clampValue=function(b,a){return Math.min(a,Math.max(-a,b))};a._fixMatrix=function(b){if(null==b)return c.IDENTITY_MATRIX;25>b.length?b=b.slice(0,b.length).concat(c.IDENTITY_MATRIX.slice(b.length,25)):25<b.length&&(b=b.slice(0,25));return b};a._copyMatrix=function(b){this._matrix||(this._matrix=[]);for(var a=0;25>a;a++)this._matrix[a]=b[a];return this._matrix};m(0,a,"type",function(){return 32});c.LENGTH=25;t(c,["DELTA_INDEX",function(){return this.DELTA_INDEX=[0,.01,.02,.04,.05,.06,.07,.08,.1,.11,.12,.14,.15,.16,.17,.18,.2,.21,.22,.24,.25,.27,.28,.3,.32,.34,.36,.38,.4,.42,.44,.46,.48,.5,.53,.56,.59,.62,.65,.68,.71,.74,.77,.8,.83,.86,.89,.92,.95,.98,1,1.06,1.12,1.18,1.24,1.3,1.36,1.42,1.48,1.54,1.6,1.66,1.72,1.78,1.84,1.9,1.96,2,2.12,2.25,2.37,2.5,2.62,2.75,2.87,3,3.2,3.4,3.6,3.8,4,4.3,4.7,4.9,5,5.5,6,6.5,6.8,7,7.3,7.5,7.8,8,8.4,8.7,9,9.4,9.6,9.8,10]},"GRAY_MATRIX",function(){return this.GRAY_MATRIX=[.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,0,0,0,1,0]},"IDENTITY_MATRIX",function(){return this.IDENTITY_MATRIX=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1]}]);return c}(Ja),qb=function(a){function c(){this._matrix=new I;this._matrix4=ja.defaultMatrix4.concat();c.__super.call(this,1E4);this.shaderValue=new U(0,0)}p(c,"laya.webgl.submit.SubmitCanvas",a);a=c.prototype;a.renderSubmit=function(){var b=F.worldAlpha,a=F.worldMatrix4,c=F.worldMatrix,f=F.worldFilters,g=F.worldShaderDefines,h=this.shaderValue,k=this._matrix4,n=I.TEMP;I.mul(this._matrix,c,n);k[0]=n.a;k[1]=n.b;k[4]=n.c;k[5]=n.d;k[12]=n.tx;k[13]=n.ty;F.worldMatrix=n.clone();F.worldMatrix4=k;F.worldAlpha*=h.alpha;h.filters&&h.filters.length&&(F.worldFilters=h.filters,F.worldShaderDefines=h.defines);this.canv.flushsubmit();F.worldAlpha=b;F.worldMatrix4=a;F.worldMatrix.destroy();F.worldMatrix=c;F.worldFilters=f;F.worldShaderDefines=g;return 1};a.releaseRender=function(){if(1>--this._ref){var b=c.POOL;this._mesh=null;b[b._length++]=this}};a.clone=function(b,a,c){return null};a.getRenderType=function(){return 10003};c.create=function(b,a,e){var d=c.POOL._length?c.POOL[--c.POOL._length]:new c;d.canv=b;d._ref=1;d._numEle=0;b=d.shaderValue;b.alpha=a;b.defines.setValue(0);e&&e.length&&b.setFilters(e);return d};c.POOL=[];c.__init$=function(){c.POOL._length=0};return c}(z);(function(a){function c(){c.__super.call(this)}p(c,"laya.components.Script",a);a=c.prototype;a._onAwake=function(){this.onAwake();this.onStart!==laya.components.Script.prototype.onStart&&l.startTimer.callLater(this,this.onStart)};a._onEnable=function(){var b=laya.components.Script.prototype;if(this.onTriggerEnter!==b.onTriggerEnter)this.owner.on("triggerenter",this,this.onTriggerEnter);if(this.onTriggerStay!==b.onTriggerStay)this.owner.on("triggerstay",this,this.onTriggerStay);if(this.onTriggerExit!==b.onTriggerExit)this.owner.on("triggerexit",this,this.onTriggerExit);if(this.onMouseDown!==b.onMouseDown)this.owner.on("mousedown",this,this.onMouseDown);if(this.onMouseUp!==b.onMouseUp)this.owner.on("mouseup",this,this.onMouseUp);if(this.onClick!==b.onClick)this.owner.on("click",this,this.onClick);if(this.onStageMouseDown!==b.onStageMouseDown)l.stage.on("mousedown",this,this.onStageMouseDown);if(this.onStageMouseUp!==b.onStageMouseUp)l.stage.on("mouseup",this,this.onStageMouseUp);if(this.onStageClick!==b.onStageClick)l.stage.on("click",this,this.onStageClick);if(this.onStageMouseMove!==b.onStageMouseMove)l.stage.on("mousemove",this,this.onStageMouseMove);if(this.onDoubleClick!==b.onDoubleClick)this.owner.on("doubleclick",this,this.onDoubleClick);if(this.onRightClick!==b.onRightClick)this.owner.on("rightclick",this,this.onRightClick);if(this.onMouseMove!==b.onMouseMove)this.owner.on("mousemove",this,this.onMouseMove);if(this.onMouseOver!==b.onMouseOver)this.owner.on("mouseover",this,this.onMouseOver);if(this.onMouseOut!==b.onMouseOut)this.owner.on("mouseout",this,this.onMouseOut);if(this.onKeyDown!==b.onKeyDown)l.stage.on("keydown",this,this.onKeyDown);if(this.onKeyPress!==b.onKeyPress)l.stage.on("keypress",this,this.onKeyPress);if(this.onKeyUp!==b.onKeyUp)l.stage.on("keyup",this,this.onKeyUp);this.onUpdate!==b.onUpdate&&l.updateTimer.frameLoop(1,this,this.onUpdate);this.onLateUpdate!==b.onLateUpdate&&l.lateTimer.frameLoop(1,this,this.onLateUpdate);this.onPreRender!==b.onPreRender&&l.lateTimer.frameLoop(1,this,this.onPreRender)};a._onDisable=function(){this.owner.offAllCaller(this);l.stage.offAllCaller(this);l.startTimer.clearAll(this);l.updateTimer.clearAll(this);l.lateTimer.clearAll(this)};a._isScript=function(){return!0};a._onDestroy=function(){this.onDestroy()};a.onAwake=function(){};a.onEnable=function(){};a.onStart=function(){};a.onTriggerEnter=function(b,a,c){};a.onTriggerStay=function(b,a,c){};a.onTriggerExit=function(b,a,c){};a.onMouseDown=function(b){};a.onMouseUp=function(b){};a.onClick=function(b){};a.onStageMouseDown=function(b){};a.onStageMouseUp=function(b){};a.onStageClick=function(b){};a.onStageMouseMove=function(b){};a.onDoubleClick=function(b){};a.onRightClick=function(b){};a.onMouseMove=function(b){};a.onMouseOver=function(b){};a.onMouseOut=function(b){};a.onKeyDown=function(b){};a.onKeyPress=function(b){};a.onKeyUp=function(b){};a.onUpdate=function(){};a.onLateUpdate=function(){};a.onPreRender=function(){};a.onPostRender=function(){};a.onDisable=function(){};a.onDestroy=function(){};m(0,a,"isSingleton",function(){return!1});return c})(fb);var Ea=function(a){function c(){this.audio=this.url=null;this.loaded=!1;c.__super.call(this)}p(c,"laya.media.h5audio.AudioSound",a);a=c.prototype;a.dispose=function(){var b=c._audioCache[this.url];w.clearBySign("audio:"+this.url);b&&(v.isConchApp||(b.src=""),delete c._audioCache[this.url])};a.load=function(b){function a(){f();h.loaded=!0;h.event("complete")}function e(){g.load=null;f();h.event("error")}function f(){g.removeEventListener("canplaythrough",a);g.removeEventListener("error",e)}this.url=b=M.formatURL(b);var g;b==Q._bgMusic?(c._initMusicAudio(),g=c._musicAudio,g.src!=b&&(g=c._audioCache[g.src]=null)):g=c._audioCache[b];if(g&&2<=g.readyState)this.event("complete");else{g||(b==Q._bgMusic?(c._initMusicAudio(),g=c._musicAudio):g=r.createElement("audio"),c._audioCache[b]=g,g.src=b);g.addEventListener("canplaythrough",a);g.addEventListener("error",e);var h=this;this.audio=g;g.load?g.load():e()}};a.play=function(b,a){void 0===b&&(b=0);void 0===a&&(a=0);if(!this.url)return null;var d;d=this.url==Q._bgMusic?c._musicAudio:c._audioCache[this.url];if(!d)return null;var f;f=w.getItem("audio:"+this.url);v.isConchApp?f||(f=r.createElement("audio"),f.src=this.url):this.url==Q._bgMusic?(c._initMusicAudio(),f=c._musicAudio,f.src=this.url):f=f?f:d.cloneNode(!0);d=new Jc(f);d.url=this.url;d.loops=a;d.startTime=b;d.play();Q.addChannel(d);return d};m(0,a,"duration",function(){var b;return(b=c._audioCache[this.url])?b.duration:0});c._initMusicAudio=function(){c._musicAudio||(c._musicAudio||(c._musicAudio=r.createElement("audio")),v.isConchApp||r.document.addEventListener("mousedown",c._makeMusicOK))};c._makeMusicOK=function(){r.document.removeEventListener("mousedown",c._makeMusicOK);c._musicAudio.src?c._musicAudio.play():(c._musicAudio.src="",c._musicAudio.load())};c._audioCache={};c._musicAudio=null;return c}(W);(function(a){function c(){c.__super.call(this)}p(c,"laya.media.Sound",a);a=c.prototype;a.load=function(b){};a.play=function(b,a){return null};a.dispose=function(){};m(0,a,"duration",function(){return 0});return c})(W);(function(a){function c(b){c.__super.call(this,116,464*b,4);this.canReuse=!0;this.setAttributes(laya.webgl.utils.MeshParticle2D._fixattriInfo);this.createQuadIB(b);this._quadNum=b}p(c,"laya.webgl.utils.MeshParticle2D",a);a=c.prototype;a.setMaxParticleNum=function(b){this._vb._resizeBuffer(464*b,!1);this.createQuadIB(b)};a.releaseMesh=function(){this._vb.setByteLength(0);this.indexNum=this.vertNum=0;laya.webgl.utils.MeshParticle2D._POOL.push(this)};a.destroy=function(){this._ib.destroy();this._vb.destroy();this._vb.deleteBuffer()};c.getAMesh=function(b){if(laya.webgl.utils.MeshParticle2D._POOL.length){var a=laya.webgl.utils.MeshParticle2D._POOL.pop();a.setMaxParticleNum(b);return a}return new c(b)};c.const_stride=116;c._POOL=[];t(c,["_fixattriInfo",function(){return this._fixattriInfo=[5126,4,0,5126,3,16,5126,3,28,5126,4,40,5126,4,56,5126,3,72,5126,2,84,5126,4,92,5126,1,108,5126,1,112]}]);return c})(Ka);var Kc=function(a){function c(){this._bits=0;this._parent=null;this.name="";this.destroyed=!1;this._scene=this._activeChangeScripts=this._components=this._conchData=null;c.__super.call(this);this._extUIChild=this._children=c.ARRAY_EMPTY;this.createGLBuffer()}p(c,"laya.display.Node",a);a=c.prototype;a.createGLBuffer=function(){};a._setBit=function(b,a){16===b&&this._getBit(b)!=a&&this._updateDisplayedInstage();this._bits=a?this._bits|b:this._bits&~b};a._getBit=function(b){return 0!=(this._bits&b)};a._setUpNoticeChain=function(){this._getBit(16)&&this._setBitUp(16)};a._setBitUp=function(b){var a=this;a._setBit(b,!0);for(a=a._parent;a&&!a._getBit(b);)a._setBit(b,!0),a=a._parent};a.on=function(b,a,c,f){if("display"===b||"undisplay"===b)this._getBit(16)||this._setBitUp(16);return this._createListener(b,a,c,f,!1)};a.once=function(b,a,c,f){if("display"===b||"undisplay"===b)this._getBit(16)||this._setBitUp(16);return this._createListener(b,a,c,f,!0)};a.destroy=function(b){void 0===b&&(b=!0);this.destroyed=!0;this._destroyAllComponent();this._parent&&this._parent.removeChild(this);this._children&&(b?this.destroyChildren():this.removeChildren());this.onDestroy();this._children=null;this.offAll()};a.onDestroy=function(){};a.destroyChildren=function(){if(this._children)for(var b=0,a=this._children.length;b<a;b++)this._children[0].destroy(!0)};a.addChild=function(b){if(!b||this.destroyed||b===this)return b;b._zOrder&&this._setBit(32,!0);if(b._parent===this){var a=this.getChildIndex(b);a!==this._children.length-1&&(this._children.splice(a,1),this._children.push(b),this._childChanged())}else b._parent&&b._parent.removeChild(b),this._children===c.ARRAY_EMPTY&&(this._children=[]),this._children.push(b),b._setParent(this),this._childChanged();return b};a.addInputChild=function(b){if(this._extUIChild==c.ARRAY_EMPTY)this._extUIChild=[b];else{if(0<=this._extUIChild.indexOf(b))return null;this._extUIChild.push(b)}return null};a.removeInputChild=function(b){b=this._extUIChild.indexOf(b);0<=b&&this._extUIChild.splice(b,1)};a.addChildren=function(b){for(var a=arguments,c=0,f=a.length;c<f;)this.addChild(a[c++])};a.addChildAt=function(b,a){if(!b||this.destroyed||b===this)return b;b._zOrder&&this._setBit(32,!0);if(0<=a&&a<=this._children.length){if(b._parent===this){var d=this.getChildIndex(b);this._children.splice(d,1);this._children.splice(a,0,b);this._childChanged()}else b._parent&&b._parent.removeChild(b),this._children===c.ARRAY_EMPTY&&(this._children=[]),this._children.splice(a,0,b),b._setParent(this);return b}throw Error("appendChildAt:The index is out of bounds");};a.getChildIndex=function(b){return this._children.indexOf(b)};a.getChildByName=function(b){var a=this._children;if(a)for(var c=0,f=a.length;c<f;c++){var g=a[c];if(g.name===b)return g}return null};a.getChildAt=function(b){return this._children[b]||null};a.setChildIndex=function(b,a){var d=this._children;if(0>a||a>=d.length)throw Error("setChildIndex:The index is out of bounds.");var c=this.getChildIndex(b);if(0>c)throw Error("setChildIndex:node is must child of this object.");d.splice(c,1);d.splice(a,0,b);this._childChanged();return b};a._childChanged=function(b){};a.removeChild=function(b){if(!this._children)return b;b=this._children.indexOf(b);return this.removeChildAt(b)};a.removeSelf=function(){this._parent&&this._parent.removeChild(this);return this};a.removeChildByName=function(b){(b=this.getChildByName(b))&&this.removeChild(b);return b};a.removeChildAt=function(b){var a=this.getChildAt(b);a&&(this._children.splice(b,1),a._setParent(null));return a};a.removeChildren=function(b,a){void 0===b&&(b=0);void 0===a&&(a=2147483647);if(this._children&&0<this._children.length){var d=this._children;0===b&&a>=d.length-1?this._children=c.ARRAY_EMPTY:d=d.splice(b,a-b);for(var f=0,g=d.length;f<g;f++)d[f]._setParent(null)}return this};a.replaceChild=function(b,a){var d=this._children.indexOf(a);return-1<d?(this._children.splice(d,1,b),a._setParent(null),b._setParent(this),b):null};a._setParent=function(b){this._parent!==b&&(b?(this._parent=b,this._onAdded(),this.event("added"),this._getBit(16)&&(this._setUpNoticeChain(),b.displayedInStage&&this._displayChild(this,!0)),b._childChanged(this)):(this._onRemoved(),this.event("removed"),this._parent._childChanged(),this._getBit(16)&&this._displayChild(this,!1),this._parent=b))};a._updateDisplayedInstage=function(){var b;b=this;for(var a=l.stage,c=!1;b;){if(b._getBit(16)){c=b._getBit(128);break}if(b===a||b._getBit(128)){c=!0;break}b=b._parent}this._setBit(128,c)};a._setDisplay=function(b){this._getBit(128)!==b&&(this._setBit(128,b),b?this.event("display"):this.event("undisplay"))};a._displayChild=function(b,a){var d=b._children;if(d)for(var c=0,g=d.length;c<g;c++){var h=d[c];h._getBit(16)&&(0<h._children.length?this._displayChild(h,a):h._setDisplay(a))}b._setDisplay(a)};a.contains=function(b){if(b===this)return!0;for(;b;){if(b._parent===this)return!0;b=b._parent}return!1};a.timerLoop=function(b,a,c,f,g,h){void 0===g&&(g=!0);void 0===h&&(h=!1);(this.scene?this.scene.timer:l.timer).loop(b,a,c,f,g,h)};a.timerOnce=function(b,a,c,f,g){void 0===g&&(g=!0);(this.scene?this.scene.timer:l.timer)._create(!1,!1,b,a,c,f,g)};a.frameLoop=function(b,a,c,f,g){void 0===g&&(g=!0);(this.scene?this.scene.timer:l.timer)._create(!0,!0,b,a,c,f,g)};a.frameOnce=function(b,a,c,f,g){void 0===g&&(g=!0);(this.scene?this.scene.timer:l.timer)._create(!0,!1,b,a,c,f,g)};a.clearTimer=function(b,a){(this.scene?this.scene.timer:l.timer).clear(b,a)};a.callLater=function(b,a){(this.scene?this.scene.timer:l.timer).callLater(this,b,a)};a.runCallLater=function(b){(this.scene?this.scene.timer:l.timer).runCallLater(this,b)};a._onActive=function(){J.spriteCount++};a._onInActive=function(){J.spriteCount--};a._onActiveInScene=function(){};a._onInActiveInScene=function(){};a._parse=function(b,a){};a._setBelongScene=function(b){if(!this._scene){this._scene=b;if(this._components)for(var a=0,c=this._components.length;a<c;a++)this._components[a]._setActiveInScene(!0);this._onActiveInScene();a=0;for(c=this._children.length;a<c;a++)this._children[a]._setBelongScene(b)}};a._setUnBelongScene=function(){if(this._scene!==this){this._onInActiveInScene();if(this._components)for(var b=0,a=this._components.length;b<a;b++)this._components[b]._setActiveInScene(!1);this._scene=null;b=0;for(a=this._children.length;b<a;b++)this._children[b]._setUnBelongScene()}};a.onAwake=function(){};a.onEnable=function(){};a._processActive=function(){this._activeChangeScripts||(this._activeChangeScripts=[]);this._activeHierarchy(this._activeChangeScripts);this._activeScripts()};a._activeHierarchy=function(b){this._setBit(2,!0);if(this._components)for(var a=0,c=this._components.length;a<c;a++){var f=this._components[a];f._setActive(!0);f._isScript()&&f._enabled&&b.push(f)}this._onActive();a=0;for(c=this._children.length;a<c;a++)f=this._children[a],!f._getBit(1)&&f._activeHierarchy(b);this._getBit(4)||(this._setBit(4,!0),this.onAwake());this.onEnable()};a._activeScripts=function(){for(var b=0,a=this._activeChangeScripts.length;b<a;b++)this._activeChangeScripts[b].onEnable();this._activeChangeScripts.length=0};a._processInActive=function(){this._activeChangeScripts||(this._activeChangeScripts=[]);this._inActiveHierarchy(this._activeChangeScripts);this._inActiveScripts()};a._inActiveHierarchy=function(b){this._onInActive();if(this._components)for(var a=0,c=this._components.length;a<c;a++){var f=this._components[a];f._setActive(!1);f._isScript()&&f._enabled&&b.push(f)}this._setBit(2,!1);a=0;for(c=this._children.length;a<c;a++)(f=this._children[a])&&!f._getBit(1)&&f._inActiveHierarchy(b);this.onDisable()};a._inActiveScripts=function(){for(var b=0,a=this._activeChangeScripts.length;b<a;b++)this._activeChangeScripts[b].onDisable();this._activeChangeScripts.length=0};a.onDisable=function(){};a._onAdded=function(){if(this._activeChangeScripts&&0!==this._activeChangeScripts.length)throw"Node: can't set the main inActive node active in hierarchy,if the operate is in main inActive node or it's children script's onDisable Event.";var b=this._parent.scene;b&&this._setBelongScene(b);this._parent.activeInHierarchy&&this.active&&this._processActive()};a._onRemoved=function(){if(this._activeChangeScripts&&0!==this._activeChangeScripts.length)throw"Node: can't set the main active node inActive in hierarchy,if the operate is in main active node or it's children script's onEnable Event.";this._parent.activeInHierarchy&&this.active&&this._processInActive();this._parent.scene&&this._setUnBelongScene()};a._addComponentInstance=function(b){this._components=this._components||[];this._components.push(b);b.owner=this;b._onAdded();this.activeInHierarchy&&(b._setActive(!0),b._isScript()&&b._enabled&&b.onEnable());this._scene&&b._setActiveInScene(!0)};a._destroyComponent=function(b){if(this._components)for(var a=0,c=this._components.length;a<c;a++){var f=this._components[a];if(f===b){f._destroy();this._components.splice(a,1);break}}};a._destroyAllComponent=function(){if(this._components){for(var b=0,a=this._components.length;b<a;b++)this._components[b]._destroy();this._components.length=0}};a._cloneTo=function(b,a,c){if(this._components)for(a=0,c=this._components.length;a<c;a++){var d=b.addComponent(this._components[a].constructor);this._components[a]._cloneTo(d)}};a.addComponentIntance=function(b){if(b.owner)throw"Node:the component has belong to other node.";if(b.isSingleton&&this.getComponent(b.constructor))throw"Node:the component is singleton,can't add the second one.";this._addComponentInstance(b);return b};a.addComponent=function(b){var a=w.createByClass(b);a._destroyed=!1;if(a.isSingleton&&this.getComponent(b))throw"\u65e0\u6cd5\u5b9e\u4f8b"+b+"\u7ec4\u4ef6\uff0c"+b+"\u7ec4\u4ef6\u5df2\u5b58\u5728\uff01";this._addComponentInstance(a);return a};a.getComponent=function(b){if(this._components)for(var a=0,c=this._components.length;a<c;a++){var f=this._components[a];if(l.__typeof(f,b))return f}return null};a.getComponents=function(b){var a;if(this._components)for(var c=0,f=this._components.length;c<f;c++){var g=this._components[c];l.__typeof(g,b)&&(a=a||[],a.push(g))}return a};m(0,a,"numChildren",function(){return this._children.length});m(0,a,"parent",function(){return this._parent});m(0,a,"activeInHierarchy",function(){return this._getBit(2)});m(0,a,"active",function(){return!this._getBit(8)&&!this._getBit(1)},function(b){b=!!b;if(!this._getBit(1)!==b){if(this._activeChangeScripts&&0!==this._activeChangeScripts.length){if(b)throw"Node: can't set the main inActive node active in hierarchy,if the operate is in main inActive node or it's children script's onDisable Event.";throw"Node: can't set the main active node inActive in hierarchy,if the operate is in main active node or it's children script's onEnable Event.";}this._setBit(1,!b);this._parent&&this._parent.activeInHierarchy&&(b?this._processActive():this._processInActive())}});m(0,a,"displayedInStage",function(){if(this._getBit(16))return this._getBit(128);this._setBitUp(16);return this._getBit(128)});m(0,a,"scene",function(){return this._scene});m(0,a,"timer",function(){return this.scene?this.scene.timer:l.timer});c.ARRAY_EMPTY=[];return c}(W),zb=function(a){function c(){this.url=null;this.loops=0;this.startTime=NaN;this.isStopped=!1;this.completeHandler=null;c.__super.call(this)}p(c,"laya.media.SoundChannel",a);a=c.prototype;a.play=function(){};a.stop=function(){this.completeHandler&&this.completeHandler.run()};a.pause=function(){};a.resume=function(){};a.__runComplete=function(b){b&&b.run()};m(0,a,"volume",function(){return 1},function(b){});m(0,a,"position",function(){return 0});m(0,a,"duration",function(){return 0});return c}(W),va=function(a){function c(){this._id=0;this._url=null;this._gpuMemory=this._cpuMemory=0;this._destroyed=!1;this._referenceCount=0;this.lock=!1;this.name=null;c.__super.call(this);this._id=++c._uniqueIDCounter;this._destroyed=!1;this._referenceCount=0;c._idResourcesMap[this.id]=this;this.lock=!1}p(c,"laya.resource.Resource",a);a=c.prototype;l.imps(a,{"laya.resource.ICreateResource":!0,"laya.resource.IDestroy":!0});a._setCPUMemory=function(b){var a=b-this._cpuMemory;this._cpuMemory=b;c._addCPUMemory(a)};a._setGPUMemory=function(b){var a=b-this._gpuMemory;this._gpuMemory=b;c._addGPUMemory(a)};a._setCreateURL=function(b){b=M.formatURL(b);if(this._url!==b){var a;this._url&&(a=c._urlResourcesMap[this._url],a.splice(a.indexOf(this),1),0===a.length&&delete c._urlResourcesMap[this._url]);b&&((a=c._urlResourcesMap[b])||(c._urlResourcesMap[b]=a=[]),a.push(this));this._url=b}};a._addReference=function(b){void 0===b&&(b=1);this._referenceCount+=b};a._removeReference=function(b){void 0===b&&(b=1);this._referenceCount-=b};a._clearReference=function(){this._referenceCount=0};a._recoverResource=function(){};a._disposeResource=function(){};a._activeResource=function(){};a.destroy=function(){if(!this._destroyed){this._destroyed=!0;this.lock=!1;this._disposeResource();delete c._idResourcesMap[this.id];var b;if(this._url){if(b=c._urlResourcesMap[this._url])b.splice(b.indexOf(this),1),0===b.length&&delete c._urlResourcesMap[this._url];H.getRes(this._url)==this&&delete H.loadedMap[this._url]}}};m(0,a,"id",function(){return this._id});m(0,a,"gpuMemory",function(){return this._gpuMemory});m(0,a,"url",function(){return this._url});m(0,a,"cpuMemory",function(){return this._cpuMemory});m(0,a,"destroyed",function(){return this._destroyed});m(0,a,"referenceCount",function(){return this._referenceCount});m(1,c,"cpuMemory",function(){return this._cpuMemory},laya.events.EventDispatcher._$SET_cpuMemory);m(1,c,"gpuMemory",function(){return this._gpuMemory},laya.events.EventDispatcher._$SET_gpuMemory);c._addCPUMemory=function(b){this._cpuMemory+=b};c._addGPUMemory=function(b){this._gpuMemory+=b};c._addMemory=function(b,a){this._cpuMemory+=b;this._gpuMemory+=a};c.getResourceByID=function(b){return c._idResourcesMap[b]};c.getResourceByURL=function(b,a){void 0===a&&(a=0);return c._urlResourcesMap[b][a]};c.destroyUnusedResources=function(){for(var b in c._idResourcesMap){var a=c._idResourcesMap[b];a.lock||0!==a._referenceCount||a.destroy()}};c._uniqueIDCounter=0;c._idResourcesMap={};c._urlResourcesMap={};c._cpuMemory=0;c._gpuMemory=0;return c}(W),Ca=function(a){function c(){c.__super.call(this,12,4,4);this.canReuse=!0;this.setAttributes(laya.webgl.utils.MeshVG._fixattriInfo)}p(c,"laya.webgl.utils.MeshVG",a);a=c.prototype;a.addVertAndIBToMesh=function(b,a,c,f){b=this._vb.needSize(a.length/2*12)>>2;for(var d=this._vb._floatArray32||this._vb.getFloat32Array(),e=this._vb._uint32Array,k=0,n=a.length/2,q=0;q<n;q++)d[b++]=a[k],d[b++]=a[k+1],k+=2,e[b++]=c;this._vb.setNeedUpload();this._ib.append(new Uint16Array(f));this._ib.setNeedUpload();this.vertNum+=n;this.indexNum+=f.length};a.releaseMesh=function(){this._vb.setByteLength(0);this._ib.setByteLength(0);this.indexNum=this.vertNum=0;laya.webgl.utils.MeshVG._POOL.push(this)};a.destroy=function(){this._ib.destroy();this._vb.destroy();this._ib.disposeResource();this._vb.deleteBuffer()};c.getAMesh=function(b){var a;a=laya.webgl.utils.MeshVG._POOL.length?laya.webgl.utils.MeshVG._POOL.pop():new c;b&&a._vb._resizeBuffer(786432,!1);return a};c.const_stride=12;c._POOL=[];t(c,["_fixattriInfo",function(){return this._fixattriInfo=[5126,2,0,5121,4,8]}]);return c}(Ka),Lc=function(a){function c(){this._labelDic=null;this._tweenDic={};this._tweenDataList=[];this._endTweenDataList=null;this._gidIndex=this._index=this._startTime=this._lastTime=this._currTime=0;this._firstTweenDic={};this._loopKey=this._endTimeSort=this._startTimeSort=!1;this.scale=1;this._frameRate=60;this._total=this._frameIndex=0;c.__super.call(this)}var b;p(c,"laya.utils.TimeLine",a);a=c.prototype;a.to=function(b,a,c,g,h){void 0===h&&(h=0);return this._create(b,a,c,g,h,!0)};a.from=function(b,a,c,g,h){void 0===h&&(h=0);return this._create(b,a,c,g,h,!1)};a._create=function(a,c,f,g,h,k){var d=w.getItemByClass("tweenData",b);d.isTo=k;d.type=0;d.target=a;d.duration=f;d.data=c;d.startTime=this._startTime+h;d.endTime=d.startTime+d.duration;d.ease=g;this._startTime=Math.max(d.endTime,this._startTime);this._tweenDataList.push(d);this._endTimeSort=this._startTimeSort=!0;return this};a.addLabel=function(a,c){var d=w.getItemByClass("tweenData",b);d.type=1;d.data=a;d.endTime=d.startTime=this._startTime+c;this._labelDic||(this._labelDic={});this._labelDic[a]=d;this._tweenDataList.push(d);return this};a.removeLabel=function(b){if(this._labelDic&&this._labelDic[b]){var a=this._labelDic[b];a&&(a=this._tweenDataList.indexOf(a),-1<a&&this._tweenDataList.splice(a,1));delete this._labelDic[b]}};a.gotoTime=function(b){if(null!=this._tweenDataList&&0!=this._tweenDataList.length){var a,d,c;for(c in this._firstTweenDic)if(d=this._firstTweenDic[c])for(var h in d)d.diyTarget.hasOwnProperty(h)&&(d.diyTarget[h]=d[h]);for(c in this._tweenDic)a=this._tweenDic[c],a.clear(),delete this._tweenDic[c];this._gidIndex=this._index=0;this._currTime=b;this._lastTime=r.now();null==this._endTweenDataList||this._endTimeSort?(this._endTimeSort=!1,this._endTweenDataList=a=this._tweenDataList.concat(),a.sort(function(a,b){return a.endTime>b.endTime?1:a.endTime<b.endTime?-1:0})):a=this._endTweenDataList;d=0;for(h=a.length;d<h;d++)if(c=a[d],0==c.type)if(b>=c.endTime){this._index=Math.max(this._index,d+1);var k=c.data;if(c.isTo)for(var n in k)c.target[n]=k[n]}else break;d=0;for(h=this._tweenDataList.length;d<h;d++)c=this._tweenDataList[d],0==c.type&&b>=c.startTime&&b<c.endTime&&(this._index=Math.max(this._index,d+1),this._gidIndex++,a=w.getItemByClass("tween",Wa),a._create(c.target,c.data,c.duration,c.ease,S.create(this,this._animComplete,[this._gidIndex]),0,!1,c.isTo,!0,!1),a.setStartTime(this._currTime-(b-c.startTime)),a._updateEase(this._currTime),a.gid=this._gidIndex,this._tweenDic[this._gidIndex]=a)}};a.gotoLabel=function(a){null!=this._labelDic&&(a=this._labelDic[a])&&this.gotoTime(a.startTime)};a.pause=function(){l.timer.clear(this,this._update)};a.resume=function(){this.play(this._currTime,this._loopKey)};a.play=function(a,b){void 0===a&&(a=0);void 0===b&&(b=!1);if(this._tweenDataList){if(this._startTimeSort){this._startTimeSort=!1;this._tweenDataList.sort(function(a,b){return a.startTime>b.startTime?1:a.startTime<b.startTime?-1:0});for(var d=0,c=this._tweenDataList.length;d<c;d++){var e=this._tweenDataList[d];if(null!=e&&0==e.type){var k=e.target,n=k.$_GID||(k.$_GID=L.getGID()),q=null;null==this._firstTweenDic[n]?(q={},q.diyTarget=k,this._firstTweenDic[n]=q):q=this._firstTweenDic[n];for(var m in e.data)null==q[m]&&(q[m]=k[m])}}}"string"==typeof a?this.gotoLabel(a):this.gotoTime(a);this._loopKey=b;this._lastTime=r.now();l.timer.frameLoop(1,this,this._update)}};a._update=function(){if(this._currTime>=this._startTime)if(this._loopKey){this._complete();if(!this._tweenDataList)return;this.gotoTime(0)}else{for(var a in this._tweenDic)b=this._tweenDic[a],b.complete();this._complete();this.pause();return}var b=r.now(),c=this._currTime+=(b-this._lastTime)*this.scale;this._lastTime=b;for(a in this._tweenDic)b=this._tweenDic[a],b._updateEase(c);var b;0!=this._tweenDataList.length&&this._index<this._tweenDataList.length&&(a=this._tweenDataList[this._index],c>=a.startTime&&(this._index++,0==a.type?(this._gidIndex++,b=w.getItemByClass("tween",Wa),b._create(a.target,a.data,a.duration,a.ease,S.create(this,this._animComplete,[this._gidIndex]),0,!1,a.isTo,!0,!1),b.setStartTime(c),b.gid=this._gidIndex,this._tweenDic[this._gidIndex]=b,b._updateEase(c)):this.event("label",a.data)))};a._animComplete=function(a){this._tweenDic[a]&&delete this._tweenDic[a]};a._complete=function(){this.event("complete")};a.reset=function(){var a;if(this._labelDic)for(a in this._labelDic)delete this._labelDic[a];var b;for(a in this._tweenDic)b=this._tweenDic[a],b.clear(),delete this._tweenDic[a];for(a in this._firstTweenDic)delete this._firstTweenDic[a];this._endTweenDataList=null;if(this._tweenDataList&&this._tweenDataList.length)for(b=this._tweenDataList.length,a=0;a<b;a++)this._tweenDataList[a]&&this._tweenDataList[a].destroy();this._gidIndex=this._index=this._startTime=this._lastTime=this._currTime=this._tweenDataList.length=0;this.scale=1;l.timer.clear(this,this._update)};a.destroy=function(){this.reset();this._firstTweenDic=this._tweenDataList=this._tweenDic=this._labelDic=null};m(0,a,"index",function(){return this._frameIndex},function(a){this._frameIndex=a;this.gotoTime(this._frameIndex/this._frameRate*1E3)});m(0,a,"total",function(){return this._total=Math.floor(this._startTime/1E3*this._frameRate)});c.to=function(a,b,f,g,h){void 0===h&&(h=0);return(new c).to(a,b,f,g,h)};c.from=function(a,b,f,g,h){void 0===h&&(h=0);return(new c).from(a,b,f,g,h)};c.__init$=function(){b=function(){function a(){this.type=0;this.isTo=!0;this.endTime=this.startTime=NaN;this.target=null;this.duration=NaN;this.data=this.ease=null}p(a,"");a.prototype.destroy=function(){this.data=this.ease=this.target=null;this.isTo=!0;this.type=0;w.recover("tweenData",this)};return a}()};return c}(W),Ma=function(a){function c(){c.__super.call(this,c.__name2int,c.__int2name,c.__int2nameMap)}p(c,"laya.webgl.shader.d2.ShaderDefines2D",a);c.__init__=function(){c.reg("TEXTURE2D",1);c.reg("PRIMITIVE",4);c.reg("GLOW_FILTER",8);c.reg("BLUR_FILTER",16);c.reg("COLOR_FILTER",32);c.reg("COLOR_ADD",64);c.reg("WORLDMAT",128);c.reg("FILLTEXTURE",256);c.reg("FSHIGHPRECISION",1024);c.reg("MVP3D",2048)};c.reg=function(a,d){La._reg(a,d,c.__name2int,c.__int2name)};c.toText=function(a,d,c){return La._toText(a,d,c)};c.toInt=function(a){return La._toInt(a,c.__name2int)};c.TEXTURE2D=1;c.PRIMITIVE=4;c.FILTERGLOW=8;c.FILTERBLUR=16;c.FILTERCOLOR=32;c.COLORADD=64;c.WORLDMAT=128;c.FILLTEXTURE=256;c.SKINMESH=512;c.SHADERDEFINE_FSHIGHPRECISION=1024;c.MVP3D=2048;c.NOOPTMASK=312;c.__name2int={};c.__int2name=[];c.__int2nameMap=[];return c}(La),X=function(a){function c(a,d,e,f){this.uvrect=[0,0,1,1];this._destroyed=!1;this.sourceHeight=this.sourceWidth=this._h=this._w=this.offsetY=this.offsetX=this.$_GID=this._referenceCount=0;this.url=null;this.scaleRate=1;c.__super.call(this);void 0===e&&(e=0);void 0===f&&(f=0);this.setTo(a,d,e,f)}p(c,"laya.resource.Texture",a);a=c.prototype;a._addReference=function(){this._bitmap&&this._bitmap._addReference();this._referenceCount++};a._removeReference=function(){this._bitmap&&this._bitmap._removeReference();this._referenceCount--};a._getSource=function(a){if(this._destroyed||!this._bitmap)return null;this.recoverBitmap(a);return this._bitmap.destroyed?null:this.bitmap._getSource()};a._onLoaded=function(a,d){d&&d!=this&&(d instanceof laya.resource.Texture?c._create(d,0,0,d.width,d.height,0,0,d.sourceWidth,d.sourceHeight,this):(this.bitmap=d,this.sourceWidth=this._w=d.width,this.sourceHeight=this._h=d.height));a&&a.run();this.event("ready",this)};a.getIsReady=function(){return this._destroyed?!1:this._bitmap?!0:!1};a.setTo=function(a,d,e,f){void 0===e&&(e=0);void 0===f&&(f=0);this.bitmap=a;this.sourceWidth=e;this.sourceHeight=f;a&&(this._w=a.width,this._h=a.height,this.sourceWidth=this.sourceWidth||a.width,this.sourceHeight=this.sourceHeight||a.height);this.uv=d||c.DEF_UV};a.load=function(a,d){this._destroyed||l.loader.load(a,S.create(this,this._onLoaded,[d]),null,"htmlimage",1,!1,null,!0)};a.getTexturePixels=function(a,d,c,f){var b,e=this.bitmap;b=e.width;var k=e.height;a+c>b&&(c-=a+c-b);d+f>k&&(f-=d+f-k);if(0>=c||0>=f)return null;var n=4*c,q=null;try{q=e.getPixels()}catch(na){}if(q){if(0==a&&0==d&&c==b&&f==k)return q;k=new Uint8Array(c*f*4);n=4*b;b=4*a;a=(d+f-1)*n+4*a;for(--f;0<=f;f--)k.set(m.slice(a,a+4*c),b),b+=n,a-=n;return k}e=new V;e.size(c,f);e.asBitmap=!0;var l=null;if(0!=a||0!=d||c!=b||f!=k)l=l.concat(),m=l[0],q=l[1],b=(l[2]-m)/b,k=(l[7]-q)/k,l=[m+a*b,q+d*k,m+(a+c)*b,q+d*k,m+(a+c)*b,q+(d+f)*k,m+a*b,q+(d+f)*k];e._drawTextureM(this,0,0,c,f,null,1,l);e._targets.start();e.flush();e._targets.end();e._targets.restore();var m=e._targets.getData(0,0,c,f);e.destroy();k=new Uint8Array(c*f*4);b=0;a=(f-1)*n;for(--f;0<=f;f--)k.set(m.slice(a,a+n),b),b+=n,a-=n;return k};a.getPixels=function(a,d,c,f){return v.isConchApp?this._nativeObj.getImageData(a,d,c,f):this.getTexturePixels(a,d,c,f)};a.recoverBitmap=function(a){var b=this,c=this._bitmap.url;this._destroyed||this._bitmap&&!this._bitmap.destroyed||!c||l.loader.load(c,S.create(this,function(d){b.bitmap=d;a&&a()}),null,"htmlimage",1,!1,null,!0)};a.disposeBitmap=function(){!this._destroyed&&this._bitmap&&this._bitmap.destroy()};a.destroy=function(a){void 0===a&&(a=!1);if(!this._destroyed){this._destroyed=!0;var b=this._bitmap;b&&(b._removeReference(this._referenceCount),(0===b.referenceCount||a)&&b.destroy());this.url&&this===l.loader.getRes(this.url)&&l.loader.clearRes(this.url)}};m(0,a,"height",function(){return this._h?this._h:this.bitmap?this.uv&&this.uv!==c.DEF_UV?(this.uv[5]-this.uv[1])*this.bitmap.height:this.bitmap.height:0},function(a){this._h=a;this.sourceHeight||(this.sourceHeight=a)});m(0,a,"uv",function(){return this._uv},function(a){this.uvrect[0]=Math.min(a[0],a[2],a[4],a[6]);this.uvrect[1]=Math.min(a[1],a[3],a[5],a[7]);this.uvrect[2]=Math.max(a[0],a[2],a[4],a[6])-this.uvrect[0];this.uvrect[3]=Math.max(a[1],a[3],a[5],a[7])-this.uvrect[1];this._uv=a});m(0,a,"width",function(){return this._w?this._w:this.bitmap?this.uv&&this.uv!==c.DEF_UV?(this.uv[2]-this.uv[0])*this.bitmap.width:this.bitmap.width:0},function(a){this._w=a;this.sourceWidth||(this.sourceWidth=a)});m(0,a,"bitmap",function(){return this._bitmap},function(a){this._bitmap&&this._bitmap._removeReference(this._referenceCount);(this._bitmap=a)&&a._addReference(this._referenceCount)});m(0,a,"destroyed",function(){return this._destroyed});c.moveUV=function(a,d,c){for(var b=0;8>b;b+=2)c[b]+=a,c[b+1]+=d;return c};c.create=function(a,d,e,f,g,h,k,n,q){void 0===h&&(h=0);void 0===k&&(k=0);void 0===n&&(n=0);void 0===q&&(q=0);return c._create(a,d,e,f,g,h,k,n,q)};c._create=function(a,d,e,f,g,h,k,n,q,l){void 0===h&&(h=0);void 0===k&&(k=0);void 0===n&&(n=0);void 0===q&&(q=0);var b=a instanceof laya.resource.Texture,m=b?a.uv:c.DEF_UV;a=b?a.bitmap:a;a.width&&d+f>a.width&&(f=a.width-d);a.height&&e+g>a.height&&(g=a.height-e);l?l.setTo(a,null,n||f,q||g):l=new c(a,null,n||f,q||g);l.width=f;l.height=g;l.offsetX=h;l.offsetY=k;h=1/a.width;k=1/a.height;d*=h;e*=k;f*=h;g*=k;h=l.uv[0];k=l.uv[1];n=l.uv[4];q=l.uv[5];var b=n-h,p=q-k;d=c.moveUV(m[0],m[1],[d,e,d+f,e,d+f,e+g,d,e+g]);l.uv=new Float32Array([h+d[0]*b,k+d[1]*p,n-(1-d[2])*b,k+d[3]*p,n-(1-d[4])*b,q-(1-d[5])*p,h+d[6]*b,q-(1-d[7])*p]);(d=a.scaleRate)&&1!=d?(l.sourceWidth/=d,l.sourceHeight/=d,l.width/=d,l.height/=d,l.scaleRate=d):l.scaleRate=1;return l};c.createFromTexture=function(a,d,e,f,g){var b=a.scaleRate;1!=b&&(d*=b,e*=b,f*=b,g*=b);d=K.TEMP.setTo(d-a.offsetX,e-a.offsetY,f,g);if(e=d.intersection(c._rect1.setTo(0,0,a.width,a.height),c._rect2))a=c.create(a,e.x,e.y,e.width,e.height,e.x-d.x,e.y-d.y,f,g);else return null;return a};c.DEF_UV=new Float32Array([0,0,1,0,1,1,0,1]);c.NO_UV=new Float32Array([0,0,0,0,0,0,0,0]);c.INV_UV=new Float32Array([0,1,1,1,1,0,0,0]);c._rect1=new K;c._rect2=new K;return c}(W),Na=function(a){function c(){this._url=this._data=this._responseType=null;c.__super.call(this);this._http=new r.window.XMLHttpRequest}p(c,"laya.net.HttpRequest",a);a=c.prototype;a.send=function(a,d,c,f,g){void 0===c&&(c="get");void 0===f&&(f="text");this._responseType=f;this._data=null;if(r.onQGMiniGame||r.onVVMiniGame)this._url=encodeURI(a);this._url=a;var b=this,e=this._http;a=M.getAdptedFilePath(a);e.open(c,a,!0);if(g)for(a=0;a<g.length;a++)e.setRequestHeader(g[a++],g[a]);else v.isConchApp||(d&&"string"!=typeof d?e.setRequestHeader("Content-Type","application/json"):e.setRequestHeader("Content-Type","application/x-www-form-urlencoded"));e.responseType="arraybuffer"!==f?"text":"arraybuffer";e.onerror=function(a){b._onError(a)};e.onabort=function(a){b._onAbort(a)};e.onprogress=function(a){b._onProgress(a)};e.onload=function(a){b._onLoad(a)};e.send(d)};a._onProgress=function(a){a&&a.lengthComputable&&this.event("progress",a.loaded/a.total)};a._onAbort=function(a){this.error("Request was aborted by user")};a._onError=function(a){this.error("Request failed Status:"+this._http.status+" text:"+this._http.statusText)};a._onLoad=function(a){a=this._http;var b=void 0!==a.status?a.status:200;200===b||204===b||0===b?this.complete():this.error("["+a.status+"]"+a.statusText+":"+a.responseURL)};a.error=function(a){this.clear();console.warn(this.url,a);this.event("error",a)};a.complete=function(){this.clear();var a=!0;try{this._data="json"===this._responseType?JSON.parse(this._http.responseText):"xml"===this._responseType?L.parseXMLFromString(this._http.responseText):this._http.response||this._http.responseText}catch(d){a=!1,this.error(d.message)}a&&this.event("complete",this._data instanceof Array?[this._data]:this._data)};a.clear=function(){var a=this._http;a.onerror=a.onabort=a.onprogress=a.onload=null};m(0,a,"url",function(){return this._url});m(0,a,"http",function(){return this._http});m(0,a,"data",function(){return this._data});return c}(W),H=function(a){function c(){this._type=this._url=this._data=null;this._cache=!1;this._http=null;this._customParse=this._useWorkerLoader=!1;this._propertyParams=this._constructParams=null;this._createCache=!1;c.__super.call(this)}p(c,"laya.net.Loader",a);a=c.prototype;a.load=function(a,d,e,f,g,h){void 0===e&&(e=!0);void 0===g&&(g=!1);void 0===h&&(h=!1);if(a)if(c.setGroup(a,"666"),this._url=a,0===a.indexOf("data:image")?d="image":a=M.formatURL(a),this._type=d||(d=c.getTypeFromUrl(this._url)),this._cache=e,this._useWorkerLoader=h,this._data=null,h&&Mc.enableWorkerLoader(),!g&&c.loadedMap[a])this._data=c.loadedMap[a],this.event("progress",1),this.event("complete",this._data);else if(f&&c.setGroup(a,f),null!=c.parserMap[d])this._customParse=!0,c.parserMap[d]instanceof laya.utils.Handler?c.parserMap[d].runWith(this):c.parserMap[d].call(null,this);else{if("image"===d||"htmlimage"===d||"nativeimage"===d)return this._loadImage(a);if("sound"===d)return this._loadSound(a);if("ttf"===d)return this._loadTTF(a);switch(d){case "atlas":case "prefab":case "plf":d="json";break;case "font":d="xml";break;case "plfb":d="arraybuffer"}if(c.preLoadedMap[a])this.onLoaded(c.preLoadedMap[a]);else r.onVVMiniGame?(this._http=new Na,this._http.on("progress",this,this.onProgress),this._http.on("error",this,this.onError),this._http.on("complete",this,this.onLoaded)):this._http||(this._http=new Na,this._http.on("progress",this,this.onProgress),this._http.on("error",this,this.onError),this._http.on("complete",this,this.onLoaded)),this._http.send(a,null,"get",d)}else this.onLoaded(null)};a._loadTTF=function(a){a=M.formatURL(a);var b=new Rb;b.complete=S.create(this,this.onLoaded);b.load(a)};a._loadImage=function(a){function b(){var b=f;b&&(b.onload=null,b.onerror=null,delete c._imgCache[a])}a=M.formatURL(a);var e=this,f,g=function(){b();e.event("error","Load image failed")};if("nativeimage"===this._type){var h=function(){b();e.onLoaded(f)};f=new r.window.Image;f.crossOrigin="";f.onload=h;f.onerror=g;f.src=a;c._imgCache[a]=f}else{var k=L.getFileExtension(a);if("ktx"===k||"pvr"===k){var h=function(d){var c=0;switch(k){case "ktx":c=5;break;case "pvr":c=12}f=new pa(0,0,c,!1,!1);f.wrapModeU=1;f.wrapModeV=1;f.setCompressData(d);f._setCreateURL(a);b();e.onLoaded(f)},n;n=new Na;n.on("error",null,g);n.on("complete",null,h);n.send(a,null,"get","arraybuffer")}else{var l=new r.window.Image;l.crossOrigin="";l.onload=function(){var d=new pa(l.width,l.height,1,!1,!1);d.wrapModeU=1;d.wrapModeV=1;d.loadImageSource(l,!0);d._setCreateURL(a);b();e.onLoaded(d)};l.onerror=g;l.src=a;c._imgCache[a]=l}}};a._loadSound=function(a){var b=new Q._soundClass,c=this;b.on("complete",this,function(){b.offAll();c.onLoaded(b)});b.on("error",this,function(){b.offAll();b.dispose();c.event("error","Load sound failed")});b.load(a)};a.onProgress=function(a){"atlas"===this._type?this.event("progress",.3*a):this.event("progress",a)};a.onError=function(a){this.event("error",a)};a.onLoaded=function(a){var b=this._type;if("plfb"==b)this.parsePLFBData(a),this.complete(a);else if("plf"==b)this.parsePLFData(a),this.complete(a);else if("image"===b){var e=new X(a);e.url=this._url;this.complete(e)}else if("sound"===b||"htmlimage"===b||"nativeimage"===b)this.complete(a);else if("atlas"===b)if(a.url||a._setContext){this._data.pics.push(a);if(0<this._data.toLoads.length)return this.event("progress",.3+1/this._data.toLoads.length*.6),this._loadImage(this._data.toLoads.pop());a=this._data.frames;var f=this._url.split("?")[0],f=this._data.meta&&this._data.meta.prefix?this._data.meta.prefix:f.substring(0,f.lastIndexOf("."))+"/",g=this._data.pics,b=M.formatURL(this._url),b=c.atlasMap[b]||(c.atlasMap[b]=[]);b.dir=f;var h;if(this._data.meta&&this._data.meta.scale&&1!=this._data.meta.scale)for(e in h=parseFloat(this._data.meta.scale),a){var k=a[e],n=g[k.frame.idx?k.frame.idx:0],l=M.formatURL(f+e);n.scaleRate=h;k=X._create(n,k.frame.x,k.frame.y,k.frame.w,k.frame.h,k.spriteSourceSize.x,k.spriteSourceSize.y,k.sourceSize.w,k.sourceSize.h,laya.net.Loader.getRes(l));c.cacheRes(l,k);k.url=l;b.push(l)}else for(e in a)k=a[e],n=g[k.frame.idx?k.frame.idx:0],l=M.formatURL(f+e),k=X._create(n,k.frame.x,k.frame.y,k.frame.w,k.frame.h,k.spriteSourceSize.x,k.spriteSourceSize.y,k.sourceSize.w,k.sourceSize.h,laya.net.Loader.getRes(l)),c.cacheRes(l,k),k.url=l,b.push(l);delete this._data.pics;this.complete(this._data)}else{if(!this._data){this._data=a;if(a.meta&&a.meta.image)for(f=a.meta.image.split(","),e=0<=this._url.indexOf("/")?"/":"\\",e=this._url.lastIndexOf(e),e=0<=e?this._url.substr(0,e+1):"",r.onAndroid&&a.meta.compressTextureAndroid&&(g=".ktx"),r.onIOS&&a.meta.compressTextureIOS&&(g=".pvr"),b=0,h=f.length;b<h;b++)f[b]=g?e+f[b].replace(".png",g):e+f[b];else f=[this._url.replace(".json",".png")];f.reverse();a.toLoads=f;a.pics=[]}this.event("progress",.3+1/f.length*.6);return this._loadImage(f.pop())}else if("font"===b)if(a._source)e=new Ob,e.parseFont(this._data,new X(a)),a=this._url.split(".fnt")[0].split("/"),O.registerBitmapFont(a[a.length-1],e),this._data=e,this.complete(this._data);else return this._data=a,this.event("progress",.5),this._loadImage(this._url.replace(".fnt",".png"));else"prefab"===b?(e=new Ic,e.json=a,this.complete(e)):this.complete(a)};a.parsePLFData=function(a){var b,e,f;for(b in a)switch(f=a[b],b){case "json":case "text":for(e in f)c.preLoadedMap[M.formatURL(e)]=f[e];break;default:for(e in f)c.preLoadedMap[M.formatURL(e)]=f[e]}};a.parsePLFBData=function(a){a=new wb(a);var b,c;c=a.getInt32();for(b=0;b<c;b++)this.parseOnePLFBFile(a)};a.parseOnePLFBFile=function(a){var b,e;e=a.getUTFString();b=a.getInt32();a=a.readArrayBuffer(b);c.preLoadedMap[M.formatURL(e)]=a};a.complete=function(a){this._data=a;this._customParse?this.event("loaded",a instanceof Array?[a]:a):(c._loaders.push(this),c._isWorking||c.checkNext())};a.endLoad=function(a){a&&(this._data=a);this._cache&&c.cacheRes(this._url,this._data);this.event("progress",1);this.event("complete",this.data instanceof Array?[this.data]:this.data)};m(0,a,"url",function(){return this._url});m(0,a,"data",function(){return this._data});m(0,a,"cache",function(){return this._cache});m(0,a,"type",function(){return this._type});c.getTypeFromUrl=function(a){var b=L.getFileExtension(a);if(b)return c.typeMap[b];console.warn("Not recognize the resources suffix",a);return"text"};c.checkNext=function(){c._isWorking=!0;for(var a=r.now();c._startIndex<c._loaders.length;)if(r.now(),c._loaders[c._startIndex].endLoad(),c._startIndex++,r.now()-a>c.maxTimeOut){console.warn("loader callback cost a long time:"+(r.now()-a)+" url\x3d"+c._loaders[c._startIndex-1].url);l.systemTimer.frameOnce(1,null,c.checkNext);return}c._loaders.length=0;c._startIndex=0;c._isWorking=!1};c.clearRes=function(a){a=M.formatURL(a);var b=c.getAtlas(a);if(b){for(var e=0,f=b.length;e<f;e++){var g=b[e],h=c.getRes(g);delete c.loadedMap[g];h&&h.destroy()}b.length=0;delete c.atlasMap[a];delete c.loadedMap[a]}else if(b=c.loadedMap[a])delete c.loadedMap[a],b instanceof laya.resource.Texture&&b.bitmap&&b.destroy()};c.clearTextureRes=function(a){a=M.formatURL(a);var b=laya.net.Loader.getAtlas(a);a=b&&0<b.length?laya.net.Loader.getRes(b[0]):laya.net.Loader.getRes(a);a instanceof laya.resource.Texture&&a.disposeBitmap()};c.getRes=function(a){return c.loadedMap[M.formatURL(a)]};c.getAtlas=function(a){return c.atlasMap[M.formatURL(a)]};c.cacheRes=function(a,d){a=M.formatURL(a);null!=c.loadedMap[a]?console.warn("Resources already exist,is repeated loading:",a):c.loadedMap[a]=d};c.setGroup=function(a,d){c.groupMap[d]||(c.groupMap[d]=[]);c.groupMap[d].push(a)};c.clearResByGroup=function(a){if(c.groupMap[a]){a=c.groupMap[a];var b,e=a.length;for(b=0;b<e;b++)c.clearRes(a[b]);a.length=0}};c.TEXT="text";c.JSON="json";c.PREFAB="prefab";c.XML="xml";c.BUFFER="arraybuffer";c.IMAGE="image";c.SOUND="sound";c.ATLAS="atlas";c.FONT="font";c.TTF="ttf";c.PLF="plf";c.PLFB="plfb";c.HIERARCHY="HIERARCHY";c.MESH="MESH";c.MATERIAL="MATERIAL";c.TEXTURE2D="TEXTURE2D";c.TEXTURECUBE="TEXTURECUBE";c.ANIMATIONCLIP="ANIMATIONCLIP";c.AVATAR="AVATAR";c.TERRAINHEIGHTDATA="TERRAINHEIGHTDATA";c.TERRAINRES="TERRAIN";c.typeMap={ttf:"ttf",png:"image",jpg:"image",jpeg:"image",ktx:"image",pvr:"image",txt:"text",json:"json",prefab:"prefab",xml:"xml",als:"atlas",atlas:"atlas",mp3:"sound",ogg:"sound",wav:"sound",part:"json",fnt:"font",plf:"plf",plfb:"plfb",scene:"json",ani:"json",sk:"arraybuffer"};c.parserMap={};c.maxTimeOut=100;c.groupMap={};c.loadedMap={};c.atlasMap={};c.preLoadedMap={};c._imgCache={};c._loaders=[];c._isWorking=!1;c._startIndex=0;return c}(W);(function(a){function c(a){this.strength=NaN;this.strength_sig2_2sig2_gauss1=[];this.renderFunc=this.strength_sig2_native=null;c.__super.call(this);void 0===a&&(a=4);this.strength=a;this._glRender=new kc}p(c,"laya.filters.BlurFilter",a);a=c.prototype;a.getStrenth_sig2_2sig2_native=function(){this.strength_sig2_native||(this.strength_sig2_native=new Float32Array(4));var a=this.strength/3,a=a*a;this.strength_sig2_native[0]=this.strength;this.strength_sig2_native[1]=a;this.strength_sig2_native[2]=2*a;this.strength_sig2_native[3]=1/(2*Math.PI*a);return this.strength_sig2_native};m(0,a,"type",function(){return 16});return c})(Ja);var ab=function(a){function c(){this._maxsize=0;this._upload=!0;this._bufferSize=this._uploadSize=0;this._u8Array=null;c.__super.call(this)}p(c,"laya.webgl.utils.Buffer2D",a);a=c.prototype;a.setByteLength=function(a){this._byteLength!==a&&(a<=this._bufferSize||this._resizeBuffer(2*a+256,!0),this._byteLength=a)};a.needSize=function(a){var b=this._byteLength;a&&(a=this._byteLength+a,a<=this._bufferSize||this._resizeBuffer(a<<1,!0),this._byteLength=a);return b};a._bufferData=function(){this._maxsize=Math.max(this._maxsize,this._byteLength);0==J.loopCount%30&&(this._buffer.byteLength>this._maxsize+64&&(this._buffer=this._buffer.slice(0,this._maxsize+64),this._bufferSize=this._buffer.byteLength,this._checkArrayUse()),this._maxsize=this._byteLength);this._uploadSize<this._buffer.byteLength&&(this._uploadSize=this._buffer.byteLength,y.instance.bufferData(this._bufferType,this._uploadSize,this._bufferUsage));y.instance.bufferSubData(this._bufferType,0,new Uint8Array(this._buffer,0,this._byteLength))};a._bufferSubData=function(a,d,c){void 0===a&&(a=0);void 0===d&&(d=0);void 0===c&&(c=0);this._maxsize=Math.max(this._maxsize,this._byteLength);0==J.loopCount%30&&(this._buffer.byteLength>this._maxsize+64&&(this._buffer=this._buffer.slice(0,this._maxsize+64),this._bufferSize=this._buffer.byteLength,this._checkArrayUse()),this._maxsize=this._byteLength);this._uploadSize<this._buffer.byteLength&&(this._uploadSize=this._buffer.byteLength,y.instance.bufferData(this._bufferType,this._uploadSize,this._bufferUsage));d||c?(d=this._buffer.slice(d,c),y.instance.bufferSubData(this._bufferType,a,d)):y.instance.bufferSubData(this._bufferType,a,this._buffer)};a._checkArrayUse=function(){};a._bind_uploadForVAO=function(){if(!this._upload)return!1;this._upload=!1;this._bindForVAO();this._bufferData();return!0};a._bind_upload=function(){if(!this._upload)return!1;this._upload=!1;this.bind();this._bufferData();return!0};a._bind_subUpload=function(a,d,c){void 0===a&&(a=0);void 0===d&&(d=0);void 0===c&&(c=0);if(!this._upload)return!1;this._upload=!1;this.bind();this._bufferSubData(a,d,c);return!0};a._resizeBuffer=function(a,d){var b=this._buffer;if(a<=b.byteLength)return this;var c=this._u8Array;if(d&&b&&0<b.byteLength){var g=new ArrayBuffer(a),b=c&&c.buffer==b?c:new Uint8Array(b),c=this._u8Array=new Uint8Array(g);c.set(b,0);b=this._buffer=g}else b=this._buffer=new ArrayBuffer(a),this._u8Array=null;this._checkArrayUse();this._upload=!0;this._bufferSize=b.byteLength;return this};a.append=function(a){this._upload=!0;var b,c;b=a.byteLength;a instanceof Uint8Array?(this._resizeBuffer(this._byteLength+b,!0),c=new Uint8Array(this._buffer,this._byteLength)):a instanceof Uint16Array?(this._resizeBuffer(this._byteLength+b,!0),c=new Uint16Array(this._buffer,this._byteLength)):a instanceof Float32Array&&(this._resizeBuffer(this._byteLength+b,!0),c=new Float32Array(this._buffer,this._byteLength));c.set(a,0);this._byteLength+=b;this._checkArrayUse()};a.appendU16Array=function(a,d){this._resizeBuffer(this._byteLength+2*d,!0);var b=new Uint16Array(this._buffer,this._byteLength,d);if(6==d)b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b[4]=a[4],b[5]=a[5];else if(100<=d)b.set(new Uint16Array(a.buffer,0,d));else for(var c=0;c<d;c++)b[c]=a[c];this._byteLength+=2*d;this._checkArrayUse()};a.appendEx=function(a,d){this._upload=!0;var b;b=a.byteLength;this._resizeBuffer(this._byteLength+b,!0);(new d(this._buffer,this._byteLength)).set(a,0);this._byteLength+=b;this._checkArrayUse()};a.appendEx2=function(a,d,c,f){void 0===f&&(f=1);this._upload=!0;f*=c;this._resizeBuffer(this._byteLength+f,!0);d=new d(this._buffer,this._byteLength);var b;for(b=0;b<c;b++)d[b]=a[b];this._byteLength+=f;this._checkArrayUse()};a.getBuffer=function(){return this._buffer};a.setNeedUpload=function(){this._upload=!0};a.getNeedUpload=function(){return this._upload};a.upload=function(){var a=this._bind_upload();y.instance.bindBuffer(this._bufferType,null);34962==this._bufferType&&(fa._bindedVertexBuffer=null);34963==this._bufferType&&(fa._bindedIndexBuffer=null);aa.activeShader=null;return a};a.subUpload=function(a,d,c){a=this._bind_subUpload();y.instance.bindBuffer(this._bufferType,null);34962==this._bufferType&&(fa._bindedVertexBuffer=null);34963==this._bufferType&&(fa._bindedIndexBuffer=null);aa.activeShader=null;return a};a._disposeResource=function(){this._upload=!0;this._uploadSize=0};a.clear=function(){this._byteLength=0;this._upload=!0};m(0,a,"bufferLength",function(){return this._buffer.byteLength});m(0,a,"byteLength",null,function(a){this.setByteLength(a)});c.__int__=function(a){};c.FLOAT32=4;c.SHORT=2;return c}(fa),ma=function(a){function c(){this.url=null;this.loaded=!1;this.__toPlays=this.audioBuffer=this.data=null;this._disposed=!1;c.__super.call(this)}p(c,"laya.media.webaudio.WebAudioSound",a);a=c.prototype;a.load=function(a){var b=this;this.url=a=M.formatURL(a);if(this.audioBuffer=c._dataCache[a])this._loaded(this.audioBuffer);else if(c.e.on("loaded:"+a,this,this._loaded),c.e.on("err:"+a,this,this._err),!c.__loadingSound[a]){c.__loadingSound[a]=!0;var e=new r.window.XMLHttpRequest;e.open("GET",a,!0);e.responseType="arraybuffer";e.onload=function(){b._disposed?b._removeLoadEvents():(b.data=e.response,c.buffs.push({buffer:b.data,url:b.url}),c.decode())};e.onerror=function(a){b._err()};e.send()}};a._err=function(){this._removeLoadEvents();c.__loadingSound[this.url]=!1;this.event("error")};a._loaded=function(a){this._removeLoadEvents();this._disposed||(this.audioBuffer=a,c._dataCache[this.url]=this.audioBuffer,this.loaded=!0,this.event("complete"))};a._removeLoadEvents=function(){c.e.off("loaded:"+this.url,this,this._loaded);c.e.off("err:"+this.url,this,this._err)};a.__playAfterLoaded=function(){if(this.__toPlays){var a,d,c;c=this.__toPlays;d=c.length;var f;for(a=0;a<d;a++)f=c[a],f[2]&&!f[2].isStopped&&this.play(f[0],f[1],f[2]);this.__toPlays.length=0}};a.play=function(a,d,c){void 0===a&&(a=0);void 0===d&&(d=0);c=c?c:new Nc;!this.audioBuffer&&this.url&&(this.__toPlays||(this.__toPlays=[]),this.__toPlays.push([a,d,c]),this.once("complete",this,this.__playAfterLoaded),this.load(this.url));c.url=this.url;c.loops=d;c.audioBuffer=this.audioBuffer;c.startTime=a;c.play();Q.addChannel(c);return c};a.dispose=function(){this._disposed=!0;delete c._dataCache[this.url];delete c.__loadingSound[this.url];this.data=this.audioBuffer=null;this.__toPlays=[]};m(0,a,"duration",function(){return this.audioBuffer?this.audioBuffer.duration:0});c.decode=function(){0>=c.buffs.length||c.isDecoding||(c.isDecoding=!0,c.tInfo=c.buffs.shift(),c.ctx.decodeAudioData(c.tInfo.buffer,c._done,c._fail))};c._done=function(a){c.e.event("loaded:"+c.tInfo.url,a);c.isDecoding=!1;c.decode()};c._fail=function(){c.e.event("err:"+c.tInfo.url,null);c.isDecoding=!1;c.decode()};c._playEmptySound=function(){if(null!=c.ctx){var a=c.ctx.createBufferSource();a.buffer=c._miniBuffer;a.connect(c.ctx.destination);a.start(0,0,0)}};c._unlock=function(){c._unlocked||(c._playEmptySound(),"running"==c.ctx.state&&(r.document.removeEventListener("mousedown",c._unlock,!0),r.document.removeEventListener("touchend",c._unlock,!0),r.document.removeEventListener("touchstart",c._unlock,!0),c._unlocked=!0))};c.initWebAudio=function(){"running"!=c.ctx.state&&(c._unlock(),r.document.addEventListener("mousedown",c._unlock,!0),r.document.addEventListener("touchend",c._unlock,!0),r.document.addEventListener("touchstart",c._unlock,!0))};c._dataCache={};c.buffs=[];c.isDecoding=!1;c._unlocked=!1;c.tInfo=null;c.__loadingSound={};t(c,["window",function(){return this.window=r.window},"webAudioEnabled",function(){return this.webAudioEnabled=c.window.AudioContext||c.window.webkitAudioContext||c.window.mozAudioContext},"ctx",function(){return this.ctx=c.webAudioEnabled?new (c.window.AudioContext||c.window.webkitAudioContext||c.window.mozAudioContext):void 0},"_miniBuffer",function(){return this._miniBuffer=c.ctx.createBuffer(1,1,22050)},"e",function(){return this.e=new W}]);return c}(W),la=function(a){function c(){c.__super.call(this,24,4,4);this.canReuse=!0;this.setAttributes(laya.webgl.utils.MeshQuadTexture._fixattriInfo);laya.webgl.utils.MeshQuadTexture._fixib?(this._ib=laya.webgl.utils.MeshQuadTexture._fixib,this._quadNum=c._maxIB):(this.createQuadIB(c._maxIB),laya.webgl.utils.MeshQuadTexture._fixib=this._ib)}p(c,"laya.webgl.utils.MeshQuadTexture",a);a=c.prototype;a.releaseMesh=function(){this._vb.setByteLength(0);this.indexNum=this.vertNum=0;laya.webgl.utils.MeshQuadTexture._POOL.push(this)};a.destroy=function(){this._vb.destroy();this._vb.deleteBuffer()};a.addQuad=function(a,d,c,f){var b=this._vb,e=b._byteLength>>2;b.setByteLength(e+24<<2);var k=b._floatArray32||b.getFloat32Array(),n=b._uint32Array;f=f?255:0;k[e++]=a[0];k[e++]=a[1];k[e++]=d[0];k[e++]=d[1];n[e++]=c;n[e++]=f;k[e++]=a[2];k[e++]=a[3];k[e++]=d[2];k[e++]=d[3];n[e++]=c;n[e++]=f;k[e++]=a[4];k[e++]=a[5];k[e++]=d[4];k[e++]=d[5];n[e++]=c;n[e++]=f;k[e++]=a[6];k[e++]=a[7];k[e++]=d[6];k[e++]=d[7];n[e++]=c;n[e++]=f;b._upload=!0};c.getAMesh=function(a){var b;b=laya.webgl.utils.MeshQuadTexture._POOL.length?laya.webgl.utils.MeshQuadTexture._POOL.pop():new c;a&&b._vb._resizeBuffer(1572864,!1);return b};c.const_stride=24;c._fixib=null;c._maxIB=16384;c._POOL=[];t(c,["_fixattriInfo",function(){return this._fixattriInfo=[5126,4,0,5121,4,16,5121,4,20]}]);return c}(Ka);(function(a){function c(a,d,e,f){this._sv_blurInfo2=[0,0,1,0];this._blurInof2_native=this._blurInof1_native=this._color_native=this._color=null;c.__super.call(this);this._elements=new Float32Array(9);this._sv_blurInfo1=Array(4);void 0===d&&(d=4);void 0===e&&(e=6);void 0===f&&(f=6);this._color=new x(a);this.blur=Math.min(d,20);this.offX=e;this.offY=f;this._sv_blurInfo1[0]=this._sv_blurInfo1[1]=this.blur;this._sv_blurInfo1[2]=e;this._sv_blurInfo1[3]=-f;this._glRender=new Hc}p(c,"laya.filters.GlowFilter",a);a=c.prototype;a.getColor=function(){return this._color.arrColor};a.getColorNative=function(){this._color_native||(this._color_native=new Float32Array(4));var a=this.getColor();this._color_native[0]=a[0];this._color_native[1]=a[1];this._color_native[2]=a[2];this._color_native[3]=a[3];return this._color_native};a.getBlurInfo1Native=function(){this._blurInof1_native||(this._blurInof1_native=new Float32Array(4));this._blurInof1_native[0]=this._blurInof1_native[1]=this.blur;this._blurInof1_native[2]=this.offX;this._blurInof1_native[3]=this.offY;return this._blurInof1_native};a.getBlurInfo2Native=function(){this._blurInof2_native||(this._blurInof2_native=new Float32Array(4));this._blurInof2_native[2]=1;return this._blurInof2_native};m(0,a,"type",function(){return 8});m(0,a,"offY",function(){return this._elements[6]},function(a){this._elements[6]=a;this._sv_blurInfo1[3]=-a});m(0,a,"offX",function(){return this._elements[5]},function(a){this._elements[5]=a;this._sv_blurInfo1[2]=a});m(0,a,"blur",function(){return this._elements[4]},function(a){this._elements[4]=a;this._sv_blurInfo1[0]=this._sv_blurInfo1[1]=a});return c})(Ja);(function(a){function c(a,d,e,f){this._socket=this._endian=null;this._connected=!1;this._addInputPosition=0;this._output=this._input=null;this.disableInput=!1;this._byteClass=null;this.protocols=[];c.__super.call(this);void 0===d&&(d=0);this._byteClass=e?e:wb;this.protocols=f;this.endian="bigEndian";a&&0<d&&65535>d&&this.connect(a,d)}p(c,"laya.net.Socket",a);a=c.prototype;a.connect=function(a,d){this.connectByUrl("ws://"+a+":"+d)};a.connectByUrl=function(a){var b=this;null!=this._socket&&this.close();this._socket&&this.cleanSocket();this._socket=this.protocols&&0!=this.protocols.length?new r.window.WebSocket(a,this.protocols):new r.window.WebSocket(a);this._socket.binaryType="arraybuffer";this._output=new this._byteClass;this._output.endian=this.endian;this._input=new this._byteClass;this._input.endian=this.endian;this._addInputPosition=0;this._socket.onopen=function(a){b._onOpen(a)};this._socket.onmessage=function(a){b._onMessage(a)};this._socket.onclose=function(a){b._onClose(a)};this._socket.onerror=function(a){b._onError(a)}};a.cleanSocket=function(){this.close();this._connected=!1;this._socket.onopen=null;this._socket.onmessage=null;this._socket.onclose=null;this._socket=this._socket.onerror=null};a.close=function(){if(null!=this._socket)try{this._socket.close()}catch(b){}};a._onOpen=function(a){this._connected=!0;this.event("open",a)};a._onMessage=function(a){if(a&&a.data){a=a.data;if(!this.disableInput||!a){0<this._input.length&&1>this._input.bytesAvailable&&(this._input.clear(),this._addInputPosition=0);var b=this._input.pos;!this._addInputPosition&&(this._addInputPosition=0);this._input.pos=this._addInputPosition;a&&("string"==typeof a?this._input.writeUTFBytes(a):this._input.writeArrayBuffer(a),this._addInputPosition=this._input.pos,this._input.pos=b)}this.event("message",a)}};a._onClose=function(a){this._connected=!1;this.event("close",a)};a._onError=function(a){this.event("error",a)};a.send=function(a){this._socket.send(a)};a.flush=function(){if(this._output&&0<this._output.length){var a;try{this._socket&&this._socket.send(this._output.__getBuffer().slice(0,this._output.length))}catch(d){a=d}this._output.endian=this.endian;this._output.clear();a&&this.event("error",a)}};m(0,a,"input",function(){return this._input});m(0,a,"output",function(){return this._output});m(0,a,"connected",function(){return this._connected});m(0,a,"endian",function(){return this._endian},function(a){this._endian=a;null!=this._input&&(this._input.endian=a);null!=this._output&&(this._output.endian=a)});c.LITTLE_ENDIAN="littleEndian";c.BIG_ENDIAN="bigEndian";return c})(W);var mb=function(a){function c(a){this.u_colorMatrix=null;this.strength=0;this.colorAlpha=this.colorMat=this.blurInfo=null;void 0===a&&(a=0);c.__super.call(this,1,a);this._attribLocation=["posuv",0,"attribColor",1,"attribFlags",2]}p(c,"laya.webgl.shader.d2.value.TextureSV",a);c.prototype.clear=function(){this.shader=this.texture=null;this.defines._value=this.subID+(E.shaderHighPrecision?1024:0)};return c}(U);(function(a){function c(){c.__super.call(this)}p(c,"laya.components.CommonScript",a);a=c.prototype;a.onAwake=function(){};a.onEnable=function(){};a.onStart=function(){};a.onUpdate=function(){};a.onLateUpdate=function(){};a.onDisable=function(){};a.onDestroy=function(){};m(0,a,"isSingleton",function(){return!1});return c})(fb);var Ra=function(a){function c(){this.retryNum=1;this.retryDelay=0;this.maxLoader=5;this._loaders=[];this._loaderCount=0;this._resInfos=[];this._infoPool=[];this._maxPriority=5;this._failRes={};this._statInfo={count:1,loaded:1};c.__super.call(this);for(var a=0;a<this._maxPriority;a++)this._resInfos[a]=[]}var b;p(c,"laya.net.LoaderManager",a);a=c.prototype;a.getProgress=function(){return this._statInfo.loaded/this._statInfo.count};a.resetProgress=function(){this._statInfo.count=this._statInfo.loaded=1};a.create=function(a,b,c,g,h,k,n,l){void 0===n&&(n=1);void 0===l&&(l=!0);this._create(a,!0,b,c,g,h,k,n,l)};a._create=function(a,b,c,g,h,k,n,l,m){void 0===l&&(l=1);void 0===m&&(m=!0);if(a instanceof Array){var d=function(a,b){a.progress=b;for(var d=0,c=0;c<p;c++)d+=q[c].progress;r.runWith(d/p)},e=function(a,b){u++;a.progress=1;b||(f=!1);u===p&&c&&c.runWith(f)},f=!0,q=a,p=q.length,u=0;if(g)var r=S.create(g.caller,g.method,g.args,!1);for(a=0;a<p;a++){var t=q[a];"string"==typeof t&&(t=q[a]={url:t});t.progress=0}for(a=0;a<p;a++){var t=q[a],v=g?S.create(null,d,[t],!1):null,w=g||c?S.create(null,e,[t]):null;this._createOne(t.url,b,w,v,t.type||h,t.constructParams||k,t.propertyParams||n,t.priority||l,m)}}else this._createOne(a,b,c,g,h,k,n,l,m)};a._createOne=function(a,b,f,g,h,k,n,m,p){void 0===m&&(m=1);void 0===p&&(p=!0);var d=this.getRes(a);d?(!b&&d instanceof laya.resource.Resource&&d._addReference(),g&&g.runWith(1),f&&f.runWith(d)):(d=L.getFileExtension(a),h||(h=c.createMap[d]?c.createMap[d][0]:null),h?H.parserMap[h]?this._createLoad(a,S.create(null,function(d){d&&(!b&&d instanceof laya.resource.Resource&&d._addReference(),d._setCreateURL(a));f&&f.runWith(d);l.loader.event(a)}),g,h,k,n,m,p,!0):this.load(a,f,g,h,m,p):this.load(a,f,g,h,m,p))};a.load=function(a,e,f,g,h,k,n,m,p){var d=this;void 0===h&&(h=1);void 0===k&&(k=!0);void 0===m&&(m=!1);void 0===p&&(p=!1);if(a instanceof Array)return this._loadAssets(a,e,f,g,h,k,n);var q=H.getRes(a);if(m||null==q){var u;u=a;a=yb.getFileLoadPath(a);a!=u&&"nativeimage"!==g?g="atlas":u=null;var r=c._resMap[a];r?(e&&(u?e&&r._createListener("complete",this,this._resInfoLoaded,[u,e],!1,!1):e&&r._createListener("complete",e.caller,e.method,e.args,!1,!1)),f&&r._createListener("progress",f.caller,f.method,f.args,!1,!1)):(r=this._infoPool.length?this._infoPool.pop():new b,r.url=a,r.type=g,r.cache=k,r.group=n,r.ignoreCache=m,r.useWorkerLoader=p,r.originalUrl=u,e&&r.on("complete",e.caller,e.method,e.args),f&&r.on("progress",f.caller,f.method,f.args),c._resMap[a]=r,h=h<this._maxPriority?h:this._maxPriority-1,this._resInfos[h].push(r),this._statInfo.count++,this.event("progress",this.getProgress()),this._next())}else l.systemTimer.frameOnce(1,null,function(){f&&f.runWith(1);e&&e.runWith(q instanceof Array?[q]:q);d._loaderCount||d.event("complete")});return this};a._resInfoLoaded=function(a,b){b.runWith(H.getRes(a))};a._createLoad=function(a,e,f,g,h,k,n,m,p){var d=this;void 0===n&&(n=1);void 0===m&&(m=!0);void 0===p&&(p=!1);if(a instanceof Array)return this._loadAssets(a,e,f,g,n,m);var q=H.getRes(a);if(null!=q)l.systemTimer.frameOnce(1,null,function(){f&&f.runWith(1);e&&e.runWith(q);d._loaderCount||d.event("complete")});else{var r=c._resMap[a];r?(e&&r._createListener("complete",e.caller,e.method,e.args,!1,!1),f&&r._createListener("progress",f.caller,f.method,f.args,!1,!1)):(r=this._infoPool.length?this._infoPool.pop():new b,r.url=a,r.type=g,r.cache=!1,r.ignoreCache=p,r.originalUrl=null,r.createCache=m,r.createConstructParams=h,r.createPropertyParams=k,e&&r.on("complete",e.caller,e.method,e.args),f&&r.on("progress",f.caller,f.method,f.args),c._resMap[a]=r,n=n<this._maxPriority?n:this._maxPriority-1,this._resInfos[n].push(r),this._statInfo.count++,this.event("progress",this.getProgress()),this._next())}return this};a._next=function(){if(!(this._loaderCount>=this.maxLoader)){for(var a=0;a<this._maxPriority;a++)for(var b=this._resInfos[a];0<b.length;){var c=b.shift();if(c)return this._doLoad(c)}this._loaderCount||this.event("complete")}};a._doLoad=function(a){function b(b){d.offAll();d._data=null;d._customParse=!1;c._loaders.push(d);c._endLoad(a,b instanceof Array?[b]:b);c._loaderCount--;c._next()}this._loaderCount++;var d=this._loaders.length?this._loaders.pop():new H;d.on("complete",null,b);d.on("progress",null,function(b){a.event("progress",b)});d.on("error",null,function(a){b(null)});var c=this;d._constructParams=a.createConstructParams;d._propertyParams=a.createPropertyParams;d._createCache=a.createCache;d.load(a.url,a.type,a.cache,a.group,a.ignoreCache,a.useWorkerLoader)};a._endLoad=function(a,b){var d=a.url;if(null==b){var e=this._failRes[d]||0;if(e<this.retryNum){console.warn("[warn]Retry to load:",d);this._failRes[d]=e+1;l.systemTimer.once(this.retryDelay,this,this._addReTry,[a],!1);return}H.clearRes(d);console.warn("[error]Failed to load:",d);this.event("error",d)}this._failRes[d]&&(this._failRes[d]=0);delete c._resMap[d];a.originalUrl&&(b=H.getRes(a.originalUrl));a.event("complete",b);a.offAll();this._infoPool.push(a);this._statInfo.loaded++;this.event("progress",this.getProgress())};a._addReTry=function(a){this._resInfos[this._maxPriority-1].push(a);this._next()};a.clearRes=function(a){H.clearRes(a)};a.clearTextureRes=function(a){H.clearTextureRes(a)};a.getRes=function(a){return H.getRes(a)};a.cacheRes=function(a,b){H.cacheRes(a,b)};a.setGroup=function(a,b){H.setGroup(a,b)};a.clearResByGroup=function(a){H.clearResByGroup(a)};a.clearUnLoaded=function(){for(var a=0;a<this._maxPriority;a++){for(var b=this._resInfos[a],f=b.length-1;-1<f;f--){var g=b[f];g&&(g.offAll(),this._infoPool.push(g))}b.length=0}this._loaderCount=0;c._resMap={}};a.cancelLoadByUrls=function(a){if(a)for(var b=0,d=a.length;b<d;b++)this.cancelLoadByUrl(a[b])};a.cancelLoadByUrl=function(a){for(var b=0;b<this._maxPriority;b++)for(var d=this._resInfos[b],g=d.length-1;-1<g;g--){var h=d[g];h&&h.url===a&&(d[g]=null,h.offAll(),this._infoPool.push(h))}c._resMap[a]&&delete c._resMap[a]};a._loadAssets=function(a,b,c,g,h,k,n){function d(a,d){l++;a.progress=1;d||(r=!1);l===f&&b&&b.runWith(r)}function e(a,b){if(null!=c){a.progress=b;for(var d=0,e=0;e<p.length;e++)var f=p[e],d=d+f.size*f.progress;c.runWith(d/m)}}void 0===h&&(h=1);void 0===k&&(k=!0);for(var f=a.length,l=0,m=0,p=[],r=!0,t=0;t<f;t++){var v=a[t];"string"==typeof v&&(v={url:v,type:g,size:1,priority:h});v.size||(v.size=1);v.progress=0;m+=v.size;p.push(v);var w=c?S.create(null,e,[v],!1):null,x=b||c?S.create(null,d,[v]):null;this.load(v.url,x,w,v.type,v.priority||1,k,v.group||n,!1,v.useWorkerLoader)}return this};a.decodeBitmaps=function(a){var b,d=a.length,c;c=v._context;for(b=0;b<d;b++){var h;(h=H.getAtlas(a[b]))?this._decodeTexture(h[0],c):(h=this.getRes(a[b]))&&h instanceof laya.resource.Texture&&this._decodeTexture(h,c)}};a._decodeTexture=function(a,b){var d=a.bitmap;a&&d&&(d=d.source||d.image)&&l.__typeof(d,r.window.HTMLImageElement)&&(b.drawImage(d,0,0,1,1),b.getImageData(0,0,1,1))};c.cacheRes=function(a,b){H.cacheRes(a,b)};c._resMap={};t(c,["createMap",function(){return this.createMap={atlas:[null,"atlas"]}}]);c.__init$=function(){b=function(a){function b(){this.type=this.url=null;this.cache=!1;this.group=null;this.useWorkerLoader=this.ignoreCache=!1;this.originalUrl=null;this.createCache=!1;this.createPropertyParams=this.createConstructParams=null;b.__super.call(this)}p(b,"",a);return b}(W)};return c}(W),Pa=function(a){function c(){c.__super.call(this,24,4,4);this.canReuse=!0;this.setAttributes(laya.webgl.utils.MeshTexture._fixattriInfo)}p(c,"laya.webgl.utils.MeshTexture",a);a=c.prototype;a.addData=function(a,d,c,f,g){var b=this._vb,e=this._ib,n=a.length>>1,l=b.needSize(24*n)>>2,m=b._floatArray32||b.getFloat32Array(),p=b._uint32Array,r=0,t=f.a,v=f.b,w=f.c,x=f.d,y=f.tx,z=f.ty;for(f=0;f<n;f++){var D=a[r],A=a[r+1];m[l]=D*t+A*w+y;m[l+1]=D*v+A*x+z;m[l+2]=d[r];m[l+3]=d[r+1];p[l+4]=g;p[l+5]=255;l+=6;r+=2}b.setNeedUpload();a=this.vertNum;g=c.length;f=e.needSize(c.byteLength);d=e.getUint16Array();f>>=1;if(0<a)for(g=f+g,b=0;f<g;f++,b++)d[f]=c[b]+a;else d.set(c,f);e.setNeedUpload();this.vertNum+=n;this.indexNum+=c.length};a.releaseMesh=function(){this._vb.setByteLength(0);this._ib.setByteLength(0);this.indexNum=this.vertNum=0;laya.webgl.utils.MeshTexture._POOL.push(this)};a.destroy=function(){this._ib.destroy();this._vb.destroy();this._ib.disposeResource();this._vb.deleteBuffer()};c.getAMesh=function(a){var b;b=laya.webgl.utils.MeshTexture._POOL.length?laya.webgl.utils.MeshTexture._POOL.pop():new c;a&&b._vb._resizeBuffer(1572864,!1);return b};c.const_stride=24;c._POOL=[];t(c,["_fixattriInfo",function(){return this._fixattriInfo=[5126,4,0,5121,4,16,5121,4,20]}]);return c}(Ka),Ab=function(a){function c(){this.totalCount=0;this._toLoadList=this._completeHandler=null;this._isLoading=!1;this._curUrl=null;c.__super.call(this);this._completeHandler=new S(this,this.onOneLoadComplete);this.reset()}p(c,"laya.net.SceneLoader",a);a=c.prototype;a.reset=function(){this._toLoadList=[];this._isLoading=!1;this.totalCount=0};a.load=function(a,d,c){void 0===d&&(d=!1);void 0===c&&(c=!0);if(a instanceof Array){var b,e;e=a.length;for(b=0;b<e;b++)this._addToLoadList(a[b],d)}else this._addToLoadList(a,d);c&&this._checkNext()};a._addToLoadList=function(a,d){void 0===d&&(d=!1);0<=this._toLoadList.indexOf(a)||H.getRes(a)||(d?this._toLoadList.push({url:a}):this._toLoadList.push(a),this.totalCount++)};a._checkNext=function(){if(!this._isLoading)if(0==this._toLoadList.length)this.event("complete");else{var a;a=this._toLoadList.pop();"string"==typeof a?this.loadOne(a):this.loadOne(a.url,!0)}};a.loadOne=function(a,d){void 0===d&&(d=!1);this._curUrl=a;var b=L.getFileExtension(this._curUrl);d?l.loader.create(a,this._completeHandler):c.LoadableExtensions[b]?l.loader.load(a,this._completeHandler,null,c.LoadableExtensions[b]):a!=yb.getFileLoadPath(a)||c.No3dLoadTypes[b]||!Ra.createMap[b]?l.loader.load(a,this._completeHandler):l.loader.create(a,this._completeHandler)};a.onOneLoadComplete=function(){this._isLoading=!1;H.getRes(this._curUrl)||console.log("Fail to load:",this._curUrl);var a=L.getFileExtension(this._curUrl);if(c.LoadableExtensions[a]){var d;(d=H.getRes(this._curUrl))&&d instanceof laya.components.Prefab&&(d=d.json);d&&(d.loadList&&this.load(d.loadList,!1,!1),d.loadList3D&&this.load(d.loadList3D,!0,!1))}"sk"==a&&this.load(this._curUrl.replace(".sk",".png"),!1,!1);this.event("progress",this.getProgress());this._checkNext()};a.getProgress=function(){return this.loadedCount/this.totalCount};m(0,a,"loadedCount",function(){return this.totalCount-this.leftCount});m(0,a,"leftCount",function(){return this._isLoading?this._toLoadList.length+1:this._toLoadList.length});t(c,["LoadableExtensions",function(){return this.LoadableExtensions={scene:"json",scene3d:"json",ani:"json",ui:"json",prefab:"prefab"}},"No3dLoadTypes",function(){return this.No3dLoadTypes={png:!0,jpg:!0,txt:!0}}]);return c}(W),Fa=function(a){function c(){this.italic=!1;c.__super.call(this)}p(c,"laya.display.css.TextStyle",a);var b=c.prototype;b.reset=function(){a.prototype.reset.call(this);this.italic=!1;this.align="left";this.wordWrap=!1;this.leading=0;this.padding=[0,0,0,0];this.borderColor=this.bgColor=null;this.asPassword=!1;this.stroke=0;this.strokeColor="#000000";this.underline=this.bold=!1;this.currBitmapFont=this.underlineColor=null;return this};b.recover=function(){this!==c.EMPTY&&w.recover("TextStyle",this.reset())};b.render=function(a,b,c,g){(this.bgColor||this.borderColor)&&b.drawRect(c,g,a.width,a.height,this.bgColor,this.borderColor,1)};c.create=function(){return w.getItemByClass("TextStyle",c)};c.EMPTY=new c;return c}(Oa),Mc=function(a){function c(){this.worker=null;this._useWorkerLoader=!1;c.__super.call(this);var a=this;this.worker=new Worker(c.workerPath);this.worker.onmessage=function(b){a.workerMessage(b.data)}}p(c,"laya.net.WorkerLoader",a);a=c.prototype;a.workerMessage=function(a){if(a)switch(a.type){case "Image":this.imageLoaded(a);break;case "Disable":c.enable=!1}};a.imageLoaded=function(a){if(a.dataType&&"imageBitmap"==a.dataType){var b=new ea(!0),c=b.source.getContext("2d");switch(a.dataType){case "imageBitmap":var f=a.imageBitmap;b.size(f.width,f.height);c.drawImage(f,0,0)}console.log("load:",a.url);b._setGPUMemory(0);c=new pa;c.loadImageSource(b.source);this.event(a.url,c)}else this.event(a.url,null)};a.loadImage=function(a){this.worker.postMessage(a)};a._loadImage=function(a){var b=this;if(this._useWorkerLoader&&c._enable){a=M.formatURL(a);var e=function(d){laya.net.WorkerLoader.I.off(a,b,e);if(d)b.onLoaded(d);else c._preLoadFun.call(b,a)};laya.net.WorkerLoader.I.on(a,b,e);laya.net.WorkerLoader.I.loadImage(a)}else c._preLoadFun.call(b,a)};m(1,c,"enable",function(){return c._enable},function(a){c._enable!=a&&(c._enable=a)&&null==c._preLoadFun&&(c._enable=c.__init__())});c.__init__=function(){if(null!=c._preLoadFun||!Worker)return!1;c._preLoadFun=H.prototype._loadImage;H.prototype._loadImage=c.prototype._loadImage;c.I||(c.I=new c);return!0};c.workerSupported=function(){return Worker?!0:!1};c.enableWorkerLoader=function(){c._tryEnabled||(c.enable=!0,c._tryEnabled=!0)};c.I=null;c.workerPath="libs/workerloader.js";c._preLoadFun=null;c._enable=!1;c._tryEnabled=!1;return c}(W),Jb=function(a){function c(){c.__super.call(this)}p(c,"laya.webgl.BufferState2D",a);return c}(mc),Vb=function(a){function c(a){c.__super.call(this,4,0);this._attribLocation=["position",0,"attribColor",1]}p(c,"laya.webgl.shader.d2.value.PrimitiveSV",a);return c}(U),Wb=function(a){function c(a){this.position=this.texcoord=null;this.offsetX=300;this.offsetY=0;c.__super.call(this,512,0);a=8*ja.BYTES_PE;this.position=[2,5126,!1,a,0];this.texcoord=[2,5126,!1,a,2*ja.BYTES_PE];this.color=[4,5126,!1,a,4*ja.BYTES_PE]}p(c,"laya.webgl.shader.d2.skinAnishader.SkinSV",a);return c}(U),Lb=function(a){function c(a,d,e,f,g){this.ctx=null;this.lastScaleY=this.lastScaleX=1;this.needResetScale=!1;this.maxTexH=this.maxTexW=0;this.scaleFontSize=!0;this.showDbgInfo=!1;this.supportImageData=!0;this.settrans=null;c.__super.call(this);void 0===e&&(e=!0);void 0===f&&(f=!0);void 0===g&&(g=!1);this.maxTexW=a;this.maxTexH=d;this.scaleFontSize=e;this.supportImageData=f;this.showDbgInfo=g;c.canvas||(c.canvas=G.document.createElement("canvas"),c.canvas.width=1024,c.canvas.height=512,c.canvas.style.left="-10000px",c.canvas.style.position="absolute",Ga.body.appendChild(c.canvas),this.ctx=c.canvas.getContext("2d"),this.settrans=this.ctx._setTransform||this.ctx.setTransform)}p(c,"laya.webgl.text.CharRender_Canvas",a);a=c.prototype;a.getWidth=function(a,d){if(!this.ctx)return 0;this.ctx._lastFont!=a&&(this.ctx.font=a,this.ctx._lastFont=a);return this.ctx.measureText(d).width};a.scale=function(a,d){if(!this.supportImageData)this.lastScaleX=a,this.lastScaleY=d;else if(this.lastScaleX!=a||this.lastScaleY!=d)this.settrans.call(this.ctx,a,0,0,d,0,0),this.lastScaleX=a,this.lastScaleY=d};a.getCharBmp=function(a,d,c,f,g,h,k,n,l,m,p){if(!this.supportImageData)return this.getCharCanvas(a,d,c,f,g,h,k,n,l,m);var b=this.ctx;b.font!=d&&(b.font=d,b._lastFont=d);h.width=b.measureText(a).width;d=h.width*this.lastScaleX;var e=h.height*this.lastScaleY;d+=(k+l)*this.lastScaleX;e+=(n+m)*this.lastScaleY;d=Math.ceil(d);e=Math.ceil(e);d=Math.min(d,laya.webgl.text.CharRender_Canvas.canvas.width);e=Math.min(e,laya.webgl.text.CharRender_Canvas.canvas.height);l=d+2*c+1;m=e+2*c+1;p&&(l=Math.max(l,p[0]+p[2]+1),m=Math.max(m,p[1]+p[3]+1));b.clearRect(0,0,l,m);b.save();b.textBaseline="top";0<c&&(b.strokeStyle=g,b.lineWidth=c,b.strokeText(a,k,n));b.fillStyle=f;b.fillText(a,k,n);this.showDbgInfo&&(b.strokeStyle="#ff0000",b.strokeRect(0,0,d,e),b.strokeStyle="#00ff00",b.strokeRect(k,n,h.width,h.height));p&&-1==p[2]&&(p[2]=Math.ceil((h.width+2*c)*this.lastScaleX));a=p?b.getImageData(p[0],p[1],p[2],p[3]):b.getImageData(0,0,d,e);b.restore();h.bmpWidth=a.width;h.bmpHeight=a.height;return a};a.getCharCanvas=function(a,d,e,f,g,h,k,n,l,m){var b=this.ctx;b.font!=d&&(b.font=d,b._lastFont=d);h.width=b.measureText(a).width;var q=h.width*this.lastScaleX,p=h.height*this.lastScaleY,q=q+(k+l)*this.lastScaleX,p=p+((n+m)*this.lastScaleY+1),q=Math.min(q,this.maxTexW),p=Math.min(p,this.maxTexH);c.canvas.width=Math.min(q+1,this.maxTexW);c.canvas.height=Math.min(p+1,this.maxTexH);b.font=d;b.clearRect(0,0,q+1+e,p+1+e);this.settrans.call(b,1,0,0,1,0,0);b.save();this.scaleFontSize&&b.scale(this.lastScaleX,this.lastScaleY);b.translate(k,n);b.textAlign="left";b.textBaseline="top";0<e?(b.strokeStyle=g,b.fillStyle=f,b.lineWidth=e,b.fillAndStrokeText?b.fillAndStrokeText(a,0,0):(b.strokeText(a,0,0),b.fillText(a,0,0))):(b.fillStyle=f,b.fillText(a,0,0));this.showDbgInfo&&(b.strokeStyle="#ff0000",b.strokeRect(0,0,q,p),b.strokeStyle="#00ff00",b.strokeRect(0,0,h.width,h.height));b.restore();h.bmpWidth=c.canvas.width;h.bmpHeight=c.canvas.height;return c.canvas};m(0,a,"canvasWidth",function(){return c.canvas.width},function(a){c.canvas.width!=a&&(c.canvas.width=a,2048<a&&console.warn("\u753b\u6587\u5b57\u8bbe\u7f6e\u7684\u5bbd\u5ea6\u592a\u5927\uff0c\u8d85\u8fc72048\u4e86"),this.settrans.call(this.ctx,1,0,0,1,0,0),this.ctx.scale(this.lastScaleX,this.lastScaleY))});c.canvas=null;return c}(xb),Kb=function(a){function c(){this.lastFont="";c.__super.call(this)}p(c,"laya.webgl.text.CharRender_Native",a);a=c.prototype;a.getWidth=function(a,d){if(!G.conchTextCanvas)return 0;this.lastFont=G.conchTextCanvas.font=a;return G.conchTextCanvas.measureText(d).width};a.scale=function(a,d){};a.getCharBmp=function(a,d,c,f,g,h,k,n,l,m,p){if(!G.conchTextCanvas)return null;this.lastFont=G.conchTextCanvas.font=d;h.width=G.conchTextCanvas.measureText(a).width;d=x.create(g).numColor;f=x.create(f).numColor;a=G.conchTextCanvas.getTextBitmapData(a,f,2<c?2:c,d);h.bmpWidth=a.width;h.bmpHeight=a.height;return a};return c}(xb),P=function(a){function c(){this._height=this._width=this._y=this._x=0;this._visible=!0;this._renderType=this._zOrder=this._mouseState=0;this._transform=null;this._tfChanged=!1;this._graphics=this._boundStyle=this._texture=null;this.hitTestPrior=this.autoSize=this.mouseThrough=!1;c.__super.call(this);this._repaint=0;this._style=Oa.EMPTY;this._cacheStyle=Ya.EMPTY}p(c,"laya.display.Sprite",a);var b=c.prototype;b.destroy=function(b){void 0===b&&(b=!0);a.prototype.destroy.call(this,b);this._style&&this._style.recover();this._cacheStyle&&this._cacheStyle.recover();this._boundStyle&&this._boundStyle.recover();this._transform=this._boundStyle=this._cacheStyle=this._style=null;this._graphics&&this._graphics.autoDestroy&&this._graphics.destroy();this.texture=this._graphics=null};b.updateZOrder=function(){L.updateOrder(this._children)&&this.repaint()};b._getBoundsStyle=function(){this._boundStyle||(this._boundStyle=oc.create());return this._boundStyle};b._setCustomRender=function(){};b._setCacheAs=function(a){};b._checkCanvasEnable=function(){var a=this._cacheStyle.needEnableCanvasRender();(this._getCacheStyle().enableCanvasRender=a)?(this._cacheStyle.needBitmapCache()?this._cacheStyle.cacheAs="bitmap":this._cacheStyle.cacheAs=this._cacheStyle.userSetCache,this._cacheStyle.reCache=!0,this._renderType|=8):(this._cacheStyle.cacheAs="none",this._cacheStyle.releaseContext(),this._renderType&=-9);this._setCacheAs(this._cacheStyle.cacheAs);this._setRenderType(this._renderType)};b.reCache=function(){this._cacheStyle.reCache=!0;this._repaint|=2};b.getRepaint=function(){return this._repaint};b._setX=function(a){this._x=a};b._setY=function(a){this._y=a};b._setWidth=function(a,b){};b._setHeight=function(a,b){};b.setSelfBounds=function(a){this._getBoundsStyle().userBounds=a};b.getBounds=function(){return this._getBoundsStyle().bounds=K._getWrapRec(this._boundPointsToParent())};b.getSelfBounds=function(){return this._boundStyle&&this._boundStyle.userBounds?this._boundStyle.userBounds:this._graphics||0!==this._children.length||this._texture?this._getBoundsStyle().bounds=K._getWrapRec(this._getBoundPointsM(!1)):K.TEMP.setTo(0,0,0,0)};b._boundPointsToParent=function(a){void 0===a&&(a=!1);var b=0,d=0;this._style&&(b=this.pivotX,d=this.pivotY,a=a||0!==this._style.rotation,this._style.scrollRect&&(b+=this._style.scrollRect.x,d+=this._style.scrollRect.y));var c=this._getBoundPointsM(a);if(!c||1>c.length)return c;8!=c.length&&(c=a?nb.scanPList(c):K._getWrapRec(c,K.TEMP)._getBoundPoints());if(!this.transform)return L.transPointList(c,this._x-b,this._y-d),c;a=N.TEMP;d=c.length;for(b=0;b<d;b+=2)a.x=c[b],a.y=c[b+1],this.toParentPoint(a),c[b]=a.x,c[b+1]=a.y;return c};b.getGraphicBounds=function(a){void 0===a&&(a=!1);return this._graphics?this._graphics.getBounds(a):K.TEMP.setTo(0,0,0,0)};b._getBoundPointsM=function(a){void 0===a&&(a=!1);if(this._boundStyle&&this._boundStyle.userBounds)return this._boundStyle.userBounds._getBoundPoints();this._boundStyle||this._getBoundsStyle();this._boundStyle.temBM||(this._boundStyle.temBM=[]);if(this._style.scrollRect){a=L.clearArray(this._boundStyle.temBM);var b=K.TEMP;b.copyFrom(this._style.scrollRect);L.concatArray(a,b._getBoundPoints());return a}var d;this._graphics?d=this._graphics.getBoundPoints():(d=L.clearArray(this._boundStyle.temBM),this._texture&&(b=K.TEMP,b.setTo(0,0,this.width||this._texture.width,this.height||this._texture.height),L.concatArray(d,b._getBoundPoints())));for(var c,b=this._children,h=0,k=b.length;h<k;h++)c=b[h],c instanceof laya.display.Sprite&&!0===c._visible&&(c=c._boundPointsToParent(a))&&(d=d?L.concatArray(d,c):c);return d};b._getCacheStyle=function(){this._cacheStyle===Ya.EMPTY&&(this._cacheStyle=Ya.create());return this._cacheStyle};b.getStyle=function(){this._style===Oa.EMPTY&&(this._style=Oa.create());return this._style};b.setStyle=function(a){this._style=a};b._setScaleX=function(a){this._style.scaleX=a};b._setScaleY=function(a){this._style.scaleY=a};b._setRotation=function(a){this._style.rotation=a};b._setSkewX=function(a){this._style.skewX=a};b._setSkewY=function(a){this._style.skewY=a};b._createTransform=function(){return I.create()};b._adjustTransform=function(){this._tfChanged=!1;var a=this._style,b=a.scaleX,c=a.scaleY,g=a.skewX,h=a.skewY,k=a.rotation,a=this._transform||(this._transform=this._createTransform());if(k||1!==b||1!==c||0!==g||0!==h){a._bTransform=!0;var g=.0174532922222222*(k-g),h=.0174532922222222*(k+h),k=Math.sin(h),n=Math.sin(g),g=Math.cos(g);a.a=b*Math.cos(h);a.b=b*k;a.c=-c*n;a.d=c*g;a.tx=a.ty=0}else a.identity(),this._renderType&=-3,this._setRenderType(this._renderType);return a};b._setTransform=function(a){};b._setPivotX=function(a){this.getStyle().pivotX=a};b._getPivotX=function(){return this._style.pivotX};b._setPivotY=function(a){this.getStyle().pivotY=a};b._getPivotY=function(){return this._style.pivotY};b._setAlpha=function(a){this._style.alpha!==a&&(this.getStyle().alpha=a,this._renderType=1!==a?this._renderType|1:this._renderType&-2,this._setRenderType(this._renderType),this.parentRepaint())};b._getAlpha=function(){return this._style.alpha};b._setBlendMode=function(a){};b._setGraphics=function(a){};b._setGraphicsCallBack=function(){};b._setScrollRect=function(a){};b.pos=function(a,b,c){void 0===c&&(c=!1);if(this._x!==a||this._y!==b){if(this.destroyed)return this;c?(this._setX(a),this._setY(b),this.parentRepaint(2),(a=this._cacheStyle.maskParent)&&a.repaint(2)):(this.x=a,this.y=b)}return this};b.pivot=function(a,b){this.pivotX=a;this.pivotY=b;return this};b.size=function(a,b){this.width=a;this.height=b;return this};b.scale=function(a,b,c){void 0===c&&(c=!1);var d=this.getStyle();if(d.scaleX!=a||d.scaleY!=b){if(this.destroyed)return this;c?(this._setScaleX(a),this._setScaleY(b),this._setTranformChange()):(this.scaleX=a,this.scaleY=b)}return this};b.skew=function(a,b){this.skewX=a;this.skewY=b;return this};b.render=function(a,b,c){ta.renders[this._renderType]._fun(this,a,b+this._x,c+this._y);this._repaint=0};b.drawToCanvas=function(a,b,c,g){return Z.drawToCanvas(this,this._renderType,a,b,c,g)};b.drawToTexture=function(a,b,c,g){return Z.drawToTexture(this,this._renderType,a,b,c,g)};b.customRender=function(a,b,c){this._repaint=3};b._applyFilters=function(){};b._setColorFilter=function(a){};b._isHaveGlowFilter=function(){var a,b;if(this.filters)for(a=0;a<this.filters.length;a++)if(8==this.filters[a].type)return!0;a=0;for(b=this._children.length;a<b;a++)if(this._children[a]._isHaveGlowFilter())return!0;return!1};b.localToGlobal=function(a,b,c){void 0===b&&(b=!1);!0===b&&(a=new N(a.x,a.y));b=this;for(c=c||l.stage;b&&!b.destroyed&&b!=c;)a=b.toParentPoint(a),b=b.parent;return a};b.globalToLocal=function(a,b,c){void 0===b&&(b=!1);b&&(a=new N(a.x,a.y));b=this;var d=[];for(c=c||l.stage;b&&!b.destroyed&&b!=c;)d.push(b),b=b.parent;for(c=d.length-1;0<=c;)b=d[c],a=b.fromParentPoint(a),c--;return a};b.toParentPoint=function(a){if(!a)return a;a.x-=this.pivotX;a.y-=this.pivotY;this.transform&&this._transform.transformPoint(a);a.x+=this._x;a.y+=this._y;var b=this._style.scrollRect;b&&(a.x-=b.x,a.y-=b.y);return a};b.fromParentPoint=function(a){if(!a)return a;a.x-=this._x;a.y-=this._y;var b=this._style.scrollRect;b&&(a.x+=b.x,a.y+=b.y);this.transform&&this._transform.invertTransformPoint(a);a.x+=this.pivotX;a.y+=this.pivotY;return a};b.fromStagePoint=function(a){return a};b.on=function(b,c,f,g){return 1!==this._mouseState&&this.isMouseEvent(b)?(this.mouseEnabled=!0,this._setBit(64,!0),this._parent&&this._$2__onDisplay(),this._createListener(b,c,f,g,!1)):a.prototype.on.call(this,b,c,f,g)};b.once=function(b,c,f,g){return 1!==this._mouseState&&this.isMouseEvent(b)?(this.mouseEnabled=!0,this._setBit(64,!0),this._parent&&this._$2__onDisplay(),this._createListener(b,c,f,g,!0)):a.prototype.once.call(this,b,c,f,g)};b._$2__onDisplay=function(){if(1!==this._mouseState){var a;for(a=this.parent;a&&1!==a._mouseState&&!a._getBit(64);)a.mouseEnabled=!0,a._setBit(64,!0),a=a.parent}};b._setParent=function(b){a.prototype._setParent.call(this,b);b&&this._getBit(64)&&this._$2__onDisplay()};b.loadImage=function(a,b){function d(){c.repaint(3);b&&b.run()}var c=this;if(null==a)this.texture=null,d();else{var e=H.getRes(a);e||(e=new X,e.load(a),H.cacheRes(a,e));this.texture=e;if(e.getIsReady())d();else e.once("ready",null,d)}return this};b.repaint=function(a){void 0===a&&(a=2);this._repaint&a||(this._repaint|=a,this.parentRepaint(a));this._cacheStyle&&this._cacheStyle.maskParent&&this._cacheStyle.maskParent.repaint(a)};b._needRepaint=function(){return this._repaint&2&&this._cacheStyle.enableCanvasRender&&this._cacheStyle.reCache};b._childChanged=function(a){this._renderType=this._children.length?this._renderType|8192:this._renderType&-8193;this._setRenderType(this._renderType);a&&this._getBit(32)&&l.systemTimer.callLater(this,this.updateZOrder);this.repaint(3)};b.parentRepaint=function(a){void 0===a&&(a=2);var b=this._parent;!b||b._repaint&a||(b._repaint|=a,b.parentRepaint(a))};b._setMask=function(a){};b.startDrag=function(a,b,c,g,h,k,n){void 0===b&&(b=!1);void 0===c&&(c=0);void 0===g&&(g=300);void 0===k&&(k=!1);void 0===n&&(n=.92);this._style.dragging||(this.getStyle().dragging=new xc);this._style.dragging.start(this,a,b,c,g,h,k,n)};b.stopDrag=function(){this._style.dragging&&this._style.dragging.stop()};b._setDisplay=function(b){!b&&this._cacheStyle&&(this._cacheStyle.releaseContext(),this._cacheStyle.releaseFilterCache(),this._cacheStyle.hasGlowFilter&&(this._cacheStyle.hasGlowFilter=!1));a.prototype._setDisplay.call(this,b)};b.hitTestPoint=function(a,b){var d=this.globalToLocal(N.TEMP.setTo(a,b));a=d.x;b=d.y;return(this._style.hitArea?this._style.hitArea:0<this._width&&0<this._height?K.TEMP.setTo(0,0,this._width,this._height):this.getSelfBounds()).contains(a,b)};b.getMousePoint=function(){return this.globalToLocal(N.TEMP.setTo(l.stage.mouseX,l.stage.mouseY))};b._setTexture=function(a){};b._setRenderType=function(a){};b._setTranformChange=function(){this._tfChanged=!0;this._renderType|=2;this.parentRepaint(2)};b._setBgStyleColor=function(a,b,c,g,h){};b._setBorderStyleColor=function(a,b,c,g,h,k){};b.captureMouseEvent=function(a){ha.instance.setCapture(this,a)};b.releaseMouseEvent=function(){ha.instance.releaseCapture()};m(0,b,"customRenderEnable",null,function(a){a&&(this._renderType|=2048,this._setRenderType(this._renderType),this._setCustomRender())});m(0,b,"cacheAs",function(){return this._cacheStyle.cacheAs},function(a){a===this._cacheStyle.userSetCache||this.mask&&"normal"===a||(this._setCacheAs(a),this._getCacheStyle().userSetCache=a,this._checkCanvasEnable(),this.repaint())});m(0,b,"globalScaleY",function(){for(var a=1,b=this;b&&b!==l.stage;)a*=b.scaleY,b=b.parent;return a});m(0,b,"hitArea",function(){return this._style.hitArea},function(a){this.getStyle().hitArea=a});m(0,b,"staticCache",function(){return this._cacheStyle.staticCache},function(a){(this._getCacheStyle().staticCache=a)||this.reCache()});m(0,b,"displayWidth",function(){return this.width*this.scaleX});m(0,b,"zOrder",function(){return this._zOrder},function(a){this._zOrder!=a&&(this._zOrder=a,this._parent&&(a&&this._parent._setBit(32,!0),l.systemTimer.callLater(this._parent,this.updateZOrder)))});m(0,b,"rotation",function(){return this._style.rotation},function(a){this.getStyle().rotation!==a&&(this._setRotation(a),this._setTranformChange())});m(0,b,"width",function(){return this.autoSize?this.texture?this.texture.width:this._graphics||0!==this._children.length?this.getSelfBounds().width:0:this._width||(this.texture?this.texture.width:0)},function(a){this._width!==a&&(this._width=a,this._setWidth(this.texture,a),this._setTranformChange())});m(0,b,"x",function(){return this._x},function(a){this.destroyed||this._x===a||(this._setX(a),this.parentRepaint(2),(a=this._cacheStyle.maskParent)&&a.repaint(2))});m(0,b,"drawCallOptimize",function(){return this._getBit(256)},function(a){this._setBit(256,a)});m(0,b,"texture",function(){return this._texture},function(a){"string"==typeof a?this.loadImage(a):this._texture!=a&&(this._texture&&this._texture._removeReference(),(this._texture=a)&&a._addReference(),this._setTexture(a),this._setWidth(this._texture,this.width),this._setHeight(this._texture,this.height),this._renderType=a?this._renderType|256:this._renderType&-257,this._setRenderType(this._renderType),this.repaint())});m(0,b,"globalRotation",function(){for(var a=0,b=this;b&&b!==l.stage;)a+=b.rotation,b=b.parent;return a});m(0,b,"y",function(){return this._y},function(a){this.destroyed||this._y===a||(this._setY(a),this.parentRepaint(2),(a=this._cacheStyle.maskParent)&&a.repaint(2))});m(0,b,"displayHeight",function(){return this.height*this.scaleY});m(0,b,"height",function(){return this.autoSize?this.texture?this.texture.height:this._graphics||0!==this._children.length?this.getSelfBounds().height:0:this._height||(this.texture?this.texture.height:0)},function(a){this._height!==a&&(this._height=a,this._setHeight(this.texture,a),this._setTranformChange())});m(0,b,"blendMode",function(){return this._style.blendMode},function(a){this._setBlendMode(a);this._renderType=(this.getStyle().blendMode=a)&&"source-over"!=a?this._renderType|4:this._renderType&-5;this._setRenderType(this._renderType);this.parentRepaint()});m(0,b,"scaleX",function(){return this._style.scaleX},function(a){this.getStyle().scaleX!==a&&(this._setScaleX(a),this._setTranformChange())});m(0,b,"scaleY",function(){return this._style.scaleY},function(a){this.getStyle().scaleY!==a&&(this._setScaleY(a),this._setTranformChange())});m(0,b,"stage",function(){return l.stage});m(0,b,"skewX",function(){return this._style.skewX},function(a){this.getStyle().skewX!==a&&(this._setSkewX(a),this._setTranformChange())});m(0,b,"scrollRect",function(){return this._style.scrollRect},function(a){this.getStyle().scrollRect=a;this._setScrollRect(a);this.repaint();this._renderType=a?this._renderType|64:this._renderType&-65;this._setRenderType(this._renderType)});m(0,b,"skewY",function(){return this._style.skewY},function(a){this.getStyle().skewY!==a&&(this._setSkewY(a),this._setTranformChange())});m(0,b,"transform",function(){return this._tfChanged?this._adjustTransform():this._transform},function(a){this._tfChanged=!1;var b=this._transform||(this._transform=this._createTransform());a.copyTo(b);this._setTransform(b);a&&(this._x=b.tx,this._y=b.ty,b.tx=b.ty=0);this._renderType=a?this._renderType|2:this._renderType&-3;this._setRenderType(this._renderType);this.parentRepaint()});m(0,b,"pivotX",function(){return this._getPivotX()},function(a){this._setPivotX(a);this.repaint()});m(0,b,"pivotY",function(){return this._getPivotY()},function(a){this._setPivotY(a);this.repaint()});m(0,b,"alpha",function(){return this._getAlpha()},function(a){this._setAlpha(0>a?0:1<a?1:a)});m(0,b,"visible",function(){return this._visible},function(a){this._visible!==a&&(this._visible=a,this.parentRepaint(3))});m(0,b,"graphics",function(){this._graphics||(this.graphics=new sa,this._graphics.autoDestroy=!0);return this._graphics},function(a){this._graphics&&(this._graphics._sp=null);(this._graphics=a)?(this._setGraphics(a),this._renderType|=512,a._sp=this):this._renderType&=-513;this._setRenderType(this._renderType);this.repaint()});m(0,b,"filters",function(){return this._cacheStyle.filters},function(a){a&&0===a.length&&(a=null);this._cacheStyle.filters!=a&&(this._getCacheStyle().filters=a?a.slice():null,a&&a.length?(this._setColorFilter(a[0]),this._renderType|=16):(this._setColorFilter(null),this._renderType&=-17),this._setRenderType(this._renderType),a&&0<a.length?(this._getBit(16)||this._setBitUp(16),1==a.length&&a[0]instanceof laya.filters.ColorFilter||(this._getCacheStyle().cacheForFilters=!0,this._checkCanvasEnable())):this._cacheStyle.cacheForFilters&&(this._cacheStyle.cacheForFilters=!1,this._checkCanvasEnable()),this._getCacheStyle().hasGlowFilter=this._isHaveGlowFilter(),this.repaint())});m(0,b,"mask",function(){return this._cacheStyle.mask},function(a){a&&this.mask&&this.mask._cacheStyle.maskParent||(this._getCacheStyle().mask=a,this._setMask(a),this._checkCanvasEnable(),a?a._getCacheStyle().maskParent=this:this.mask&&(this.mask._getCacheStyle().maskParent=null),this._renderType|=32,this._setRenderType(this._renderType),this.parentRepaint(3))});m(0,b,"mouseEnabled",function(){return 1<this._mouseState},function(a){this._mouseState=a?2:1});m(0,b,"globalScaleX",function(){for(var a=1,b=this;b&&b!==l.stage;)a*=b.scaleX,b=b.parent;return a});m(0,b,"mouseX",function(){return this.getMousePoint().x});m(0,b,"mouseY",function(){return this.getMousePoint().y});m(0,b,"viewport",function(){return this._style.viewport},function(a){if("string"==typeof a){var b;b=a.split(",");3<b.length&&(a=new K(parseFloat(b[0]),parseFloat(b[1]),parseFloat(b[2]),parseFloat(b[3])))}this.getStyle().viewport=a});c.fromImage=function(a){return(new c).loadImage(a)};return c}(Kc),aa=function(a){function c(){c.__super.call(this)}p(c,"laya.webgl.shader.BaseShader",a);c.activeShader=null;c.bindShader=null;return c}(va),bb=function(a){function c(){c.__super.call(this);this._height=this._width=-1}p(c,"laya.resource.Bitmap",a);a=c.prototype;a._getSource=function(){throw"Bitmap: must override it.";};m(0,a,"width",function(){return this._width});m(0,a,"height",function(){return this._height});return c}(va),Ua=function(a){function c(a,d){this._source=null;this._texH=this._texW=0;this.__destroyed=!1;this.genID=this._discardTm=0;this.bitmap={id:0,_glTexture:null};this.lastTouchTm=this.curUsedCovRateAtlas=this.curUsedCovRate=0;this.ri=null;c.__super.call(this);this._texW=a||Y.atlasWidth;this._texH=d||Y.atlasWidth;this.bitmap.id=this.id;this.lock=!0}p(c,"laya.webgl.text.TextTexture",a);a=c.prototype;a.recreateResource=function(){if(!this._source){var a=v.isConchApp?y.instance.getDefaultCommandEncoder():E.mainContext,c=this._source=a.createTexture();this.bitmap._glTexture=c;C.bindTexture(a,3553,c);a.texImage2D(3553,0,6408,this._texW,this._texH,0,6408,5121,null);a.texParameteri(3553,10241,9729);a.texParameteri(3553,10240,9729);a.texParameteri(3553,10242,33071);a.texParameteri(3553,10243,33071);Y.debugUV&&this.fillWhite()}};a.addChar=function(a,c,e,f){if(Y.isWan1Wan)return this.addCharCanvas(a,c,e,f);!this._source&&this.recreateResource();var b=v.isConchApp?y.instance.getDefaultCommandEncoder():E.mainContext;C.bindTexture(b,3553,this._source);!v.isConchApp&&b.pixelStorei(37441,!0);var d=a.data;a.data instanceof Uint8ClampedArray&&(d=new Uint8Array(d.buffer));b.texSubImage2D(3553,0,c,e,a.width,a.height,6408,5121,d);!v.isConchApp&&b.pixelStorei(37441,!1);v.isConchApp?(b=c/this._texW,d=e/this._texH,c=(c+a.width)/this._texW,a=(e+a.height)/this._texH):(b=(c+1)/this._texW,d=e/this._texH,c=(c+a.width-1)/this._texW,a=(e+a.height-1)/this._texH);f=f||Array(8);f[0]=b;f[1]=d;f[2]=c;f[3]=d;f[4]=c;f[5]=a;f[6]=b;f[7]=a;return f};a.addCharCanvas=function(a,c,e,f){!this._source&&this.recreateResource();var b=v.isConchApp?y.instance.getDefaultCommandEncoder():E.mainContext;C.bindTexture(b,3553,this._source);!v.isConchApp&&b.pixelStorei(37441,!0);b.texSubImage2D(3553,0,c,e,6408,5121,a);!v.isConchApp&&b.pixelStorei(37441,!1);var d;v.isConchApp?(b=c/this._texW,d=e/this._texH,c=(c+a.width)/this._texW,a=(e+a.height)/this._texH):(b=(c+1)/this._texW,d=(e+1)/this._texH,c=(c+a.width-1)/this._texW,a=(e+a.height-1)/this._texH);f=f||Array(8);f[0]=b;f[1]=d;f[2]=c;f[3]=d;f[4]=c;f[5]=a;f[6]=b;f[7]=a;return f};a.fillWhite=function(){!this._source&&this.recreateResource();var a=v.isConchApp?y.instance.getDefaultCommandEncoder():E.mainContext,c=new Uint8Array(this._texW*this._texH*4);c.fill(255);a.texSubImage2D(3553,0,0,0,this._texW,this._texH,6408,5121,c)};a.discard=function(){this._texW!=Y.atlasWidth||this._texH!=Y.atlasWidth?this.destroy():(this.genID++,c.poolLen>=c.pool.length&&(c.pool=c.pool.concat(Array(10))),this._discardTm=l.stage.getFrameTm(),c.pool[c.poolLen++]=this)};a.destroy=function(){this.__destroyed=!0;var a=v.isConchApp?y.instance.getDefaultCommandEncoder():E.mainContext;this._source&&a.deleteTexture(this._source);this._source=null};a.touchRect=function(a,c){this.lastTouchTm!=c&&(this.curUsedCovRateAtlas=this.curUsedCovRate=0,this.lastTouchTm=c);var b=Y.atlasWidth*Y.atlasWidth,d=ya.atlasGridW*ya.atlasGridW;this.curUsedCovRate+=a.bmpWidth*a.bmpHeight/b;this.curUsedCovRateAtlas+=Math.ceil(a.bmpWidth/ya.atlasGridW)*Math.ceil(a.bmpHeight/ya.atlasGridW)/(b/d)};a._getSource=function(){return this._source};a.drawOnScreen=function(a,c){};m(0,a,"texture",function(){return this});c.getTextTexture=function(a,d){if(a!=Y.atlasWidth||a!=Y.atlasWidth)return new c(a,d);if(0<c.poolLen){var b=c.pool[--c.poolLen];0<c.poolLen&&c.clean();return b}return new c(a,d)};c.clean=function(){var a=l.stage.getFrameTm();0===c.cleanTm&&(c.cleanTm=a);if(a-c.cleanTm>=Y.checkCleanTextureDt){for(var d=0;d<c.poolLen;d++){var e=c.pool[d];a-e._discardTm>=Y.destroyUnusedTextureDt&&(e.destroy(),c.pool[d]=c.pool[c.poolLen-1],c.poolLen--,d--)}c.cleanTm=a}};c.poolLen=0;c.cleanTm=0;t(c,["pool",function(){return this.pool=Array(10)}]);return c}(va),gb=function(a){function c(a){this._uint16Array=null;void 0===a&&(a=35044);c.__super.call(this);this._bufferUsage=a;this._bufferType=34963;this._buffer=new ArrayBuffer(8)}p(c,"laya.webgl.utils.IndexBuffer2D",a);a=c.prototype;a._checkArrayUse=function(){this._uint16Array&&(this._uint16Array=new Uint16Array(this._buffer))};a.getUint16Array=function(){return this._uint16Array||(this._uint16Array=new Uint16Array(this._buffer))};a._bindForVAO=function(){y.instance.bindBuffer(34963,this._glBuffer)};a.bind=function(){return fa._bindedIndexBuffer!==this._glBuffer?(y.instance.bindBuffer(34963,this._glBuffer),fa._bindedIndexBuffer=this._glBuffer,!0):!1};a.destory=function(){this._buffer=this._uint16Array=null};a.disposeResource=function(){this._disposeResource()};c.create=function(a){void 0===a&&(a=35044);return new c(a)};return c}(ab),Nc=function(a){function c(){this.bufferSource=this.gain=this.audioBuffer=null;this._currentTime=0;this._volume=1;this._pauseTime=this._startTime=0;this._onPlayEnd=null;this.context=ma.ctx;c.__super.call(this);this._onPlayEnd=L.bind(this.__onPlayEnd,this);this.gain=this.context.createGain?this.context.createGain():this.context.createGainNode()}p(c,"laya.media.webaudio.WebAudioSoundChannel",a);var b=c.prototype;b.play=function(){Q.addChannel(this);this.isStopped=!1;this._clearBufferSource();if(this.audioBuffer){if(this.startTime>=this.duration)return this.stop();var a=this.context,b=this.gain,c=a.createBufferSource();this.bufferSource=c;c.buffer=this.audioBuffer;c.connect(b);b&&b.disconnect();b.connect(a.destination);c.onended=this._onPlayEnd;this._startTime=r.now();this.gain.gain.setTargetAtTime?this.gain.gain.setTargetAtTime(this._volume,this.context.currentTime,.001):this.gain.gain.value=this._volume;0==this.loops&&(c.loop=!0);c.playbackRate.setTargetAtTime?c.playbackRate.setTargetAtTime(Q.playbackRate,this.context.currentTime,.001):c.playbackRate.value=Q.playbackRate;c.start(0,this.startTime);this._currentTime=0}};b.__onPlayEnd=function(){1==this.loops?(this.completeHandler&&(l.timer.once(10,this,this.__runComplete,[this.completeHandler],!1),this.completeHandler=null),this.stop(),this.event("complete")):(0<this.loops&&this.loops--,this.startTime=0,this.play())};b._clearBufferSource=function(){if(this.bufferSource){var a=this.bufferSource;a.stop?a.stop(0):a.noteOff(0);a.disconnect(0);a.onended=null;c._tryCleanFailed||this._tryClearBuffer(a);this.bufferSource=null}};b._tryClearBuffer=function(a){if(r.onMac)try{a.buffer=ma._miniBuffer}catch(e){c._tryCleanFailed=!0}else try{a.buffer=null}catch(e){c._tryCleanFailed=!0}};b.stop=function(){a.prototype.stop.call(this);this._clearBufferSource();this.audioBuffer=null;this.gain&&this.gain.disconnect();this.isStopped=!0;Q.removeChannel(this);this.completeHandler=null;Q.autoReleaseSound&&Q.disposeSoundLater(this.url)};b.pause=function(){this.isStopped||(this._pauseTime=this.position);this._clearBufferSource();this.gain&&this.gain.disconnect();this.isStopped=!0;Q.removeChannel(this);Q.autoReleaseSound&&Q.disposeSoundLater(this.url)};b.resume=function(){this.startTime=this._pauseTime;this.play()};m(0,b,"position",function(){return this.bufferSource?(r.now()-this._startTime)/1E3+this.startTime:0});m(0,b,"duration",function(){return this.audioBuffer?this.audioBuffer.duration:0});m(0,b,"volume",function(){return this._volume},function(a){this._volume=a;this.isStopped||(this.gain.gain.setTargetAtTime?this.gain.gain.setTargetAtTime(a,this.context.currentTime,.001):this.gain.gain.value=a)});c._tryCleanFailed=!1;c.SetTargetDelay=.001;return c}(zb),Jc=function(a){function c(a){this._resumePlay=this._onEnd=this._audio=null;c.__super.call(this);this._onEnd=L.bind(this.__onEnd,this);this._resumePlay=L.bind(this.__resumePlay,this);a.addEventListener("ended",this._onEnd);this._audio=a}p(c,"laya.media.h5audio.AudioSoundChannel",a);var b=c.prototype;b.__onEnd=function(){1==this.loops?(this.completeHandler&&(l.systemTimer.once(10,this,this.__runComplete,[this.completeHandler],!1),this.completeHandler=null),this.stop(),this.event("complete")):(0<this.loops&&this.loops--,this.startTime=0,this.play())};b.__resumePlay=function(){this._audio&&this._audio.removeEventListener("canplay",this._resumePlay);if(!this.isStopped)try{this._audio.currentTime=this.startTime,r.container.appendChild(this._audio),this._audio.play()}catch(d){this.event("error")}};b.play=function(){this.isStopped=!1;try{this._audio.playbackRate=Q.playbackRate,this._audio.currentTime=this.startTime}catch(d){this._audio.addEventListener("canplay",this._resumePlay);return}Q.addChannel(this);r.container.appendChild(this._audio);"play"in this._audio&&this._audio.play()};b.stop=function(){a.prototype.stop.call(this);this.isStopped=!0;Q.removeChannel(this);this.completeHandler=null;this._audio&&("pause"in this._audio&&v.isConchApp&&this._audio.stop(),this._audio.pause(),this._audio.removeEventListener("ended",this._onEnd),this._audio.removeEventListener("canplay",this._resumePlay),r.onIE||this._audio!=Ea._musicAudio&&w.recover("audio:"+this.url,this._audio),r.removeElement(this._audio),this._audio=null)};b.pause=function(){this.isStopped=!0;Q.removeChannel(this);"pause"in this._audio&&this._audio.pause()};b.resume=function(){this._audio&&(this.isStopped=!1,Q.addChannel(this),"play"in this._audio&&this._audio.play())};m(0,b,"position",function(){return this._audio?this._audio.currentTime:0});m(0,b,"duration",function(){return this._audio?this._audio.duration:0});m(0,b,"volume",function(){return this._audio?this._audio.volume:1},function(a){this._audio&&(this._audio.volume=a)});return c}(zb),hb=function(a){function c(a,d){this._uint32Array=this._floatArray32=null;this._vertexStride=0;c.__super.call(this);this._vertexStride=a;this._bufferUsage=d;this._bufferType=34962;this._buffer=new ArrayBuffer(8);this._floatArray32=new Float32Array(this._buffer);this._uint32Array=new Uint32Array(this._buffer)}p(c,"laya.webgl.utils.VertexBuffer2D",a);a=c.prototype;a.getFloat32Array=function(){return this._floatArray32};a.appendArray=function(a){var b=this._byteLength>>2;this.setByteLength(this._byteLength+4*a.length);this.getFloat32Array().set(a,b);this._upload=!0};a._checkArrayUse=function(){this._floatArray32&&(this._floatArray32=new Float32Array(this._buffer));this._uint32Array&&(this._uint32Array=new Uint32Array(this._buffer))};a.deleteBuffer=function(){this._disposeResource()};a._bindForVAO=function(){y.instance.bindBuffer(34962,this._glBuffer)};a.bind=function(){return fa._bindedVertexBuffer!==this._glBuffer?(y.instance.bindBuffer(34962,this._glBuffer),fa._bindedVertexBuffer=this._glBuffer,!0):!1};a.destroy=function(){laya.webgl.utils.Buffer.prototype.destroy.call(this);this._byteLength=0;this._upload=!0;this._floatArray32=this._buffer=null};m(0,a,"vertexStride",function(){return this._vertexStride});c.create=function(a,d){void 0===d&&(d=35048);return new c(a,d)};return c}(ab),O=function(a){function c(){this._text=this._clipPoint=null;this._isChanged=!1;this._textHeight=this._textWidth=0;this._lines=[];this._lineWidths=[];this._startY=this._startX=0;this._words=null;this._charSize={};this._valign="top";this._color="#000000";this._singleCharRender=!1;c.__super.call(this);this._fontSize=c.defaultFontSize;this._font=c.defaultFont;this.overflow="visible";this._style=Fa.EMPTY}p(c,"laya.display.Text",a);var b=c.prototype;b.getStyle=function(){this._style===Fa.EMPTY&&(this._style=Fa.create());return this._style};b._getTextStyle=function(){this._style===Fa.EMPTY&&(this._style=Fa.create());return this._style};b.destroy=function(b){void 0===b&&(b=!0);a.prototype.destroy.call(this,b);this._lineWidths=this._lines=this._clipPoint=null;this._words&&this._words.forEach(function(a){a.cleanCache()});this._charSize=this._words=null};b._getBoundPointsM=function(a){a=K.TEMP;a.setTo(0,0,this.width,this.height);return a._getBoundPoints()};b.getGraphicBounds=function(a){a=K.TEMP;a.setTo(0,0,this.width,this.height);return a};b._getCSSStyle=function(){return this._style};b.lang=function(a,b,f,g,h,k,n,l,m,p,r){a=c.langPacks&&c.langPacks[a]?c.langPacks[a]:a;if(!(2>arguments.length))for(var d=0,e=arguments.length;d<e;d++)a=a.replace("{"+d+"}",arguments[d+1]);this._text=a};b._getContextFont=function(){return(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+(r.onIPhone?laya.display.Text.fontFamilyMap[this.font]||this.font:this.font)};b._isPassWordMode=function(){var a=this._style.asPassword;"prompt"in this&&this.prompt==this._text&&(a=!1);return a};b._getPassWordTxt=function(a){var b=a.length;for(a="";0<b;b--)a+="\u25cf";return a};b._renderText=function(){var a=this.padding,b=this._lines.length;"visible"!=this.overflow&&(b=Math.min(b,Math.floor((this.height-a[0]-a[2])/(this.leading+this._charSize.height))+1));var c=this.scrollY/(this._charSize.height+this.leading)|0,g=this.graphics;g.clear(!0);var h=this._getContextFont();r.context.font=h;var k=a[3],n="left",l=this._lines,m=this.leading+this._charSize.height,p=this._style.currBitmapFont;p&&(m=this.leading+p.getMaxHeight());var t=a[0];!p&&0<this._width&&this._textWidth<=this._width&&("right"==this.align?(n="right",k=this._width-a[1]):"center"==this.align&&(n="center",k=.5*this._width+a[3]-a[1]));if(0<this._height){var v=this._textHeight>this._height?"top":this.valign;"middle"===v?t=.5*(this._height-b*m)+a[0]-a[2]:"bottom"===v&&(t=this._height-b*m-a[2])}v=this._style;if(p&&p.autoScaleSize)var w=p.fontSize/this.fontSize;if(this._clipPoint){g.save();if(p&&p.autoScaleSize){var x=0,y=0;this._width?x=this._width-a[3]-a[1]:x=this._textWidth;this._height?y=this._height-a[0]-a[2]:y=this._textHeight;g.clipRect(a[3],a[0],x*w,y*w)}else g.clipRect(a[3],a[0],this._width?this._width-a[3]-a[1]:this._textWidth,this._height?this._height-a[0]-a[2]:this._textHeight);this.repaint()}a=v.asPassword;"prompt"in this&&this.prompt==this._text&&(a=!1);for(var z,D,b=Math.min(this._lines.length,b+c)||1,x=c;x<b;x++){var y=l[x],C;if(a)for(z=y.length,y="";0<z;z--)y+="\u25cf";null==y&&(y="");z=k-(this._clipPoint?this._clipPoint.x:0);D=t+m*x-(this._clipPoint?this._clipPoint.y:0);this.underline&&this._drawUnderline(n,z,D,x);p?(C=this.width,p.autoScaleSize&&(C=this.width*w),p._drawText(y,this,z,D,this.align,C)):(this._words||(this._words=[]),this._words.length>x-c?C=this._words[x-c]:(C=new Ib,this._words.push(C)),C.setText(y),C.splitRender=this._singleCharRender,v.stroke?g.fillBorderText(C,z,D,h,this.color,v.strokeColor,v.stroke,n):g.fillText(C,z,D,h,this.color,n))}p&&p.autoScaleSize&&(c=1/w,this.scale(c,c));this._clipPoint&&g.restore();this._startX=k;this._startY=t};b._drawUnderline=function(a,b,c,g){g=this._lineWidths[g];switch(a){case "center":b-=g/2;break;case "right":b-=g}c+=this._charSize.height;this._graphics.drawLine(b,c,b+g,c,this.underlineColor||this.color,1)};b.typeset=function(){this._isChanged=!1;this._text?(v.isConchApp?G.conchTextCanvas.font=this._getContextFont():r.context.font=this._getContextFont(),this._lines.length=0,this._lineWidths.length=0,this._isPassWordMode()?this._parseLines(this._getPassWordTxt(this._text)):this._parseLines(this._text),this._evalTextSize(),this._checkEnabledViewportOrNot()?this._clipPoint||(this._clipPoint=new N(0,0)):this._clipPoint=null,this._renderText()):(this._clipPoint=null,this._textWidth=this._textHeight=0,this.graphics.clear(!0))};b._evalTextSize=function(){var a,b;a=Math.max.apply(this,this._lineWidths);b=this._style.currBitmapFont?this._lines.length*(this._style.currBitmapFont.getMaxHeight()+this.leading)+this.padding[0]+this.padding[2]:this._lines.length*(this._charSize.height+this.leading)+this.padding[0]+this.padding[2];if(a!=this._textWidth||b!=this._textHeight)this._textWidth=a,this._textHeight=b};b._checkEnabledViewportOrNot=function(){return"scroll"==this.overflow&&(0<this._width&&this._textWidth>this._width||0<this._height&&this._textHeight>this._height)};b.changeText=function(a){this._text!==a&&(this.lang(a+""),this._graphics&&this._graphics.replaceText(this._text)||this.typeset())};b._parseLines=function(a){var b=this.wordWrap||"hidden"==this.overflow;if(b)var d=this._getWordWrapWidth();var g=this._style.currBitmapFont;g?(this._charSize.width=g.getMaxWidth(),this._charSize.height=g.getMaxHeight()):((g=v.isConchApp?G.conchTextCanvas.measureText(this._testWord):r.context.measureText(c._testWord))||(g={width:100}),this._charSize.width=g.width,this._charSize.height=g.height||this.fontSize);a=a.replace(/\r\n/g,"\n").split("\n");for(var g=0,h=a.length;g<h;g++){var k=a[g];b?this._parseLine(k,d):(this._lineWidths.push(this._getTextWidth(k)),this._lines.push(k))}};b._parseLine=function(a,b){var c=this._lines,d,e,k,n,l=0;k=this._getTextWidth(a);if(k<=b)c.push(a),this._lineWidths.push(k);else{k=this._charSize.width;d=Math.floor(b/k);0==d&&(d=1);n=k=this._getTextWidth(a.substring(0,d));for(var m=d,p=a.length;m<p;m++)if(k=this._getTextWidth(a.charAt(m)),n+=k,n>b)if(this.wordWrap){var r=a.substring(l,m);255>r.charCodeAt(r.length-1)&&(e=/(?:\w|-)+$/.exec(r))&&(m=e.index+l,0==e.index?m+=r.length:r=a.substring(l,m));c.push(r);this._lineWidths.push(n-k);l=m;if(m+d<p)m+=d,n=k=this._getTextWidth(a.substring(l,m)),m--;else{c.push(a.substring(l,p));this._lineWidths.push(this._getTextWidth(c[c.length-1]));l=-1;break}}else if("hidden"==this.overflow){c.push(a.substring(0,m));this._lineWidths.push(this._getTextWidth(c[c.length-1]));return}this.wordWrap&&-1!=l&&(c.push(a.substring(l,p)),this._lineWidths.push(this._getTextWidth(c[c.length-1])))}};b._getTextWidth=function(a){var b=this._style.currBitmapFont;return b?b.getTextWidth(a):v.isConchApp?G.conchTextCanvas.measureText(a).width:r.context.measureText(a).width};b._getWordWrapWidth=function(){var a=this.padding,b;b=(b=this._style.currBitmapFont)&&b.autoScaleSize?b.fontSize/this.fontSize*this._width:this._width;0>=b&&(b=this.wordWrap?100:r.width);0>=b&&(b=100);return b-a[3]-a[1]};b.getCharPoint=function(a,b){this._isChanged&&l.systemTimer.runCallLater(this,this.typeset);for(var c=0,d=this._lines,e=0,k=0,n=d.length;k<n;k++){c+=d[k].length;if(a<c){var m=k;break}e=c}r.context.font=(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+this.font;c=this._getTextWidth(this._text.substring(e,a));return(b||new N).setTo(this._startX+c-(this._clipPoint?this._clipPoint.x:0),this._startY+m*(this._charSize.height+this.leading)-(this._clipPoint?this._clipPoint.y:0))};m(0,b,"width",function(){return this._width?this._width:this.textWidth+this.padding[1]+this.padding[3]},function(a){a!=this._width&&(l.superSet(P,this,"width",a),this.isChanged=!0,this.borderColor&&this._setBorderStyleColor(0,0,this.width,this.height,this.borderColor,1))});m(0,b,"textWidth",function(){this._isChanged&&l.systemTimer.runCallLater(this,this.typeset);return this._textWidth});m(0,b,"height",function(){return this._height?this._height:this.textHeight},function(a){a!=this._height&&(l.superSet(P,this,"height",a),this.isChanged=!0,this.borderColor&&this._setBorderStyleColor(0,0,this.width,this.height,this.borderColor,1))});m(0,b,"textHeight",function(){this._isChanged&&l.systemTimer.runCallLater(this,this.typeset);return this._textHeight});m(0,b,"padding",function(){return this._style.padding},function(a){if("string"==typeof a){a=a.split(",");var b,c;for(c=a.length;4>a.length;)a.push(0);for(b=0;b<c;b++)a[b]=parseFloat(a[b])||0}this._getTextStyle().padding=a;this.isChanged=!0});m(0,b,"bold",function(){return this._style.bold},function(a){this._getTextStyle().bold=a;this.isChanged=!0});m(0,b,"text",function(){return this._text||""},function(a){this._text!==a&&(this.lang(a+""),this.isChanged=!0,this.event("change"),this.borderColor&&this._setBorderStyleColor(0,0,this.width,this.height,this.borderColor,1))});m(0,b,"color",function(){return this._color},function(a){this._color!=a&&(this._color=a,!this._isChanged&&this._graphics?this._graphics.replaceTextColor(this.color):this.isChanged=!0)});m(0,b,"font",function(){return this._font},function(a){this._style.currBitmapFont&&(this._getTextStyle().currBitmapFont=null,this.scale(1,1));c._bitmapFonts&&c._bitmapFonts[a]&&(this._getTextStyle().currBitmapFont=c._bitmapFonts[a]);this._font=a;this.isChanged=!0});m(0,b,"fontSize",function(){return this._fontSize},function(a){this._fontSize!=a&&(this._fontSize=a,this.isChanged=!0)});m(0,b,"italic",function(){return this._style.italic},function(a){this._getTextStyle().italic=a;this.isChanged=!0});m(0,b,"align",function(){return this._style.align},function(a){this._getTextStyle().align=a;this.isChanged=!0});m(0,b,"valign",function(){return this._valign},function(a){this._valign=a;this.isChanged=!0});m(0,b,"wordWrap",function(){return this._style.wordWrap},function(a){this._getTextStyle().wordWrap=a;this.isChanged=!0});m(0,b,"singleCharRender",function(){return this._singleCharRender},function(a){this._singleCharRender=a});m(0,b,"leading",function(){return this._style.leading},function(a){this._getTextStyle().leading=a;this.isChanged=!0});m(0,b,"bgColor",function(){return this._style.bgColor},function(a){this._getTextStyle().bgColor=a;this._renderType|=128;this._setBgStyleColor(0,0,this.width,this.height,a);this._setRenderType(this._renderType);this.isChanged=!0});m(0,b,"borderColor",function(){return this._style.borderColor},function(a){this._getTextStyle().borderColor=a;this._renderType|=128;this._setBorderStyleColor(0,0,this.width,this.height,a,1);this._setRenderType(this._renderType);this.isChanged=!0});m(0,b,"stroke",function(){return this._style.stroke},function(a){this._getTextStyle().stroke=a;this.isChanged=!0});m(0,b,"strokeColor",function(){return this._style.strokeColor},function(a){this._getTextStyle().strokeColor=a;this.isChanged=!0});m(0,b,"isChanged",null,function(a){this._isChanged!==a&&(this._isChanged=a)&&l.systemTimer.callLater(this,this.typeset)});m(0,b,"scrollX",function(){return this._clipPoint?this._clipPoint.x:0},function(a){if("scroll"==this.overflow&&!(this.textWidth<this._width)&&this._clipPoint){a=a<this.padding[3]?this.padding[3]:a;var b=this._textWidth-this._width;this._clipPoint.x=a>b?b:a;this._renderText()}});m(0,b,"scrollY",function(){return this._clipPoint?this._clipPoint.y:0},function(a){if("scroll"==this.overflow&&!(this.textHeight<this._height)&&this._clipPoint){a=a<this.padding[0]?this.padding[0]:a;var b=this._textHeight-this._height;this._clipPoint.y=a>b?b:a;this._renderText()}});m(0,b,"maxScrollX",function(){return this.textWidth<this._width?0:this._textWidth-this._width});m(0,b,"maxScrollY",function(){return this.textHeight<this._height?0:this._textHeight-this._height});m(0,b,"lines",function(){this._isChanged&&this.typeset();return this._lines});m(0,b,"underlineColor",function(){return this._style.underlineColor},function(a){this._getTextStyle().underlineColor=a;this._isChanged||this._renderText()});m(0,b,"underline",function(){return this._style.underline},function(a){this._getTextStyle().underline=a});c.defaultFontStr=function(){return c.defaultFontSize+"px "+c.defaultFont};c.registerBitmapFont=function(a,b){c._bitmapFonts||(c._bitmapFonts={});c._bitmapFonts[a]=b};c.unregisterBitmapFont=function(a,b){void 0===b&&(b=!0);if(c._bitmapFonts&&c._bitmapFonts[a]){var d=c._bitmapFonts[a];b&&d.destroy();delete c._bitmapFonts[a]}};c.VISIBLE="visible";c.SCROLL="scroll";c.HIDDEN="hidden";c.defaultFontSize=12;c.defaultFont="Arial";c.langPacks=null;c.isComplexText=!1;c._testWord="\u6e38";c._bitmapFonts=null;c.CharacterCache=!0;c.RightToLeft=!1;t(c,["fontFamilyMap",function(){return this.fontFamilyMap={"\u62a5\u96b6":"\u62a5\u96b6-\u7b80","\u9ed1\u4f53":"\u9ed1\u4f53-\u7b80","\u6977\u4f53":"\u6977\u4f53-\u7b80","\u5170\u4ead\u9ed1":"\u5170\u4ead\u9ed1-\u7b80","\u96b6\u53d8":"\u96b6\u53d8-\u7b80","\u51cc\u6167\u4f53":"\u51cc\u6167\u4f53-\u7b80","\u7fe9\u7fe9\u4f53":"\u7fe9\u7fe9\u4f53-\u7b80","\u82f9\u65b9":"\u82f9\u65b9-\u7b80","\u624b\u672d\u4f53":"\u624b\u672d\u4f53-\u7b80","\u5b8b\u4f53":"\u5b8b\u4f53-\u7b80","\u5a03\u5a03\u4f53":"\u5a03\u5a03\u4f53-\u7b80","\u9b4f\u7891":"\u9b4f\u7891-\u7b80","\u884c\u6977":"\u884c\u6977-\u7b80","\u96c5\u75de":"\u96c5\u75de-\u7b80","\u5706\u4f53":"\u5706\u4f53-\u7b80"}}]);return c}(P),Bb=function(a){function c(){this.loop=!1;this._count=this._index=this.wrapMode=0;this._isPlaying=!1;this._labels=null;this._frameRateChanged=this._isReverse=!1;this._controlNode=this._actionName=null;c.__super.call(this);this._interval=da.animationInterval;this._setBitUp(16)}p(c,"laya.display.AnimationBase",a);var b=c.prototype;b.play=function(a,b,c){void 0===a&&(a=0);void 0===b&&(b=!0);void 0===c&&(c="");this._isPlaying=!0;this._actionName=c;this.index="string"==typeof a?this._getFrameByLabel(a):a;this.loop=b;this._isReverse=1===this.wrapMode;0==this.index&&this._isReverse&&(this.index=this.count-1);0<this.interval&&this.timerLoop(this.interval,this,this._frameLoop,null,!0,!0)};b._getFrameByLabel=function(a){for(var b=0;b<this._count;b++){var c=this._labels[b];if(c&&-1<c.indexOf(a))return b}return 0};b._frameLoop=function(){if(this._isReverse){if(this._index--,0>this._index)if(this.loop)2==this.wrapMode?(this._index=0<this._count?1:0,this._isReverse=!1):this._index=this._count-1,this.event("complete");else{this._index=0;this.stop();this.event("complete");return}}else if(this._index++,this._index>=this._count)if(this.loop)2==this.wrapMode?(this._index=0<=this._count-2?this._count-2:0,this._isReverse=!0):this._index=0,this.event("complete");else{this._index--;this.stop();this.event("complete");return}this.index=this._index};b._setControlNode=function(a){this._controlNode&&(this._controlNode.off("display",this,this._resumePlay),this._controlNode.off("undisplay",this,this._resumePlay));(this._controlNode=a)&&a!=this&&(a.on("display",this,this._resumePlay),a.on("undisplay",this,this._resumePlay))};b._setDisplay=function(b){a.prototype._setDisplay.call(this,b);this._resumePlay()};b._resumePlay=function(){this._isPlaying&&(this._controlNode.displayedInStage?this.play(this._index,this.loop,this._actionName):this.clearTimer(this,this._frameLoop))};b.stop=function(){this._isPlaying=!1;this.clearTimer(this,this._frameLoop)};b.addLabel=function(a,b){this._labels||(this._labels={});this._labels[b]||(this._labels[b]=[]);this._labels[b].push(a)};b.removeLabel=function(a){if(!a)this._labels=null;else if(this._labels)for(var b in this._labels)this._removeLabelFromList(this._labels[b],a)};b._removeLabelFromList=function(a,b){if(a)for(var c=a.length-1;0<=c;c--)a[c]==b&&a.splice(c,1)};b.gotoAndStop=function(a){this.index="string"==typeof a?this._getFrameByLabel(a):a;this.stop()};b._displayToIndex=function(a){};b.clear=function(){this.stop();this._labels=null;return this};m(0,b,"interval",function(){return this._interval},function(a){this._interval!=a&&(this._frameRateChanged=!0,this._interval=a,this._isPlaying&&0<a&&this.timerLoop(a,this,this._frameLoop,null,!0,!0))});m(0,b,"isPlaying",function(){return this._isPlaying});m(0,b,"index",function(){return this._index},function(a){this._index=a;this._displayToIndex(a);if(this._labels&&this._labels[a]){a=this._labels[a];for(var b=0,c=a.length;b<c;b++)this.event("label",a[b])}});m(0,b,"count",function(){return this._count});c.WRAP_POSITIVE=0;c.WRAP_REVERSE=1;c.WRAP_PINGPONG=2;return c}(P),ka=function(a){function c(a,d,e,f,g){this._attribInfo=null;this.customCompile=!1;this._curActTexIndex=0;this.tag={};this._params=this._program=null;this._paramsMap={};c.__super.call(this);if(!a||!d)throw"Shader Error";this._attribInfo=g;this._id=++c._count;this._vs=a;this._ps=d;this._nameMap=f?f:{};null!=e&&(c.sharders[e]=this);this.recreateResource();this.lock=!0}p(c,"laya.webgl.shader.Shader",a);a=c.prototype;a.recreateResource=function(){this._compile();this._setGPUMemory(0)};a._disposeResource=function(){E.mainContext.deleteShader(this._vshader);E.mainContext.deleteShader(this._pshader);E.mainContext.deleteProgram(this._program);this._params=this._vshader=this._pshader=this._program=null;this._paramsMap={};this._setGPUMemory(0);this._curActTexIndex=0};a._compile=function(){if(this._vs&&this._ps&&!this._params){this._reCompile=!0;this._params=[];var a;this.customCompile&&(a=Ba.preGetParams(this._vs,this._ps));var d=E.mainContext;this._program=d.createProgram();this._vshader=c._createShader(d,this._vs,35633);this._pshader=c._createShader(d,this._ps,35632);d.attachShader(this._program,this._vshader);d.attachShader(this._program,this._pshader);var e,f,g=this._attribInfo?this._attribInfo.length:0;for(f=0;f<g;f+=2)d.bindAttribLocation(this._program,this._attribInfo[f+1],this._attribInfo[f]);d.linkProgram(this._program);if(!this.customCompile&&!d.getProgramParameter(this._program,35714))throw d.getProgramInfoLog(this._program);g=this.customCompile?a.uniforms.length:d.getProgramParameter(this._program,35718);for(f=0;f<g;f++){var h=this.customCompile?a.uniforms[f]:d.getActiveUniform(this._program,f);e=d.getUniformLocation(this._program,h.name);e={vartype:"uniform",glfun:null,ivartype:1,location:e,name:h.name,type:h.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0};0<e.name.indexOf("[0]")&&(e.name=e.name.substr(0,e.name.length-3),e.isArray=!0,e.location=d.getUniformLocation(this._program,e.name));this._params.push(e)}f=0;for(a=this._params.length;f<a;f++)switch(e=this._params[f],e.indexOfParams=f,e.index=1,e.value=[e.location,null],e.codename=e.name,e.name=this._nameMap[e.codename]?this._nameMap[e.codename]:e.codename,this._paramsMap[e.name]=e,e._this=this,e.uploadedValue=[],e.type){case 5124:e.fun=e.isArray?this._uniform1iv:this._uniform1i;break;case 5126:e.fun=e.isArray?this._uniform1fv:this._uniform1f;break;case 35664:e.fun=e.isArray?this._uniform_vec2v:this._uniform_vec2;break;case 35665:e.fun=e.isArray?this._uniform_vec3v:this._uniform_vec3;break;case 35666:e.fun=e.isArray?this._uniform_vec4v:this._uniform_vec4;break;case 35678:e.fun=this._uniform_sampler2D;break;case 35680:e.fun=this._uniform_samplerCube;break;case 35676:e.glfun=d.uniformMatrix4fv;e.fun=this._uniformMatrix4fv;break;case 35670:e.fun=this._uniform1i;break;case 35674:case 35675:throw Error("compile shader err!");default:throw Error("compile shader err!");}}};a.getUniform=function(a){return this._paramsMap[a]};a._uniform1f=function(a,c){var b=a.uploadedValue;return b[0]!==c?(E.mainContext.uniform1f(a.location,b[0]=c),1):0};a._uniform1fv=function(a,c){if(4>c.length){var b=a.uploadedValue;return b[0]!==c[0]||b[1]!==c[1]||b[2]!==c[2]||b[3]!==c[3]?(E.mainContext.uniform1fv(a.location,c),b[0]=c[0],b[1]=c[1],b[2]=c[2],b[3]=c[3],1):0}E.mainContext.uniform1fv(a.location,c);return 1};a._uniform_vec2=function(a,c){var b=a.uploadedValue;return b[0]!==c[0]||b[1]!==c[1]?(E.mainContext.uniform2f(a.location,b[0]=c[0],b[1]=c[1]),1):0};a._uniform_vec2v=function(a,c){if(2>c.length){var b=a.uploadedValue;return b[0]!==c[0]||b[1]!==c[1]||b[2]!==c[2]||b[3]!==c[3]?(E.mainContext.uniform2fv(a.location,c),b[0]=c[0],b[1]=c[1],b[2]=c[2],b[3]=c[3],1):0}E.mainContext.uniform2fv(a.location,c);return 1};a._uniform_vec3=function(a,c){var b=a.uploadedValue;return b[0]!==c[0]||b[1]!==c[1]||b[2]!==c[2]?(E.mainContext.uniform3f(a.location,b[0]=c[0],b[1]=c[1],b[2]=c[2]),1):0};a._uniform_vec3v=function(a,c){E.mainContext.uniform3fv(a.location,c);return 1};a._uniform_vec4=function(a,c){var b=a.uploadedValue;return b[0]!==c[0]||b[1]!==c[1]||b[2]!==c[2]||b[3]!==c[3]?(E.mainContext.uniform4f(a.location,b[0]=c[0],b[1]=c[1],b[2]=c[2],b[3]=c[3]),1):0};a._uniform_vec4v=function(a,c){E.mainContext.uniform4fv(a.location,c);return 1};a._uniformMatrix2fv=function(a,c){E.mainContext.uniformMatrix2fv(a.location,!1,c);return 1};a._uniformMatrix3fv=function(a,c){E.mainContext.uniformMatrix3fv(a.location,!1,c);return 1};a._uniformMatrix4fv=function(a,c){E.mainContext.uniformMatrix4fv(a.location,!1,c);return 1};a._uniform1i=function(a,c){var b=a.uploadedValue;return b[0]!==c?(E.mainContext.uniform1i(a.location,b[0]=c),1):0};a._uniform1iv=function(a,c){E.mainContext.uniform1iv(a.location,c);return 1};a._uniform_ivec2=function(a,c){var b=a.uploadedValue;return b[0]!==c[0]||b[1]!==c[1]?(E.mainContext.uniform2i(a.location,b[0]=c[0],b[1]=c[1]),1):0};a._uniform_ivec2v=function(a,c){E.mainContext.uniform2iv(a.location,c);return 1};a._uniform_vec3i=function(a,c){var b=a.uploadedValue;return b[0]!==c[0]||b[1]!==c[1]||b[2]!==c[2]?(E.mainContext.uniform3i(a.location,b[0]=c[0],b[1]=c[1],b[2]=c[2]),1):0};a._uniform_vec3vi=function(a,c){E.mainContext.uniform3iv(a.location,c);return 1};a._uniform_vec4i=function(a,c){var b=a.uploadedValue;return b[0]!==c[0]||b[1]!==c[1]||b[2]!==c[2]||b[3]!==c[3]?(E.mainContext.uniform4i(a.location,b[0]=c[0],b[1]=c[1],b[2]=c[2],b[3]=c[3]),1):0};a._uniform_vec4vi=function(a,c){E.mainContext.uniform4iv(a.location,c);return 1};a._uniform_sampler2D=function(a,c){var b=E.mainContext,d=a.uploadedValue;if(null==d[0])return d[0]=this._curActTexIndex,b.uniform1i(a.location,this._curActTexIndex),C.activeTexture(b,33984+this._curActTexIndex),C.bindTexture(b,3553,c),this._curActTexIndex++,1;C.activeTexture(b,33984+d[0]);C.bindTexture(b,3553,c);return 0};a._uniform_samplerCube=function(a,c){var b=E.mainContext,d=a.uploadedValue;if(null==d[0])return d[0]=this._curActTexIndex,b.uniform1i(a.location,this._curActTexIndex),C.activeTexture(b,33984+this._curActTexIndex),C.bindTexture(b,34067,c),this._curActTexIndex++,1;C.activeTexture(b,33984+d[0]);C.bindTexture(b,34067,c);return 0};a._noSetValue=function(a){console.log("no....:"+a.name)};a.uploadOne=function(a,c){C.useProgram(E.mainContext,this._program);var b=this._paramsMap[a];b.fun.call(this,b,c)};a.uploadTexture2D=function(a){var b=C;b._activeTextures[0]!==a&&(b.bindTexture(E.mainContext,b.TEXTURE_2D,a),b._activeTextures[0]=a)};a.upload=function(a,c){aa.activeShader=aa.bindShader=this;C.useProgram(E.mainContext,this._program);this._reCompile?(c=this._params,this._reCompile=!1):c=c||this._params;for(var b,d,g=c.length,h=0,k=0;k<g;k++)b=c[k],null!==(d=a[b.name])&&(h+=b.fun.call(this,b,d));J.shaderCall+=h};a.uploadArray=function(a,c,e){aa.activeShader=this;aa.bindShader=this;C.useProgram(E.mainContext,this._program);for(var b,d=0,h=c-2;0<=h;h-=2)if(b=this._paramsMap[a[h]])c=a[h+1],null!=c&&(e&&e[b.name]&&e[b.name].bind(),d+=b.fun.call(this,b,c));J.shaderCall+=d};a.getParams=function(){return this._params};a.setAttributesLocation=function(a){this._attribInfo=a};c.getShader=function(a){return c.sharders[a]};c.create=function(a,d,e,f,g){return new c(a,d,e,f,g)};c.withCompile=function(a,d,e,f){if(e&&c.sharders[e])return c.sharders[e];var b=c._preCompileShader[2E-4*a];if(!b)throw Error("withCompile shader err!"+a);return b.createShader(d,e,f,null)};c.withCompile2D=function(a,d,e,f,g,h){if(f&&c.sharders[f])return c.sharders[f];var b=c._preCompileShader[2E-4*a+d];if(!b)throw Error("withCompile shader err!"+a+" "+d);return b.createShader(e,f,g,h)};c.addInclude=function(a,c){Ba.addInclude(a,c)};c.preCompile=function(a,d,e,f){c._preCompileShader[2E-4*a]=new Ba(d,e,f)};c.preCompile2D=function(a,d,e,f,g){c._preCompileShader[2E-4*a+d]=new Ba(e,f,g)};c._createShader=function(a,c,e){e=a.createShader(e);a.shaderSource(e,c);a.compileShader(e);if(a.getShaderParameter(e,35713))return e;console.log(a.getShaderInfoLog(e));return null};c._count=0;c._preCompileShader={};c.SHADERNAME2ID=2E-4;c.sharders=Array(32);t(c,["nameKey",function(){return this.nameKey=new wc}]);return c}(aa);(function(a){function c(){this._stopEvents=this._playEvents=this._tar=this._channel=this.url=null;c.__super.call(this);this.visible=!1;this.on("added",this,this._onParentChange);this.on("removed",this,this._onParentChange)}p(c,"laya.media.SoundNode",a);a=c.prototype;a._onParentChange=function(){this.target=this.parent};a.play=function(a,c){void 0===a&&(a=1);isNaN(a)&&(a=1);this.url&&(this.stop(),this._channel=Q.playSound(this.url,a,c))};a.stop=function(){this._channel&&!this._channel.isStopped&&this._channel.stop();this._channel=null};a._setPlayAction=function(a,c,e,f){void 0===f&&(f=!0);if(this[e]&&a)if(f)a.on(c,this,this[e]);else a.off(c,this,this[e])};a._setPlayActions=function(a,c,e,f){void 0===f&&(f=!0);if(a&&c){c=c.split(",");var b,d;d=c.length;for(b=0;b<d;b++)this._setPlayAction(a,c[b],e,f)}};m(0,a,"playEvent",null,function(a){(this._playEvents=a)&&this._tar&&this._setPlayActions(this._tar,a,"play")});m(0,a,"target",null,function(a){this._tar&&(this._setPlayActions(this._tar,this._playEvents,"play",!1),this._setPlayActions(this._tar,this._stopEvents,"stop",!1));if(this._tar=a)this._setPlayActions(this._tar,this._playEvents,"play",!0),this._setPlayActions(this._tar,this._stopEvents,"stop",!0)});m(0,a,"stopEvent",null,function(a){(this._stopEvents=a)&&this._tar&&this._setPlayActions(this._tar,a,"stop")});return c})(P);var Cb=function(a){function c(a,d){c.__super.call(this);this._wrapModeV=this._wrapModeU=0;this._filterMode=1;this._readyed=!1;this._height=this._width=-1;this._format=a;this._mipmap=d;this._anisoLevel=1;this._glTexture=y.instance.createTexture()}p(c,"laya.resource.BaseTexture",a);a=c.prototype;a._isPot=function(a){return 0===(a&a-1)};a._getGLFormat=function(){var a;switch(this._format){case 0:a=6407;break;case 1:a=6408;break;case 2:a=6406;break;case 3:if(C._compressedTextureS3tc)a=C._compressedTextureS3tc.COMPRESSED_RGB_S3TC_DXT1_EXT;else throw"BaseTexture: not support DXT1 format.";break;case 4:if(C._compressedTextureS3tc)a=C._compressedTextureS3tc.COMPRESSED_RGBA_S3TC_DXT5_EXT;else throw"BaseTexture: not support DXT5 format.";break;case 5:if(C._compressedTextureEtc1)a=C._compressedTextureEtc1.COMPRESSED_RGB_ETC1_WEBGL;else throw"BaseTexture: not support ETC1RGB format.";break;case 9:if(C._compressedTexturePvrtc)a=C._compressedTexturePvrtc.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;else throw"BaseTexture: not support PVRTCRGB_2BPPV format.";break;case 10:if(C._compressedTexturePvrtc)a=C._compressedTexturePvrtc.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG;else throw"BaseTexture: not support PVRTCRGBA_2BPPV format.";break;case 11:if(C._compressedTexturePvrtc)a=C._compressedTexturePvrtc.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;else throw"BaseTexture: not support PVRTCRGB_4BPPV format.";break;case 12:if(C._compressedTexturePvrtc)a=C._compressedTexturePvrtc.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;else throw"BaseTexture: not support PVRTCRGBA_4BPPV format.";break;default:throw"BaseTexture: unknown texture format.";}return a};a._setFilterMode=function(a){var b=y.instance;C.bindTexture(b,this._glTextureType,this._glTexture);switch(a){case 0:this._mipmap?b.texParameteri(this._glTextureType,10241,9984):b.texParameteri(this._glTextureType,10241,9728);b.texParameteri(this._glTextureType,10240,9728);break;case 1:this._mipmap?b.texParameteri(this._glTextureType,10241,9985):b.texParameteri(this._glTextureType,10241,9729);b.texParameteri(this._glTextureType,10240,9729);break;case 2:this._mipmap?b.texParameteri(this._glTextureType,10241,9987):b.texParameteri(this._glTextureType,10241,9729);b.texParameteri(this._glTextureType,10240,9729);break;default:throw Error("BaseTexture:unknown filterMode value.");}};a._setWarpMode=function(a,c){var b=y.instance;C.bindTexture(b,this._glTextureType,this._glTexture);if(this._isPot(this._width)&&this._isPot(this._height))switch(c){case 0:b.texParameteri(this._glTextureType,a,10497);break;case 1:b.texParameteri(this._glTextureType,a,33071)}else b.texParameteri(this._glTextureType,a,33071)};a._setAnisotropy=function(a){var b=C._extTextureFilterAnisotropic;if(b&&!r.onLimixiu){a=Math.max(a,1);var c=y.instance;C.bindTexture(c,this._glTextureType,this._glTexture);a=Math.min(c.getParameter(b.MAX_TEXTURE_MAX_ANISOTROPY_EXT),a);c.texParameterf(this._glTextureType,b.TEXTURE_MAX_ANISOTROPY_EXT,a)}};a._disposeResource=function(){this._glTexture&&(y.instance.deleteTexture(this._glTexture),this._glTexture=null,this._setGPUMemory(0))};a._getSource=function(){return this._readyed?this._glTexture:null};a.generateMipmap=function(){this._isPot(this.width)&&this._isPot(this.height)&&y.instance.generateMipmap(this._glTextureType)};m(0,a,"wrapModeU",function(){return this._wrapModeU},function(a){this._wrapModeU!==a&&(this._wrapModeU=a,-1!==this._width&&this._setWarpMode(10242,a))});m(0,a,"mipmap",function(){return this._mipmap});m(0,a,"format",function(){return this._format});m(0,a,"wrapModeV",function(){return this._wrapModeV},function(a){this._wrapModeV!==a&&(this._wrapModeV=a,-1!==this._height&&this._setWarpMode(10243,a))});m(0,a,"defaulteTexture",function(){throw"BaseTexture:must override it.";});m(0,a,"filterMode",function(){return this._filterMode},function(a){a!==this._filterMode&&(this._filterMode=a,-1!==this._width&&-1!==this._height&&this._setFilterMode(a))});m(0,a,"anisoLevel",function(){return this._anisoLevel},function(a){a!==this._anisoLevel&&(this._anisoLevel=Math.max(1,Math.min(16,a)),-1!==this._width&&-1!==this._height&&this._setAnisotropy(a))});c.WARPMODE_REPEAT=0;c.WARPMODE_CLAMP=1;c.FILTERMODE_POINT=0;c.FILTERMODE_BILINEAR=1;c.FILTERMODE_TRILINEAR=2;c.FORMAT_R8G8B8=0;c.FORMAT_R8G8B8A8=1;c.FORMAT_ALPHA8=2;c.FORMAT_DXT1=3;c.FORMAT_DXT5=4;c.FORMAT_ETC1RGB=5;c.FORMAT_PVRTCRGB_2BPPV=9;c.FORMAT_PVRTCRGBA_2BPPV=10;c.FORMAT_PVRTCRGB_4BPPV=11;c.FORMAT_PVRTCRGBA_4BPPV=12;c.FORMAT_DEPTH_16=0;c.FORMAT_STENCIL_8=1;c.FORMAT_DEPTHSTENCIL_16_8=2;c.FORMAT_DEPTHSTENCIL_NONE=3;return c}(bb),ea=function(a){function c(a){c.__super.call(this);void 0===a&&(a=!1);this._source=a?r.createElement("canvas"):this;this.lock=!0}p(c,"laya.resource.HTMLCanvas",a);a=c.prototype;a._getSource=function(){return this._source};a.clear=function(){this._ctx&&this._ctx.clear&&this._ctx.clear();this._texture&&(this._texture.destroy(),this._texture=null)};a.destroy=function(){laya.resource.Resource.prototype.destroy.call(this);this._setCPUMemory(0);this._ctx&&this._ctx.destroy();this._ctx=null};a.release=function(){};a._setContext=function(a){this._ctx=a};a.getContext=function(a,c){return this.context};a.getMemSize=function(){return 0};a.size=function(a,c){if(this._width!=a||this._height!=c||this._source&&(this._source.width!=a||this._source.height!=c))this._width=a,this._height=c,this._setCPUMemory(a*c*4),this._ctx&&this._ctx.size&&this._ctx.size(a,c),this._source&&(this._source.height=c,this._source.width=a),this._texture&&(this._texture.destroy(),this._texture=null)};a.getTexture=function(){if(!this._texture){var a=new pa;a.loadImageSource(this.source);this._texture=new X(a)}return this._texture};a.toBase64=function(a,c){if(this._source){if(v.isConchApp){if(2==conchConfig.threadMode)throw"native 2 thread mode use toBase64Async";var b=this._ctx._targets.sourceWidth,d=this._ctx._targets.sourceHeight,g=this._ctx._targets.getData(0,0,b,d);return conchToBase64FlipY?conchToBase64FlipY(a,c,g.buffer,b,d):conchToBase64(a,c,g.buffer,b,d)}return this._source.toDataURL(a,c)}return null};a.toBase64Async=function(a,c,e){var b=this._ctx._targets.sourceWidth,d=this._ctx._targets.sourceHeight;this._ctx._targets.getDataAsync(0,0,b,d,function(f){f=conchToBase64FlipY?conchToBase64FlipY(a,c,f.buffer,b,d):conchToBase64(a,c,f.buffer,b,d);e(f)})};m(0,a,"source",function(){return this._source});m(0,a,"context",function(){if(this._ctx)return this._ctx;this._ctx=this._source==this?new V:this._source.getContext(v.isConchApp?"layagl":"2d");this._ctx._canvas=this;return this._ctx});return c}(bb);(function(a){function c(){c.__super.call(this)}p(c,"laya.resource.HTMLImage",a);c.create=function(a,c,e){a=new pa(a,c,e,!1,!1);a.wrapModeU=1;a.wrapModeV=1;return a};return c})(bb);var Ha=function(a){function c(){this.focus=null;this._frameRate="fast";this.designHeight=this.designWidth=0;this.canvasRotation=!1;this.canvasDegree=0;this.screenAdaptationEnabled=this.renderingEnabled=!0;this._screenMode="none";this._scaleMode="noscale";this._alignV="top";this._alignH="left";this._bgColor="black";this._frameStartTime=this._safariOffsetY=this._renderCount=this._mouseMoveTime=0;this._isVisibility=this._isFocused=!1;this._wgColor=[0,0,0,1];this._scene3Ds=[];this._globalRepaintGet=this._globalRepaintSet=!1;this._curUIBase=null;this.useRetinalCanvas=!1;c.__super.call(this);this.offset=new N;this._canvasTransform=new I;this._previousOrientation=r.window.orientation;this._3dUI=[];var a=this;this.transform=this._createTransform();this.hitTestPrior=this.mouseEnabled=!0;this.autoSize=!1;this._setBit(128,!0);this._setBit(2,!0);this._isVisibility=this._isFocused=!0;this.useRetinalCanvas=da.useRetinalCanvas;var b=r.window,f=this;b.addEventListener("focus",function(){a._isFocused=!0;f.event("focus");f.event("focuschange")});b.addEventListener("blur",function(){a._isFocused=!1;f.event("blur");f.event("focuschange");f._isInputting()&&(ia.inputElement.target.focus=!1)});var g="visibilityState",h="visibilitychange",k=b.document;"undefined"!==typeof k.hidden?(h="visibilitychange",g="visibilityState"):"undefined"!==typeof k.mozHidden?(h="mozvisibilitychange",g="mozVisibilityState"):"undefined"!==typeof k.msHidden?(h="msvisibilitychange",g="msVisibilityState"):"undefined"!==typeof k.webkitHidden&&(h="webkitvisibilitychange",g="webkitVisibilityState");b.document.addEventListener(h,function(){"hidden"==r.document[g]?(a._isVisibility=!1,f._isInputting()&&(ia.inputElement.target.focus=!1)):a._isVisibility=!0;a.renderingEnabled=a._isVisibility;f.event("visibilitychange")});b.addEventListener("resize",function(){var b=r.window.orientation;null!=b&&b!=a._previousOrientation&&f._isInputting()&&(ia.inputElement.target.focus=!1);a._previousOrientation=b;f._isInputting()||(r.onSafari&&(f._safariOffsetY=(r.window.__innerHeight||r.document.body.clientHeight||r.document.documentElement.clientHeight)-r.window.innerHeight),f._resetCanvas())});b.addEventListener("orientationchange",function(a){f._resetCanvas()});this.on("mousemove",this,this._onmouseMove);if(r.onMobile)this.on("mousedown",this,this._onmouseMove)}p(c,"laya.display.Stage",a);var b=c.prototype;b._isInputting=function(){return r.onMobile&&ia.isInputting};b._changeCanvasSize=function(){this.setScreenSize(r.clientWidth*r.pixelRatio,r.clientHeight*r.pixelRatio)};b._resetCanvas=function(){this.screenAdaptationEnabled&&this._changeCanvasSize()};b.setScreenSize=function(a,b){var c=!1;if("none"!==this._screenMode&&(c=(1>a/b?"vertical":"horizontal")!==this._screenMode)){var d=b;b=a;a=d}this.canvasRotation=c;var d=v._mainCanvas,e=d.source.style,k=this._canvasTransform.identity(),l=this._scaleMode,m=a/this.designWidth,p=b/this.designHeight,t=this.useRetinalCanvas?a:this.designWidth,w=this.useRetinalCanvas?b:this.designHeight,x=a,y=b,z=r.pixelRatio;this._width=this.designWidth;this._height=this.designHeight;switch(l){case "noscale":m=p=1;x=this.designWidth;y=this.designHeight;break;case "showall":m=p=Math.min(m,p);t=x=Math.round(this.designWidth*m);w=y=Math.round(this.designHeight*p);break;case "noborder":m=p=Math.max(m,p);x=Math.round(this.designWidth*m);y=Math.round(this.designHeight*p);break;case "full":m=p=1;this._width=t=a;this._height=w=b;break;case "fixedwidth":p=m;this._height=w=Math.round(b/m);break;case "fixedheight":m=p;this._width=t=Math.round(a/p);break;case "fixedauto":a/b<this.designWidth/this.designHeight?(p=m,this._height=w=Math.round(b/m)):(m=p,this._width=t=Math.round(a/p))}this.useRetinalCanvas&&(t=a,w=b);m*=this.scaleX;p*=this.scaleY;1===m&&1===p?this.transform.identity():(this.transform.a=this._formatData(m/(x/t)),this.transform.d=this._formatData(p/(y/w)));d.size(t,w);Z.changeWebGLSize(t,w);k.scale(x/t/z,y/w/z);this.offset.x="left"===this._alignH?0:"right"===this._alignH?a-x:.5*(a-x)/z;this.offset.y="top"===this._alignV?0:"bottom"===this._alignV?b-y:.5*(b-y)/z;this.offset.x=Math.round(this.offset.x);this.offset.y=Math.round(this.offset.y);k.translate(this.offset.x,this.offset.y);this._safariOffsetY&&k.translate(0,this._safariOffsetY);this.canvasDegree=0;c&&("horizontal"===this._screenMode?(k.rotate(Math.PI/2),k.translate(b/z,0),this.canvasDegree=90):(k.rotate(-Math.PI/2),k.translate(0,a/z),this.canvasDegree=-90));k.a=this._formatData(k.a);k.d=this._formatData(k.d);k.tx=this._formatData(k.tx);k.ty=this._formatData(k.ty);this.transform=this.transform;e.transformOrigin=e.webkitTransformOrigin=e.msTransformOrigin=e.mozTransformOrigin=e.oTransformOrigin="0px 0px 0px";e.transform=e.webkitTransform=e.msTransform=e.mozTransform=e.oTransform="matrix("+k.toString()+")";this._safariOffsetY&&k.translate(0,-this._safariOffsetY);k.translate(parseInt(e.left)||0,parseInt(e.top)||0);this.visible=!0;this._repaint|=2;this.event("resize")};b._formatData=function(a){return 1E-6>Math.abs(a)?0:.001>Math.abs(1-a)?0<a?1:-1:a};b.getMousePoint=function(){return N.TEMP.setTo(this.mouseX,this.mouseY)};b.repaint=function(a){void 0===a&&(a=2);this._repaint|=a};b.parentRepaint=function(a){};b._loop=function(){this._globalRepaintGet=this._globalRepaintSet;this._globalRepaintSet=!1;this.render(v._context,0,0);return!0};b.getFrameTm=function(){return this._frameStartTime};b._onmouseMove=function(a){this._mouseMoveTime=r.now()};b.getTimeFromFrameStart=function(){return r.now()-this._frameStartTime};b.render=function(b,e,f){c._dbgSprite.graphics.clear();if("sleep"===this._frameRate){var d=r.now();if(1E3<=d-this._frameStartTime)this._frameStartTime=d;else return}else{if(!this._visible){this._renderCount++;0===this._renderCount%5&&(oa.I._update(),J.loopCount++,this._updateTimers());return}this._frameStartTime=r.now()}this._renderCount++;var d="slow"!==("mouse"===this._frameRate?2E3>this._frameStartTime-this._mouseMoveTime?"fast":"slow":this._frameRate),h=0===this._renderCount%2;J.renderSlow=!d;if(d||h)if(oa.I._update(),J.loopCount++,this.renderingEnabled){for(var k=0,l=this._scene3Ds.length;k<l;k++)this._scene3Ds[k]._update();b.clear();a.prototype.render.call(this,b,e,f);J._show&&J._sp&&J._sp.render(b,e,f)}c._dbgSprite.render(b,0,0);if(d||!h)this.renderingEnabled&&(Z.clear(this._bgColor),b.flush(),za.instance&&za.getInstance().endDispose()),this._updateTimers()};b.renderToNative=function(b,c,f){this._renderCount++;if(this._visible){oa.I._update();J.loopCount++;if(this.renderingEnabled){for(var d=0,e=this._scene3Ds.length;d<e;d++)this._scene3Ds[d]._update();b.clear();a.prototype.render.call(this,b,c,f);J._show&&J._sp&&J._sp.render(b,c,f)}this.renderingEnabled&&(Z.clear(this._bgColor),b.flush(),za.instance&&za.getInstance().endDispose());this._updateTimers()}else 0===this._renderCount%5&&(oa.I._update(),J.loopCount++,this._updateTimers())};b._updateTimers=function(){l.systemTimer._update();l.startTimer._update();l.physicsTimer._update();l.updateTimer._update();l.lateTimer._update();l.timer._update()};b._requestFullscreen=function(){var a=r.document.documentElement;a.requestFullscreen?a.requestFullscreen():a.mozRequestFullScreen?a.mozRequestFullScreen():a.webkitRequestFullscreen?a.webkitRequestFullscreen():a.msRequestFullscreen&&a.msRequestFullscreen()};b._fullScreenChanged=function(){l.stage.event("fullscreenchange")};b.exitFullscreen=function(){var a=r.document;a.exitFullscreen?a.exitFullscreen():a.mozCancelFullScreen?a.mozCancelFullScreen():a.webkitExitFullscreen&&a.webkitExitFullscreen()};b.isGlobalRepaint=function(){return this._globalRepaintGet};b.setGlobalRepaint=function(){this._globalRepaintSet=!0};b.add3DUI=function(a){a=a.rootView;0<=this._3dUI.indexOf(a)||this._3dUI.push(a)};b.remove3DUI=function(a){a=this._3dUI.indexOf(a.rootView);return 0<=a?(this._3dUI.splice(a,1),!0):!1};m(0,b,"clientScaleY",function(){return this._transform?this._transform.getScaleY():1});m(0,b,"width",a.prototype._$get_width,function(a){this.designWidth=a;l.superSet(P,this,"width",a);l.systemTimer.callLater(this,this._changeCanvasSize)});m(0,b,"isFocused",function(){return this._isFocused});m(0,b,"alignH",function(){return this._alignH},function(a){this._alignH=a;l.systemTimer.callLater(this,this._changeCanvasSize)});m(0,b,"height",a.prototype._$get_height,function(a){this.designHeight=a;l.superSet(P,this,"height",a);l.systemTimer.callLater(this,this._changeCanvasSize)});m(0,b,"transform",function(){this._tfChanged&&this._adjustTransform();return this._transform=this._transform||this._createTransform()},a.prototype._$set_transform);m(0,b,"isVisibility",function(){return this._isVisibility});m(0,b,"scaleMode",function(){return this._scaleMode},function(a){this._scaleMode=a;l.systemTimer.callLater(this,this._changeCanvasSize)});m(0,b,"alignV",function(){return this._alignV},function(a){this._alignV=a;l.systemTimer.callLater(this,this._changeCanvasSize)});m(0,b,"bgColor",function(){return this._bgColor},function(a){this._wgColor=(this._bgColor=a)?x.create(a).arrColor:null;r.onLimixiu?this._wgColor=x.create(a).arrColor:v.canvas.style.background=a?a:"none"});m(0,b,"mouseX",function(){return Math.round(ha.instance.mouseX/this.clientScaleX)});m(0,b,"mouseY",function(){return Math.round(ha.instance.mouseY/this.clientScaleY)});m(0,b,"clientScaleX",function(){return this._transform?this._transform.getScaleX():1});m(0,b,"screenMode",function(){return this._screenMode},function(a){this._screenMode=a});m(0,b,"visible",a.prototype._$get_visible,function(a){this.visible!==a&&(l.superSet(P,this,"visible",a),v._mainCanvas.source.style.visibility=a?"visible":"hidden")});m(0,b,"fullScreenEnabled",null,function(a){var b=r.document,c=v.canvas;a?(c.addEventListener("mousedown",this._requestFullscreen),c.addEventListener("touchstart",this._requestFullscreen),b.addEventListener("fullscreenchange",this._fullScreenChanged),b.addEventListener("mozfullscreenchange",this._fullScreenChanged),b.addEventListener("webkitfullscreenchange",this._fullScreenChanged),b.addEventListener("msfullscreenchange",this._fullScreenChanged)):(c.removeEventListener("mousedown",this._requestFullscreen),c.removeEventListener("touchstart",this._requestFullscreen),b.removeEventListener("fullscreenchange",this._fullScreenChanged),b.removeEventListener("mozfullscreenchange",this._fullScreenChanged),b.removeEventListener("webkitfullscreenchange",this._fullScreenChanged),b.removeEventListener("msfullscreenchange",this._fullScreenChanged))});m(0,b,"frameRate",function(){return v.isConchApp?this._frameRateNative:this._frameRate},function(a){if(v.isConchApp){switch(a){case "fast":G.conch.config.setLimitFPS(60);break;case "mouse":G.conch.config.setMouseFrame(2E3);break;case "slow":G.conch.config.setSlowFrame(!0);break;case "sleep":G.conch.config.setLimitFPS(1)}this._frameRateNative=a}else this._frameRate=a});c.SCALE_NOSCALE="noscale";c.SCALE_EXACTFIT="exactfit";c.SCALE_SHOWALL="showall";c.SCALE_NOBORDER="noborder";c.SCALE_FULL="full";c.SCALE_FIXED_WIDTH="fixedwidth";c.SCALE_FIXED_HEIGHT="fixedheight";c.SCALE_FIXED_AUTO="fixedauto";c.ALIGN_LEFT="left";c.ALIGN_RIGHT="right";c.ALIGN_CENTER="center";c.ALIGN_TOP="top";c.ALIGN_MIDDLE="middle";c.ALIGN_BOTTOM="bottom";c.SCREEN_NONE="none";c.SCREEN_HORIZONTAL="horizontal";c.SCREEN_VERTICAL="vertical";c.FRAME_FAST="fast";c.FRAME_SLOW="slow";c.FRAME_MOUSE="mouse";c.FRAME_SLEEP="sleep";t(c,["_dbgSprite",function(){return this._dbgSprite=new P}]);return c}(P),pb=function(a){function c(){this.datas=[];this.hud_width=800;this.hud_height=200;this.gMinV=0;this.gMaxV=100;this.textSpace=40;this._now=null;this.sttm=0;c.__super.call(this);this.xdata=Array(c.DATANUM);this.ydata=Array(c.DATANUM);c.inst=this;this._renderType|=2048;this._setRenderType(this._renderType);this._setCustomRender();this.addDataDef(0,16777215,"frame",1);this.addDataDef(1,65280,"update",1);this.addDataDef(2,16711680,"flush",1);this._now=performance?performance.now.bind(performance):Date.now}p(c,"laya.utils.PerfHUD",a);a=c.prototype;a.now=function(){return this._now()};a.start=function(){this.sttm=this._now()};a.end=function(a){var b=this._now()-this.sttm;this.updateValue(a,b)};a.config=function(a,c){this.hud_width=a;this.hud_height=c};a.addDataDef=function(a,c,e,f){this.datas[a]=new cc(a,c,e,f)};a.updateValue=function(a,c){this.datas[a].addData(c)};a.v2y=function(a){return this._y+this.hud_height*(1-(a-this.gMinV)/this.gMaxV)};a.drawHLine=function(a,c,e,f){var b=this._x;c=this.v2y(c);a.fillText(f,b,c-6,null,"green",null);b+=this.textSpace;a.fillStyle=e;a.fillRect(b,c,this._x+this.hud_width,1,null)};a.customRender=function(a,d,e){d=performance.now();0>=c._lastTm&&(c._lastTm=d);this.updateValue(0,d-c._lastTm);c._lastTm=d;a.save();a.fillRect(this._x,this._y,this.hud_width,this.hud_height+4,"#000000cc");a.globalAlpha=.9;this.drawHLine(a,0,"green","    0");this.drawHLine(a,10,"green","  10");this.drawHLine(a,16.667,"red"," ");this.drawHLine(a,20,"green","50|20");this.drawHLine(a,33.334,"yellow","");this.drawHLine(a,16.667*3,"yellow","");this.drawHLine(a,66.668,"yellow","");this.drawHLine(a,50,"green","20|50");this.drawHLine(a,100,"green","10|100");d=0;for(e=this.datas.length;d<e;d++){var b=this.datas[d];if(b){var g=b.datas.length,h=(this.hud_width-this.textSpace)/g,k=b.datapos,l=this._x+this.textSpace;for(a.fillStyle=b.color;k<g;k++){var m=this.v2y(b.datas[k]*b.scale);a.fillRect(l,m,h,this.hud_height+this._y-m,null);l+=h}for(k=0;k<b.datapos;k++)m=this.v2y(b.datas[k]*b.scale),a.fillRect(l,m,h,this.hud_height+this._y-m,null),l+=h}}a.restore()};c._lastTm=0;c._now=0;c.DATANUM=300;c.inst=null;c.drawTexTm=0;return c}(P),rc=function(a){function c(){this.autoDestroyAtClosed=!1;this._timer=this.url=null;this._viewCreated=!1;this._idMap=null;this._$componentType="Scene";c.__super.call(this);this._setBit(8,!0);c.unDestroyedScenes.push(this);this._scene=this;this.createChildren()}p(c,"laya.display.Scene",a);var b=c.prototype;b.createChildren=function(){};b.loadScene=function(a){a=-1<a.indexOf(".")?a:a+".scene";var b=l.loader.getRes(a);b?this.createView(b):(l.loader.resetProgress(),b=new Ab,b.on("complete",this,this._onSceneLoaded,[a]),b.load(a))};b._onSceneLoaded=function(a){this.createView(H.getRes(a))};b.createView=function(a){a&&!this._viewCreated&&(this._viewCreated=!0,$a.createByData(this,a))};b.getNodeByID=function(a){return this._idMap?this._idMap[a]:null};b.open=function(a,b){void 0===a&&(a=!0);a&&c.closeAll();c.root.addChild(this);this.onOpened(b)};b.onOpened=function(a){};b.close=function(a){this.onClosed(a);this.autoDestroyAtClosed?this.destroy():this.removeSelf()};b.onClosed=function(a){};b.destroy=function(b){void 0===b&&(b=!0);this._idMap=null;a.prototype.destroy.call(this,b);b=laya.display.Scene.unDestroyedScenes;for(var c=b.length-1;-1<c;c--)if(b[c]===this){b.splice(c,1);break}};b._sizeChanged=function(){this.event("resize")};m(0,b,"scaleX",a.prototype._$get_scaleX,function(a){l.superGet(P,this,"scaleX")!=a&&(l.superSet(P,this,"scaleX",a),this.event("resize"))});m(0,b,"scaleY",a.prototype._$get_scaleY,function(a){l.superGet(P,this,"scaleY")!=a&&(l.superSet(P,this,"scaleY",a),this.event("resize"))});m(0,b,"width",function(){if(this._width)return this._width;for(var a=0,b=this.numChildren-1;-1<b;b--){var c=this.getChildAt(b);c._visible&&(a=Math.max(c._x+c.width*c.scaleX,a))}return a},function(a){l.superGet(P,this,"width")!=a&&(l.superSet(P,this,"width",a),this.callLater(this._sizeChanged))});m(0,b,"timer",function(){return this._timer||l.timer},function(a){this._timer=a});m(0,b,"height",function(){if(this._height)return this._height;for(var a=0,b=this.numChildren-1;-1<b;b--){var c=this.getChildAt(b);c._visible&&(a=Math.max(c._y+c.height*c.scaleY,a))}return a},function(a){l.superGet(P,this,"height")!=a&&(l.superSet(P,this,"height",a),this.callLater(this._sizeChanged))});m(1,c,"root",function(){if(!c._root){var a=function(){c._root.size(l.stage.width,l.stage.height);c._root.event("resize")};c._root=l.stage.addChild(new P);c._root.name="root";l.stage.on("resize",null,a);a()}return c._root},laya.display.Sprite._$SET_root);c.load=function(a,b,f){function d(a){c._loadPage&&c._loadPage.event("progress",a);f&&f.runWith(a)}l.loader.resetProgress();var e=new Ab;e.on("progress",null,d);e.once("complete",null,function(){e.off("progress",null,d);var f=H.getRes(a);if(!f)throw"Can not find scene:"+a;if(!f.props)throw"Scene data is error:"+a;var g=f.props.runtime?f.props.runtime:f.type,h=ra.getClass(g),l="instance"==f.props.renderType?h.instance||(h.instance=new h):new h;if(l&&l instanceof laya.display.Node)l.url=a,l._getBit(8)?(l.on("onViewCreated",null,function(){b&&b.runWith(l)}),l.createView(f)):b&&b.runWith(l),c.hideLoadingPage();else throw"Can not find scene:"+g;});e.load(a)};c.open=function(a,b,f,g,h){void 0===b&&(b=!0);if(f instanceof laya.utils.Handler){var d=g;g=f;f=d}c.showLoadingPage();c.load(a,S.create(null,this._onSceneLoaded,[b,g,f]),h)};c._onSceneLoaded=function(a,b,c,g){g.open(a,c);b&&b.runWith(g)};c.close=function(a,b){void 0===b&&(b="");for(var c=!1,d=laya.display.Scene.unDestroyedScenes,e=0,k=d.length;e<k;e++){var l=d[e];l&&l.parent&&l.url===a&&l.name==b&&(l.close(),c=!0)}return c};c.closeAll=function(){for(var a=laya.display.Scene.root,b=0,c=a.numChildren;b<c;b++){var g=a.getChildAt(0);g instanceof laya.display.Scene?g.close():g.removeSelf()}};c.destroy=function(a,b){void 0===b&&(b="");for(var c=!1,d=laya.display.Scene.unDestroyedScenes,e=0,k=d.length;e<k;e++){var l=d[e];l.url===a&&l.name==b&&(l.destroy(),c=!0)}return c};c.gc=function(){va.destroyUnusedResources()};c.setLoadingPage=function(a){c._loadPage!=a&&(c._loadPage=a)};c.showLoadingPage=function(a,b){void 0===b&&(b=500);c._loadPage&&(l.systemTimer.clear(null,c._showLoading),l.systemTimer.clear(null,c._hideLoading),l.systemTimer.once(b,null,c._showLoading,[a],!1))};c._showLoading=function(a){l.stage.addChild(c._loadPage);c._loadPage.onOpened(a)};c._hideLoading=function(){c._loadPage.close()};c.hideLoadingPage=function(a){void 0===a&&(a=500);c._loadPage&&(l.systemTimer.clear(null,c._showLoading),l.systemTimer.clear(null,c._hideLoading),l.systemTimer.once(a,null,c._hideLoading))};c.unDestroyedScenes=[];c._root=null;c._loadPage=null;return c}(P),ia=function(a){function c(){this._multiline=this._focus=!1;this._editable=!0;this._restrictPattern=null;this._type="text";this._prompt="";this._promptColor="#A9A9A9";this._originColor="#000000";this._content="";c.__super.call(this);this._maxChars=1E5;this._width=100;this._height=20;this.multiline=!1;this.overflow="scroll";this.on("mousedown",this,this._onMouseDown);this.on("undisplay",this,this._onUnDisplay)}p(c,"laya.display.Input",a);var b=c.prototype;b.setSelection=function(a,b){this.focus=!0;laya.display.Input.inputElement.selectionStart=a;laya.display.Input.inputElement.selectionEnd=b};b._onUnDisplay=function(a){this.focus=!1};b._onMouseDown=function(a){this.focus=!0};b._syncInputTransform=function(){var a=this.nativeInput,b=L.getTransformRelativeToWindow(this,this.padding[3],this.padding[0]),f=this._width-this.padding[1]-this.padding[3],g=this._height-this.padding[0]-this.padding[2];v.isConchApp?(a.setScale(b.scaleX,b.scaleY),a.setSize(f,g),a.setPos(b.x,b.y)):(c.inputContainer.style.transform=c.inputContainer.style.webkitTransform="scale("+b.scaleX+","+b.scaleY+") rotate("+l.stage.canvasDegree+"deg)",a.style.width=f+"px",a.style.height=g+"px",c.inputContainer.style.left=b.x+"px",c.inputContainer.style.top=b.y+"px")};b.select=function(){this.nativeInput.select()};b._setInputMethod=function(){c.input.parentElement&&c.inputContainer.removeChild(c.input);c.area.parentElement&&c.inputContainer.removeChild(c.area);c.inputElement=this._multiline?c.area:c.input;c.inputContainer.appendChild(c.inputElement);O.RightToLeft&&(c.inputElement.style.direction="rtl")};b._focusIn=function(){laya.display.Input.isInputting=!0;var a=this.nativeInput;this._focus=!0;var b=a.style;b.whiteSpace=this.wordWrap?"pre-wrap":"nowrap";this._setPromptColor();a.readOnly=!this._editable;v.isConchApp&&(a.setType(this._type),a.setForbidEdit(!this._editable));a.maxLength=this._maxChars;a.type=this._type;a.value=this._content;a.placeholder=this._prompt;l.stage.off("keydown",this,this._onKeyDown);l.stage.on("keydown",this,this._onKeyDown);l.stage.focus=this;this.event("focus");r.onPC&&a.focus();r.onMiniGame||r.onBDMiniGame||r.onQGMiniGame||r.onKGMiniGame||r.onVVMiniGame||r.onAlipayMiniGame||r.onBLMiniGame||(this._text=null);this.typeset();a.setColor(this._originColor);a.setFontSize(this.fontSize);a.setFontFace(r.onIPhone?O.fontFamilyMap[this.font]||this.font:this.font);v.isConchApp&&a.setMultiAble&&a.setMultiAble(this._multiline);b.lineHeight=this.leading+this.fontSize+"px";b.fontStyle=this.italic?"italic":"normal";b.fontWeight=this.bold?"bold":"normal";b.textAlign=this.align;b.padding="0 0";this._syncInputTransform();!v.isConchApp&&r.onPC&&l.systemTimer.frameLoop(1,this,this._syncInputTransform)};b._setPromptColor=function(){c.promptStyleDOM=r.getElementById("promptStyle");c.promptStyleDOM||(c.promptStyleDOM=r.createElement("style"),c.promptStyleDOM.setAttribute("id","promptStyle"),r.document.head.appendChild(c.promptStyleDOM));c.promptStyleDOM.innerText="input::-webkit-input-placeholder, textarea::-webkit-input-placeholder {color:"+this._promptColor+"}input:-moz-placeholder, textarea:-moz-placeholder {color:"+this._promptColor+"}input::-moz-placeholder, textarea::-moz-placeholder {color:"+this._promptColor+"}input:-ms-input-placeholder, textarea:-ms-input-placeholder {color:"+this._promptColor+"}"};b._focusOut=function(){this._focus=laya.display.Input.isInputting=!1;this._text=null;(this._content=this.nativeInput.value)?(l.superSet(O,this,"text",this._content),l.superSet(O,this,"color",this._originColor)):(l.superSet(O,this,"text",this._prompt),l.superSet(O,this,"color",this._promptColor));l.stage.off("keydown",this,this._onKeyDown);l.stage.focus=null;this.event("blur");this.event("change");v.isConchApp&&this.nativeInput.blur();r.onPC&&l.systemTimer.clear(this,this._syncInputTransform)};b._onKeyDown=function(a){13===a.keyCode&&(r.onMobile&&!this._multiline&&(this.focus=!1),this.event("enter"))};b.changeText=function(b){this._content=b;this._focus?(this.nativeInput.value=b||"",this.event("change")):a.prototype.changeText.call(this,b)};m(0,b,"color",a.prototype._$get_color,function(a){this._focus&&this.nativeInput.setColor(a);l.superSet(O,this,"color",this._content?a:this._promptColor);this._originColor=a});m(0,b,"multiline",function(){return this._multiline},function(a){this.valign=(this._multiline=a)?"top":"middle"});m(0,b,"maxChars",function(){return this._maxChars},function(a){0>=a&&(a=1E5);this._maxChars=a});m(0,b,"text",function(){return this._focus?this.nativeInput.value:this._content||""},function(a){l.superSet(O,this,"color",this._originColor);a+="";this._focus?(this.nativeInput.value=a||"",this.event("change")):(this._multiline||(a=a.replace(/\r?\n/g,"")),(this._content=a)?l.superSet(O,this,"text",a):(l.superSet(O,this,"text",this._prompt),l.superSet(O,this,"color",this.promptColor)))});m(0,b,"nativeInput",function(){return this._multiline?c.area:c.input});m(0,b,"focus",function(){return this._focus},function(a){var b=this.nativeInput;this._focus!==a&&(a?(b.target?b.target._focusOut():this._setInputMethod(),b.target=this,this._focusIn()):(b.target=null,this._focusOut(),r.document.body.scrollTop=0,b.blur(),v.isConchApp?b.setPos(-1E4,-1E4):c.inputContainer.contains(b)&&c.inputContainer.removeChild(b)))});m(0,b,"editable",function(){return this._editable},function(a){this._editable=a;v.isConchApp&&c.input.setForbidEdit(!a)});m(0,b,"bgColor",a.prototype._$get_bgColor,function(a){l.superSet(O,this,"bgColor",a);v.isConchApp&&this.nativeInput.setBgColor(a)});m(0,b,"restrict",function(){return this._restrictPattern?this._restrictPattern.source:""},function(a){a?(a="[^"+a+"]",-1<a.indexOf("^^")&&(a=a.replace("^^","")),this._restrictPattern=new RegExp(a,"g")):this._restrictPattern=null});m(0,b,"prompt",function(){return this._prompt},function(a){!this._text&&a&&l.superSet(O,this,"color",this._promptColor);this.promptColor=this._promptColor;this._text?l.superSet(O,this,"text",this._text==this._prompt?a:this._text):l.superSet(O,this,"text",a);this._prompt=O.langPacks&&O.langPacks[a]?O.langPacks[a]:a});m(0,b,"promptColor",function(){return this._promptColor},function(a){this._promptColor=a;this._content||l.superSet(O,this,"color",a)});m(0,b,"type",function(){return this._type},function(a){"password"===a?this._getTextStyle().asPassword=!0:this._getTextStyle().asPassword=!1;this._type=a});c.__init__=function(){c._createInputElement();if(r.onMobile){var a=!1;if(r.onMiniGame||r.onBDMiniGame||r.onQGMiniGame||r.onKGMiniGame||r.onVVMiniGame||r.onAlipayMiniGame||r.onBLMiniGame)a=!0;v.canvas.addEventListener(c.IOS_IFRAME?a?"touchend":"click":"touchend",c._popupInputMethod)}};c._popupInputMethod=function(a){laya.display.Input.isInputting&&laya.display.Input.inputElement.focus()};c._createInputElement=function(){c._initInput(c.area=r.createElement("textarea"));c._initInput(c.input=r.createElement("input"));c.inputContainer=r.createElement("div");c.inputContainer.style.position="absolute";c.inputContainer.style.zIndex=1E5;r.container.appendChild(c.inputContainer);c.inputContainer.setPos=function(a,b){c.inputContainer.style.left=a+"px";c.inputContainer.style.top=b+"px"}};c._initInput=function(a){var b=a.style;b.cssText="position:absolute;overflow:hidden;resize:none;transform-origin:0 0;-webkit-transform-origin:0 0;-moz-transform-origin:0 0;-o-transform-origin:0 0;";b.resize="none";b.backgroundColor="transparent";b.border="none";b.outline="none";b.zIndex=1;a.addEventListener("input",c._processInputting);a.addEventListener("mousemove",c._stopEvent);a.addEventListener("mousedown",c._stopEvent);a.addEventListener("touchmove",c._stopEvent);a.setFontFace=function(b){a.style.fontFamily=b};v.isConchApp||(a.setColor=function(b){a.style.color=b},a.setFontSize=function(b){a.style.fontSize=b+"px"})};c._processInputting=function(a){if(a=laya.display.Input.inputElement.target){var b=laya.display.Input.inputElement.value;a._restrictPattern&&(b=b.replace(/\u2006|\x27/g,""),a._restrictPattern.test(b)&&(b=b.replace(a._restrictPattern,""),laya.display.Input.inputElement.value=b));a._text=b;a.event("input")}};c._stopEvent=function(a){"touchmove"==a.type&&a.preventDefault();a.stopPropagation&&a.stopPropagation()};c.TYPE_TEXT="text";c.TYPE_PASSWORD="password";c.TYPE_EMAIL="email";c.TYPE_URL="url";c.TYPE_NUMBER="number";c.TYPE_RANGE="range";c.TYPE_DATE="date";c.TYPE_MONTH="month";c.TYPE_WEEK="week";c.TYPE_TIME="time";c.TYPE_DATE_TIME="datetime";c.TYPE_DATE_TIME_LOCAL="datetime-local";c.TYPE_SEARCH="search";c.input=null;c.area=null;c.inputElement=null;c.inputContainer=null;c.confirmButton=null;c.promptStyleDOM=null;c.inputHeight=45;c.isInputting=!1;c.stageMatrix=null;t(c,["IOS_IFRAME",function(){return this.IOS_IFRAME=r.onIOS&&r.window.top!=r.window.self}]);return c}(O);(function(a){function c(){this._url=this._frames=null;c.__super.call(this);this._setControlNode(this)}p(c,"laya.display.Animation",a);var b=c.prototype;b.destroy=function(a){void 0===a&&(a=!0);this.stop();laya.display.Sprite.prototype.destroy.call(this,a);this._labels=this._frames=null};b.play=function(b,c,f){void 0===b&&(b=0);void 0===c&&(c=!0);void 0===f&&(f="");f&&this._setFramesFromCache(f,!0);a.prototype.play.call(this,b,c,f)};b._setFramesFromCache=function(a,b){void 0===b&&(b=!1);this._url&&(a=this._url+"#"+a);if(a&&c.framesMap[a]){var d=c.framesMap[a];d instanceof Array?(this._frames=c.framesMap[a],this._count=this._frames.length):(d.nodeRoot&&(c.framesMap[a]=cb.parseAnimationByData(d),d=c.framesMap[a]),this._frames=d.frames,this._count=this._frames.length,this._frameRateChanged||(this._interval=d.interval),this._labels=this._copyLabels(d.labels));return!0}b&&console.log("ani not found:",a);return!1};b._copyLabels=function(a){if(!a)return null;var b;b={};for(var c in a)b[c]=L.copyArray([],a[c]);return b};b._frameLoop=function(){this._visible&&.01<this._style.alpha&&this._frames&&a.prototype._frameLoop.call(this)};b._displayToIndex=function(a){this._frames&&(this.graphics=this._frames[a])};b.clear=function(){a.prototype.clear.call(this);this.stop();this._labels=this._frames=this.graphics=null;return this};b.loadImages=function(a,b){void 0===b&&(b="");this._url="";this._setFramesFromCache(b)||(this.frames=c.framesMap[b]?c.framesMap[b]:c.createFrames(a,b));return this};b.loadAtlas=function(a,b,f){void 0===f&&(f="");this._url="";var d=this;if(!d._setFramesFromCache(f)){var e=function(e){a===e&&(d.frames=c.framesMap[f]?c.framesMap[f]:c.createFrames(a,f),b&&b.run())};H.getAtlas(a)?e(a):l.loader.load(a,S.create(null,e,[a]),null,"atlas")}return this};b.loadAnimation=function(a,b,c){this._url=a;this._actionName||(this._actionName="");this._setFramesFromCache(this._actionName)?(this._setFramesFromCache(this._actionName,!0),this.index=0,b&&b.run()):!c||H.getAtlas(c)?this._loadAnimationData(a,b,c):l.loader.load(c,S.create(this,this._loadAnimationData,[a,b,c]),null,"atlas");return this};b._loadAnimationData=function(a,b,f){function d(d){if(H.getRes(d)){if(a===d){if(c.framesMap[a+"#"])k._setFramesFromCache(e._actionName,!0),e.index=0;else{d=cb.parseAnimationData(H.getRes(a));if(!d)return;var f=d.animationList,g,h=f.length,l;for(g=0;g<h;g++)d=f[g],c.framesMap[a+"#"+d.name]=d,l||(l=d);l&&(c.framesMap[a+"#"]=l,k._setFramesFromCache(e._actionName,!0),e.index=0)}e._resumePlay();b&&b.run()}H.clearRes(a)}else c.framesMap[a+"#"]&&(k._setFramesFromCache(e._actionName,!0),e.index=0,e._resumePlay(),b&&b.run())}var e=this;if(f&&!H.getAtlas(f))console.warn("atlas load fail:"+f);else{var k=this;H.getRes(a)?d(a):l.loader.load(a,S.create(null,d,[a]),null,"json")}};m(0,b,"frames",function(){return this._frames},function(a){if(this._frames=a)this._count=a.length,this._actionName&&this._setFramesFromCache(this._actionName,!0),this.index=this._index});m(0,b,"autoPlay",null,function(a){a?this.play():this.stop()});m(0,b,"source",null,function(a){-1<a.indexOf(".ani")?this.loadAnimation(a):-1<a.indexOf(".json")||-1<a.indexOf("als")||-1<a.indexOf("atlas")?this.loadAtlas(a):this.loadImages(a.split(","))});m(0,b,"autoAnimation",null,function(a){this.play(0,!0,a)});c.createFrames=function(a,b){var d;if("string"==typeof a){var e=H.getAtlas(a);if(e&&e.length){d=[];for(var h=0,k=e.length;h<k;h++){var l=new sa;l.drawImage(H.getRes(e[h]),0,0);d.push(l)}}}else if(a instanceof Array)for(d=[],h=0,k=a.length;h<k;h++)l=new sa,l.loadImage(a[h],0,0),d.push(l);b&&(c.framesMap[b]=d);return d};c.clearCache=function(a){var b=c.framesMap,d,g=a+"#";for(d in b)d!==a&&0!==d.indexOf(g)||delete c.framesMap[d]};c.framesMap={};return c})(Bb);var Ub=function(a){function c(a,b,f,g,h){this._params2dQuick2=null;this._shaderValueHeight=this._shaderValueWidth=0;c.__super.call(this,a,b,f,g,h)}p(c,"laya.webgl.shader.d2.Shader2X",a);var b=c.prototype;b._disposeResource=function(){a.prototype._disposeResource.call(this);this._params2dQuick2=null};b.upload2dQuick2=function(a){this.upload(a,this._params2dQuick2||this._make2dQuick2())};b._make2dQuick2=function(){if(!this._params2dQuick2){this._params2dQuick2=[];for(var a=this._params,b,c=0,g=a.length;c<g;c++)b=a[c],"size"!==b.name&&this._params2dQuick2.push(b)}return this._params2dQuick2};c.create=function(a,b,f,g,h){return new c(a,b,f,g,h)};return c}(ka),Za=function(a){function c(){this._usedFrames=this._animationData=this._targetDic=null;c.__super.call(this);null===c._sortIndexFun&&(c._sortIndexFun=Mb.sortByKey("index",!1,!0))}p(c,"laya.display.FrameAnimation",a);var b=c.prototype;b._setUp=function(a,b){this._targetDic=a;this._animationData=b;this.interval=1E3/b.frameRate;b.parsed?(this._count=b.count,this._labels=b.labels,this._usedFrames=b.animationNewFrames):(this._usedFrames=[],this._calculateDatas(),b.parsed=!0,b.labels=this._labels,b.count=this._count,b.animationNewFrames=this._usedFrames)};b.clear=function(){a.prototype.clear.call(this);this._animationData=this._targetDic=null;return this};b._displayToIndex=function(a){if(this._animationData){0>a&&(a=0);a>this._count&&(a=this._count);var b=this._animationData.nodes,c,d=b.length;for(c=0;c<d;c++)this._displayNodeToFrame(b[c],a)}};b._displayNodeToFrame=function(a,b,c){c||(c=this._targetDic);if(c=c[a.target]){var d=a.frames,e,f,l=a.keys,m,p=l.length;for(m=0;m<p;m++)e=l[m],f=d[e],f=f.length>b?f[b]:f[f.length-1],c[e]=f;a=a.funkeys;p=a.length;if(0!=p)for(m=0;m<p;m++)e=a[m],l=d[e],void 0!==l[b]&&c[e]&&c[e].apply(c,l[b])}};b._calculateDatas=function(){if(this._animationData){var a=this._animationData.nodes,b,c=a.length,g;for(b=this._count=0;b<c;b++)g=a[b],this._calculateKeyFrames(g);this._count+=1}};b._calculateKeyFrames=function(a){var b=a.keyframes,d,g,h=a.target;a.frames||(a.frames={});a.keys?a.keys.length=0:a.keys=[];a.funkeys?a.funkeys.length=0:a.funkeys=[];a.initValues||(a.initValues={});for(d in b){var k=-1!=d.indexOf("()");g=b[d];k&&(d=d.substr(0,d.length-2));a.frames[d]||(a.frames[d]=[]);if(k){a.funkeys.push(d);for(var k=a.frames[d],l=0;l<g.length;l++){var m=g[l];k[m.index]=m.value;m.index>this._count&&(this._count=m.index)}}else this._targetDic&&this._targetDic[h]&&(a.initValues[d]=this._targetDic[h][d]),g.sort(c._sortIndexFun),a.keys.push(d),this._calculateNodePropFrames(g,a.frames[d],d,h)}};b.resetNodes=function(){if(this._targetDic&&this._animationData){var a=this._animationData.nodes,b,c=a.length,g,h;for(b=0;b<c;b++)if(g=a[b],h=g.initValues)if(g=this._targetDic[g.target])for(var k in h)g[k]=h[k]}};b._calculateNodePropFrames=function(a,b,c,g){g=a.length-1;b.length=a[g].index+1;for(c=0;c<g;c++)this._dealKeyFrame(a[c]),this._calculateFrameValues(a[c],a[c+1],b);0==g&&(b[0]=a[0].value,this._usedFrames&&(this._usedFrames[a[0].index]=!0));this._dealKeyFrame(a[c])};b._dealKeyFrame=function(a){a.label&&""!=a.label&&this.addLabel(a.label,a.index)};b._calculateFrameValues=function(a,b,c){var d,e,f=a.index,l=b.index,m=a.value,p=b.value-a.value,r=l-f,t=this._usedFrames;l>this._count&&(this._count=l);if(a.tween)for(e=Da[a.tweenMethod],null==e&&(e=Da.linearNone),d=f;d<l;d++)c[d]=e(d-f,m,p,r),t&&(t[d]=!0);else for(d=f;d<l;d++)c[d]=m;t&&(t[a.index]=!0,t[b.index]=!0);c[b.index]=b.value};c._sortIndexFun=null;return c}(Bb),pa=function(a){function c(a,d,e,f,g){void 0===a&&(a=0);void 0===d&&(d=0);void 0===e&&(e=1);void 0===f&&(f=!0);void 0===g&&(g=!1);c.__super.call(this,e,f);this._glTextureType=3553;this._width=a;this._height=d;this._canRead=g;this._setWarpMode(10242,this._wrapModeU);this._setWarpMode(10243,this._wrapModeV);this._setFilterMode(this._filterMode);this._setAnisotropy(this._anisoLevel);if(this._mipmap){this._mipmapCount=Math.max(Math.ceil(Math.log2(a))+1,Math.ceil(Math.log2(2))+1);for(e=0;e<this._mipmapCount;e++)this._setPixels(null,e,Math.max(a>>e,1),Math.max(d>>e,1));this._setGPUMemory(a*d*4*(1+1/3))}else this._mipmapCount=1,this._setGPUMemory(a*d*4)}p(c,"laya.resource.Texture2D",a);a=c.prototype;a._getFormatByteCount=function(){switch(this._format){case 0:return 3;case 1:return 4;case 2:return 1;default:throw"Texture2D: unknown format.";}};a._setPixels=function(a,c,e,f){var b=y.instance,d=this._glTextureType,k=this._getGLFormat();C.bindTexture(b,d,this._glTexture);0===this.format?(b.pixelStorei(3317,1),b.texImage2D(d,c,k,e,f,0,k,5121,a),b.pixelStorei(3317,4)):b.texImage2D(d,c,k,e,f,0,k,5121,a)};a._calcualatesCompressedDataSize=function(a,c,e){switch(a){case 3:case 5:return(c+3>>2)*(e+3>>2)*8;case 4:return(c+3>>2)*(e+3>>2)*16;case 11:case 12:return Math.floor((Math.max(c,8)*Math.max(e,8)*4+7)/8);case 9:case 10:return Math.floor((Math.max(c,16)*Math.max(e,8)*2+7)/8);default:return 0}};a._pharseDDS=function(a){var b=new Int32Array(a,0,31);if(542327876!=b[0])throw"Invalid magic number in DDS header";if(!(b[20]&4))throw"Unsupported format, must contain a FourCC code";var c=b[21];switch(this._format){case 3:if(827611204!==c)throw"the FourCC code is not same with texture format.";break;case 4:if(894720068!==c)throw"the FourCC code is not same with texture format.";break;default:throw"unknown texture format.";}c=1;if(b[2]&131072){if(c=Math.max(1,b[7]),!this._mipmap)throw"the mipmap is not same with Texture2D.";}else if(this._mipmap)throw"the mipmap is not same with Texture2D.";var f=b[4],g=b[3];this._width=f;this._height=g;this._upLoadCompressedTexImage2D(a,f,g,c,b[1]+4,0)};a._pharseKTX=function(a){var b=new Uint8Array(a,0,12);if(171!=b[0]||75!=b[1]||84!=b[2]||88!=b[3]||32!=b[4]||49!=b[5]||49!=b[6]||187!=b[7]||13!=b[8]||10!=b[9]||26!=b[10]||10!=b[11])throw"Invalid fileIdentifier in KTX header";b=new Int32Array(b.buffer,b.length,13);switch(b[4]){case C._compressedTextureEtc1.COMPRESSED_RGB_ETC1_WEBGL:this._format=5;break;default:throw"unknown texture format.";}var c=b[11],f=b[6],g=b[7];this._width=f;this._height=g;this._upLoadCompressedTexImage2D(a,f,g,c,64+b[12],4)};a._pharsePVR=function(a){var b=new Int32Array(a,0,13);if(55727696!=b[0])throw"Invalid magic number in PVR header";switch(b[2]){case 0:this._format=9;break;case 2:this._format=11;break;case 1:this._format=10;break;case 3:this._format=12;break;default:throw"Texture2D:unknown PVR format.";}var c=b[11],f=b[7],g=b[6];this._width=f;this._height=g;this._upLoadCompressedTexImage2D(a,f,g,c,b[12]+52,0)};a._upLoadCompressedTexImage2D=function(a,c,e,f,g,h){var b=y.instance,d=this._glTextureType;C.bindTexture(b,d,this._glTexture);for(var l=this._getGLFormat(),m=0;m<f;m++){g+=h;var p=this._calcualatesCompressedDataSize(this._format,c,e),r=new Uint8Array(a,g,p);b.compressedTexImage2D(d,m,l,c,e,0,r);c=Math.max(c>>1,1);e=Math.max(e>>1,1);g+=p}this._setGPUMemory(g);this._readyed=!0;this._activeResource()};a.loadImageSource=function(a,c){void 0===c&&(c=!1);var b=a.width,d=a.height;this._width=b;this._height=d;this._isPot(b)&&this._isPot(d)||(this._mipmap=!1);this._setWarpMode(10242,this._wrapModeU);this._setWarpMode(10243,this._wrapModeV);this._setFilterMode(this._filterMode);var g=y.instance;C.bindTexture(g,this._glTextureType,this._glTexture);var h=this._getGLFormat();v.isConchApp?(a instanceof laya.resource.HTMLCanvas||a.setPremultiplyAlpha(c),g.texImage2D(this._glTextureType,0,6408,6408,5121,a)):(c&&g.pixelStorei(37441,!0),g.texImage2D(this._glTextureType,0,h,h,5121,a),c&&g.pixelStorei(37441,!1));this._mipmap?(g.generateMipmap(this._glTextureType),this._setGPUMemory(b*d*4*(1+1/3))):this._setGPUMemory(b*d*4);this._canRead&&(v.isConchApp?this._pixels=new Uint8Array(a._nativeObj.getImageData(0,0,b,d)):(r.canvas.size(b,d),r.canvas.clear(),r.context.drawImage(a,0,0,b,d),this._pixels=new Uint8Array(r.context.getImageData(0,0,b,d).data.buffer)));this._readyed=!0;this._activeResource()};a.setPixels=function(a,c){void 0===c&&(c=0);if(!a)throw"Texture2D:pixels can't be null.";var b=Math.max(this._width>>c,1),d=Math.max(this._height>>c,1),g=b*d*this._getFormatByteCount();if(a.length<g)throw"Texture2D:pixels length should at least "+g+".";this._setPixels(a,c,b,d);this._canRead&&(this._pixels=a);this._readyed=!0;this._activeResource()};a.setSubPixels=function(a,c,e,f,g,h){void 0===h&&(h=0);if(!g)throw"Texture2D:pixels can't be null.";var b=y.instance,d=this._glTextureType;C.bindTexture(b,d,this._glTexture);var l=this._getGLFormat();0===this._format?(b.pixelStorei(3317,1),b.texSubImage2D(d,h,a,c,e,f,l,5121,g),b.pixelStorei(3317,4)):b.texSubImage2D(d,h,a,c,e,f,l,5121,g);this._readyed=!0;this._activeResource()};a.setCompressData=function(a){switch(this._format){case 3:case 4:this._pharseDDS(a);break;case 5:this._pharseKTX(a);break;case 9:case 10:case 11:case 12:this._pharsePVR(a);break;default:throw"Texture2D:unkonwn format.";}};a._recoverResource=function(){};a.getPixels=function(){if(this._canRead)return this._pixels;throw Error("Texture2D: must set texture canRead is true.");};m(0,a,"mipmapCount",function(){return this._mipmapCount});m(0,a,"defaulteTexture",function(){return laya.resource.Texture2D.grayTexture});c.__init__=function(){var a=new Uint8Array(3);a[0]=128;a[1]=128;a[2]=128;c.grayTexture=new c(1,1,0,!1,!1);c.grayTexture.setPixels(a);c.grayTexture.lock=!0;a[0]=255;a[1]=255;a[2]=255;c.whiteTexture=new c(1,1,0,!1,!1);c.whiteTexture.setPixels(a);c.whiteTexture.lock=!0;a[0]=0;a[1]=0;a[2]=0;c.blackTexture=new c(1,1,0,!1,!1);c.blackTexture.setPixels(a);c.blackTexture.lock=!0};c._parse=function(a,d,e){e=e?new c(e[0],e[1],e[2],e[3],e[4]):new c(0,0);d&&(e.wrapModeU=d.wrapModeU,e.wrapModeV=d.wrapModeV,e.filterMode=d.filterMode,e.anisoLevel=d.anisoLevel);switch(e._format){case 0:case 1:e.loadImageSource(a);break;case 3:case 4:case 5:case 9:case 10:case 11:case 12:e.setCompressData(a);break;default:throw"Texture2D:unkonwn format.";}return e};c.load=function(a,c){l.loader.create(a,c,null,"TEXTURE2D")};c.grayTexture=null;c.whiteTexture=null;c.blackTexture=null;return c}(Cb),ca=function(a){function c(a,d,e,f){this._mgrKey=0;void 0===e&&(e=0);void 0===f&&(f=0);c.__super.call(this,e,!1);this._glTextureType=3553;this._width=a;this._height=d;this._depthStencilFormat=f;this._create(a,d);this.lock=!0}p(c,"laya.resource.RenderTexture2D",a);a=c.prototype;a.getIsReady=function(){return!0};a._create=function(a,c){var b=y.instance;this._frameBuffer=b.createFramebuffer();C.bindTexture(b,this._glTextureType,this._glTexture);var d=this._getGLFormat();b.texImage2D(this._glTextureType,0,d,a,c,0,d,5121,null);this._setGPUMemory(a*c*4);b.bindFramebuffer(36160,this._frameBuffer);b.framebufferTexture2D(36160,36064,3553,this._glTexture,0);if(3!==this._depthStencilFormat)switch(this._depthStencilBuffer=b.createRenderbuffer(),b.bindRenderbuffer(36161,this._depthStencilBuffer),this._depthStencilFormat){case 0:b.renderbufferStorage(36161,33189,a,c);b.framebufferRenderbuffer(36160,36096,36161,this._depthStencilBuffer);break;case 1:b.renderbufferStorage(36161,36168,a,c);b.framebufferRenderbuffer(36160,36128,36161,this._depthStencilBuffer);break;case 2:b.renderbufferStorage(36161,34041,a,c),b.framebufferRenderbuffer(36160,33306,36161,this._depthStencilBuffer)}b.bindFramebuffer(36160,null);b.bindRenderbuffer(36161,null);this._setWarpMode(10242,this._wrapModeU);this._setWarpMode(10243,this._wrapModeV);this._setFilterMode(this._filterMode);this._setAnisotropy(this._anisoLevel);this._readyed=!0;this._activeResource()};a.generateMipmap=function(){this._isPot(this.width)&&this._isPot(this.height)?(this._mipmap=!0,y.instance.generateMipmap(this._glTextureType),this._setFilterMode(this._filterMode),this._setGPUMemory(this.width*this.height*4*(1+1/3))):(this._mipmap=!1,this._setGPUMemory(this.width*this.height*4))};a.start=function(){var a=y.instance;y.instance.bindFramebuffer(36160,this._frameBuffer);this._lastRT=c._currentActive;c._currentActive=this;this._readyed=!0;a.viewport(0,0,this._width,this._height);this._lastWidth=F.width;this._lastHeight=F.height;F.width=this._width;F.height=this._height;aa.activeShader=null};a.end=function(){y.instance.bindFramebuffer(36160,null);c._currentActive=null;this._readyed=!0};a.restore=function(){var a=y.instance;this._lastRT!=c._currentActive&&(y.instance.bindFramebuffer(36160,this._lastRT?this._lastRT._frameBuffer:null),c._currentActive=this._lastRT);this._readyed=!0;a.viewport(0,0,this._lastWidth,this._lastHeight);F.width=this._lastWidth;F.height=this._lastHeight;aa.activeShader=null};a.clear=function(a,c,e,f){void 0===a&&(a=0);void 0===c&&(c=0);void 0===e&&(e=0);void 0===f&&(f=1);var b=y.instance;b.clearColor(a,c,e,f);a=16384;switch(this._depthStencilFormat){case 33189:a|=256;break;case 36168:a|=1024;break;case 34041:a|=1280}b.clear(a)};a.getData=function(a,c,e,f){if(v.isConchApp&&2==conchConfig.threadMode)throw"native 2 thread mode use getDataAsync";var b=y.instance;b.bindFramebuffer(36160,this._frameBuffer);if(36053!==b.checkFramebufferStatus(36160))return b.bindFramebuffer(36160,null),null;var d=new Uint8Array(this._width*this._height*4),k=this._getGLFormat();b.readPixels(a,c,e,f,k,5121,d);b.bindFramebuffer(36160,null);return d};a.getDataAsync=function(a,c,e,f,g){var b=y.instance;b.bindFramebuffer(36160,this._frameBuffer);b.readPixelsAsync(a,c,e,f,6408,5121,function(a){g(new Uint8Array(a))});b.bindFramebuffer(36160,null)};a.recycle=function(){};a._disposeResource=function(){if(this._frameBuffer){var a=y.instance;a.deleteTexture(this._glTexture);a.deleteFramebuffer(this._frameBuffer);a.deleteRenderbuffer(this._depthStencilBuffer);this._depthStencilBuffer=this._frameBuffer=this._glTexture=null;this._setGPUMemory(0)}};m(0,a,"depthStencilFormat",function(){return this._depthStencilFormat});m(0,a,"defaulteTexture",function(){return pa.grayTexture});m(0,a,"sourceWidth",function(){return this._width});m(0,a,"sourceHeight",function(){return this._height});m(0,a,"offsetX",function(){return 0});m(0,a,"offsetY",function(){return 0});m(1,c,"currentActive",function(){return c._currentActive},laya.resource.BaseTexture._$SET_currentActive);c.pushRT=function(){c.rtStack.push({rt:c._currentActive,w:F.width,h:F.height})};c.popRT=function(){var a=y.instance,d=c.rtStack.pop();d&&(c._currentActive!=d.rt&&(y.instance.bindFramebuffer(36160,d.rt?d.rt._frameBuffer:null),c._currentActive=d.rt),a.viewport(0,0,d.w,d.h),F.width=d.w,F.height=d.h)};c._currentActive=null;c.rtStack=[];t(c,["defuv",function(){return this.defuv=[0,0,1,0,1,1,0,1]},"flipyuv",function(){return this.flipyuv=[0,1,1,1,1,0,0,0]}]);return c}(Cb),cb=function(a){function c(){this._gList=this._nodeDefaultProps=this._nodeList=this.animationDic=this.animationList=null;this._nodeIDAniDic={};this._nodeGDic=this._rootNode=null;c.__super.call(this)}var b;p(c,"laya.utils.GraphicAnimation",a);var d=c.prototype;d._parseNodeList=function(a){this._nodeList||(this._nodeList=[]);this._nodeDefaultProps[a.compId]=a.props;a.compId&&this._nodeList.push(a.compId);if(a=a.child){var b,c=a.length;for(b=0;b<c;b++)this._parseNodeList(a[b])}};d._calGraphicData=function(a){this._setUp(null,a);this._createGraphicData();if(this._nodeIDAniDic)for(var b in this._nodeIDAniDic)this._nodeIDAniDic[b]=null};d._createGraphicData=function(){var a=[],b,c=this.count,d=this._usedFrames;d||(d=[]);var k;for(b=0;b<c;b++){if(d[b]||!k)k=this._createFrameGraphic(b);a.push(k)}this._gList=a};d._createFrameGraphic=function(a){var b=new sa;c._rootMatrix||(c._rootMatrix=new I);this._updateNodeGraphic(this._rootNode,a,c._rootMatrix,b);return b};d._updateNodeGraphic=function(a,b,c,d,k){void 0===k&&(k=1);var e;e=this._nodeGDic[a.compId]=this._getNodeGraphicData(a.compId,b,this._nodeGDic[a.compId]);e.resultTransform||(e.resultTransform=new I);var f;f=e.resultTransform;I.mul(e.transform,c,f);c=e.alpha*k;if(!(.01>c)&&(e.skin&&(k=this._getTextureByUrl(e.skin))&&(f._checkTransform()?(d.drawTexture(k,0,0,e.width,e.height,f,c),e.resultTransform=null):d.drawTexture(k,f.tx,f.ty,e.width,e.height,null,c)),a=a.child))for(k=a.length,e=0;e<k;e++)this._updateNodeGraphic(a[e],b,f,d,c)};d._updateNoChilds=function(a,b){if(a.skin){var c=this._getTextureByUrl(a.skin);if(c){var d=a.transform;d._checkTransform();d._bTransform?b.drawTexture(c,0,0,a.width,a.height,d.clone(),a.alpha):b.drawTexture(c,d.tx,d.ty,a.width,a.height,null,a.alpha)}}};d._updateNodeGraphic2=function(a,b,c){var d;d=this._nodeGDic[a.compId]=this._getNodeGraphicData(a.compId,b,this._nodeGDic[a.compId]);if(a.child){var e=d.transform;e._checkTransform();var f;f=!e._bTransform;var g;g=f&&(0!=e.tx||0!=e.ty);var l;(l=e._bTransform||1!=d.alpha)&&c.save();1!=d.alpha&&c.alpha(d.alpha);f?g&&c.translate(e.tx,e.ty):c.transform(e.clone());a=a.child;var m;d.skin&&(m=this._getTextureByUrl(d.skin))&&c.drawImage(m,0,0,d.width,d.height);if(a)for(m=a.length,d=0;d<m;d++)this._updateNodeGraphic2(a[d],b,c);l?c.restore():f?g&&c.translate(-e.tx,-e.ty):c.transform(e.clone().invert())}else this._updateNoChilds(d,c)};d._calculateKeyFrames=function(b){a.prototype._calculateKeyFrames.call(this,b);this._nodeIDAniDic[b.target]=b};d.getNodeDataByID=function(a){return this._nodeIDAniDic[a]};d._getParams=function(a,b,d,h){var e=c._temParam;e.length=b.length;var f,g=b.length;for(f=0;f<g;f++)e[f]=this._getObjVar(a,b[f][0],d,b[f][1],h);return e};d._getObjVar=function(a,b,c,d,k){return a.hasOwnProperty(b)?(d=a[b],c>=d.length&&(c=d.length-1),a[b][c]):k.hasOwnProperty(b)?k[b]:d};d._getNodeGraphicData=function(a,d,g){g||(g=new b);g.transform?g.transform.identity():g.transform=new I;var e=this.getNodeDataByID(a);if(!e)return g;a=this._getParams(e.frames,c._drawTextureCmd,d,this._nodeDefaultProps[a]);var f=a[0],l,m,p=a[5],r=a[6],t=a[13],v=a[14];d=a[7];var e=a[8],w=a[9],x=a[11],y=a[12];l=a[3];m=a[4];if(0==l||0==m)f=null;-1==l&&(l=0);-1==m&&(m=0);var z;g.skin=f;g.width=l;g.height=m;f&&((z=this._getTextureByUrl(f))?(l||(l=z.sourceWidth),m||(m=z.sourceHeight)):console.warn("lost skin:",f,",you may load pics first"));g.alpha=a[10];f=g.transform;0!=t&&(p=t*l);0!=v&&(r=v*m);0==p&&0==r||f.translate(-p,-r);l=null;if(w||1!==d||1!==e||x||y)l=c._tempMt,l.identity(),l._bTransform=!0,x=.0174532922222222*(w-x),w=.0174532922222222*(w+y),y=Math.sin(w),m=Math.sin(x),x=Math.cos(x),l.a=d*Math.cos(w),l.b=d*y,l.c=-e*m,l.d=e*x,l.tx=l.ty=0;l&&(f=I.mul(f,l,f));f.translate(a[1],a[2]);return g};d._getTextureByUrl=function(a){return H.getRes(a)};d.setAniData=function(a,b){if(a.animations){this._nodeDefaultProps={};this._nodeGDic={};this._nodeList&&(this._nodeList.length=0);this._rootNode=a;this._parseNodeList(a);var d={},e=[],f=a.animations,l,m=f.length,p;for(l=0;l<m;l++)if(p=f[l],this._labels=null,(!b||b==p.name)&&p){try{this._calGraphicData(p)}catch(na){console.warn("parse animation fail:"+p.name+",empty animation created"),this._gList=[]}var r={};r.interval=1E3/p.frameRate;r.frames=this._gList;r.labels=this._labels;r.name=p.name;e.push(r);d[p.name]=r}this.animationList=e;this.animationDic=d}c._temParam.length=0};d.parseByData=function(a){var b,c;b=a.nodeRoot;c=a.aniO;delete a.nodeRoot;delete a.aniO;this._nodeDefaultProps={};this._nodeGDic={};this._nodeList&&(this._nodeList.length=0);this._rootNode=b;this._parseNodeList(b);this._labels=null;try{this._calGraphicData(c)}catch(h){console.warn("parse animation fail:"+c.name+",empty animation created"),this._gList=[]}a.interval=1E3/c.frameRate;a.frames=this._gList;a.labels=this._labels;a.name=c.name;return a};d.setUpAniData=function(a){if(a.animations){var b={},c=[],d=a.animations,e,l=d.length,m;for(e=0;e<l;e++)if(m=d[e]){var p={};p.name=m.name;p.aniO=m;p.nodeRoot=a;c.push(p);b[m.name]=p}this.animationList=c;this.animationDic=b}};d._clear=function(){this._nodeGDic=this._gList=this.animationDic=this.animationList=null};c.parseAnimationByData=function(a){c._I||(c._I=new c);a=c._I.parseByData(a);c._I._clear();return a};c.parseAnimationData=function(a){c._I||(c._I=new c);c._I.setUpAniData(a);a={};a.animationList=c._I.animationList;a.animationDic=c._I.animationDic;c._I._clear();return a};c._temParam=[];c._I=null;c._rootMatrix=null;t(c,["_drawTextureCmd",function(){return this._drawTextureCmd=[["skin",null],["x",0],["y",0],["width",-1],["height",-1],["pivotX",0],["pivotY",0],["scaleX",1],["scaleY",1],["rotation",0],["alpha",1],["skewX",0],["skewY",0],["anchorX",0],["anchorY",0]]},"_tempMt",function(){return this._tempMt=new I}]);c.__init$=function(){b=function(){function a(){this.resultTransform=this.transform=this.skin=null;this.height=this.width=NaN;this.alpha=1}p(a,"");return a}()};return c}(Za);(function(a){function c(){this._playEvent=this._target=null;this._initData={};this._effectClass=this._aniKeys=null;c.__super.call(this)}p(c,"laya.display.EffectAnimation",a);var b=c.prototype;b._onOtherBegin=function(a){a!==this&&this.stop()};b._addEvent=function(){this._target&&this._playEvent&&(this._setControlNode(this._target),this._target.on(this._playEvent,this,this._onPlayAction))};b._onPlayAction=function(){this.play(0,!1)};b.play=function(a,b,c){void 0===a&&(a=0);void 0===b&&(b=!0);void 0===c&&(c="");this._target&&(this._target.event("effectbegin",[this]),this._recordInitData(),laya.display.AnimationBase.prototype.play.call(this,a,b,c))};b._recordInitData=function(){if(this._aniKeys){var a,b;b=this._aniKeys.length;var c;for(a=0;a<b;a++)c=this._aniKeys[a],this._initData[c]=this._target[c]}};b._displayToIndex=function(a){if(this._animationData){0>a&&(a=0);a>this._count&&(a=this._count);var b=this._animationData.nodes,c,d=b.length,d=1<d?1:d;for(c=0;c<d;c++)this._displayNodeToFrame(b[c],a)}};b._displayNodeToFrame=function(a,b,c){if(this._target){c=this._target;var d=a.frames,e,f,l=a.keys,m,p=l.length,r=a.secondFrames,t;for(m=0;m<p;m++)e=l[m],f=d[e],t=r[e],-1==t?f=this._initData[e]:b<t?(t=a.keyframes[e],f=t[0],f.tween?(f=Da[f.tweenMethod],null==f&&(f=Da.linearNone),t=t[1],f=f(b,this._initData[e],t.value-this._initData[e],t.index)):f=this._initData[e]):f=f.length>b?f[b]:f[f.length-1],c[e]=f}};b._calculateKeyFrames=function(b){a.prototype._calculateKeyFrames.call(this,b);var c=b.keyframes,d,g={};b.secondFrames=g;for(d in c)b=c[d],g[d]=1>=b.length?-1:b[1].index};m(0,b,"target",function(){return this._target},function(a){this._target&&this._target.off("effectbegin",this,this._onOtherBegin);if(this._target=a)this._target.on("effectbegin",this,this._onOtherBegin);this._addEvent()});m(0,b,"playEvent",null,function(a){(this._playEvent=a)&&this._addEvent()});m(0,b,"effectData",null,function(a){a&&(a=a.animations)&&a[0]&&(a=a[0],this._setUp({},a),a.nodes&&a.nodes[0]&&(this._aniKeys=a.nodes[0].keys))});m(0,b,"effectClass",null,function(a){(this._effectClass=ra.getClass(a))&&(a=this._effectClass.uiView)&&(a=a.animations)&&a[0]&&(a=a[0],this._setUp({},a),a.nodes&&a.nodes[0]&&(this._aniKeys=a.nodes[0].keys))});c.EFFECT_BEGIN="effectbegin";return c})(Za);l.__init([Ra,W,V,lb,cb,$a,v,ba,ga,oa,tb,qb,eb,Lc])})(window,document,Laya);(function(G,Ga,l){var t=l["class"];new (function(){function l(){}t(l,"LayaMain");return l}())})(window,document,Laya);