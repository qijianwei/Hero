window=window||global;window.layalib||(window.layalib=function(w,A){(window._layalibs||(window._layalibs=[])).push({f:w,i:A})});window.layalib(function(w,A,q){var B=q["static"],u=q["class"],p=q.getset,l=laya.utils.Browser;A=laya.events.EventDispatcher;var H=laya.resource.HTMLImage,x=laya.utils.Handler,r=laya.display.Input,t=laya.net.Loader,I=laya.net.LocalStorage,J=laya.maths.Matrix,F=laya.renders.Render,K=laya.utils.RunDriver,L=laya.media.SoundChannel,z=laya.media.SoundManager,m=laya.net.URL,C=laya.utils.Utils;(function(){function a(){}u(a,"laya.wx.mini.MiniLocation");a.__init__=function(){e.window.navigator.geolocation.getCurrentPosition=a.getCurrentPosition;e.window.navigator.geolocation.watchPosition=a.watchPosition;e.window.navigator.geolocation.clearWatch=a.clearWatch};a.getCurrentPosition=function(b,c,a){a={success:function(c){null!=b&&b(c)}};a.fail=c;e.window.wx.getLocation(a)};a.watchPosition=function(b,c,d){a._curID++;d={};d.success=b;d.error=c;a._watchDic[a._curID]=d;q.systemTimer.loop(1E3,null,a._myLoop);return a._curID};a.clearWatch=function(b){delete a._watchDic[b];a._hasWatch()||q.systemTimer.clear(null,a._myLoop)};a._hasWatch=function(){for(var b in a._watchDic)if(a._watchDic[b])return!0;return!1};a._myLoop=function(){a.getCurrentPosition(a._mySuccess,a._myError)};a._mySuccess=function(b){var c={};c.coords=b;c.timestamp=l.now();for(var d in a._watchDic)a._watchDic[d].success&&a._watchDic[d].success(c)};a._myError=function(b){for(var c in a._watchDic)a._watchDic[c].error&&a._watchDic[c].error(b)};a._watchDic={};a._curID=0;return a})();var g=function(){function a(){}u(a,"laya.wx.mini.MiniFileMgr");a.isLocalNativeFile=function(b){for(var c=0,a=e.nativefiles.length;c<a;c++)if(-1!=b.indexOf(e.nativefiles[c]))return!0;return!1};a.getFileInfo=function(b){b=a.fakeObj[b];return null!=b?b:null};a.read=function(b,c,d,f,k,e){void 0===c&&(c="utf8");void 0===f&&(f="");void 0===k&&(k=!1);void 0===e&&(e="");b=""==f||-1==f.indexOf("http://")&&-1==f.indexOf("https://")?b:a.getFileNativePath(b);b=m.getAdptedFilePath(b);a.fs.readFile({filePath:b,encoding:c,success:function(b){null!=d&&d.runWith([0,b])},fail:function(b){b&&""!=f?a.downFiles(f,c,d,f,k,e):null!=d&&d.runWith([1])}})};a.downFiles=function(b,c,d,f,k,e,g){void 0===c&&(c="ascii");void 0===f&&(f="");void 0===k&&(k=!1);void 0===e&&(e="");void 0===g&&(g=!0);a.wxdown({url:b,success:function(h){200===h.statusCode?a.readFile(h.tempFilePath,c,d,f,k,e,g):403===h.statusCode?null!=d&&d.runWith([0,b]):null!=d&&d.runWith([1,h])},fail:function(b){null!=d&&d.runWith([1,b])}}).onProgressUpdate(function(b){null!=d&&d.runWith([2,b.progress])})};a.readFile=function(b,c,d,f,k,h,g){void 0===c&&(c="utf8");void 0===f&&(f="");void 0===k&&(k=!1);void 0===h&&(h="");void 0===g&&(g=!0);b=m.getAdptedFilePath(b);a.fs.readFile({filePath:b,encoding:c,success:function(h){-1!=b.indexOf("http://")||-1!=b.indexOf("https://")?e.autoCacheFile||k?(null!=d&&d.runWith([0,h]),a.copyFile(b,f,null,c,g)):null!=d&&d.runWith([0,h]):null!=d&&d.runWith([0,h])},fail:function(b){b&&null!=d&&d.runWith([1,b])}})};a.downOtherFiles=function(b,c,d,f,k){void 0===d&&(d="");void 0===f&&(f=!1);void 0===k&&(k=!0);a.wxdown({url:b,success:function(b){200===b.statusCode?(e.autoCacheFile||f)&&-1==d.indexOf("qlogo.cn")&&-1==d.indexOf(".php")?(null!=c&&c.runWith([0,b.tempFilePath]),a.copyFile(b.tempFilePath,d,null,"",k)):null!=c&&c.runWith([0,b.tempFilePath]):null!=c&&c.runWith([1,b])},fail:function(b){null!=c&&c.runWith([1,b])}})};a.downLoadFile=function(b,c,d,f){void 0===c&&(c="");void 0===f&&(f="ascii");0>e.window.navigator.userAgent.indexOf("MiniGame")?q.loader.load(b,d):"image"==c||"sound"==c?a.downOtherFiles(b,d,b,!0,!1):a.downFiles(b,f,d,b,!0,c,!1)};a.copyFile=function(b,c,d,f,k){void 0===f&&(f="");void 0===k&&(k=!0);var h=b.split("/"),g=h[h.length-1],h=a.getFileInfo(c),m=a.getFileNativePath(g);a.fakeObj[c]={md5:g,readyUrl:c,size:0,times:l.now(),encoding:f};var n=a.getCacheUseSize();h?h.readyUrl!=c?a.fs.getFileInfo({filePath:b,success:function(b){k&&52428800<=n+4194304+b.size&&(b.size>e.minClearSize&&(e.minClearSize=b.size),a.onClearCacheRes());a.deleteFile(g,c,d,f,b.size)},fail:function(b){null!=d&&d.runWith([1,b])}}):null!=d&&d.runWith([0]):a.fs.getFileInfo({filePath:b,success:function(h){k&&52428800<=n+4194304+h.size&&(h.size>e.minClearSize&&(e.minClearSize=h.size),a.onClearCacheRes());a.fs.copyFile({srcPath:b,destPath:m,success:function(b){a.onSaveFile(c,g,!0,f,d,h.size)},fail:function(b){null!=d&&d.runWith([1,b])}})},fail:function(b){null!=d&&d.runWith([1,b])}})};a.onClearCacheRes=function(){var b=e.minClearSize,c=[],d;for(d in a.filesListObj)c.push(a.filesListObj[d]);a.sortOn(c,"times",16);d=0;for(var f=1,k=c.length;f<k;f++){var h=c[f];if(d>=b)break;d+=h.size;a.deleteFile("",h.readyUrl)}};a.sortOn=function(b,c,a){void 0===a&&(a=0);return 16==a?b.sort(function(b,a){return b[c]-a[c]}):18==a?b.sort(function(b,a){return a[c]-b[c]}):b.sort(function(b,a){return b[c]-a[c]})};a.getFileNativePath=function(b){return laya.wx.mini.MiniFileMgr.fileNativeDir+"/"+b};a.deleteFile=function(b,c,d,f,e){void 0===c&&(c="");void 0===f&&(f="");void 0===e&&(e=0);var k=a.getFileInfo(c),k=a.getFileNativePath(k.md5);a.fs.unlink({filePath:k,success:function(k){var g=""!=b?!0:!1;if(""!=b)k=a.getFileNativePath(b),a.fs.copyFile({srcPath:b,destPath:k,success:function(e){a.onSaveFile(c,b,g,f,d,e.size)},fail:function(b){null!=d&&d.runWith([1,b])}});else a.onSaveFile(c,b,g,f,d,e)},fail:function(b){}})};a.deleteAll=function(){var b=[],c;for(c in a.filesListObj)b.push(a.filesListObj[c]);c=1;for(var d=b.length;c<d;c++)a.deleteFile("",b[c].readyUrl);laya.wx.mini.MiniFileMgr.filesListObj&&laya.wx.mini.MiniFileMgr.filesListObj.fileUsedSize&&(laya.wx.mini.MiniFileMgr.filesListObj.fileUsedSize=0);laya.wx.mini.MiniFileMgr.writeFilesList("",JSON.stringify({}),!1)};a.onSaveFile=function(b,c,d,f,e,g){void 0===d&&(d=!0);void 0===f&&(f="");void 0===g&&(g=0);null==a.filesListObj.fileUsedSize&&(a.filesListObj.fileUsedSize=0);d?(a.getFileNativePath(c),a.filesListObj[b]={md5:c,readyUrl:b,size:g,times:l.now(),encoding:f},a.filesListObj.fileUsedSize=parseInt(a.filesListObj.fileUsedSize)+g,a.writeFilesList(b,JSON.stringify(a.filesListObj),!0),null!=e&&e.runWith([0])):a.filesListObj[b]&&(c=parseInt(a.filesListObj[b].size),a.filesListObj.fileUsedSize=parseInt(a.filesListObj.fileUsedSize)-c,delete a.filesListObj[b],a.writeFilesList(b,JSON.stringify(a.filesListObj),!1),null!=e&&e.runWith([0]))};a.writeFilesList=function(b,c,d){a.fs.writeFile({filePath:a.fileNativeDir+"/"+a.fileListName,encoding:"utf8",data:c,success:function(b){},fail:function(b){}});!e.isZiYu&&e.isPosMsgYu&&e.window.wx.postMessage&&e.window.wx.postMessage({url:b,data:a.filesListObj[b],isLoad:"filenative",isAdd:d})};a.getCacheUseSize=function(){return a.filesListObj&&a.filesListObj.fileUsedSize?a.filesListObj.fileUsedSize:0};a.existDir=function(b,c){a.fs.mkdir({dirPath:b,success:function(b){null!=c&&c.runWith([0,{data:JSON.stringify({})}])},fail:function(b){-1!=b.errMsg.indexOf("file already exists")?a.readSync(a.fileListName,"utf8",c):null!=c&&c.runWith([1,b])}})};a.readSync=function(b,c,d,f){void 0===c&&(c="utf8");b=a.getFileNativePath(b);var e;try{e=a.fs.readFileSync(b,c),null!=d&&d.runWith([0,{data:e}])}catch(h){null!=d&&d.runWith([1])}};a.setNativeFileDir=function(b){a.fileNativeDir=e.window.wx.env.USER_DATA_PATH+b};a.filesListObj={};a.fakeObj={};a.fileNativeDir=null;a.fileListName="layaairfiles.txt";a.ziyuFileData={};a.ziyuFileTextureData={};a.loadPath="";a.DESCENDING=2;a.NUMERIC=16;B(a,["fs",function(){return this.fs=e.window.wx.getFileSystemManager()},"wxdown",function(){return this.wxdown=e.window.wx.downloadFile}]);return a}(),G=function(){function a(){}u(a,"laya.wx.mini.MiniLocalStorage");a.__init__=function(){a.items=a};a.setItem=function(b,c){try{wx.setStorageSync(b,c)}catch(d){wx.setStorage({key:b,data:c})}};a.getItem=function(b){return wx.getStorageSync(b)};a.setJSON=function(b,c){a.setItem(b,c)};a.getJSON=function(b){return a.getItem(b)};a.removeItem=function(b){wx.removeStorageSync(b)};a.clear=function(){wx.clearStorageSync()};a.getStorageInfoSync=function(){try{var b=wx.getStorageInfoSync();console.log(b.keys);console.log(b.currentSize);console.log(b.limitSize);return b}catch(c){}return null};a.support=!0;a.items=null;return a}();(function(){function a(b,a){this.videoend=!1;this.videourl="";this.onEndedFunC=this.onPlayFunc=this.videoElement=null;this.position=this._duration=NaN;void 0===b&&(b=320);void 0===a&&(a=240);this.videoElement=e.window.wx.createVideo({width:b,height:a,autoplay:!0})}u(a,"laya.wx.mini.MiniVideo");var b=a.prototype;b.on=function(b,a,f){"loadedmetadata"==b?(this.onPlayFunc=f.bind(a),this.videoElement.onPlay=this.onPlayFunction.bind(this)):"ended"==b&&(this.onEndedFunC=f.bind(a),this.videoElement.onEnded=this.onEndedFunction.bind(this));this.videoElement.onTimeUpdate=this.onTimeUpdateFunc.bind(this)};b.onTimeUpdateFunc=function(b){this.position=b.position;this._duration=b.duration};b.onPlayFunction=function(){this.videoElement&&(this.videoElement.readyState=200);console.log("\x3d\x3d\x3d\x3d\x3d\u89c6\u9891\u52a0\u8f7d\u5b8c\u6210\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d");null!=this.onPlayFunc&&this.onPlayFunc()};b.onEndedFunction=function(){this.videoElement&&(this.videoend=!0,console.log("\x3d\x3d\x3d\x3d\x3d\u89c6\u9891\u64ad\u653e\u5b8c\u6bd5\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d"),null!=this.onEndedFunC&&this.onEndedFunC())};b.off=function(b,a,f){"loadedmetadata"==b?(this.onPlayFunc=f.bind(a),this.videoElement.offPlay=this.onPlayFunction.bind(this)):"ended"==b&&(this.onEndedFunC=f.bind(a),this.videoElement.offEnded=this.onEndedFunction.bind(this))};b.load=function(b){this.videoElement&&(this.videoElement.src=b)};b.play=function(){this.videoElement&&(this.videoend=!1,this.videoElement.play())};b.pause=function(){this.videoElement&&(this.videoend=!0,this.videoElement.pause())};b.size=function(b,a){this.videoElement&&(this.videoElement.width=b,this.videoElement.height=a)};b.destroy=function(){this.videoElement&&this.videoElement.destroy();this.onPlayFunc=this.onEndedFunC=this.videoElement=null;this.videoend=!1;this.videourl=null};b.reload=function(){this.videoElement&&(this.videoElement.src=this.videourl)};p(0,b,"duration",function(){return this._duration});p(0,b,"paused",function(){return this.videoElement?this.videoElement.paused:!1});p(0,b,"loop",function(){return this.videoElement?this.videoElement.loop:!1},function(b){this.videoElement&&(this.videoElement.loop=b)});p(0,b,"currentTime",function(){return this.videoElement?this.videoElement.initialTime:0},function(b){this.videoElement&&(this.videoElement.initialTime=b)});p(0,b,"ended",function(){return this.videoend});p(0,b,"muted",function(){return this.videoElement?this.videoElement.muted:!1},function(b){this.videoElement&&(this.videoElement.muted=b)});p(0,b,"videoWidth",function(){return this.videoElement?this.videoElement.width:0});p(0,b,"videoHeight",function(){return this.videoElement?this.videoElement.height:0});p(0,b,"playbackRate",function(){return this.videoElement?this.videoElement.playbackRate:0},function(b){this.videoElement&&(this.videoElement.playbackRate=b)});p(0,b,"x",function(){return this.videoElement?this.videoElement.x:0},function(b){this.videoElement&&(this.videoElement.x=b)});p(0,b,"y",function(){return this.videoElement?this.videoElement.y:0},function(b){this.videoElement&&(this.videoElement.y=b)});p(0,b,"currentSrc",function(){return this.videoElement.src});a.__init__=function(){laya.device.media.Video=a};return a})();var M=function(){function a(){}u(a,"laya.wx.mini.MiniImage");a.prototype._loadImage=function(b){if(e.isZiYu)a.onCreateImage(b,this,!0);else{var c=!1;if(g.isLocalNativeFile(b)){if(-1==b.indexOf("http://usr/")&&(-1!=b.indexOf("http://")||-1!=b.indexOf("https://")))if(""!=g.loadPath)b=b.split(g.loadPath)[1];else{var d=""!=m.rootPath?m.rootPath:m._basePath,f=b;""!=d&&(b=b.split(d)[1]);b||(b=f)}if(e.subNativeFiles&&0==e.subNativeheads.length)for(var k in e.subNativeFiles)for(d=e.subNativeFiles[k],e.subNativeheads=e.subNativeheads.concat(d),f=0;f<d.length;f++)e.subMaps[d[f]]=k+"/"+d[f];e.subNativeFiles&&-1!=b.indexOf("/")&&(k=b.split("/")[0]+"/")&&-1!=e.subNativeheads.indexOf(k)&&(b=b.replace(k,e.subMaps[k]))}else c=!0,b=m.formatURL(b);if(g.getFileInfo(b))a.onCreateImage(b,this,!c);else if(-1!=b.indexOf("http://usr/")||-1==b.indexOf("http://")&&-1==b.indexOf("https://"))a.onCreateImage(b,this,!0);else if(e.isZiYu)a.onCreateImage(b,this,!0);else g.downOtherFiles(b,new x(a,a.onDownImgCallBack,[b,this]),b)}};a.onDownImgCallBack=function(b,c,d,f){void 0===f&&(f="");if(d)c.onError(null);else a.onCreateImage(b,c,!1,f)};a.onCreateImage=function(b,a,d,f){function c(){var b=a._imgCache[h];b&&(b.onload=null,b.onerror=null,delete a._imgCache[h])}void 0===d&&(d=!1);void 0===f&&(f="");var h;e.autoCacheFile?d?e.isZiYu?(d=m.formatURL(b),h=g.ziyuFileTextureData[d]?g.ziyuFileTextureData[d]:b):h=b:""!=f?h=f:(b=g.getFileInfo(b).md5,h=g.getFileNativePath(b)):h=d?b:f;null==a._imgCache&&(a._imgCache={});var v;b=function(){c();a.event("error","Load image failed")};if("nativeimage"==a._type)v=new l.window.Image,v.crossOrigin="",v.onload=function(){c();a.onLoaded(v)},v.onerror=b,v.src=h,a._imgCache[h]=v;else{var y=new l.window.Image;y.crossOrigin="";y.onload=function(){v=H.create(y.width,y.height);v.loadImageSource(y,!0);v._setCreateURL(h);c();a.onLoaded(v)};y.onerror=b;y.src=h;a._imgCache[h]=y}};return a}(),E=function(){function a(){}u(a,"laya.wx.mini.MiniInput");a._createInputElement=function(){r._initInput(r.area=l.createElement("textarea"));r._initInput(r.input=l.createElement("input"));r.inputContainer=l.createElement("div");r.inputContainer.style.position="absolute";r.inputContainer.style.zIndex=1E5;l.container.appendChild(r.inputContainer);r.inputContainer.setPos=function(b,a){r.inputContainer.style.left=b+"px";r.inputContainer.style.top=a+"px"};q.stage.on("resize",null,a._onStageResize);wx.onWindowResize&&wx.onWindowResize(function(b){w.dispatchEvent&&w.dispatchEvent("resize")});z._soundClass=D;z._musicClass=D;var b=e.systemInfo.system;-1!=e.systemInfo.model.indexOf("iPhone")&&(l.onIPhone=!0,l.onIOS=!0,l.onIPad=!0,l.onAndroid=!1);if(-1!=b.indexOf("Android")||-1!=b.indexOf("Adr"))l.onAndroid=!0,l.onIPhone=!1,l.onIOS=!1,l.onIPad=!1};a._onStageResize=function(){q.stage._canvasTransform.identity().scale(l.width/F.canvas.width/l.pixelRatio,l.height/F.canvas.height/l.pixelRatio)};a.wxinputFocus=function(b){var a=r.inputElement.target;if(!a||a.editable)e.window.wx.offKeyboardConfirm(),e.window.wx.offKeyboardInput(),e.window.wx.showKeyboard({defaultValue:a.text,maxLength:a.maxChars,multiple:a.multiline,confirmHold:!0,confirmType:a.confirmType||"done",success:function(b){},fail:function(b){}}),e.window.wx.onKeyboardConfirm(function(b){b=b?b.value:"";a._restrictPattern&&(b=b.replace(/\u2006|\x27/g,""),a._restrictPattern.test(b)&&(b=b.replace(a._restrictPattern,"")));a.text=b;a.event("input");laya.wx.mini.MiniInput.inputEnter();a.event("confirm")}),e.window.wx.onKeyboardInput(function(b){b=b?b.value:"";a.multiline||-1==b.indexOf("\n")?(a._restrictPattern&&(b=b.replace(/\u2006|\x27/g,""),a._restrictPattern.test(b)&&(b=b.replace(a._restrictPattern,""))),a.text=b,a.event("input")):laya.wx.mini.MiniInput.inputEnter()})};a.inputEnter=function(){r.inputElement.target.focus=!1};a.wxinputblur=function(){a.hideKeyboard()};a.hideKeyboard=function(){e.window.wx.offKeyboardConfirm();e.window.wx.offKeyboardInput();e.window.wx.hideKeyboard({success:function(b){console.log("\u9690\u85cf\u952e\u76d8")},fail:function(b){console.log("\u9690\u85cf\u952e\u76d8\u51fa\u9519:"+(b?b.errMsg:""))}})};return a}(),e=function(){function a(){}u(a,"laya.wx.mini.MiniAdpter");a.getJson=function(b){return JSON.parse(b)};a.enable=function(){a.init(q.isWXPosMsg,q.isWXOpenDataContext)};a.init=function(b,c){void 0===b&&(b=!1);void 0===c&&(c=!1);a._inited||(a._inited=!0,a.window=w,!a.window.hasOwnProperty("wx")||0>a.window.navigator.userAgent.indexOf("MiniGame")||(a.isZiYu=c,a.isPosMsgYu=b,a.EnvConfig={},a.isZiYu||(g.setNativeFileDir("/layaairGame"),g.existDir(g.fileNativeDir,x.create(a,a.onMkdirCallBack))),a.systemInfo=wx.getSystemInfoSync(),a.window.focus=function(){},q._getUrlPath=function(){return""},a.window.logtime=function(b){},a.window.alertTimeLog=function(b){},a.window.resetShareInfo=function(){},a.window.CanvasRenderingContext2D=function(){},a.window.CanvasRenderingContext2D.prototype=a.window.wx.createCanvas().getContext("2d").__proto__,a.window.document.body.appendChild=function(){},a.EnvConfig.pixelRatioInt=0,l._pixelRatio=a.pixelRatio(),a._preCreateElement=l.createElement,l.createElement=a.createElement,K.createShaderCondition=a.createShaderCondition,C.parseXMLFromString=a.parseXMLFromString,r._createInputElement=E._createInputElement,a.EnvConfig.load=t.prototype.load,t.prototype.load=N.prototype.load,t.prototype._loadImage=M.prototype._loadImage,I._baseClass=G,G.__init__(),a.window.wx.onMessage(a._onMessage)))};a._onMessage=function(b){switch(b.type){case "changeMatrix":q.stage.transform.identity();q.stage._width=b.w;q.stage._height=b.h;q.stage._canvasTransform=new J(b.a,b.b,b.c,b.d,b.tx,b.ty);break;case "display":q.stage.frameRate=b.rate||"fast";break;case "undisplay":q.stage.frameRate="sleep"}"opendatacontext"==b.isLoad?b.url&&(g.ziyuFileData[b.url]=b.atlasdata,g.ziyuFileTextureData[b.imgReadyUrl]=b.imgNativeUrl):"openJsondatacontext"==b.isLoad?b.url&&(g.ziyuFileData[b.url]=b.atlasdata):"openJsondatacontextPic"==b.isLoad&&(g.ziyuFileTextureData[b.imgReadyUrl]=b.imgNativeUrl)};a.getUrlEncode=function(b,a){return"arraybuffer"==a?"":"utf8"};a.downLoadFile=function(b,a,d,f){void 0===a&&(a="");void 0===f&&(f="utf8");g.getFileInfo(b)?null!=d&&d.runWith([0]):g.downLoadFile(b,a,d,f)};a.remove=function(b,a){g.deleteFile("",b,a,"",0)};a.removeAll=function(){g.deleteAll()};a.hasNativeFile=function(b){return g.isLocalNativeFile(b)};a.getFileInfo=function(b){return g.getFileInfo(b)};a.getFileList=function(){return g.filesListObj};a.exitMiniProgram=function(){a.window.wx.exitMiniProgram()};a.onMkdirCallBack=function(b,a){b||(g.filesListObj=JSON.parse(a.data),g.fakeObj=g.filesListObj)};a.pixelRatio=function(){if(!a.EnvConfig.pixelRatioInt)try{return a.EnvConfig.pixelRatioInt=a.systemInfo.pixelRatio}catch(b){}return a.EnvConfig.pixelRatioInt};a.createElement=function(b){return"canvas"==b?(1==a.idx?a.isZiYu?(b=sharedCanvas,b.style={}):b=w.canvas:b=w.wx.createCanvas(),a.idx++,b):"textarea"==b||"input"==b?a.onCreateInput(b):"div"==b?(b=a._preCreateElement(b),b.contains=function(b){return null},b.removeChild=function(b){},b):a._preCreateElement(b)};a.onCreateInput=function(b){b=a._preCreateElement(b);b.focus=E.wxinputFocus;b.blur=E.wxinputblur;b.style={};b.value=0;b.parentElement={};b.placeholder={};b.type={};b.setColor=function(b){};b.setType=function(b){};b.setFontFace=function(b){};b.addEventListener=function(b){};b.contains=function(b){return null};b.removeChild=function(b){};return b};a.createShaderCondition=function(b){var a=this;return function(){return a[b.replace("this.","")]}};a.sendAtlasToOpenDataContext=function(b){if(!laya.wx.mini.MiniAdpter.isZiYu){var c=t.getRes(m.formatURL(b));if(c){c.meta.image.split(",");if(c.meta&&c.meta.image)for(var d=c.meta.image.split(","),f=0<=b.indexOf("/")?"/":"\\",f=b.lastIndexOf(f),f=0<=f?b.substr(0,f+1):"",e=0,g=d.length;e<g;e++)d[e]=f+d[e];else d=[b.replace(".json",".png")];for(e=0;e<d.length;e++)a.postInfoToContext(b,d[e],c)}else throw"\u4f20\u9012\u7684url\u6ca1\u6709\u83b7\u53d6\u5230\u5bf9\u5e94\u7684\u56fe\u96c6\u6570\u636e\u4fe1\u606f\uff0c\u8bf7\u786e\u4fdd\u56fe\u96c6\u5df2\u7ecf\u8fc7\uff01";}};a.postInfoToContext=function(b,a,d){d={frames:d.frames,meta:d.meta};var c=g.getFileInfo(m.formatURL(a));if(c=c?g.getFileNativePath(c.md5):a)wx.postMessage({url:b,atlasdata:d,imgNativeUrl:c,imgReadyUrl:a,isLoad:"opendatacontext"});else throw"\u83b7\u53d6\u56fe\u96c6\u7684\u78c1\u76d8url\u8def\u5f84\u4e0d\u5b58\u5728\uff01";};a.sendSinglePicToOpenDataContext=function(b){var a=m.formatURL(b),d=g.getFileInfo(a);d?(d=g.getFileNativePath(d.md5),b=a):d=b;if(d)wx.postMessage({url:b,imgNativeUrl:d,imgReadyUrl:b,isLoad:"openJsondatacontextPic"});else throw"\u83b7\u53d6\u56fe\u96c6\u7684\u78c1\u76d8url\u8def\u5f84\u4e0d\u5b58\u5728\uff01";};a.sendJsonDataToDataContext=function(b){if(!laya.wx.mini.MiniAdpter.isZiYu){var a=t.getRes(b);if(a)wx.postMessage({url:b,atlasdata:a,isLoad:"openJsondatacontext"});else throw"\u4f20\u9012\u7684url\u6ca1\u6709\u83b7\u53d6\u5230\u5bf9\u5e94\u7684\u56fe\u96c6\u6570\u636e\u4fe1\u606f\uff0c\u8bf7\u786e\u4fdd\u56fe\u96c6\u5df2\u7ecf\u8fc7\uff01";}};a.EnvConfig=null;a.window=null;a._preCreateElement=null;a._inited=!1;a.systemInfo=null;a.isZiYu=!1;a.isPosMsgYu=!1;a.autoCacheFile=!0;a.minClearSize=5242880;a.subNativeFiles=null;a.subNativeheads=[];a.subMaps=[];a.AutoCacheDownFile=!1;a.parseXMLFromString=function(b){var a;b=b.replace(/>\s+</g,"\x3e\x3c");try{a=(new w.Parser.DOMParser).parseFromString(b,"text/xml")}catch(d){throw"\u9700\u8981\u5f15\u5165xml\u89e3\u6790\u5e93\u6587\u4ef6";}return a};a.idx=1;B(a,["nativefiles",function(){return this.nativefiles=["layaNativeDir","wxlocal"]}]);return a}(),N=function(a){function b(){b.__super.call(this)}u(b,"laya.wx.mini.MiniLoader",a);b.prototype.load=function(a,d,f,k,h){void 0===f&&(f=!0);void 0===h&&(h=!1);if(this._url=a)if(a=m.customFormat(a),0===a.indexOf("data:image")?this._type=d="image":this._type=d||(d=t.getTypeFromUrl(this._url)),this._cache=f,this._data=null,!h&&t.loadedMap[m.formatURL(a)])this._data=t.loadedMap[m.formatURL(a)],this.event("progress",1),this.event("complete",this._data);else if(null!=t.parserMap[d])this._customParse=!0,t.parserMap[d]instanceof laya.utils.Handler?t.parserMap[d].runWith(this):t.parserMap[d].call(null,this);else{var c;switch(d){case "atlas":case "prefab":case "plf":c="json";break;case "font":c="xml";break;case "plfb":c="arraybuffer";break;default:c=d}if(t.preLoadedMap[m.formatURL(a)])this.onLoaded(t.preLoadedMap[m.formatURL(a)]);else{c=e.getUrlEncode(a,c);var l=C.getFileExtension(a);if(-1!=b._fileTypeArr.indexOf(l))e.EnvConfig.load.call(this,a,d,f,k,h);else if(e.isZiYu&&!g.ziyuFileData[a]&&(a=m.formatURL(a)),e.isZiYu&&g.ziyuFileData[a])this.onLoaded(g.ziyuFileData[a]);else if(g.getFileInfo(a)){var n=g.getFileInfo(a);n.encoding=null==n.encoding?"utf8":n.encoding;g.readFile(a,n.encoding,new x(b,b.onReadNativeCallBack,[c,a,d,f,k,h,this]),a)}else if(g.isLocalNativeFile(a)){if(e.subNativeFiles&&0==e.subNativeheads.length)for(n in e.subNativeFiles){l=e.subNativeFiles[n];e.subNativeheads=e.subNativeheads.concat(l);for(var p=0;p<l.length;p++)e.subMaps[l[p]]=n+"/"+l[p]}e.subNativeFiles&&-1!=a.indexOf("/")&&(n=a.split("/")[0]+"/")&&-1!=e.subNativeheads.indexOf(n)&&(a=a.replace(n,e.subMaps[n]));n=""!=m.rootPath?m.rootPath:m._basePath;l=a;""!=n&&(a=a.split(n)[1]);a||(a=l);g.read(a,c,new x(b,b.onReadNativeCallBack,[c,a,d,f,k,h,this]))}else n=m.formatURL(a),-1!=n.indexOf("http://usr/")||-1==n.indexOf("http://")&&-1==n.indexOf("https://")||e.AutoCacheDownFile?(n=g.getFileInfo(a))?(n.encoding=null==n.encoding?"utf8":n.encoding,g.readFile(n.url,c,new x(b,b.onReadNativeCallBack,[c,a,d,f,k,h,this]),a)):"image"==this.type||"htmlimage"==this.type?e.EnvConfig.load.call(this,a,d,f,k,h):(a=m.formatURL(a),-1==a.indexOf("http://")&&-1==a.indexOf("https://")||g.isLocalNativeFile(a)?g.readFile(a,c,new x(b,b.onReadNativeCallBack,[c,a,d,f,k,h,this]),a):g.downFiles(a,c,new x(b,b.onReadNativeCallBack,[c,a,d,f,k,h,this]),a,f)):e.EnvConfig.load.call(this,a,d,f,k,h)}}else this.onLoaded(null)};b.onReadNativeCallBack=function(b,a,f,g,h,l,m,n,p){void 0===g&&(g=!0);void 0===l&&(l=!1);void 0===n&&(n=0);n?1==n&&e.EnvConfig.load.call(m,a,f,g,h,l):(b="json"==f||"atlas"==f||"prefab"==f||"plf"==f?e.getJson(p.data):"xml"==f?C.parseXMLFromString(p.data):p.data,!e.isZiYu&&e.isPosMsgYu&&"arraybuffer"!=f&&wx.postMessage({url:a,data:b,isLoad:"filedata"}),m.onLoaded(b))};B(b,["_fileTypeArr",function(){return this._fileTypeArr=["png","jpg","bmp","jpeg","gif"]}]);return b}(A),D=function(a){function b(){this.url=this._sound=null;this.loaded=!1;this.readyUrl=null;b.__super.call(this)}u(b,"laya.wx.mini.MiniSound",a);a=b.prototype;a.load=function(a){if(!g.isLocalNativeFile(a))a=m.formatURL(a);else if(-1!=a.indexOf("http://")||-1!=a.indexOf("https://"))if(""!=g.loadPath)a=a.split(g.loadPath)[1];else{var d=""!=m.rootPath?m.rootPath:m._basePath;""!=d&&(a=a.split(d)[1])}this.readyUrl=this.url=a;if(b._audioCache[this.readyUrl])this.event("complete");else if(e.autoCacheFile&&g.getFileInfo(a))this.onDownLoadCallBack(a,0);else if(e.autoCacheFile)if(g.isLocalNativeFile(a)){var d=""!=m.rootPath?m.rootPath:m._basePath,c=a;""!=d&&(a=a.split(d)[1]);a||(a=c);if(e.subNativeFiles&&0==e.subNativeheads.length)for(var k in e.subNativeFiles)for(d=e.subNativeFiles[k],e.subNativeheads=e.subNativeheads.concat(d),c=0;c<d.length;c++)e.subMaps[d[c]]=k+"/"+d[c];e.subNativeFiles&&-1!=a.indexOf("/")&&(k=a.split("/")[0]+"/")&&-1!=e.subNativeheads.indexOf(k)&&(a=a.replace(k,e.subMaps[k]));this.onDownLoadCallBack(a,0)}else if(!g.isLocalNativeFile(a)&&-1==a.indexOf("http://")&&-1==a.indexOf("https://")||-1!=a.indexOf("http://usr/"))this.onDownLoadCallBack(a,0);else g.downOtherFiles(a,x.create(this,this.onDownLoadCallBack,[a]),a);else this.onDownLoadCallBack(a,0)};a.onDownLoadCallBack=function(a,d,f){if(d)this.event("error");else{var c;e.autoCacheFile?(f?c=f:g.isLocalNativeFile(a)?(d=""!=m.rootPath?m.rootPath:m._basePath,""==d||-1==a.indexOf("http://")&&-1==a.indexOf("https://")||(c=a.split(d)[1]),c||(c=a)):c=(c=g.getFileInfo(a))&&c.md5?g.getFileNativePath(c.md5):a,this._sound=b._createSound(),this._sound.src=this.url=c):(this._sound=b._createSound(),this._sound.src=a);this._sound.onCanplay(b.bindToThis(this.onCanPlay,this));this._sound.onError(b.bindToThis(this.onError,this))}};a.onError=function(a){try{console.log("-----1---------------minisound-----id:"+b._id),console.log(a)}catch(d){console.log("-----2---------------minisound-----id:"+b._id),console.log(d)}this.event("error");this._sound.offError(null)};a.onCanPlay=function(){this.loaded=!0;this.event("complete");this._sound.offCanplay(null)};a.play=function(a,d){void 0===a&&(a=0);void 0===d&&(d=0);var c;this.url==z._bgMusic?(b._musicAudio||(b._musicAudio=b._createSound()),c=b._musicAudio):c=b._audioCache[this.readyUrl]?b._audioCache[this.readyUrl]._sound:b._createSound();if(!c)return null;if(e.autoCacheFile&&g.getFileInfo(this.url)){var k=g.getFileInfo(this.url).md5;c.src=this.url=g.getFileNativePath(k)}else c.src=this.url;c=new O(c,this);c.url=this.url;c.loops=d;c.loop=0===d?!0:!1;c.startTime=a;c.play();z.addChannel(c);return c};a.dispose=function(){var a=b._audioCache[this.readyUrl];a&&(a.src="",a._sound&&(a._sound.destroy(),a._sound=null),delete b._audioCache[this.readyUrl])};p(0,a,"duration",function(){return this._sound.duration});b._createSound=function(){b._id++;return e.window.wx.createInnerAudioContext()};b.bindToThis=function(a,b){return a.bind(b)};b._musicAudio=null;b._id=0;b._audioCache={};return b}(A);(function(a){function b(){b.__super.call(this)}u(b,"laya.wx.mini.MiniAccelerator",a);var c=b.prototype;c.on=function(c,e,g,h){a.prototype.on.call(this,c,e,g,h);b.startListen(this.onDeviceOrientationChange);return this};c.off=function(c,e,g,h){void 0===h&&(h=!1);this.hasListener(c)||b.stopListen();return a.prototype.off.call(this,c,e,g,h)};b.__init__=function(){try{var a;if(a=laya.device.motion.Accelerator)a.prototype.on=b.prototype.on,a.prototype.off=b.prototype.off}catch(f){}};b.startListen=function(a){b._callBack=a;if(!b._isListening){b._isListening=!0;try{e.window.wx.onAccelerometerChange(laya.wx.mini.MiniAccelerator.onDeviceOrientationChange)}catch(f){}}};b.stopListen=function(){b._isListening=!1;try{e.window.wx.stopAccelerometer({})}catch(d){}};b.onDeviceOrientationChange=function(a){var c;c={};c.acceleration=a;c.accelerationIncludingGravity=a;c.rotationRate={};null!=b._callBack&&b._callBack(c)};b._isListening=!1;b._callBack=null;return b})(A);var O=function(a){function b(a,d){this._miniSound=this._onEnd=this._audio=null;b.__super.call(this);this._audio=a;this._miniSound=d;this._onEnd=b.bindToThis(this.__onEnd,this);a.onEnded(this._onEnd)}u(b,"laya.wx.mini.MiniSoundChannel",a);a=b.prototype;a.__onEnd=function(){D._audioCache[this.url]=this._miniSound;1==this.loops?(this.completeHandler&&(q.systemTimer.once(10,this,this.__runComplete,[this.completeHandler],!1),this.completeHandler=null),this.stop(),this.event("complete")):(0<this.loops&&this.loops--,this.startTime=0,this.play())};a.play=function(){this.isStopped=!1;z.addChannel(this);this._audio.play()};a.stop=function(){this.isStopped=!0;z.removeChannel(this);this.completeHandler=null;this._audio&&(this._audio.stop(),this._audio.offEnded(null),this._miniSound.dispose(),this._onEnd=this._miniSound=this._audio=null)};a.pause=function(){this.isStopped=!0;this._audio.pause()};a.resume=function(){this._audio&&(this.isStopped=!1,z.addChannel(this),this._audio.play())};p(0,a,"startTime",null,function(a){this._audio&&(this._audio.startTime=a)});p(0,a,"autoplay",function(){return this._audio.autoplay},function(a){this._audio.autoplay=a});p(0,a,"position",function(){return this._audio?this._audio.currentTime:0});p(0,a,"duration",function(){return this._audio?this._audio.duration:0});p(0,a,"loop",function(){return this._audio.loop},function(a){this._audio.loop=a});p(0,a,"volume",function(){return this._audio?this._audio.volume:1},function(a){this._audio&&(this._audio.volume=a)});b.bindToThis=function(a,b){return a.bind(b)};return b}(L)},1E3);